<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.537">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aldebaro Klautau">

<title>Digital Signal Processing with Python, Matlab or Octave</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ak_dsp_bookse53.html" rel="next">
<link href="./ak_dsp_bookse51.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ak_dsp_bookse50.html">ak_dsp_bookch4</a></li><li class="breadcrumb-item"><a href="./ak_dsp_bookse52.html"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">ak_dsp_bookse52.html</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Digital Signal Processing with Python, Matlab or Octave</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">ak_dsp_bookap1.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">ak_dsp_bookap2.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">ak_dsp_bookap3.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">ak_dsp_bookap4.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ak_dsp_bookli1.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">ak_dsp_bookli2.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">ak_dsp_bookli3.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">ak_dsp_bookli4.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">ak_dsp_book.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ak_dsp_bookch1.html</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">ak_dsp_bookse1.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">ak_dsp_bookse2.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">ak_dsp_bookse3.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">ak_dsp_bookse4.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">ak_dsp_bookse5.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">ak_dsp_bookse6.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">ak_dsp_bookse7.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">ak_dsp_bookse8.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">ak_dsp_bookse9.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">ak_dsp_bookse10.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">ak_dsp_bookse11.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">ak_dsp_bookse12.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">ak_dsp_bookse13.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">ak_dsp_bookse14.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">ak_dsp_bookse15.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ak_dsp_bookse16.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">ak_dsp_bookse17.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">ak_dsp_bookch2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">ak_dsp_bookse18.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">ak_dsp_bookse19.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">ak_dsp_bookse20.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">ak_dsp_bookse21.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">ak_dsp_bookse22.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">ak_dsp_bookse23.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">ak_dsp_bookse24.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">ak_dsp_bookse25.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">ak_dsp_bookse26.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">ak_dsp_bookse27.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">ak_dsp_bookse28.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">ak_dsp_bookse29.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">ak_dsp_bookse30.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">ak_dsp_bookch3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">ak_dsp_bookse31.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">ak_dsp_bookse32.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">ak_dsp_bookse33.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">ak_dsp_bookse34.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">ak_dsp_bookse35.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse36.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">ak_dsp_bookse36.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse37.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">ak_dsp_bookse37.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse38.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">ak_dsp_bookse38.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse39.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ak_dsp_bookse39.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse40.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">ak_dsp_bookse40.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse41.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">ak_dsp_bookse41.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse42.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">ak_dsp_bookse42.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse43.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">ak_dsp_bookse43.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse44.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">ak_dsp_bookse44.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse45.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">ak_dsp_bookse45.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse46.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">ak_dsp_bookse46.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse47.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">ak_dsp_bookse47.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse48.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">ak_dsp_bookse48.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse49.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">ak_dsp_bookse49.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">ak_dsp_bookch4</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">ak_dsp_bookse50.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse51.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">ak_dsp_bookse51.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse52.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">ak_dsp_bookse52.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse53.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">ak_dsp_bookse53.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse54.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">ak_dsp_bookse54.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse55.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">ak_dsp_bookse55.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse56.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">ak_dsp_bookse56.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse57.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">ak_dsp_bookse57.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse58.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">ak_dsp_bookse58.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse59.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">ak_dsp_bookse59.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse60.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">ak_dsp_bookse60.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse61.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">ak_dsp_bookse61.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse62.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">ak_dsp_bookse62.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse63.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">ak_dsp_bookse63.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse64.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">ak_dsp_bookse64.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse65.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">ak_dsp_bookse65.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse66.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">ak_dsp_bookse66.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse67.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">ak_dsp_bookse67.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse68.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">ak_dsp_bookse68.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse69.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">ak_dsp_bookse69.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse70.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">ak_dsp_bookse70.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse71.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">ak_dsp_bookse71.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse72.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">ak_dsp_bookse72.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse73.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">ak_dsp_bookse73.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse74.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">ak_dsp_bookse74.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse75.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">ak_dsp_bookse75.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse76.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">85</span>&nbsp; <span class="chapter-title">ak_dsp_bookse76.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse77.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">86</span>&nbsp; <span class="chapter-title">ak_dsp_bookse77.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse78.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">87</span>&nbsp; <span class="chapter-title">ak_dsp_bookse78.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse79.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">88</span>&nbsp; <span class="chapter-title">ak_dsp_bookse79.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse80.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">89</span>&nbsp; <span class="chapter-title">ak_dsp_bookse80.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse81.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">90</span>&nbsp; <span class="chapter-title">ak_dsp_bookse81.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse82.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">91</span>&nbsp; <span class="chapter-title">ak_dsp_bookse82.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse83.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">92</span>&nbsp; <span class="chapter-title">ak_dsp_bookse83.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse84.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">93</span>&nbsp; <span class="chapter-title">ak_dsp_bookse84.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse85.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">94</span>&nbsp; <span class="chapter-title">ak_dsp_bookse85.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse86.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">95</span>&nbsp; <span class="chapter-title">ak_dsp_bookse86.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse87.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">96</span>&nbsp; <span class="chapter-title">ak_dsp_bookse87.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse88.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">97</span>&nbsp; <span class="chapter-title">ak_dsp_bookse88.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse89.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">98</span>&nbsp; <span class="chapter-title">ak_dsp_bookse89.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse90.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">99</span>&nbsp; <span class="chapter-title">ak_dsp_bookse90.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse91.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">100</span>&nbsp; <span class="chapter-title">ak_dsp_bookse91.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse92.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">101</span>&nbsp; <span class="chapter-title">ak_dsp_bookse92.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse93.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">102</span>&nbsp; <span class="chapter-title">ak_dsp_bookse93.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse94.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">103</span>&nbsp; <span class="chapter-title">ak_dsp_bookse94.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse95.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">104</span>&nbsp; <span class="chapter-title">ak_dsp_bookse95.html</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">






<title>
Windows for spectral analysis
</title>
<meta charset="utf-8">
<meta content="TeX4ht (https://tug.org/tex4ht/)" name="generator">
<meta content="width=device-width,initial-scale=1" name="viewport">
<link href="ak_dsp_book.css" rel="stylesheet" type="text/css">
<meta content="ak_dsp_book.tex" name="src">
<script async="async" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js" type="text/javascript"></script>


<h3 class="sectionHead anchored">
<span class="titlemark">4.3</span>&nbsp;&nbsp;<a id="x62-2070004.3"></a>Windows for spectral analysis
</h3>
<!-- l. 56 -->
<p class="noindent">
Windows were briefly discussed in the context of FIR design in Section&nbsp;<a href="ak_dsp_bookse43.html#x52-1850003.13.5">3.13.5<!-- tex4ht:ref: subsec:fir_windowing  --></a>. Here they are applied in spectral analysis to better control trade offs such as <span class="ec-lmri-10x-x-109">resolution </span>and <span class="ec-lmri-10x-x-109">leakage</span>.
</p>
<!-- l. 59 -->
<p class="indent">
Windows are essential to model the extraction of a finite-duration segment of a signal with a potentially infinite duration. For example, an FFT is restricted to operate on <!-- l. 59 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> signal samples and even if the user is not aware or explicitly modeling the windowing operation, obtaining a segment of <!-- l. 59 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> samples from a longer signal <!-- l. 59 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is equivalent to multiplying <!-- l. 59 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> by a rectangular window <!-- l. 59 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> of duration <!-- l. 59 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> samples.
</p>
<!-- l. 62 -->
<p class="indent">
Windowing in time domain is often performed by
</p>
<table class="equation">
<tbody><tr>
<td>
<!-- l. 63 -->
<p class="indent">
</p>
<!-- l. 63 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x62-207001r1"></mstyle><!-- endlabel --><msub><mrow><mi>x</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(4.1)
</td>
</tr>
</tbody></table>
<!-- l. 67 -->
<p class="indent">
as a pre-processing step. Then, for example, the FFT of the windowed signal <!-- l. 67 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is calculated (the FFT of the original signal <!-- l. 67 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> would be unfeasible due to its long duration).
</p>
<!-- l. 70 -->
<p class="indent">
As informed by Eq.&nbsp;(<a href="ak_dsp_bookse34.html#x43-127007r12">3.12<!-- tex4ht:ref: eq:windowingConvolution  --></a>), this multiplication <!-- l. 70 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> in time-domain corresponds to a periodic convolution <!-- l. 70 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">⊛</mo><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in frequency-domain between their respective spectra <!-- l. 70 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 70 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<!-- l. 76 -->
<p class="indent">
</p><p>Reduced resolution and leakage are the two primary effects on the spectrum as a result of applying a window to the signal. The resolution of the <span class="ec-lmri-10x-x-109">overall spectral analysis</span></p>
is primarily influenced by the width of the main-lobe of the window, which is inversely proportional to the window (and consequently signal) duration. The degree of leakage depends on aspects of the window DTFT such as the relative amplitude of the main-lobe with respect to the amplitudes of the sidelobes. An FFT-based spectral analysis resolution also depends on the <span class="ec-lmri-10x-x-109">FFT resolution</span> <!-- l. 76 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi></mrow></math> given by Eq.&nbsp;(<a href="ak_dsp_bookse24.html#x32-101001r32">2.32<!-- tex4ht:ref: eq:fft_freq_resolution  --></a>). Given a windowed signal <!-- l. 76 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> with duration of <!-- l. 76 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> samples, the FFT resolution can always be increased via zero-padding. Using a FFT size larger than <!-- l. 76 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> decreases <!-- l. 76 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi></mrow></math>, but cannot recover the leakage that occurred due to windowing.
<p></p>
<!-- l. 78 -->
<p class="indent">
The convolution in Eq.&nbsp;(<a href="ak_dsp_bookse34.html#x43-127007r12">3.12<!-- tex4ht:ref: eq:windowingConvolution  --></a>) may not significantly alter <!-- l. 78 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with respect to the original <!-- l. 78 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in case <!-- l. 78 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is relatively narrow compared to variations in <!-- l. 78 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. However, because the tradeoff between narrower bandwidths and longer duration over time (see the Fourier transform of a square pulse in Eq.&nbsp;(<a href="ak_dsp_bookse80.html#x92-279005r54">B.54<!-- tex4ht:ref: eq:sinc_transform  --></a>), for example), this condition requires the window <!-- l. 78 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> to be sufficiently long (i. e., <!-- l. 78 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> must be sufficiently large). In the extreme (and ideal) situation of windowing not altering the original <!-- l. 80 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, the window DTFT would be <!-- l. 80 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>δ</mi><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>k</mi><mn>2</mn><mi>π</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>k</mi> <mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℤ</mi></mrow></math>. But this is equivalent to having <!-- l. 80 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> with infinite duration and, obviously, not performing windowing at all.
</p>
<!-- l. 82 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.3.1</span>&nbsp;&nbsp;<a id="x62-2080004.3.1"></a>Popular windows
</h4>
<!-- l. 84 -->
<p class="noindent">
Five of the most popular windows are described here.
</p>
<figure class="figure">
<p><a id="x62-2080011"></a></p>
<!-- l. 118 -->
<p class="noindent">
<img alt="PIC" src="./Figures/windowsTimeDomain.png" class="figure-img">
</p>
<figcaption class="caption">
<span class="id">Figure&nbsp;4.1: </span><span class="content">Selected windows <!-- l. 119 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> of duration <!-- l. 119 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> samples in time-domain.</span>
</figcaption>
<!-- tex4ht:label?: x62-2080011  -->
</figure>
<figure class="figure">
<p><a id="x62-2080022"></a></p>
<!-- l. 124 -->
<p class="noindent">
<img alt="PIC" src="./Figures/windowsFreqDomain.png" class="figure-img">
</p>
<figcaption class="caption">
<span class="id">Figure&nbsp;4.2: </span><span class="content">The DTFT <!-- l. 125 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> of the windows in Figure&nbsp;<a href="#x62-2080011">4.1<!-- tex4ht:ref: fig:windowsTimeDomain  --></a>.</span>
</figcaption>
<!-- tex4ht:label?: x62-2080022  -->
</figure>
<!-- l. 128 -->
<p class="indent">
Figure&nbsp;<a href="#x62-2080011">4.1<!-- tex4ht:ref: fig:windowsTimeDomain  --></a> shows some common windows for <!-- l. 128 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> samples in time-domain. Note that the maximum amplitude is equal to one. Figure&nbsp;<a href="#x62-2080022">4.2<!-- tex4ht:ref: fig:windowsFreqDomain  --></a> shows these windows in frequency-domain via their DTFTs.
</p>
<!-- l. 130 -->
<p class="noindent">
<a id="x62-208003r1"></a> <span id="textcolor281">Example 4.1. </span><span class="ec-lmbx-10x-x-109">Designing windows in Matlab/Octave</span>. Listing&nbsp;<a href="#x62-208004r1">4.1<!-- tex4ht:ref: code:snip_frequency_windows  --></a> lists the commands to design windows with <!-- l. 131 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>256</mn></mrow></math> samples using Matlab/Octave.
</p>
<!-- l. 134 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.1: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_windows.m</span>
</figcaption>
<!-- tex4ht:label?: x62-208004r4.3.1  -->
<pre class="lstinputlisting" id="listing-136"><span class="label"><a id="x62-208006r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=256;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">desired</span></span><span style="color:#005900"> <span class="ec-lmtt-9">number of samples of window W</span> 
</span><span class="label"><a id="x62-208007r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">rectwin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Rectangular</span></span><span style="color:#005900"> <span class="ec-lmtt-9">window</span> 
</span><span class="label"><a id="x62-208008r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">hamming</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Hamming</span></span><span style="color:#005900"> <span class="ec-lmtt-9">window</span> 
</span><span class="label"><a id="x62-208009r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">hanning</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Hann</span></span><span style="color:#005900"> <span class="ec-lmtt-9">window</span> 
</span><span class="label"><a id="x62-208010r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">kaiser</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,7.85)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Kaiser</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with beta=7.85</span> 
</span><span class="label"><a id="x62-208011r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">flattopwin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Flat</span></span><span style="color:#005900"> <span class="ec-lmtt-9">top window</span></span>
  </pre>
<!-- l. 144 -->
<p class="indent">
Assuming discrete-time windows, the only input parameter for their design is their duration. The Kaiser windows (also called Kaiser-Bessel window) is the only exception among the five, because it also has a parameter <!-- l. 150 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math>. For example, increasing <!-- l. 150 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math> of a Kaiser window widens the main lobe and decreases the amplitude of the sidelobes. &nbsp; &nbsp;<!-- l. 151 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<figure class="figure">
<p><a id="x62-2080143"></a></p>
<!-- l. 155 -->
<p class="noindent">
<img alt="PIC" src="./Figures/windowsFreqDomainNormalized.png" class="figure-img">
</p>
<figcaption class="caption">
<span class="id">Figure&nbsp;4.3: </span><span class="content">The DTFT of windows in Figure&nbsp;<a href="#x62-2080011">4.1<!-- tex4ht:ref: fig:windowsTimeDomain  --></a> with their values normalized such that <!-- l. 156 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> for <!-- l. 156 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math>&nbsp;rad.</span>
</figcaption>
<!-- tex4ht:label?: x62-2080143  -->
</figure>
<!-- l. 159 -->
<p class="indent">
It is common to normalize a window such that its DTFT has a value equal to one at DC. This was done to generate Figure&nbsp;<a href="#x62-2080143">4.3<!-- tex4ht:ref: fig:windowsFreqDomainNormalized  --></a>. The normalization can use the fact that the DC value <!-- l. 161 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>z</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>1</mn></mrow></msub></mrow></math> coincides with the sum of the window coefficients. For example, a normalized Hamming window can be obtained with <span class="ec-lmss-10x-x-109">w=hamming(32);w=w/sum(w)</span>.
</p>
<!-- l. 164 -->
<p class="noindent">
<a id="x62-208015r2"></a> <span id="textcolor282">Example 4.2. </span><span class="ec-lmbx-10x-x-109">Equations describing popular windows</span>. The <span class="ec-lmri-10x-x-109">Hamming </span>window<a id="dx62-208016"></a> adopted here is given by
</p>
<table class="equation">
<tbody><tr>
<td>
<!-- l. 166 -->
<p class="indent">
</p>
<!-- l. 166 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x62-208017r2"></mstyle><!-- endlabel --><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.54</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.46</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mn>2</mn><mi mathvariant="italic">πn</mi></mrow> <mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow><mo class="MathClass-punc" stretchy="false">,</mo><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;&nbsp;&nbsp;</mtext></mstyle><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mtext class="qopname">…</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(4.2)
</td>
</tr>
</tbody></table>
<!-- l. 170 -->
<p class="indent">
while the <span class="ec-lmri-10x-x-109">Hann </span>window<a id="dx62-208018"></a> is
</p>
<table class="equation">
<tbody><tr>
<td>
<!-- l. 171 -->
<p class="indent">
</p>
<!-- l. 171 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x62-208019r3"></mstyle><!-- endlabel --><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.5</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mn>2</mn><mi mathvariant="italic">πn</mi></mrow> <mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow><mo class="MathClass-punc" stretchy="false">,</mo><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;&nbsp;&nbsp;</mtext></mstyle><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mtext class="qopname">…</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(4.3)
</td>
</tr>
</tbody></table>
<!-- l. 175 -->
<p class="indent">
Note that according to Eq.&nbsp;(<a href="#x62-208019r3">4.3<!-- tex4ht:ref: eq:hannWindow  --></a>), the first and last samples (<!-- l. 175 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> and <!-- l. 175 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></math>) are zero and this version of the Hann window is called “periodic”. In Python, the commands <span class="ec-lmss-10x-x-109">import numpy </span>and <span class="ec-lmss-10x-x-109">w = numpy.hanning(5) </span>return <span class="ec-lmss-10x-x-109">[0.,0.5,1.,0.5,0.]</span>. In Matlab/Octave, the command <span class="ec-lmss-10x-x-109">hanning(6,’periodic’) </span>returns <span class="ec-lmss-10x-x-109">[0;0.25;0.75;1.00;0.75;0.25] </span>while the commands <span class="ec-lmss-10x-x-109">hanning(5) </span>and <span class="ec-lmss-10x-x-109">hanning(5,’symmetric’) </span>return <span class="ec-lmss-10x-x-109">[0.25;0.75;1.00;0.75;0.25]</span>, without the zero-valued samples.
</p>
<!-- l. 178 -->
<p class="indent">
</p><p>The <span class="ec-lmri-10x-x-109">flat-top </span>window<a id="dx62-208020"></a> is</p>
<p></p>
<!-- tex4ht:inline -->
<!-- l. 183 -->
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable class="align" columnalign="left" displaystyle="true"> <mtr><mtd class="align-odd" columnalign="right"><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.21557895</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.41663158</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mn>2</mn><mi mathvariant="italic">πn</mi></mrow> <mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.277263158</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mn>4</mn><mi mathvariant="italic">πn</mi></mrow> <mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow><mspace width="2em"></mspace></mtd> <mtd class="align-label" columnalign="right"><mstyle class="label" id="x62-208021r4"></mstyle><!-- endlabel --><mstyle class="maketag"><mtext>(4.4)&nbsp;</mtext></mstyle><mspace class="nbsp" width="0.33em"></mspace> </mtd></mtr><mtr><mtd class="align-odd" columnalign="right"></mtd> <mtd class="align-even"> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.083578947</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mn>6</mn><mi mathvariant="italic">πn</mi></mrow> <mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.006947368</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mn>8</mn><mi mathvariant="italic">πn</mi></mrow> <mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow><mo class="MathClass-punc" stretchy="false">,</mo><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;&nbsp;&nbsp;</mtext></mstyle><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mtext class="qopname">…</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mspace width="2em"></mspace></mtd> <mtd class="align-label" columnalign="right"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr></mtable></math> <!-- l. 185 -->
<p class="noindent">
The <span class="ec-lmri-10x-x-109">Kaiser </span>windows<a id="dx62-208022"></a> for <!-- l. 185 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> odd, such that <!-- l. 185 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">(</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math> is an integer, is
</p>
<table class="equation">
<tbody><tr>
<td>
<!-- l. 186 -->
<p class="indent">
</p>
<!-- l. 186 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x62-208023r5"></mstyle><!-- endlabel --><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><msub><mrow><mi>I</mi></mrow><mrow><mn>0</mn></mrow></msub> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mi>β</mi><msqrt><mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo><msup><mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi>n</mi><mo class="MathClass-bin" stretchy="false">−</mo><mi>M</mi></mrow> <mrow><mi>M</mi></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow><mrow><mn>2</mn></mrow></msup></mrow></msqrt></mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow> <mrow><msub><mrow><mi>I</mi></mrow><mrow><mn>0</mn></mrow></msub> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mi>β</mi></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></mfrac> <mo class="MathClass-punc" stretchy="false">,</mo><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;&nbsp;&nbsp;</mtext></mstyle><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(4.5)
</td>
</tr>
</tbody></table>
<!-- l. 190 -->
<p class="indent">
where <!-- l. 190 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>I</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>x</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is the <!-- l. 190 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow><mn>0</mn></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">th</mtext></mstyle></mrow></msup></math> order Bessel function of the first kind, which is calculated in Matlab/Octave with <span class="ec-lmss-10x-x-109">besseli(0,x)</span>, as indicated in the following commands:
</p>
<!-- l. 191 -->
<pre class="lstlisting" id="listing-137"><span class="label"><a id="x62-208024r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=13;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">beta</span></span><span style="color:#000000"><span class="ec-lmtt-9">=7.85;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">produce</span></span><span style="color:#005900"> <span class="ec-lmtt-9">same window as w=kaiser(N,beta):</span> 
</span><span class="label"><a id="x62-208025r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">M=(N-1)/2;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">auxiliary</span></span><span style="color:#005900"> <span class="ec-lmtt-9">variables</span> 
</span><span class="label"><a id="x62-208026r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">besseli</span></span><span style="color:#000000"><span class="ec-lmtt-9">(0,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">beta</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sqrt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1-((</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">besseli</span></span><span style="color:#000000"><span class="ec-lmtt-9">(0,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">beta</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x62-208027r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">normalize</span></span><span style="color:#005900"> <span class="ec-lmtt-9">to have maximum value equal to 1</span></span></pre>
<!-- l. 197 -->
<p class="indent">
that create a Kaiser window (for <!-- l. 197 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> odd). &nbsp;&nbsp;<!-- l. 198 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.3.2</span>&nbsp;&nbsp;<a id="x62-2090004.3.2"></a>Leakage
</h4>
<!-- l. 202 -->
<p class="noindent">
Leakage is a very important aspect on spectral analysis using FFT. To understand leakage one must remember that the multiplication <!-- l. 202 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> in time-domain, between the signal <!-- l. 202 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and a window <!-- l. 202 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, corresponds to the convolution in frequency-domain between their respective spectra <!-- l. 202 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 202 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<!-- l. 204 -->
<p class="indent">
The spectra of the windows in Figure&nbsp;<a href="#x62-2080022">4.2<!-- tex4ht:ref: fig:windowsFreqDomain  --></a> indicate that the values of the original spectrum <!-- l. 205 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> will be surely altered if <!-- l. 205 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is convolved with any window. This happens because the spectrum <!-- l. 207 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> of a finite-duration window can be very distinct from the ideal impulse <!-- l. 207 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>δ</mi><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in frequency domain.
</p>
<!-- l. 209 -->
<p class="indent">
To make this point clear, consider that <!-- l. 209 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is the DTFT of a cosine of amplitude <!-- l. 209 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math> and frequency <!-- l. 209 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub></math>, such that the impulses of area <!-- l. 209 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="italic">Aπ</mi></mrow></math> are located at <!-- l. 209 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">±</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>k</mi><mn>2</mn><mi>π</mi><mo class="MathClass-punc" stretchy="false">,</mo><mi>k</mi> <mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℤ</mi></mrow></math>. Assuming the window DTFT <!-- l. 210 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> has value <!-- l. 210 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math> at <!-- l. 210 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> (DC), according to Eq.&nbsp;(<a href="ak_dsp_bookse34.html#x43-127007r12">3.12<!-- tex4ht:ref: eq:windowingConvolution  --></a>), the windowing operation will lead to a convolution result with shifted versions of <!-- l. 212 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> centered at <!-- l. 212 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">±</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math> with a peak value of <!-- l. 212 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>0.5</mn><mo class="MathClass-open" stretchy="false">(</mo><mi>A</mi> <mo class="MathClass-bin" stretchy="false">×</mo> <mi>B</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<!-- l. 218 -->
<p class="indent">
The result of the convolution caused by windowing may not significantly impact the original spectrum <!-- l. 218 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in case <!-- l. 218 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is relatively narrow compared to variations in <!-- l. 218 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. But this condition implies that the window <!-- l. 218 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is sufficiently long (i. e., <!-- l. 218 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> must be sufficiently large). As mentioned, the ideal situation, where windowing would not alter the original <!-- l. 220 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, is to have <!-- l. 221 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> as an impulse in the range <!-- l. 221 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>π</mi> <mo class="MathClass-rel" stretchy="false">&lt;</mo> <mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">≤</mo> <mi>π</mi></mrow></math> (i. e. <!-- l. 222 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>δ</mi><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>k</mi><mn>2</mn><mi>π</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>k</mi> <mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℤ</mi></mrow></math>), but this implies that <!-- l. 222 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> has infinite duration and all samples of <!-- l. 222 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> are available.
</p>
<!-- l. 224 -->
<p class="indent">
</p><p>Hence, even if <!-- l. 224 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is</p>
narrow compared to <!-- l. 224 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, the convolution <!-- l. 224 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∗</mo><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> may have non-zero (“leaked”) values in frequencies where the original signal <!-- l. 224 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> was zero.
<p></p>
<!-- l. 226 -->
<p class="indent">
Note that many times, leakage is erroneously associated to using FFTs to perform spectral analysis. Even when dealing with DTFTs, without the inherent discretization of frequency provoked by FFTs, windowing the spectrum <!-- l. 228 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> creates “frequency leaks” that show up on the DTFT <!-- l. 228 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. Hence, leakage is associated to the DTFTs and should not be confused with the picket-fence effect caused by sampling the DTFT via a FFT, as discussed in the sequel.
</p>
<!-- l. 231 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.3.3</span>&nbsp;&nbsp;<a id="x62-2100004.3.3"></a>Picket-fence effect
</h4>
<!-- l. 233 -->
<p class="noindent">
Conceptually, the result of taking the FFT of a signal segment is the consequence of two steps: a) obtaining <!-- l. 233 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, a version of <!-- l. 233 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with leakage due to windowing, and then b) discretizing <!-- l. 233 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> according to the frequency grid imposed by the FFT.
</p>
<!-- l. 235 -->
<p class="indent">
The consequence of discretizing <!-- l. 235 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> via an FFT is sometimes called <span class="ec-lmri-10x-x-109">picket-fence </span>effect<a id="dx62-210001"></a>, which corresponds to observing the DTFT of the signal under analysis just at multiples of <!-- l. 235 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi></mrow></math> from Eq.&nbsp;(<a href="ak_dsp_bookse24.html#x32-101001r32">2.32<!-- tex4ht:ref: eq:fft_freq_resolution  --></a>). These effects appear in a combined way in FFT-based spectral analysis, such as in Application&nbsp;<a href="ak_dsp_bookse27.html#x35-106150r11">2.11<!-- tex4ht:ref: app:spectral_leakage  --></a>.
</p>
<!-- l. 240 -->
<p class="indent">
It is useful to distinguish the two concepts: spectral leakage due to windowing and the picket-fence due to discretization of <!-- l. 240 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> according to FFT frequency grid.
</p>
<!-- l. 242 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.3.4</span>&nbsp;&nbsp;<a id="x62-2110004.3.4"></a>Figures of merit applied to windows
</h4>
<!-- l. 244 -->
<p class="noindent">
Four of the most important parameters of a window are:
</p>
<ul class="itemize1">
<li class="itemize">
<p>width of its main lobe,</p>
<pre><code> &lt;/li&gt;
 &lt;li class='itemize'&gt;amplitude of its sidelobes,
 &lt;/li&gt;
 &lt;li class='itemize'&gt;rate of sidelobe decay as frequency increases,
 &lt;/li&gt;
 &lt;li class='itemize'&gt;and scallopping loss.&lt;/li&gt;&lt;/ul&gt;</code></pre>
<!-- l. 251 -->
<p class="noindent">
Each of them are discussed in the sequel. There are other figures of merit of windows, and the reader is invited to check the references about windows in Section&nbsp;<a href="ak_dsp_bookse60.html#x70-2510004.11">4.11<!-- tex4ht:ref: sec:spectral_further  --></a>.
</p>
<!-- l. 254 -->
<p class="noindent">
<a id="x62-211001r3"></a> <span id="textcolor283">Example 4.3. </span><span class="ec-lmbx-10x-x-109">Evaluating windows using Matlab’s wintool</span>. Matlab’s <span class="ec-lmss-10x-x-109">wintool </span>(Window Design &amp; Analysis Tool) GUI is useful to explore trade offs in windowing. One can observe, for example, that increasing <!-- l. 255 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math> of a Kaiser window widens the main lobe and decreases the amplitude of the sidelobes. It also calculates the leakage factor, relative sidelobe attenuation and main lobe width. &nbsp; &nbsp;<!-- l. 256 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 258 -->
<p class="indent">
Windows differ in their main-lobe width, which is typically inversely proportional to <!-- l. 258 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>, the length of the window. Thus, it is possible to achieve a better resolution in frequency by increasing <!-- l. 258 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>, but more signal samples are needed and sometimes they are not available.
</p>
<!-- l. 260 -->
<p class="indent">
</p><p>Another important window parameter is the highest sidelobe level, which should have a small value. When a window is used for FIR design, the smaller the sidelobe amplitude with respect to the amplitude of the main lobe, the higher the filter attenuation in the stopband. From the spectra in Figure&nbsp;<a href="#x62-2080143">4.3<!-- tex4ht:ref: fig:windowsFreqDomainNormalized  --></a>, Table&nbsp;<a href="#x62-2110021">4.1<!-- tex4ht:ref: tab:windows_sidelobe  --></a> can be obtained, which indicates the difference in dB between the main lobe and the highest sidelobe amplitudes. It should be noticed that, for the Hamming window, the highest sidelobe is the third one. The first sidelobe is localized in the frequency equal to 0.46 rad and has a level of <!-- l. 263 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>50</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>53</mn></mrow></math>&nbsp;dB when compared to the main-lobe level.</p>
<p></p>
<!-- l. 265 -->
<p class="indent">
<a id="x62-2110021"></a>
</p>
<figure class="float figure">
<figcaption class="caption">
<span class="id">Table&nbsp;4.1: </span><span class="content">Difference in dB between the window main lobe and highest sidelobe amplitudes.</span>
</figcaption>
<!-- tex4ht:label?: x62-2110021  -->
<div class="tabular">
<table class="tabular" id="TBL-113" rules="groups">
<colgroup id="TBL-113-1g">
<col id="TBL-113-1">
</colgroup>
<colgroup id="TBL-113-2g">
<col id="TBL-113-2">
</colgroup>
<colgroup id="TBL-113-3g">
<col id="TBL-113-3">
</colgroup>
<colgroup id="TBL-113-4g">
<col id="TBL-113-4">
</colgroup>
<colgroup id="TBL-113-5g">
<col id="TBL-113-5">
</colgroup>
<colgroup id="TBL-113-6g">
<col id="TBL-113-6">
</colgroup>
<tbody><tr class="hline">
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr id="TBL-113-1-" style="vertical-align:baseline;">
<td class="td11" id="TBL-113-1-1" style="text-align:left; white-space:nowrap;">
<span class="ec-lmr-10">Window </span>
</td>
<td class="td11" id="TBL-113-1-2" style="text-align:center; white-space:nowrap;">
<span class="ec-lmr-10">Rectangular </span>
</td>
<td class="td11" id="TBL-113-1-3" style="text-align:center; white-space:nowrap;">
<span class="ec-lmr-10">Hann </span>
</td>
<td class="td11" id="TBL-113-1-4" style="text-align:center; white-space:nowrap;">
<span class="ec-lmr-10">Hamming </span>
</td>
<td class="td11" id="TBL-113-1-5" style="text-align:center; white-space:nowrap;">
<span class="ec-lmr-10">Kaiser (</span><!-- l. 270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>β</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>7.85</mn></mrow></math><span class="ec-lmr-10">) </span>
</td>
<td class="td11" id="TBL-113-1-6" style="text-align:center; white-space:nowrap;">
<span class="ec-lmr-10">Flat top </span>
</td>
</tr>
<tr class="hline">
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr id="TBL-113-2-" style="vertical-align:baseline;">
<td class="td11" id="TBL-113-2-1" style="text-align:left; white-space:nowrap;">
<span class="ec-lmr-10">Difference (dB) </span>
</td>
<td class="td11" id="TBL-113-2-2" style="text-align:center; white-space:nowrap;">
<!-- l. 271 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>13</mn></mrow></math>
</td>
<td class="td11" id="TBL-113-2-3" style="text-align:center; white-space:nowrap;">
<!-- l. 271 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>32</mn></mrow></math>
</td>
<td class="td11" id="TBL-113-2-4" style="text-align:center; white-space:nowrap;">
<!-- l. 271 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>43</mn></mrow></math>
</td>
<td class="td11" id="TBL-113-2-5" style="text-align:center; white-space:nowrap;">
<!-- l. 271 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>57</mn></mrow></math>
</td>
<td class="td11" id="TBL-113-2-6" style="text-align:center; white-space:nowrap;">
<!-- l. 271 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>68</mn></mrow></math>
</td>
</tr>
<tr class="hline">
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
</tbody></table>
<pre><code>                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;/div&gt;
                                                                          
                                                                          </code></pre>
</div></figure>
<!-- l. 275 -->
<p class="indent">
When comparing spectral components that are close to each other, the adopted windows must have good resolution and a low highest sidelobe level. When the spectral components are far apart, having a large sidelobe decay can be more important.
</p>
<!-- l. 277 -->
<p class="indent">
This sidelobe fall-off indicates how the peak amplitude of the sidelobes decay with frequency and, for example, is a motivation for using the Hann window. The side-lobe fall-off is dependent on the continuity of the window <!-- l. 278 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in time-domain and its derivatives. For example, the Hann window is continuous, and besides, its first derivative is continuous too. Thus, its transform falls off at <!-- l. 278 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup></mrow></math> or, equivalently, at <!-- l. 278 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>18</mn></mrow></math>&nbsp;dB per octave. In contrast, the rectangular and Hamming windows, which are not continuous at their endpoints, have a <!-- l. 278 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>6</mn></mrow></math>&nbsp;dB per octave fall-off.
</p>
<!-- l. 280 -->
<p class="indent">
When using FFT to estimate the amplitude or power of a sinusoid, the combined effect of picket-fence and leakage creates a variation on the estimated sinusoid amplitude called “scalloping”. For most windows, the so-called <span class="ec-lmri-10x-x-109">scalloping loss</span><a id="dx62-211003"></a> is worst when the frequency is half-way the two neighboring bins. Listing&nbsp;<a href="#x62-213006r2">4.2<!-- tex4ht:ref: code:snip_frequency_fftCosineExample  --></a> allows to observe the scalloping loss when using the rectangular window for obtaining the FFT of a cosine.<span class="footnote-mark"><a href="#fn1x6" id="fn1x6-bk"><sup class="textsuperscript">1</sup></a></span><a id="x62-211004f1"></a>
</p>
<!-- l. 301 -->
<p class="noindent">
<a id="x62-211006r4"></a> <span id="textcolor284">Example 4.4. </span><span class="ec-lmbx-10x-x-109">When a DTFT has impulses, does this create a problem for an FFT-based analysis?</span>. A DTFT can have impulses such as, for example, the DTFT of a sinusoid. One question that may arise then is: <span class="ec-lmri-10x-x-109">-If the FFT simply performs sampling of the DTFT, what is the FFT value when exactly sampling an impulse? Should this value go to infinite? </span>The answer requires noting that the impulse in the DTFT appears because <!-- l. 304 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is an infinite-long signal (e. g., an eternal sinusoid). But an FFT has to be applied to a signal with a finite number <!-- l. 304 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> of samples. Therefore, the FFT is always applied to a windowed signal <!-- l. 304 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, with a DTFT <!-- l. 304 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> that does not have impulses. &nbsp;&nbsp;<!-- l. 305 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.3.5</span>&nbsp;&nbsp;<a id="x62-2120004.3.5"></a>Alternative representation of discrete-time sinusoids
</h4>
<!-- l. 309 -->
<p class="noindent">
</p><p>Given that the bin width of an <!-- l. 309 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>-points DFT (or FFT) is <!-- l. 309 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> </mrow></math> radians, the angular frequency associated to the FFT bin <!-- l. 309 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math> is</p>
<!-- l. 309 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>k</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>k</mi><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> </mrow></math> radians, as given by Eq.&nbsp;(<a href="ak_dsp_bookse24.html#x32-101004r35">2.35<!-- tex4ht:ref: eq:fft_freq_tone_rad  --></a>).
<p></p>
<!-- l. 311 -->
<p class="indent">
When performing the spectral analysis of a sinusoid <!-- l. 311 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> using an <!-- l. 311 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>-points FFT, the components of “positive” and “negative” frequencies of <!-- l. 311 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> will be mapped to the FFT bins <!-- l. 311 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math> and <!-- l. 311 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>k</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, respectively. Therefore, it is useful to generalize the signal expression to <!-- l. 311 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi>α</mi><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, where <!-- l. 311 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi> <mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℝ</mi></mrow></math> is a real number that allows to obtain any desired value for the angular frequency <!-- l. 311 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>α</mi><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> </mrow></math>.
</p>
<!-- l. 316 -->
<p class="indent">
To check the periodicity of <!-- l. 316 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, one can use Eq.&nbsp;(<a href="ak_dsp_bookse9.html#x16-60004r39">1.39<!-- tex4ht:ref: eq:sinusoidPeriodicityCondition  --></a>) and write
</p>
<table class="equation">
<tbody><tr>
<td>
<!-- l. 317 -->
<p class="indent">
</p>
<!-- l. 317 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x62-212001r6"></mstyle><!-- endlabel --> <mfrac><mrow><mi>m</mi></mrow> <mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub></mrow> <mrow><mn>2</mn><mi>π</mi></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mi>α</mi></mrow> <mrow><mn>2</mn><mi>π</mi></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mi>α</mi></mrow> <mrow><mi>N</mi></mrow></mfrac><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(4.6)
</td>
</tr>
</tbody></table>
<!-- l. 321 -->
<p class="indent">
which is a ratio <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>m</mi><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>N</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math> of two integers when <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> is a rational number (<!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi> <mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℚ</mi></mrow></math>). For instance, assume the signal of interest is <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>100</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>256</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, with <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>50</mn></mrow></math> and <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>256</mn></mrow></math>, where <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is the adopted FFT size. In this special case, in which <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi> <mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℤ</mi></mrow></math>, the fundamental period is <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>128</mn></mrow></math> samples, given that simplifying the fraction <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> leads to <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>m</mi><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>N</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>25</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>128</mn></mrow></math>, and this cosine is represented by the FFT bins <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>50</mn></mrow></math> and <!-- l. 321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>256</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>50</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>206</mn></mrow></math>.
</p>
<!-- l. 323 -->
<p class="indent">
</p><p>As another example, consider the signal <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>61</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>256</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and an FFT</p>
size <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>256</mn></mrow></math>. In this case, <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>30</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn></mrow></math> and <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi><mo class="MathClass-rel" stretchy="false">∉</mo><mi>ℤ</mi></mrow></math>, but <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi> <mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℚ</mi></mrow></math> and can be written as a ratio <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>30</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>256</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>61</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>512</mn></mrow></math> of two integers <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>m</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>61</mn></mrow></math> and <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>512</mn></mrow></math>. The signal <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> has a period of <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>512</mn></mrow></math> samples but only <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>256</mn></mrow></math> of its samples are being analyzed via the FFT. In this case, the FFT does not “see” a pure sinusoid. The component of <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> corresponding to the positive frequency will reside between the bins <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>30</mn></mrow></math> and <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>31</mn></mrow></math>, while the negative-frequency component will be located between bins <!-- l. 323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>224</mn></mrow></math> and 225. Leakage will occur for both components and will be more visible in their neighbor bins.
<p></p>
<!-- l. 325 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.3.6</span>&nbsp;&nbsp;<a id="x62-2130004.3.6"></a>Example of combined effects of leakage and picket-fence
</h4>
<!-- l. 328 -->
<p class="noindent">
It is informative to revisit the result of an FFT when the original input signal is a discrete-time sinusoid <!-- l. 328 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>A</mi><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> after windowing. Note that the eternal cosine DTFT is <!-- l. 329 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="italic">Aπ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>δ</mi><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi> <mo class="MathClass-bin" stretchy="false">+</mo><msub><mrow> <mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>δ</mi><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi> <mo class="MathClass-bin" stretchy="false">−</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> within the range <!-- l. 329 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>π</mi> <mo class="MathClass-rel" stretchy="false">≤</mo><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">≤</mo> <mi>π</mi></mrow></math>, then repeated in multiples of <!-- l. 329 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2</mn><mi>π</mi></mrow></math>.
</p>
<!-- l. 331 -->
<p class="indent">
Assuming that <!-- l. 331 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> denotes the DTFT of the windowed cosine, the final FFT result depends on the two effects:
</p>
<dl class="enumerate-enumitem">
<dt class="enumerate-enumitem">
<span class="ec-lmbx-10x-x-109">f</span> 1.
</dt>
<dd class="enumerate-enumitem">
<span class="ec-lmbx-10x-x-109">Leakage</span>: <!-- l. 333 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is the periodic convolution between <!-- l. 333 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and the window DTFT <!-- l. 333 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. Assuming a rectangular window <!-- l. 333 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> with non-zero amplitudes from <!-- l. 333 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></math>, its spectrum is
<table class="equation">
<tbody><tr>
<td>
<!-- l. 334 -->
<p class="noindent">
</p>
<!-- l. 334 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x62-213002r7"></mstyle><!-- endlabel --><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi>N</mi><mi mathvariant="normal">Ω</mi></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow> <mrow><mtext class="qopname"> sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi mathvariant="normal">Ω</mi></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow></mfrac> <msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mfrac><mrow><mi mathvariant="normal">Ω</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow></msup><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(4.7)
</td>
</tr>
</tbody></table>
<pre><code> &lt;!-- l. 338 --&gt;&lt;p class='noindent'&gt;Recalling that the periodic convolution of Eq.&nbsp;(&lt;a href='ak_dsp_bookse34.html#x43-127007r12'&gt;3.12&lt;!-- tex4ht:ref: eq:windowingConvolution  --&gt;&lt;/a&gt;) has a factor
 &lt;!-- l. 338 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt; &lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;</code></pre>
<mrow><mn>2</mn><mi>π</mi></mrow>, the resulting DTFT is
<p></p>
<table class="equation">
<tbody><tr>
<td>
<!-- l. 339 -->
<p class="noindent">
</p>
<!-- l. 339 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x62-213003r8"></mstyle><!-- endlabel --><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mi>A</mi></mrow> <mrow><mn>2</mn></mrow></mfrac> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo class="MathClass-bin" stretchy="false">+</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo class="MathClass-bin" stretchy="false">−</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow><mo fence="true" form="postfix">]</mo></mrow> </mrow></math>
</td>
<td class="eq-no">
(4.8)
</td>
</tr>
</tbody></table>
<pre><code> &lt;/dd&gt;&lt;dt class='enumerate-enumitem'&gt;&lt;span class='ec-lmbx-10x-x-109'&gt;f&lt;/span&gt;</code></pre>
<ol start="2" type="1">
<li>
<dd class="enumerate-enumitem">
<span class="ec-lmbx-10x-x-109">Picket-fence</span>: The FFT <!-- l. 343 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> has a resolution of <!-- l. 343 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> and corresponds to samples <!-- l. 343 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi mathvariant="normal">Ω</mi><mo class="MathClass-rel" stretchy="false">=</mo><mi>k</mi><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Ω</mi></mrow></msub></mrow></math> of the DTFT <!-- l. 343 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> at frequencies <!-- l. 343 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>k</mi><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Ω</mi></mrow></math>.
</dd>
</li></ol></dd></dl>
<!-- l. 361 -->
<p class="indent">
The FFT values <!-- l. 361 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> for the windowed cosine <!-- l. 361 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, with <!-- l. 363 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>α</mi><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>α</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> and <!-- l. 363 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi> <mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℝ</mi></mrow></math>, is obtained substituting Eq.&nbsp;(<a href="#x62-213002r7">4.7<!-- tex4ht:ref: eq:dtftRectangularWindow  --></a>) in Eq.&nbsp;(<a href="#x62-213003r8">4.8<!-- tex4ht:ref: eq:dtftWindowedCosine  --></a>):
</p>
<table class="equation">
<tbody><tr>
<td>
<!-- l. 364 -->
<p class="indent">

</p>
<!-- l. 364 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x62-213005r9"></mstyle><!-- endlabel --><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mi>A</mi></mrow> <mrow><mn>2</mn></mrow></mfrac> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mfrac><mrow><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>α</mi><mo class="MathClass-close" stretchy="false">)</mo><mi>π</mi></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow> <mrow><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi><mo class="MathClass-bin" stretchy="false">+</mo><mi>α</mi><mo class="MathClass-close" stretchy="false">)</mo><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow></mfrac> <msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi><mo class="MathClass-bin" stretchy="false">+</mo><mi>α</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mfrac><mrow><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>α</mi><mo class="MathClass-close" stretchy="false">)</mo><mi>π</mi></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow> <mrow><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi><mo class="MathClass-bin" stretchy="false">−</mo><mi>α</mi><mo class="MathClass-close" stretchy="false">)</mo><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow></mfrac> <msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi><mo class="MathClass-bin" stretchy="false">−</mo><mi>α</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></msup></mrow><mo fence="true" form="postfix">]</mo></mrow> <mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(4.9)
</td>
</tr>
</tbody></table>
<!-- l. 372 -->
<p class="indent">
From Eq.&nbsp;(<a href="#x62-213002r7">4.7<!-- tex4ht:ref: eq:dtftRectangularWindow  --></a>), for <!-- l. 372 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math>&nbsp;rad, the value of <!-- l. 372 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> can be found using L’Hospital’s rule, which leads to <!-- l. 372 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi mathvariant="normal">Ω</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>N</mi></mrow></math>. In the special case of <!-- l. 372 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math>, the signal <!-- l. 372 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>A</mi></mrow></math> has a constant amplitude, its DTFT is <!-- l. 372 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="italic">AW</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and the FFT DC bin <!-- l. 372 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="italic">AN</mi></mrow></math>. Recall from Eq.&nbsp;(<a href="ak_dsp_bookse24.html#x32-101014r44">2.44<!-- tex4ht:ref: eq:dft_as_dtfs  --></a>), that one needs to normalize the DFT by <!-- l. 373 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> in order to associate the DFT coefficients to the amplitude in Volts of the signal components in time-domain. In this case, the normalized DC value is <!-- l. 373 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>A</mi></mrow></math>. Similarly, when <!-- l. 373 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub><mo class="MathClass-rel" stretchy="false">≠</mo><mn>0</mn></mrow></math>, the two DTFT peaks at <!-- l. 373 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">±</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub></mrow></math> have amplitude <!-- l. 373 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="italic">AN</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math>. Normalizing the peak values by <!-- l. 373 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>, leads to an amplitude of <!-- l. 373 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math> for each.
</p>
<!-- l. 375 -->
<p class="indent">
Two cases of interest are <!-- l. 375 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>k</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi></mrow></math> and <!-- l. 375 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>k</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math>, where <!-- l. 375 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℤ</mi></mrow></math>, which correspond to <!-- l. 375 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub></math> centered on a bin and exactly in the middle of two bins, respectively.
</p>
<!-- l. 377 -->
<p class="indent">
</p><p>Listing&nbsp;<a href="#x62-213006r2">4.2<!-- tex4ht:ref: code:snip_frequency_fftCosineExample  --></a> compares the magnitudes of the DTFT and <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math>-points DFT for a signal <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, with <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi mathvariant="italic">πα</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> and <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8.3</mn></mrow></math>. This windowed cosine is not bin-centered and the leakage is visible through the “picket-fence” corresponding to the DFT bins. The cosine has an angular frequency <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1.6297</mn></mrow></math>&nbsp;rad and the closest FFT bin is <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mstyle class="text"><mtext class="textrm" mathvariant="normal">round</mtext></mstyle><mo class="MathClass-open" stretchy="false">(</mo><mi>α</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math>. In this case, the DFT magnitude <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">|</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>84</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>77</mn></mrow></math> at <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math> would lead to an estimated</p>
frequency <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mover accent="true"><mrow><mi mathvariant="normal">Ω</mi></mrow><mo accent="true">^</mo></mover></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi mathvariant="italic">πk</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1.5708</mn></mrow></math>&nbsp;rad. The DTFT magnitude peak at <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1.6297</mn></mrow></math>&nbsp;rad is <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="italic">AN</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>6</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>32</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>96</mn></mrow></math>, such that the scalloping loss is <!-- l. 377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>96</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>84</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>77</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>11</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>23</mn></mrow></math>.
<p></p>
<!-- l. 379 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.2: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_fftCosineExample.m</span>
</figcaption>
<!-- tex4ht:label?: x62-213006r4.3.6  -->
<pre class="lstinputlisting" id="listing-138"><span class="label"><a id="x62-213008r1"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">function</span></span><span style="color:#000000"> <span class="ec-lmtt-9">snip_frequency_fftCosineExample()</span> 
</span><span class="label"><a id="x62-213009r2"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">clf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">N=32; A=6;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">clear</span></span><span style="color:#005900"> <span class="ec-lmtt-9">figure, FFT length, cosine amplitude</span> 
</span><span class="label"><a id="x62-213010r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1000;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of sample points imposing the DTFT resolution</span> 
</span><span class="label"><a id="x62-213011r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">alpha</span></span><span style="color:#000000"><span class="ec-lmtt-9">=8.3;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">specifies</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the cosine frequency</span> 
</span><span class="label"><a id="x62-213012r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(</span></span><span style="color:#000000"><span class="ec-lmtt-9">alpha</span></span><span style="color:#000000"><span class="ec-lmtt-9">*2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">cosine</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency in radians</span> 
</span><span class="label"><a id="x62-213013r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">linspace</span></span><span style="color:#000000"><span class="ec-lmtt-9">(0,2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span><span style="color:#005900"> <span class="ec-lmtt-9">range</span> 
</span><span class="label"><a id="x62-213014r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xw</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">DTFT</span></span><span style="color:#005900"> <span class="ec-lmtt-9">values</span> 
</span><span class="label"><a id="x62-213015r8"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">for</span></span><span style="color:#000000"> <span class="ec-lmtt-9">i=1:M</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">loop</span></span><span style="color:#005900"> <span class="ec-lmtt-9">over frequencies and calculate DTFT values</span> 
</span><span class="label"><a id="x62-213016r9"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">Xw</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= (A/2)*(rect_dtft(W(i)+Wc, N)+rect_dtft(W(i)-Wc, N));</span> 
</span><span class="label"><a id="x62-213017r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x62-213018r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x=A*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">N samples of the cosine</span> 
</span><span class="label"><a id="x62-213019r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xfft</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">FFT with N points</span> 
</span><span class="label"><a id="x62-213020r13"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Max</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">abs</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">FFT</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">)</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">)</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">=</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x62-213021r14"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Scalloping</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">loss in DTFT=</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2-</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x62-213022r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xw</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on,</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">([0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1]*(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">or</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x62-213023r16"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">xlabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Frequency</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">\Omega (rad) normalized by \pi)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x62-213024r17"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">ylabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Magnitude</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">legend</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">DTFT</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">DFT</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">grid</span></span> 
<span class="label"><a id="x62-213025r18"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x62-213026r19"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">function</span></span><span style="color:#000000"> <span class="ec-lmtt-9">dtft_value = rect_dtft(Omega, N)</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">DTFT</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of rectangular window</span> 
</span><span class="label"><a id="x62-213027r20"></a><span class="ec-lmr-6">20</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Omega == 0</span> 
</span><span class="label"><a id="x62-213028r21"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">dtft_value</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= N;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">L</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">Hospital</span></span><span style="color:#005900"> <span class="ec-lmtt-9">rule to correct NaN if 0/0</span> 
</span><span class="label"><a id="x62-213029r22"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">else</span></span> 
<span class="label"><a id="x62-213030r23"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">W_div_2</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= Omega/2;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">speed</span></span><span style="color:#005900"> <span class="ec-lmtt-9">up things computing only once</span> 
</span><span class="label"><a id="x62-213031r24"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">dtft_value</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">W_div_2</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">W_div_2</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(-1</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">W_div_2</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x62-213032r25"></a><span class="ec-lmr-6">25</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x62-213033r26"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span>
  </pre>
<!-- l. 381 -->
<p class="indent">
If one varies <!-- l. 381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math> in Listing&nbsp;<a href="#x62-213006r2">4.2<!-- tex4ht:ref: code:snip_frequency_fftCosineExample  --></a> to <!-- l. 381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math> and <!-- l. 381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>8.5</mn></mrow></math>, the maximum DFT amplitudes at <!-- l. 381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math> are <!-- l. 381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">|</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>96</mn></mrow></math> and 61.51, respectively. Therefore, the corresponding scalloping losses are 0 (the minimum possible value) and <!-- l. 381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>96</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>61</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>51</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>34</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>49</mn></mrow></math>. Observe that when estimating the cosine amplitude, one would divide the FFT peak amplitude by <!-- l. 381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>. For <!-- l. 381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8.5</mn></mrow></math>, this normalization would lead to an estimate of <!-- l. 381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>61</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>51</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>3.84</mn></mrow></math>&nbsp;Volts instead of the correct value of <!-- l. 381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>6</mn></mrow></math>&nbsp;V. This indicates how deleterious the combination of leakage and picket-fence can be.
</p>
<!-- l. 385 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.3.7</span>&nbsp;&nbsp;<a id="x62-2140004.3.7"></a>Example of using windows in spectral analysis
</h4>
<!-- l. 387 -->
<p class="noindent">
To illustrate the importance of windows, two distinct signals, <!-- l. 387 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 387 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, each composed by a stronger and a weaker sinusoids, will have their spectra estimated using a FFT with <!-- l. 387 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>256</mn></mrow></math> points:
</p>
<pre><code> &lt;ul class='itemize1'&gt;
 &lt;li class='itemize'&gt;
 &lt;!-- l. 389 --&gt;&lt;p class='noindent'&gt;Case 1: the stronger sinusoid is bin-centered - The first sequence is &lt;/p&gt;&lt;table class='equation-star'&gt;&lt;tr&gt;&lt;td&gt;
                                                                          
                                                                          
 &lt;!-- l. 390 --&gt;&lt;math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;
           &lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;[&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;]&lt;/mo&gt; &lt;mo class='MathClass-rel' stretchy='false'&gt;=&lt;/mo&gt; &lt;mn&gt;1&lt;/mn&gt;&lt;mtext class='qopname'&gt;cos&lt;/mtext&gt;&lt;mo&gt; ⁡&lt;!-- FUNCTION APPLICATION --&gt; &lt;/mo&gt;&lt;!-- nolimits --&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mn&gt;64&lt;/mn&gt;&lt;mi&gt;π&lt;/mi&gt;&lt;mo class='MathClass-bin' stretchy='false'&gt;∕&lt;/mo&gt;&lt;mn&gt;256&lt;/mn&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt; &lt;mo class='MathClass-bin' stretchy='false'&gt;+&lt;/mo&gt; &lt;mi&gt;π&lt;/mi&gt;&lt;mo class='MathClass-bin' stretchy='false'&gt;∕&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt; &lt;mo class='MathClass-bin' stretchy='false'&gt;+&lt;/mo&gt; &lt;mn&gt;100&lt;/mn&gt;&lt;mtext class='qopname'&gt;cos&lt;/mtext&gt;&lt;mo&gt; ⁡&lt;!-- FUNCTION APPLICATION --&gt; &lt;/mo&gt;&lt;!-- nolimits --&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mn&gt;76&lt;/mn&gt;&lt;mi&gt;π&lt;/mi&gt;&lt;mo class='MathClass-bin' stretchy='false'&gt;∕&lt;/mo&gt;&lt;mn&gt;256&lt;/mn&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt; &lt;mo class='MathClass-bin' stretchy='false'&gt;+&lt;/mo&gt; &lt;mi&gt;π&lt;/mi&gt;&lt;mo class='MathClass-bin' stretchy='false'&gt;∕&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;mo class='MathClass-punc' stretchy='false'&gt;.&lt;/mo&gt;</code></pre>




<pre><code> &lt;!-- l. 394 --&gt;&lt;p class='noindent'&gt;The idea is that the weaker cosine (of amplitude 1 V) is located in the center of the
 FFT bin &lt;!-- l. 394 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt; &lt;mo class='MathClass-rel' stretchy='false'&gt;=&lt;/mo&gt; &lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;,
 and  the  stronger  is  located  in  the  center  of  bin  38.  Having  a  bin-centered
 sinusoid corresponds to choosing the FFT length coinciding with a multiple of
 the sinusoid period.
 &lt;/p&gt;&lt;/li&gt;
 &lt;li class='itemize'&gt;
 &lt;!-- l. 396 --&gt;&lt;p class='noindent'&gt;Case 2: the stronger sinusoid is not bin-centered - The second sequence is
 &lt;/p&gt;&lt;table class='equation-star'&gt;&lt;tr&gt;&lt;td&gt;
 &lt;!-- l. 397 --&gt;&lt;math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;
           &lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;[&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;]&lt;/mo&gt; &lt;mo class='MathClass-rel' stretchy='false'&gt;=&lt;/mo&gt; &lt;mn&gt;1&lt;/mn&gt;&lt;mtext class='qopname'&gt;cos&lt;/mtext&gt;&lt;mo&gt; ⁡&lt;!-- FUNCTION APPLICATION --&gt; &lt;/mo&gt;&lt;!-- nolimits --&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mn&gt;64&lt;/mn&gt;&lt;mi&gt;π&lt;/mi&gt;&lt;mo class='MathClass-bin' stretchy='false'&gt;∕&lt;/mo&gt;&lt;mn&gt;256&lt;/mn&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt; &lt;mo class='MathClass-bin' stretchy='false'&gt;+&lt;/mo&gt; &lt;mi&gt;π&lt;/mi&gt;&lt;mo class='MathClass-bin' stretchy='false'&gt;∕&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt; &lt;mo class='MathClass-bin' stretchy='false'&gt;+&lt;/mo&gt; &lt;mn&gt;100&lt;/mn&gt;&lt;mtext class='qopname'&gt;cos&lt;/mtext&gt;&lt;mo&gt; ⁡&lt;!-- FUNCTION APPLICATION --&gt; &lt;/mo&gt;&lt;!-- nolimits --&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mn&gt;75&lt;/mn&gt;&lt;mi&gt;π&lt;/mi&gt;&lt;mo class='MathClass-bin' stretchy='false'&gt;∕&lt;/mo&gt;&lt;mn&gt;256&lt;/mn&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt; &lt;mo class='MathClass-bin' stretchy='false'&gt;+&lt;/mo&gt; &lt;mi&gt;π&lt;/mi&gt;&lt;mo class='MathClass-bin' stretchy='false'&gt;∕&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;mo class='MathClass-punc' stretchy='false'&gt;.&lt;/mo&gt;</code></pre>




<pre><code> &lt;!-- l. 401 --&gt;&lt;p class='noindent'&gt;In this case, the weaker cosine is located in the center of bin 32 but the stronger
 is located in the border of bins 37 and 38.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</code></pre>
<!-- l. 403 -->
<p class="noindent">
In this example the goal is to distinguish the sinusoids and estimate their frequencies. As in many applications of spectral analysis, the amplitudes are irrelevant and what is taken into account is the relative difference between the signal components in frequency domain. For both <!-- l. 403 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 403 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, the difference in power between the sinusoids is <!-- l. 403 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>20</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>100</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>40</mn></mrow></math>&nbsp;dB. These sequences can be generated as in Listing&nbsp;<a href="#x62-214001r3">4.3<!-- tex4ht:ref: code:snip_frequency_sequence_generation  --></a>.
</p>
<!-- l. 405 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.3: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_sequence_generation.m</span>
</figcaption>
<!-- tex4ht:label?: x62-214001r4.3.7  -->
<pre class="lstinputlisting" id="listing-139"><span class="label"><a id="x62-214003r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=256;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of samples available of x1 and x2</span> 
</span><span class="label"><a id="x62-214004r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">abscissa</span></span> 
<span class="label"><a id="x62-214005r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">kweak</span></span><span style="color:#000000"><span class="ec-lmtt-9">=32;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">FFT</span></span><span style="color:#005900"> <span class="ec-lmtt-9">bin where the weak cosine is located</span> 
</span><span class="label"><a id="x62-214006r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">kstrong1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=38;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">FFT</span></span><span style="color:#005900"> <span class="ec-lmtt-9">bin for strong cosine in x1</span> 
</span><span class="label"><a id="x62-214007r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">weakSigal</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">((2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">kweak</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/3)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">common</span></span><span style="color:#005900"> <span class="ec-lmtt-9">parcel</span> 
</span><span class="label"><a id="x62-214008r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=100*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">((2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">kstrong1</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/4)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">+ weakSigal;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">x1</span></span><span style="color:#005900"><span class="ec-lmtt-9">[</span></span><span style="color:#005900"><span class="ec-lmtt-9">n</span></span><span style="color:#005900"><span class="ec-lmtt-9">]</span></span> 
<span class="label"><a id="x62-214009r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">kstrong2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=37.5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">location</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for strong cosine in x2</span> 
</span><span class="label"><a id="x62-214010r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=100*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">((2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">kstrong2</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/4)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">+ weakSigal;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">x2</span></span><span style="color:#005900"><span class="ec-lmtt-9">[</span></span><span style="color:#005900"><span class="ec-lmtt-9">n</span></span><span style="color:#005900"><span class="ec-lmtt-9">]</span></span>
  </pre>
<figure class="figure">
<p><a id="x62-2140134"></a></p>
<!-- l. 419 -->
<p class="noindent">
<img alt="PIC" src="./Figures/windowsHarmonicAnalysis.png" class="figure-img">
</p>
<figcaption class="caption">
<span class="id">Figure&nbsp;4.4: </span><span class="content">Comparison of spectra obtained with four windows in case both sinusoids are bin-centered (left plots) and not (right plots).</span>
</figcaption>
<!-- tex4ht:label?: x62-2140134  -->
</figure>
<!-- l. 423 -->
<p class="indent">
The commands that design the windows to pre-multiply <span class="ec-lmss-10x-x-109">x1 </span>and <span class="ec-lmss-10x-x-109">x2 </span>in Listing&nbsp;<a href="#x62-214001r3">4.3<!-- tex4ht:ref: code:snip_frequency_sequence_generation  --></a>, before calling the FFT, are given in Listing&nbsp;<a href="#x62-208004r1">4.1<!-- tex4ht:ref: code:snip_frequency_windows  --></a>.
</p>
<!-- l. 425 -->
<p class="indent">
The results with four windows from Listing&nbsp;<a href="#x62-208004r1">4.1<!-- tex4ht:ref: code:snip_frequency_windows  --></a> are shown in Figure&nbsp;<a href="#x62-2140134">4.4<!-- tex4ht:ref: fig:windowsHarmonicAnalysis  --></a>. The flat top window was not used due to its poor frequency resolution. For example, the spectrum in Figure&nbsp;<a href="#x62-2140134">4.4<!-- tex4ht:ref: fig:windowsHarmonicAnalysis  --></a> for <!-- l. 426 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> (called <span class="ec-lmss-10x-x-109">x2 </span>in the code) using Hamming was obtained with Listing&nbsp;<a href="#x62-214014r4">4.4<!-- tex4ht:ref: code:snip_frequency_analysis  --></a>.
</p>
<!-- l. 428 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.4: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_analysis.m</span>
</figcaption>
<!-- tex4ht:label?: x62-214014r4.3.7  -->
<pre class="lstinputlisting" id="listing-140"><span class="label"><a id="x62-214016r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=256;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">n=0:N-1;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">N</span></span><span style="color:#005900"> <span class="ec-lmtt-9">is the number of available samples and FFT length</span> 
</span><span class="label"><a id="x62-214017r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=100*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">((2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*37.5/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/4)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">+</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">((2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*32/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/3)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">cosines</span></span> 
<span class="label"><a id="x62-214018r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">dw</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">DFT</span></span><span style="color:#005900"> <span class="ec-lmtt-9">spacing in radians</span> 
</span><span class="label"><a id="x62-214019r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">=-</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">dw</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">dw</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">abscissa</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for plots matched to fftshift</span> 
</span><span class="label"><a id="x62-214020r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">.*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">hamming</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">perform</span></span><span style="color:#005900"> <span class="ec-lmtt-9">windowing</span> 
</span><span class="label"><a id="x62-214021r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">factor</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">normalization</span></span><span style="color:#005900"> <span class="ec-lmtt-9">to have stronger at 0 dB</span> 
</span><span class="label"><a id="x62-214022r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fftshift</span></span><span style="color:#000000"><span class="ec-lmtt-9">(20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">factor</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span>
  </pre>
<!-- l. 436 -->
<p class="indent">
The graphs at the left column in Figure&nbsp;<a href="#x62-2140134">4.4<!-- tex4ht:ref: fig:windowsHarmonicAnalysis  --></a> correspond to estimated spectra of <!-- l. 436 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> (both sinusoids are bin-centered). For <!-- l. 436 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, it can be seen that the best result was obtained by a rectangular window while the other windows led to spectra with leakage (spurious power) near the cosines. Based solely on the results obtained for case 1, one could erroneously concluded that the rectangular window is always the best. However, as shown in the top-right graph, when the strong cosine is not bin-centered, the rectangular window miserably fails to detect the weaker cosine.
</p>
<!-- l. 439 -->
<p class="indent">
In Figure&nbsp;<a href="#x62-2140134">4.4<!-- tex4ht:ref: fig:windowsHarmonicAnalysis  --></a>, the Hann window allows a marginal detection of the weaker cosine, while the Hamming window allows the detection of both cosines but contaminates the whole spectrum with spurious power along frequency just 50&nbsp;dB below the power level of the strongest sinusoid. This is a consequence of the reduced side-lobe fall-off for the Hamming window, as indicated in Figure&nbsp;<a href="#x62-2080143">4.3<!-- tex4ht:ref: fig:windowsFreqDomainNormalized  --></a>. The Kaiser window achieves the best result when one takes in account both cases (bin-centered and not).
</p>
<figure class="figure">
<p><a id="x62-2140255"></a></p>
<!-- l. 443 -->
<p class="noindent">
<img alt="PIC" src="./Figures/windowsKaiserNotCentered.png" class="figure-img">
</p>
<figcaption class="caption">
<span class="id">Figure&nbsp;4.5: </span><span class="content">Individual spectra of the two sinusoids superimposed obtained using the Kaiser window.</span>
</figcaption>
<!-- tex4ht:label?: x62-2140255  -->
</figure>
<figure class="figure">
<p><a id="x62-2140266"></a></p>
<!-- l. 449 -->
<p class="noindent">
<img alt="PIC" src="./Figures/windowsRectangularNotCentered.png" class="figure-img">
</p>
<figcaption class="caption">
<span class="id">Figure&nbsp;4.6: </span><span class="content">Individual spectra of the two sinusoids superimposed, obtained using the rectangular window.</span>
</figcaption>
<!-- tex4ht:label?: x62-2140266  -->
</figure>
<!-- l. 453 -->
<p class="indent">
To complement the analysis of estimating the spectrum of <!-- l. 453 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> (the stronger sinusoid is not bin centered), Figure&nbsp;<a href="#x62-2140255">4.5<!-- tex4ht:ref: fig:windowsKaiserNotCentered  --></a> and Figure&nbsp;<a href="#x62-2140266">4.6<!-- tex4ht:ref: fig:windowsRectangularNotCentered  --></a> show the individual spectra of the two sinusoids superimposed, obtained using the Kaiser and rectangular windows, respectively. Note that, Figure&nbsp;<a href="#x62-2140134">4.4<!-- tex4ht:ref: fig:windowsHarmonicAnalysis  --></a> shows exactly the combined effect of these individual spectra. Figure&nbsp;<a href="#x62-2140266">4.6<!-- tex4ht:ref: fig:windowsRectangularNotCentered  --></a> clearly shows that the significant leakage of the stronger cosine caused by the rectangular window, completely “masks” the weaker cosine.
</p>
<!-- l. 457 -->
<p class="indent">
Note that this was a specific application. For example, features such as side-lobe fall-off are important in other situations. A very general conclusion is to always use a window other than the rectangular when performing spectral analysis of a signal that is not guaranteed to have all components bin-centered.
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.3.8</span>&nbsp;&nbsp;<a id="x62-2150004.3.8"></a>Estimating sinusoid amplitude and correction of scalloping loss
</h4>
<!-- l. 461 -->
<p class="noindent">
In some applications of FFT-based spectral analysis it is necessary not only detect the frequencies but also the amplitudes of the signal frequency components. In this case, the impact of windowing needs to be taken in account, by scaling the FFT of the windowed signal.
</p>
<!-- l. 463 -->
<p class="indent">
For instance, if one is calculating the harmonic distortion solely based on percentage values, such as: “- the third harmonic has 12% of the amplitude of the fundamental frequency component”, then mitigating the scalloping loss may not be needed. But if the analysis requires the absolute amplitude values of the harmonic components, the procedure to be discussed in the next paragraphs become important.
</p>
<!-- l. 465 -->
<p class="indent">
For convenience, we assume a complex exponential <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>A</mi><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mn>2</mn><mi mathvariant="italic">πk</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi mathvariant="italic">′n</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></msup></mrow></math>, where <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math> is the amplitude, <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is the FFT-size and <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi></mrow></math> is the FFT bin in which <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> resides. Note that <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is bin-centered. The windowed signal <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>A</mi><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mn>2</mn><mi mathvariant="italic">πk</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi mathvariant="italic">′n</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></msup><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is obtained by multiplying <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> by a window <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> with support of <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> samples. Due to the orthogonality of the FFT basis functions, all FFT coefficients <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> will be zero but the one corresponding to bin <!-- l. 465 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi></mrow></math>. This coefficient is given by:
</p>
<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 466 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow> <mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo><munderover accent="false" accentunder="false"><mrow><mo> ∑</mo> </mrow><mrow><mi>n</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>x</mi></mrow><mrow> <mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mn>2</mn><mi mathvariant="italic">πk</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi mathvariant="italic">′n</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>A</mi><munderover accent="false" accentunder="false"><mrow><mtext>∑</mtext></mrow><mrow> <mi>n</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mn>2</mn><mi mathvariant="italic">πk</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi mathvariant="italic">′n</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></msup><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mn>2</mn><mi mathvariant="italic">πk</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi mathvariant="italic">′n</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>A</mi><munderover accent="false" accentunder="false"><mrow><mtext>∑</mtext></mrow><mrow> <mi>n</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>
</tbody></table>
<!-- l. 469 -->
<p class="indent">
Therefore, to obtain an estimate <!-- l. 469 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>Â</mi></math> of the correct amplitude <!-- l. 469 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math> from an FFT value <!-- l. 469 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, one should use
</p>
<table class="equation">
<tbody><tr>
<td>
<!-- l. 470 -->
<p class="indent">
</p>
<!-- l. 470 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x62-215001r10"></mstyle><!-- endlabel --><mi>Â</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mo class="MathClass-rel" stretchy="false">|</mo><msub><mrow><mi>X</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow> <mrow><munderover accent="false" accentunder="false"><mrow><mo>∑</mo> </mrow><mrow><mi>n</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(4.10)
</td>
</tr>
</tbody></table>
<!-- l. 474 -->
<p class="indent">
Note that one divides the FFT result by <!-- l. 474 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> when wants to interpret it in Volts, but this is already incorporated in Eq.&nbsp;(<a href="#x62-215001r10">4.10<!-- tex4ht:ref: eq:scalloping_correction  --></a>). If the division by <!-- l. 474 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is already incorporated in a given software routine, one needs to multiply the FFT <!-- l. 474 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> by <!-- l. 474 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><msubsup><mrow><mi class="MathClass-op">∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo> <!-- nolimits --></mrow><mrow><mi>n</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msubsup><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> in order to compensate the later division by <!-- l. 474 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>.
</p>
<!-- l. 476 -->
<p class="indent">
</p><p>Listing&nbsp;<a href="#x62-215004r5">4.5<!-- tex4ht:ref: code:snip_frequency_scalloping  --></a> illustrates the procedure for estimating the amplitude <!-- l. 476 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>6</mn></mrow></math>&nbsp;V of a cosine. When using the rectangular window for a frequency <!-- l. 476 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub></math> located half-way two neighboring bins (<span class="ec-lmss-10x-x-109">alpha=8.5</span>), the result is:</p>
<p></p>
<pre class="verbatim" id="verbatim-8">Max(abs(scaled&nbsp;FFT))=1.9221
Scalloping&nbsp;loss&nbsp;=&nbsp;1.0779
Correct&nbsp;amplitude&nbsp;(Volts)&nbsp;=&nbsp;6
Estimated&nbsp;amplitude&nbsp;(Volts)&nbsp;=&nbsp;3.8442
Amplitude&nbsp;error&nbsp;(Volts)&nbsp;=&nbsp;2.1558
Amplitude&nbsp;error&nbsp;(%)&nbsp;=&nbsp;35.9301
</pre>
<!-- l. 484 -->
<p class="nopar">
The amplitude error in this case is 35.9%, which is due to the worst-case scalloping loss for the rectangular window in this situation of a sinusoid exactly half-way the bins.<span class="footnote-mark"><a href="#fn2x6" id="fn2x6-bk"><sup class="textsuperscript">2</sup></a></span><a id="x62-215002f2"></a>
</p>
<!-- l. 488 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.5: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_scalloping.m</span>
</figcaption>
<!-- tex4ht:label?: x62-215004r4.3.8  -->
<pre class="lstinputlisting" id="listing-141"><span class="label"><a id="x62-215006r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">window_choice</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">choose</span></span><span style="color:#005900"> <span class="ec-lmtt-9">one among 3 possible windows</span> 
</span><span class="label"><a id="x62-215007r2"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">clf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">N=32; A=6;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">clear</span></span><span style="color:#005900"> <span class="ec-lmtt-9">figure, FFT length, cosine amplitude</span> 
</span><span class="label"><a id="x62-215008r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">alpha</span></span><span style="color:#000000"><span class="ec-lmtt-9">=8.5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">specifies</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the cosine frequency</span> 
</span><span class="label"><a id="x62-215009r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(</span></span><span style="color:#000000"><span class="ec-lmtt-9">alpha</span></span><span style="color:#000000"><span class="ec-lmtt-9">*2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">cosine</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency in radians</span> 
</span><span class="label"><a id="x62-215010r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x=A*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">N samples of the cosine</span> 
</span><span class="label"><a id="x62-215011r6"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">switch</span></span><span style="color:#000000"> <span class="ec-lmtt-9">(window_choice)</span> 
</span><span class="label"><a id="x62-215012r7"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">case</span></span><span style="color:#000000"> <span class="ec-lmtt-9">1</span> 
</span><span class="label"><a id="x62-215013r8"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">this_window</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">rectwin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x62-215014r9"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">case</span></span><span style="color:#000000"> <span class="ec-lmtt-9">2</span> 
</span><span class="label"><a id="x62-215015r10"></a><span class="ec-lmr-6">10</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">this_window</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">hanning</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x62-215016r11"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">case</span></span><span style="color:#000000"> <span class="ec-lmtt-9">3</span> 
</span><span class="label"><a id="x62-215017r12"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">this_window</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">flattopwin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x62-215018r13"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x62-215019r14"></a></span><span style="color:#000000"><span class="ec-lmtt-9">amplitude_scaling</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">this_window</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">factor</span></span><span style="color:#005900"> <span class="ec-lmtt-9">to mitigate scalloping</span> 
</span><span class="label"><a id="x62-215020r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#000000"><span class="ec-lmtt-9">xw</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= x.*</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">transpose</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">this_window</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">multiply</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in time-domain</span> 
</span><span class="label"><a id="x62-215021r16"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xw_scaled_fft</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">xw</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">amplitude_scaling</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">N</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">points</span></span><span style="color:#005900"> <span class="ec-lmtt-9">FFT and scale it</span> 
</span><span class="label"><a id="x62-215022r17"></a></span><span style="color:#000000"><span class="ec-lmtt-9">max_fft_amplitude</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xw_scaled_fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x62-215023r18"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Max</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">abs</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">scaled</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">FFT))=</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">max_fft_amplitude</span></span><span style="color:#000000"> <span class="ec-lmtt-9">)])</span> 
</span><span class="label"><a id="x62-215024r19"></a></span><span style="color:#000000"><span class="ec-lmtt-9">scalloping_loss</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">max_fft_amplitude</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x62-215025r20"></a><span class="ec-lmr-6">20</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Scalloping</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">loss = </span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">scalloping_loss</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x62-215026r21"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Correct</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">amplitude (Volts) = </span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x62-215027r22"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Estimated</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">amplitude (Volts) = </span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">max_fft_amplitude</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x62-215028r23"></a></span><span style="color:#000000"><span class="ec-lmtt-9">amplitude_error</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= A - 2*max_fft_amplitude;</span> 
</span><span class="label"><a id="x62-215029r24"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Amplitude</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">error (Volts) = </span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">amplitude_error</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x62-215030r25"></a><span class="ec-lmr-6">25</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Amplitude</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">error (%) = </span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(100*</span></span><span style="color:#000000"><span class="ec-lmtt-9">amplitude_error</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x62-215031r26"></a></span><span style="color:#000000"><span class="ec-lmtt-9">ak_impulseplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">A/2],[Wc,2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">]/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[])</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">plot</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cosine impulses</span> 
</span><span class="label"><a id="x62-215032r27"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on,</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">([0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1]*(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xw_scaled_fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">or</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x62-215033r28"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">xlabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Frequency</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">\Omega (rad) normalized by \pi)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x62-215034r29"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">ylabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">FFT</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">magnitude and impulse area scaled by \pi</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">grid</span></span>
  </pre>
<!-- l. 490 -->
<p class="indent">
</p><p>In case one chooses the flat-top window in Listing&nbsp;<a href="#x62-215004r5">4.5<!-- tex4ht:ref: code:snip_frequency_scalloping  --></a> (<span class="ec-lmss-10x-x-109">window_choice=3</span>), the results are:</p>
<p></p>
<pre class="verbatim" id="verbatim-9">Max(abs(scaled&nbsp;FFT))=2.9949
Scalloping&nbsp;loss&nbsp;=&nbsp;0.0050728
Correct&nbsp;amplitude&nbsp;(Volts)&nbsp;=&nbsp;6
Estimated&nbsp;amplitude&nbsp;(Volts)&nbsp;=&nbsp;5.9899
Amplitude&nbsp;error&nbsp;(Volts)&nbsp;=&nbsp;0.010146
Amplitude&nbsp;error&nbsp;(%)&nbsp;=&nbsp;0.16909
</pre>
<!-- l. 498 -->
<p class="nopar">
The flat-top window does not have a good frequency resolution but reaches an amplitude estimation error of only 0.17%. Because of that, it is widely adopt to calibrate equipment.<span class="footnote-mark"><a href="#fn3x6" id="fn3x6-bk"><sup class="textsuperscript">3</sup></a></span><a id="x62-215035f3"></a> The Hann window is a trade-off between frequency resolution and amplitude error, reaching 14.24% of amplitude error when one uses <span class="ec-lmss-10x-x-109">window_choice=2</span>.
</p>
<!-- l. 501 -->
<p class="indent">
</p><p>After this short introduction to windowing, the next sections discuss three important functions in spectral analysis.</p>
<p></p>
<div class="footnotes">
<a id="x62-211005x4.3.4"></a> <!-- l. 281 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn1x6-bk" id="fn1x6"><sup class="textsuperscript">1</sup>&nbsp;</a></span><span class="ec-lmr-9">Scalloping loss is better understood by interpreting FFT as a filter-bank, as in Application&nbsp;</span><a href="ak_dsp_bookse59.html#x69-250034r4"><span class="ec-lmr-9">4.4</span><!-- tex4ht:ref: app:fftFilterBank  --></a><span class="ec-lmr-9">.</span>
</p>
<a id="x62-215003x4.3.8"></a> <!-- l. 485 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn2x6-bk" id="fn2x6"><sup class="textsuperscript">2</sup>&nbsp;</a></span><span class="ec-lmr-9">Similar to the amplitudes, the absolute power values inferred from of an FFT-based analysis require correction&nbsp;&nbsp;[</span><span class="ec-lmbx-9">?</span><span class="ec-lmr-9">].</span>
</p>
<a id="x62-215036x4.3.8"></a> <!-- l. 499 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn3x6-bk" id="fn3x6"><sup class="textsuperscript">3</sup>&nbsp;</a></span><span class="ec-lmr-9">See, e. g., the presentation by Matt Ettus at </span><a class="url" href="http://www.youtube.com/watch?v=wqKNUXDdIvU"><span class="ec-lmtt-9">http://www.youtube.com/watch?v=wqKNUXDdIvU</span></a><span class="ec-lmr-9">.</span>
</p>
</div>





</li></ul></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ak_dsp_bookse51.html" class="pagination-link  aria-label=" &lt;span="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">ak_dsp_bookse51.html</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ak_dsp_bookse53.html" class="pagination-link" aria-label="<span class='chapter-number'>62</span>&nbsp; <span class='chapter-title'>ak_dsp_bookse53.html</span>">
        <span class="nav-page-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">ak_dsp_bookse53.html</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Digital Signal Processing with Python, Matlab or Octave, Applications in Machine Learning Aldebaro Klautau Federal University of Pará (UFPA), Brazil</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>