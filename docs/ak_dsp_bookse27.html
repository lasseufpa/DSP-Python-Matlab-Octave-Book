<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aldebaro Klautau">

<title>Digital Signal Processing with Python, Matlab or Octave - 27&nbsp; Applications</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ak_dsp_bookse28.html" rel="next">
<link href="./ak_dsp_bookse26.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ak_dsp_bookch2.html">Transforms and Signal Representation</a></li><li class="breadcrumb-item"><a href="./ak_dsp_bookse27.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Digital Signal Processing with Python, Matlab or Octave</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Tables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listings</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Signals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analog, Digital and Discrete-Time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basic Signal Manipulation and Representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Block Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Complex-Valued and Sampled Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modeling the Stages in A/D and D/A Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Relating Frequencies in Continuous, Sampled and Discrete-time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">An Introduction to Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Signal Categorization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Power and Energy in Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Relating Power in Continuous and Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Correlation: Finding Trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Linear Model for Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforms and Signal Representation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Linear Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inner Products to Obtain the Transform Coefficients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Block Transforms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Fourier Transforms and Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Relating discrete and analog frequencies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Summary of equations for DFT / FFT Usage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Laplace Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Z Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse27.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Contrasting Signals and Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Analog and Digital Filters: A Quick Hands-On Tour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Linear Time-Invariant Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Sampling and Signal Reconstruction Revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse36.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Facts About First and Second-Order Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse37.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Bandwidth and Quality Factor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse38.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Importance of Linear Phase (or Constant Group Delay)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse39.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Filtering technologies: Surface acoustic wave (SAW) and others</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse40.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse41.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">IIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse42.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Bilinear Transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse43.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">FIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse44.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Realization of Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse45.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multirate Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse46.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse47.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse48.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse49.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spectral Estimation Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse51.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse52.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Windows for spectral analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse53.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">The ESD, PSD and MS Spectrum functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse54.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Filtering Random Signals and the Impact on PSDs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse55.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Periodogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse56.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Welch’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse57.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Parametric PSD Estimation via Autoregressive (AR) Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse58.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Time-frequency Analysis using the Spectrogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse59.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse60.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse61.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse62.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">ak_dsp_bookap2.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">ak_dsp_bookap3.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">ak_dsp_bookap4.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<meta charset="utf-8">
<meta content="TeX4ht (https://tug.org/tex4ht/)" name="generator">
<meta content="width=device-width,initial-scale=1" name="viewport">
<link href="ak_dsp_book.css" rel="stylesheet" type="text/css">
<meta content="ak_dsp_book.tex" name="src">
<script async="async" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js" type="text/javascript"></script>


<!-- l. 1934 -->
<p class="noindent">
This section will briefly discuss some applications of transforms.
</p>
<!-- l. 1939 -->
<p class="noindent">
<a id="x35-106001r1"></a> <span id="textcolor141"><span class="ec-lmbx-10x-x-109">Application 2.1.</span></span> <span class="ec-lmbx-10x-x-109">Example of Gram-Schmidt transform. </span>As an example of the Gram-Schmidt procedure, assume that Listing&nbsp;<a href="ak_dsp_bookse77.html#x89-276001r4">B.4<!-- tex4ht:ref: code:ak_gram_schmidt  --></a> is invoked with the commands
</p>
<!-- l. 1942 -->
<pre class="lstlisting" id="listing-52"><span class="label"><a id="x35-106002r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[0,-1,-1,0;</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">0,2,2,0;</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">0,1,0,1;</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">1,1,1,1;</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">-2,2,2,1]</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">row</span></span><span style="color:#005900"> <span class="ec-lmtt-9">vectors</span> 
</span><span class="label"><a id="x35-106003r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ah</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ak_gram_schmidt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">perform</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the orthonormalization procedure</span> 
</span><span class="label"><a id="x35-106004r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ah</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">transpose</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,:)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">coefficients</span></span><span style="color:#005900"> <span class="ec-lmtt-9">corresponding to first vector</span> 
</span><span class="label"><a id="x35-106005r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">reconstruction</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of first vector x(1,:) (as a column vector)</span></span></pre>
<!-- l. 1948 -->
<p class="indent">
where <!-- l. 1948 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn></mrow></math> vectors and <!-- l. 1948 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>D</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></mrow></math> is the space dimension. In this case, the number of orthonormal basis functions is <!-- l. 1948 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></mrow></math>, such that both matrices <span class="ec-lmss-10x-x-109">Ah </span>and <span class="ec-lmss-10x-x-109">A </span>have dimension <!-- l. 1948 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>4</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>4</mn></mrow></math>. The basis functions correspond to the columns of matrix <span class="ec-lmss-10x-x-109">A</span>. The first element of <span class="ec-lmss-10x-x-109">x1</span>, corresponding to the first basis function, is the only non-zero element and has value <!-- l. 1948 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><mrow> <mn>2</mn></mrow></msqrt></math> which is the coefficient that must multiply the first basis function <!-- l. 1948 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-bin" stretchy="false">−</mo><msqrt><mrow><mn>2</mn></mrow></msqrt><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><msqrt><mrow><mn>2</mn></mrow></msqrt><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> to reconstruct the first vector <!-- l. 1948 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. The reason is that <span class="ec-lmss-10x-x-109">ak_gram_schmidt </span>chooses the first basis as a normalized (unitary-norm) version of the first vector in <span class="ec-lmss-10x-x-109">x</span>.
</p>
<!-- l. 1950 -->
<p class="indent">
Debugging the execution of the code <span class="ec-lmss-10x-x-109">ak_gram_schmidt</span>, step-by-step, allows to observe more details as listed in Listing&nbsp;<a href="#x35-106006r4">2.4<!-- tex4ht:ref: code:snip_transforms_granschmidt_debug  --></a>.
</p>
<!-- l. 1952 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;2.4: </span><span class="content">MatlabOctaveCodeSnippets/snip_transforms_granschmidt_debug.m</span>
</figcaption>
<!-- tex4ht:label?: x35-106006r2.10  -->
<pre class="lstinputlisting" id="listing-53"><span class="label"><a id="x35-106008r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">tol</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1.1102e-015</span> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculated</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(default) tolerance</span> 
</span><span class="label"><a id="x35-106009r2"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">first</span></span><span style="color:#005900"> <span class="ec-lmtt-9">basis in y is [0</span> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">-0.7071</span></span><span style="color:#005900"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">-0.7071</span></span><span style="color:#005900"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">0],</span></span><span style="color:#005900"> <span class="ec-lmtt-9">numBasis=1</span> 
</span><span class="label"><a id="x35-106010r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 2, m = 1</span> 
</span><span class="label"><a id="x35-106011r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">projectionOverBasis</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [0 2.0 2.0 0]</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">2</span></span><span style="color:#005900"><span class="ec-lmtt-9">nd</span></span><span style="color:#005900"> <span class="ec-lmtt-9">input vector</span> 
</span><span class="label"><a id="x35-106012r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">errorVector</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1.0e-015 * [0</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">0.4441</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">0.4441</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">0]</span></span> 
<span class="label"><a id="x35-106013r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">magErrorVector</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 6.2804e-016</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">do</span></span><span style="color:#005900"> <span class="ec-lmtt-9">NOT add error vector to basis set</span> 
</span><span class="label"><a id="x35-106014r7"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">2</span></span><span style="color:#005900"><span class="ec-lmtt-9">nd</span></span><span style="color:#005900"> <span class="ec-lmtt-9">vector is already represented, go to next iteration</span> 
</span><span class="label"><a id="x35-106015r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 3, m = 1</span> 
</span><span class="label"><a id="x35-106016r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">projectionOverBasis</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [0 0.5 0.5 0]</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">3</span></span><span style="color:#005900"><span class="ec-lmtt-9">rd</span></span><span style="color:#005900"> <span class="ec-lmtt-9">input vector</span> 
</span><span class="label"><a id="x35-106017r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">errorVector</span></span><span style="color:#005900"> <span class="ec-lmtt-9">below is orthogonal to [0 -0.7071 -0.7071 0]</span> 
</span><span class="label"><a id="x35-106018r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">errorVector</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [0 0.5 -0.5 1]</span> 
</span><span class="label"><a id="x35-106019r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">magErrorVector</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1.2247</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">add</span></span><span style="color:#005900"> <span class="ec-lmtt-9">normalized error vector to basis set</span> 
</span><span class="label"><a id="x35-106020r13"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">second</span></span><span style="color:#005900"> <span class="ec-lmtt-9">basis is [0 0.4082 -0.4082 0.8165], numBasis=2</span> 
</span><span class="label"><a id="x35-106021r14"></a></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 4, m = 1</span> 
</span><span class="label"><a id="x35-106022r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#000000"><span class="ec-lmtt-9">projectionOverBasis</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [0 1.0 1.0</span> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">0]</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">4</span></span><span style="color:#005900"><span class="ec-lmtt-9">th</span></span><span style="color:#005900"> <span class="ec-lmtt-9">input vector</span> 
</span><span class="label"><a id="x35-106023r16"></a></span><span style="color:#000000"><span class="ec-lmtt-9">errorVector</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [1.0 0.0 0.0 1]</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> <span class="ec-lmtt-9">1st basis</span> 
</span><span class="label"><a id="x35-106024r17"></a></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 4, m = 2</span> 
</span><span class="label"><a id="x35-106025r18"></a></span><span style="color:#000000"><span class="ec-lmtt-9">projectionOverBasis</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [0.0</span> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">0.3333</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">-0.3333</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">0.6667]</span></span> 
<span class="label"><a id="x35-106026r19"></a></span><span style="color:#000000"><span class="ec-lmtt-9">errorVector</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [1.0 -0.3333 0.3333 0.3333]</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> <span class="ec-lmtt-9">2 basis vectors</span> 
</span><span class="label"><a id="x35-106027r20"></a><span class="ec-lmr-6">20</span></span><span style="color:#000000"><span class="ec-lmtt-9">magErrorVector</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1.1547</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">add</span></span><span style="color:#005900"> <span class="ec-lmtt-9">normalized error vector to basis set</span> 
</span><span class="label"><a id="x35-106028r21"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">3</span></span><span style="color:#005900"><span class="ec-lmtt-9">rd</span></span><span style="color:#005900"> <span class="ec-lmtt-9">basis is [0.8660 -0.2887 0.2887 0.2887], numBasis=3</span> 
</span><span class="label"><a id="x35-106029r22"></a></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 5, m = 1</span> 
</span><span class="label"><a id="x35-106030r23"></a></span><span style="color:#000000"><span class="ec-lmtt-9">projectionOverBasis</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [0 2.0 2.0 0]</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">5</span></span><span style="color:#005900"><span class="ec-lmtt-9">th</span></span><span style="color:#005900"> <span class="ec-lmtt-9">input vector</span> 
</span><span class="label"><a id="x35-106031r24"></a></span><span style="color:#000000"><span class="ec-lmtt-9">errorVector</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [-2.0 0.0 0.0 1.0]</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> <span class="ec-lmtt-9">only 1st basis</span> 
</span><span class="label"><a id="x35-106032r25"></a><span class="ec-lmr-6">25</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 5, m = 2</span> 
</span><span class="label"><a id="x35-106033r26"></a></span><span style="color:#000000"><span class="ec-lmtt-9">projectionOverBasis</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [0 0.3333 -0.3333 0.6667]</span> 
</span><span class="label"><a id="x35-106034r27"></a></span><span style="color:#000000"><span class="ec-lmtt-9">errorVector</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [-2.0 -0.3333 0.3333 0.3333]</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">using 2 basis vectors</span> 
</span><span class="label"><a id="x35-106035r28"></a></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 5, m = 3</span> 
</span><span class="label"><a id="x35-106036r29"></a></span><span style="color:#000000"><span class="ec-lmtt-9">projectionOverBasis</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [-1.250 0.4167 -0.4167 -0.4167]</span> 
</span><span class="label"><a id="x35-106037r30"></a><span class="ec-lmr-6">30</span></span><span style="color:#000000"><span class="ec-lmtt-9">errorVector</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [-0.75 -0.75 0.75 0.75]</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> <span class="ec-lmtt-9">3 basis vectors</span> 
</span><span class="label"><a id="x35-106038r31"></a></span><span style="color:#000000"><span class="ec-lmtt-9">magErrorVector</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1.5000</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">add</span></span><span style="color:#005900"> <span class="ec-lmtt-9">normalized error vector to basis set</span> 
</span><span class="label"><a id="x35-106039r32"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">4</span></span><span style="color:#005900"><span class="ec-lmtt-9">th</span></span><span style="color:#005900"> <span class="ec-lmtt-9">basis is [-0.5 -0.5 0.5 0.5], numBasis=4</span> 
</span><span class="label"><a id="x35-106040r33"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">abort</span></span><span style="color:#005900"> <span class="ec-lmtt-9">because (numBasis &gt;= N)</span></span>
  </pre>
<!-- l. 1988 -->
<p class="indent">
The reader can perform a similar analysis for another set of vectors and compare with the results obtained via calculating by hand. &nbsp; &nbsp;<!-- l. 1989 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 1992 -->
<p class="noindent">
<a id="x35-106041r2"></a> <span id="textcolor142"><span class="ec-lmbx-10x-x-109">Application 2.2.</span></span> <span class="ec-lmbx-10x-x-109">Time-localization property of Haar coefficients.</span>
</p>
<figure class="figure">
<p><a id="x35-10604225"></a></p>
<!-- l. 1997 -->
<p class="noindent">
<img alt="PIC" src="Figures/dct_haar_impulse.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.25: </span><span class="content">Signal <!-- l. 1998 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>11</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> analyzed by 32-points DCT and Haar transforms. The right column shows the transform coefficients (abscissa is <!-- l. 1998 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math>). The left column shows time-domain plots. Below the signal itself, one can visualize the “best” (the one corresponding to the coefficient with largest absolute value) basis functions for each transform.</span>
</figcaption>
<!-- tex4ht:label?: x35-10604225  -->
</figure>
<!-- l. 2002 -->
<p class="indent">
A very simple experiment will help illustrating the time-localization property of Haar functions. Consider the signal to be analyzed in the transform domain is a single impulse <!-- l. 2002 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>n</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>n</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mn>31</mn></mrow></math>, which will be represented by a vector <!-- l. 2002 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></math> will zeroed elements but the one corresponding to the <!-- l. 2002 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>n</mi></mrow><mrow><mn>0</mn></mrow></msub></math> position. The script <span class="ec-lmss-10x-x-109">MatlabOctaveBookExamples/ex_transforms_dcthaar_example.m </span>can be used to observe the behavior of the transforms. Figure&nbsp;<a href="#x35-10604225">2.25<!-- tex4ht:ref: fig:dct_haar_impulse  --></a> shows the output of the script when the signal is <!-- l. 2002 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>11</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. In this case, many Haar coefficients are zero and the one with largest magnitude (<!-- l. 2002 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>21</mn></mrow></math>) has a corresponding basis function (bottom of the left column) that helps to localize the occurrence of the impulse in <!-- l. 2002 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. In contrast, most DCT coefficients have relatively large values and the basis functions do not help in time-localization. The mentioned script allows to investigate this aspect more deeply. Compare the results of DCT and Haar transforms when the signal is a cosine summed to an impulse. &nbsp;&nbsp;<!-- l. 2004 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2006 -->
<p class="noindent">
<a id="x35-106043r3"></a> <span id="textcolor143"><span class="ec-lmbx-10x-x-109">Application 2.3.</span></span> <span class="ec-lmbx-10x-x-109">Inverse Laplace transforms with Matlab’s Symbolic Math Toolbox. </span>Keeping in mind that Matlab adopts the unilateral Laplace transform, its Symbolic Math Toolbox can be used to calculate Laplace transforms and their inverses. For example, the unilateral Laplace transform <!-- l. 2007 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mi>s</mi></mrow></math> of <!-- l. 2007 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>u</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> can be obtained with the commands <span class="ec-lmss-10x-x-109">syms t; laplace(t / t)</span>. Similarly, the commands <span class="ec-lmss-10x-x-109">syms w0,t; laplace(sin(w0*t))</span> indicate that <!-- l. 2007 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <msubsup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow><mrow><mn>2</mn></mrow></msubsup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> for <!-- l. 2007 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo><mi>u</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. The following commands illustrate the inverse transform of <!-- l. 2008 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> given by Eq.&nbsp;(<a href="ak_dsp_bookse25.html#x33-102014r45">2.45<!-- tex4ht:ref: eq:laplace_example  --></a>):
</p>
<!-- l. 2009 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;2.5: </span><span class="content">MatlabOnly/snip_transforms_ilaplace.m</span>
</figcaption>
<!-- tex4ht:label?: x35-106044r2.10  -->
<pre class="lstinputlisting" id="listing-54"><span class="label"><a id="x35-106046r1"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">syms</span></span><span style="color:#000000"> <span class="ec-lmtt-9">s</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">defines</span></span><span style="color:#005900"> <span class="ec-lmtt-9">s as a symbolic variable</span> 
</span><span class="label"><a id="x35-106047r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">a</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">b=-2; c=-1+j*2;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">choose</span></span><span style="color:#005900"> <span class="ec-lmtt-9">poles and zeros</span> 
</span><span class="label"><a id="x35-106048r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">a</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/((</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">conj</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">define</span></span><span style="color:#005900"> <span class="ec-lmtt-9">X(s)</span> 
</span><span class="label"><a id="x35-106049r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">ilaplace</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Matlab</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> <span class="ec-lmtt-9">inverse unilateral Laplace transform</span></span>
  </pre>
<!-- l. 2016 -->
<p class="indent">
The command <span class="ec-lmss-10x-x-109">pretty </span>(e. g., <span class="ec-lmss-10x-x-109">pretty(ilaplace(X))</span>) can be used to beautify the output, which in this case is <span class="ec-lmss-10x-x-109">- 3/5 exp(-2 t) + 1/5 exp(-t) (3 cos(2 t) + sin(2 t))</span>. Find the inverse Laplace transform for other signals, such as <!-- l. 2017 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo><mi>u</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. &nbsp; &nbsp;<!-- l. 2018 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2020 -->
<p class="noindent">
</p><p><a id="x35-106052r4"></a> <span id="textcolor144"><span class="ec-lmbx-10x-x-109">Application 2.4.</span></span> <span class="ec-lmbx-10x-x-109">ECG transform coding. </span>Because a</p>
block transform is completely specified by an invertible matrix <!-- l. 2022 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></math>, going from one domain to another (<!-- l. 2022 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></math> to <!-- l. 2022 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle></math> or vice-versa) is <span class="ec-lmri-10x-x-109">loss-less</span>, which means there is no loss of information. In many applications, such as image coding, where the goal is to minimize the number of bits to represent an image, it is useful to compress the signal using a lossy algorithm. Transform coding can be a lossy algorithm when it discards or quantizes coefficients in the transform domain. This is effective in many applications because, while all samples in <!-- l. 2022 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></math> have the same “importance”, in the transform domain <!-- l. 2022 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle></math> the coefficients can be organized according to some hierarchy or rank. In transform coding the most “important” coefficients are quantized more carefully than the unimportant ones.
<p></p>
<!-- l. 2024 -->
<p class="indent">
Figure&nbsp;<a href="#x35-10605526">2.26<!-- tex4ht:ref: fig:ecg_signal  --></a> depicts a segment (first 1,500 samples) of an ECG signal. The ECG data used here is from the MIT-BIH Arrhythmia Database.<span class="footnote-mark"><a href="#fn13x4" id="fn13x4-bk"><sup class="textsuperscript">13</sup></a></span><a id="x35-106053f13"></a>, and Figure&nbsp;<a href="#x35-10605526">2.26<!-- tex4ht:ref: fig:ecg_signal  --></a> corresponds to the first channel of file 12531_04.dat. The function <span class="ec-lmss-10x-x-109">ak_rddata.m </span>indicates that the DC offset of the ADC chip was calibrated to be zero. It also indicates that the ECG signals were digitized with a sampling frequency <!-- l. 2024 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>250</mn></mrow></math> Hz, 12 bits per sample, and a quantizer with step <!-- l. 2024 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Δ</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">AD</mtext></mstyle></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>400</mn></mrow></math>&nbsp;mV. The (empirical) signal power is 3.07 mW and, following the conventional quantization model, Eq.&nbsp;(<a href="ak_dsp_bookse9.html#x16-56038r38">1.38<!-- tex4ht:ref: eq:variance_uniformrv  --></a>) suggests the quantization noise power was <!-- l. 2024 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>5.2</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>10</mn></mrow></msup></mrow></math> mW. Hence, the SNR corresponding to the quantization stage alone is approximately 97.7 dB.
</p>
<figure class="figure">
<p><a id="x35-10605526"></a></p>
<!-- l. 2028 -->
<p class="noindent">
<img alt="PIC" src="Figures/ecg_signal.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.26: </span><span class="content">A segment of one channel of the original ECG data.</span>
</figcaption>
<!-- tex4ht:label?: x35-10605526  -->
</figure>
<!-- l. 2032 -->
<p class="indent">
A very simple example of a transform coding system is provided as Matlab/Octave code in the companion software (in directory <span class="ec-lmss-10x-x-109">Applications/ECGTransformCoding</span>). The idea is to simply discard the higher-order coefficients in the transform domain. For example, assume that <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is the dimension of <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></math> and <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle></math>, which are related by a <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">×</mo> <mi>N</mi></mrow></math> transform matrix <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></math>. In the encoding stage, a discrete-time input signal <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is segmented into blocks of dimension <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>, composing a set of <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math> input vectors <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">{</mo><msub><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></mrow><mrow><mi>M</mi></mrow></msub><mo class="MathClass-close" stretchy="false">}</mo></mrow></math>, where <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">×</mo> <mi>M</mi></mrow></math> is the available number of samples of <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. The coding scheme converts each <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></mrow><mrow><mi>i</mi></mrow></msub></math> into <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle></mrow><mrow><mi>i</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mi>H</mi></mrow></msup><msub><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> and keeps in a new vector <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mover accent="true"><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle></mrow><mo accent="true">^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub></math> only the first <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>K</mi> <mo class="MathClass-rel" stretchy="false">≤</mo> <mi>N</mi></mrow></math> elements of <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle></mrow><mrow><mi>i</mi></mrow></msub></math> (the remaining <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>K</mi></mrow></math> are discarded). The <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math> vectors <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mover accent="true"><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle></mrow><mo accent="true">^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub></math> can be concatenated to create an encoded output signal <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mrow><mi>X</mi></mrow><mo accent="true">^</mo></mover><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> with <!-- l. 2032 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-bin" stretchy="false">×</mo> <mi>K</mi></mrow></math> samples.
</p>
<!-- l. 2034 -->
<p class="indent">
In the decoding stage, in order to reconstruct a signal <!-- l. 2034 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> from <!-- l. 2034 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mrow><mi>X</mi></mrow><mo accent="true">^</mo></mover><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> (if there were no losses, <!-- l. 2034 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>), an inverse procedure is adopted. The signal <!-- l. 2034 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mrow><mi>X</mi></mrow><mo accent="true">^</mo></mover><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is blocked into vectors of dimension <!-- l. 2034 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math> and <!-- l. 2034 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>K</mi></mrow></math> zero elements are inserted to create vectors <!-- l. 2034 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> of dimension <!-- l. 2034 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> (this operation is called <span class="ec-lmri-10x-x-109">zero-padding</span><a id="dx35-106056"></a>). Each of these <!-- l. 2034 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>-dimensional vectors is converted to time-domain vectors <!-- l. 2034 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle><mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>, which are then concatenated to form <!-- l. 2034 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>.
</p>
<!-- l. 2036 -->
<p class="indent">
</p><p>Figure&nbsp;<a href="#x35-10605727">2.27<!-- tex4ht:ref: fig:ecg_reconstructedsignal  --></a> was obtained using a DCT matrix <!-- l. 2036 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></math> of <!-- l. 2036 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> points</p>
and discarding 26 (high-frequency) coefficients. It can be seen that keeping only <!-- l. 2036 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>K</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>6</mn></mrow></math> out of 32 coefficients is enough to provide a rough representation of <!-- l. 2036 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> but the error is significant in high-frequency regions. Note that the DCT operation is performed in blocks of <!-- l. 2036 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> samples and Figure&nbsp;<a href="#x35-10605727">2.27<!-- tex4ht:ref: fig:ecg_reconstructedsignal  --></a> is the result of processing many of these blocks.
<p></p>
<figure class="figure">
<p><a id="x35-10605727"></a></p>
<!-- l. 2040 -->
<p class="noindent">
<img alt="PIC" src="Figures/ecg_reconstructedsignal.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.27: </span><span class="content">Original and reconstructed ECG signals with DCT of <!-- l. 2041 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> points and discarding 26 (high-frequency) coefficients. Therefore, the error is predominant in high-frequency regions as indicated in the plot.</span>
</figcaption>
<!-- tex4ht:label?: x35-10605727  -->
</figure>
<!-- l. 2044 -->
<p class="indent">
In practice, a quantization scheme should be adopted to represent <!-- l. 2044 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mrow><mi>X</mi></mrow><mo accent="true">^</mo></mover><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> with a small number of bits per sample. The compression ratio is the number of bits to represent <!-- l. 2044 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>M</mi> <mo class="MathClass-bin" stretchy="false">×</mo> <mi>N</mi></mrow></math> divided by the number of bits to represent <!-- l. 2044 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mrow><mi>X</mi></mrow><mo accent="true">^</mo></mover><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>M</mi> <mo class="MathClass-bin" stretchy="false">×</mo> <mi>K</mi></mrow></math>. For simplicity, the proposed example does not involve quantization and the compression ratio is evaluated by <!-- l. 2044 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>K</mi></mrow></math>. This corresponds to assuming that each sample of both <!-- l. 2044 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 2044 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mrow><mi>X</mi></mrow><mo accent="true">^</mo></mover><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is represented with the same number of bits.
</p>
<!-- l. 2046 -->
<p class="indent">
Figure&nbsp;<a href="#x35-10605828">2.28<!-- tex4ht:ref: fig:ecg_ratedistortion  --></a> shows the percentage of kept coefficients <!-- l. 2046 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>K</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> in the abscissa and <!-- l. 2046 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mstyle class="text"><mtext class="textrm" mathvariant="normal">MSE</mtext></mstyle></mrow></math> in the ordinate, where
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2047 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="text"><mtext class="textrm" mathvariant="normal">MSE</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><mi>M</mi> <mo class="MathClass-bin" stretchy="false">×</mo> <mi>N</mi></mrow></mfrac><munderover accent="false" accentunder="false"><mrow><mo>∑</mo> </mrow><mrow><mi>n</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>M</mi><mo class="MathClass-bin" stretchy="false">×</mo><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><msup><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>x</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-close" stretchy="false">)</mo></mrow><mrow><mn>2</mn></mrow></msup> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2048 -->
<p class="indent">
is the mean-squared error, which is equivalent to the power of the error signal. If <!-- l. 2048 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>K</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>N</mi></mrow></math> (100% in the abscissa) the system is lossless and <!-- l. 2048 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">MSE</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> (<!-- l. 2048 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo><mi>∞</mi></mrow></math> in log scale), so the graphs do not show these points. The larger <!-- l. 2048 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>, the better the coding performance but the higher the computational cost.
</p>
<!-- l. 2051 -->
<p class="indent">
</p><p>Assuming <!-- l. 2051 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>128</mn></mrow></math> and <!-- l. 2051 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>K</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math> as indicated in Figure&nbsp;<a href="#x35-10605828">2.28<!-- tex4ht:ref: fig:ecg_ratedistortion  --></a>, the abscissa is <!-- l. 2051 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>K</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>128</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>7.81</mn></mrow></math>% and the corresponding error is <!-- l. 2051 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">MSE</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1.4824</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>8</mn></mrow></msup></mrow></math>&nbsp;W (<!-- l. 2051 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>78</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>29</mn></mrow></math> dBW) or, equivalently, <!-- l. 2051 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>48</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>29</mn></mrow></math>&nbsp;dBm. Given that the signal power was estimated as 3.07 mW (<!-- l. 2052 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>4.87</mn></mrow></math> dBm), the <!-- l. 2052 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">SNR</mtext></mstyle></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">dB</mtext></mstyle></mrow></msub> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>4.87</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>48</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>3</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>53</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>16</mn></mrow></math></p>
dB when considering only the distortion incurred by this specific encoding procedure.
<p></p>
<figure class="figure">
<p><a id="x35-10605828"></a></p>
<!-- l. 2056 -->
<p class="noindent">
<img alt="PIC" src="Figures/ecg_ratedistortion.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.28: </span><span class="content">Performance of five DCT-based ECG coding schemes. The number of points is varied <!-- l. 2057 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">∈</mo><mo class="MathClass-open" stretchy="false">{</mo><mn>4</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>8</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>32</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>64</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>128</mn><mo class="MathClass-close" stretchy="false">}</mo></mrow></math> and <!-- l. 2057 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>K</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>M</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></math>. The larger <!-- l. 2057 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>, the better the coding performance but the higher the computational cost.</span>
</figcaption>
<!-- tex4ht:label?: x35-10605828  -->
</figure>
<!-- l. 2060 -->
<p class="indent">
It should be noted that the dataset used is formed by abnormal ECG signals and, eventually, better results could be obtained when using another dataset.
</p>
<!-- l. 2062 -->
<p class="indent">
Write an encoder that uses DCT coding to generate files of a relatively small size and a decoder to “decompress” such files and recover an ECG signal (an approximation to the original one). To do that, it is necessary to quantize the DCT coefficients and pack them in a way that the resulting file has a small size. Consider using scalar or <span class="ec-lmri-10x-x-109">vector quantization</span><a id="dx35-106059"></a>. The advantage of vector quantization is that you need to store only the index to the codebook entry (codeword) with a vector that will represent the DCT. In case you use a codebook with <!-- l. 2062 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mrow><mn>2</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>256</mn></mrow></math> codewords, each entry can be conveniently written as an unsigned char of 8 bits. To design the codebook, besides the Mathwork’s code in the DSP System Toolbox, there are many algorithms such as the <span class="ec-lmri-10x-x-109">K-means </span>with implementations available on the Web.
</p>
<!-- l. 2064 -->
<p class="indent">
Another interesting exercise is to apply KLT and other transforms to this problem, trying to get better results than with the DCT. &nbsp; &nbsp;<!-- l. 2065 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2067 -->
<p class="noindent">
<a id="x35-106060r5"></a> <span id="textcolor145"><span class="ec-lmbx-10x-x-109">Application 2.5.</span></span> <span class="ec-lmbx-10x-x-109">DCT coding of image.</span>
</p>
<!-- l. 2071 -->
<p class="indent">
The usefulness of DCT in coding is illustrated by the JPEG image coding standard.<span class="footnote-mark"><a href="#fn14x4" id="fn14x4-bk"><sup class="textsuperscript">14</sup></a></span><a id="x35-106061f14"></a> Before describing an example, two dimensional transforms are briefly discussed.
</p>
<!-- l. 2074 -->
<p class="indent">
Linearly-separable two dimensional (2-D) transforms of a block <!-- l. 2074 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></math> (e. g., a matrix with pixel values) is obtained by first using the transform along the rows (or columns) and then transforming this result along the columns (or rows). Alternatively, one can use matrix notation: <!-- l. 2075 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo><msup><mrow> <mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></mrow><mrow><mi>H</mi></mrow></msup><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle><msup><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></mrow><mrow><mo class="MathClass-bin" stretchy="false">∗</mo></mrow></msup><mo class="MathClass-punc" stretchy="false">.</mo></mrow></math> Because, <!-- l. 2076 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></math> is real for a DCT, one has
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2077 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo><msup><mrow> <mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></mrow><mrow><mi>T</mi> </mrow></msup><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle><mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2080 -->
<p class="indent">
</p><p>This is equivalent to first calculating <!-- l. 2080 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">T</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo><msup><mrow> <mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></mrow><mrow><mi>H</mi></mrow></msup><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></mrow></math>: the 1-D DCT transform of each column of <!-- l. 2080 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></math></p>
is placed in its corresponding column in a temporary matrix <!-- l. 2080 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">T</mtext></mstyle></math>. Then, each row of <!-- l. 2080 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">T</mtext></mstyle></math> is transformed by another 1-D DCT, which could be accomplished by <!-- l. 2081 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></mrow><mrow><mi>H</mi></mrow></msup><msup><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">T</mtext></mstyle></mrow><mrow><mi>T</mi> </mrow></msup></mrow></math>. This result should be transposed to generate <!-- l. 2081 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle></math>. These operations are equivalent to:
<p></p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2082 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="text"><mtext class="textbf" mathvariant="bold">X</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></mrow><mrow><mi>H</mi></mrow></msup><msup><mrow><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></mrow><mrow><mi>H</mi></mrow></msup><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle><mo class="MathClass-close" stretchy="false">)</mo></mrow><mrow><mi>T</mi> </mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow><mrow><mi>T</mi> </mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo><msup><mrow> <mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></mrow><mrow><mi>H</mi></mrow></msup><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle><msup><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">A</mtext></mstyle></mrow><mrow><mo class="MathClass-bin" stretchy="false">∗</mo></mrow></msup><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<figure class="figure">
<p><a id="x35-10606329"></a></p>
<!-- l. 2088 -->
<p class="noindent">
<img alt="PIC" src="Figures/lenna_eye.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.29: </span><span class="content">A zoom of the eye region of the Lenna image.</span>
</figcaption>
<!-- tex4ht:label?: x35-10606329  -->
</figure>
<!-- l. 2092 -->
<p class="indent">
Listing&nbsp;<a href="#x35-106064r6">2.6<!-- tex4ht:ref: code:dctimagecoding  --></a> illustrates the adoption of a 2-D DCT for coding an image block (represented by a matrix).
</p>
<!-- l. 2093 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;2.6: </span><span class="content">MatlabBookFigures/figs_transforms_dctimagecoding</span>
</figcaption>
<!-- tex4ht:label?: x35-106064r2.10  -->
<pre class="lstinputlisting" id="listing-55"><span class="label"><a id="x35-106066r1"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">load</span></span><span style="color:#005900"> <span class="ec-lmtt-9">black &amp; white 256 x 256 pixels of Lenna:</span> 
</span><span class="label"><a id="x35-106067r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">fullPath</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">lenna_bw</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">gif</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">file</span></span><span style="color:#005900"> <span class="ec-lmtt-9">location</span> 
</span><span class="label"><a id="x35-106068r3"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">lenaImage</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">map</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">imread</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">fullPath</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">read</span></span><span style="color:#005900"> <span class="ec-lmtt-9">file</span> 
</span><span class="label"><a id="x35-106069r4"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">colormap</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">map</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">use</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the proper color map</span> 
</span><span class="label"><a id="x35-106070r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">x1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=128;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x2=135; y1=160; y2=167;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> <span class="ec-lmtt-9">take a 8x8 block close to her eye</span> 
</span><span class="label"><a id="x35-106071r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">lenaImage</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x1</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y1</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">y2</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">get</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the region</span> 
</span><span class="label"><a id="x35-106072r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">double</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">cast</span></span><span style="color:#005900"> <span class="ec-lmtt-9">x to be double instead of integer</span> 
</span><span class="label"><a id="x35-106073r8"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">draw</span></span><span style="color:#005900"> <span class="ec-lmtt-9">a rectangle to indicate the block:</span> 
</span><span class="label"><a id="x35-106074r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">lenaImage</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x1</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y1</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">y2</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">lenaImage(x2,y1:y2)=1;</span> 
</span><span class="label"><a id="x35-106075r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">lenaImage</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x1</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y1</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">lenaImage(x1:x2,y2)=1;</span> 
</span><span class="label"><a id="x35-106076r11"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">imagesc</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">lenaImage</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">show</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the image</span> 
</span><span class="label"><a id="x35-106077r12"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">axis</span></span><span style="color:#000000"> <span class="ec-lmtt-9">equal</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">correct</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the aspect ratio</span> 
</span><span class="label"><a id="x35-106078r13"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Some</span></span><span style="color:#005900"> <span class="ec-lmtt-9">calculations to practice:</span> 
</span><span class="label"><a id="x35-106079r14"></a></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">octave_dct2</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">forward DCT</span> 
</span><span class="label"><a id="x35-106080r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">octave_idct2</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">inverse DCT to check</span> 
</span><span class="label"><a id="x35-106081r16"></a></span><span style="color:#000000"><span class="ec-lmtt-9">numericError</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">any</span></span><span style="color:#005900"> <span class="ec-lmtt-9">numeric error?</span> 
</span><span class="label"><a id="x35-106082r17"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Ah</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">octave_dctmtx</span></span><span style="color:#000000"><span class="ec-lmtt-9">(8)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">now</span></span><span style="color:#005900"> <span class="ec-lmtt-9">calculate in an alternative way</span> 
</span><span class="label"><a id="x35-106083r18"></a></span><span style="color:#000000"><span class="ec-lmtt-9">X2</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= Ah*x*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">transpose</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ah</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x35-106084r19"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">X2</span></span><span style="color:#005900"> <span class="ec-lmtt-9">= transpose(Ah)*x*Ah; %Note: this would be wrong!</span> 
</span><span class="label"><a id="x35-106085r20"></a><span class="ec-lmr-6">20</span></span><span style="color:#000000"><span class="ec-lmtt-9">numericError2</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">X2</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">any</span></span><span style="color:#005900"> <span class="ec-lmtt-9">numeric error?</span></span>
  </pre>
<!-- l. 2095 -->
<p class="indent">
Similar to the 1-D ECG coding example in Application&nbsp;<a href="#x35-106052r4">2.4<!-- tex4ht:ref: app:ecgcoding  --></a>, few DCT coefficients can be enough to represent an image. Study the code <span class="ec-lmss-10x-x-109">MatlabOctaveFunctions/ak_dctdemo.m </span>using DCT to represent different images,<span class="footnote-mark"><a href="#fn15x4" id="fn15x4-bk"><sup class="textsuperscript">15</sup></a></span><a id="x35-106086f15"></a> including ones with text. Even better results can be obtained with the wavelet transform, which is used in the JPEG 2000 image coding standard. Write an encoder and decoder that use a transform to compress and decompress an image file. &nbsp; &nbsp;<!-- l. 2097 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2099 -->
<p class="noindent">
<a id="x35-106088r6"></a> <span id="textcolor146"><span class="ec-lmbx-10x-x-109">Application 2.6.</span></span> <span class="ec-lmbx-10x-x-109">Orthogonality of continuous-time sinusoids over a given interval. </span>In applications such as frequency modulation, it is important to know the conditions in which two cosines with frequencies <!-- l. 2101 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub></math> and <!-- l. 2101 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mn>2</mn></mrow></msub></math> and phase <!-- l. 2101 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>𝜃</mi></math>, are orthogonal over a given interval <!-- l. 2102 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>T</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">sym</mtext></mstyle></mrow></msub></math> of interest. Mathematically, this requirement can be expressed as
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2104 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <msub><mrow><mo>∫ <!-- nolimits --></mo><!-- nolimits --></mrow><mrow><mo class="MathClass-rel" stretchy="false">&lt;</mo><msub><mrow><mi>T</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">sym</mtext></mstyle></mrow></msub><mo class="MathClass-rel" stretchy="false">&gt;</mo></mrow></msub><mtext class="qopname"> cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>t</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>𝜃</mi><mo class="MathClass-close" stretchy="false">)</mo><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mrow><mi>f</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>t</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>𝜃</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2107 -->
<p class="indent">
and, because the phase <!-- l. 2107 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>𝜃</mi></math> is the same for both cosines, this requirement is called “coherent orthogonality”. It can be shown<span class="footnote-mark"><a href="#fn16x4" id="fn16x4-bk"><sup class="textsuperscript">16</sup></a></span><a id="x35-106089f16"></a> that this condition is satisfied with integers <!-- l. 2108 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math> and <!-- l. 2108 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math> such that
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2109 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>m</mi></mrow> <mrow><mn>4</mn><msub><mrow><mi>T</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">sym</mtext></mstyle></mrow></msub></mrow></mfrac> <mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn><mi>n</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>m</mi></mrow> <mrow><mn>4</mn><msub><mrow><mi>T</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">sym</mtext></mstyle></mrow></msub></mrow></mfrac> <mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;and&nbsp;</mtext></mstyle><msub><mrow><mi>f</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mi>m</mi></mrow> <mrow><mn>2</mn><msub><mrow><mi>T</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">sym</mtext></mstyle></mrow></msub></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2112 -->
<p class="indent">
For example, assume that <!-- l. 2112 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>T</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">sym</mtext></mstyle></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.01</mn></mrow></math>&nbsp;seconds, <!-- l. 2112 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>m</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></mrow></math> and <!-- l. 2112 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>35</mn></mrow></math>. In this case, <!-- l. 2112 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub></math> and <!-- l. 2112 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mn>2</mn></mrow></msub></math> are 1650 and 1850&nbsp;Hz, respectively. Note that the minimum value of <!-- l. 2112 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math> is <!-- l. 2112 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><msub><mrow><mi>T</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">sym</mtext></mstyle></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>50</mn></mrow></math>&nbsp;Hz in this case, which corresponds to choosing <!-- l. 2112 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>m</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>.
</p>
<!-- l. 2114 -->
<p class="indent">
As a side note, for “noncoherent orthogonality”, the minimum frequency separation<span class="footnote-mark"><a href="#fn17x4" id="fn17x4-bk"><sup class="textsuperscript">17</sup></a></span><a id="x35-106091f17"></a> is <!-- l. 2114 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>T</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">sym</mtext></mstyle></mrow></msub></mrow></math>. &nbsp; &nbsp;<!-- l. 2115 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2117 -->
<p class="noindent">
<a id="x35-106093r7"></a> <span id="textcolor147"><span class="ec-lmbx-10x-x-109">Application 2.7.</span></span> <span class="ec-lmbx-10x-x-109">Orthogonality of finite duration discrete-time sinusoids. </span>It is also important to evaluate in what conditions a pair of discrete-time sinusoids are orthogonal considering a finite duration interval.
</p>
<!-- l. 2122 -->
<p class="indent">
Two discrete-time exponentials <!-- l. 2122 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>n</mi></mrow></msup></math> and <!-- l. 2122 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>n</mi></mrow></msup></math>, <!-- l. 2122 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-rel" stretchy="false">≠</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math>, are always orthogonal when summed over a range <!-- l. 2122 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo><mi>∞</mi></mrow></math> to <!-- l. 2122 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>∞</mi></math> (see Example&nbsp;<a href="ak_dsp_bookse22.html#x30-92001r12">2.12<!-- tex4ht:ref: ex:eternal_sinusoids  --></a>), but this is not the case when the summation interval is finite. One way of inspecting what happens when the duration is finite is to reason as following: 1) keep in mind that the sum of the samples of a single sinusoid over a multiple of its fundamental period is zero. 2) Interpreting Example&nbsp;<a href="ak_dsp_bookse22.html#x30-92003r14">2.14<!-- tex4ht:ref: ex:harmonic_sinusoids  --></a> in discrete-time allows to decompose the inner product for testing orthogonality into a sum of two sinusoids. 3) the inner product is mapped to summations of sinusoids with frequencies equal to <!-- l. 2124 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo><msub><mrow> <mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math> and <!-- l. 2124 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">−</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math> and the goal is to find an integer <!-- l. 2124 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> that is a multiple of both fundamental periods.
</p>
<!-- l. 2126 -->
<p class="indent">
</p><p>One application of this orthogonality principle is the design of a binary transmission, where the two signals are distinguished by their frequencies</p>
<!-- l. 2126 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mn>0</mn></mrow></msub></math> and <!-- l. 2126 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub></math>. This scheme is called frequency shift keying (FSK). We are interested on determining the minimum symbol period that guarantees orthogonality between the two sinusoids. In the context of telecommunications, this minimum period will correspond to the highest symbol rate. The script <span class="ec-lmss-10x-x-109">MatlabOctaveBookExamples/ex_transforms_check_orthogonality.m </span>can be used for studying this question and is repeated below. The sampling frequency is <!-- l. 2129 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> and one should check different pairs of <!-- l. 2129 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mn>0</mn></mrow></msub></math> and <!-- l. 2129 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub></math>.
<p></p>
<!-- l. 2130 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;2.7: </span><span class="content">MatlabOctaveBookExamples/ex_transforms_check_orthogonality.m</span>
</figcaption>
<!-- tex4ht:label?: x35-106094r2.10  -->
<pre class="lstinputlisting" id="listing-56"><span class="label"><a id="x35-106096r1"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> <span class="ec-lmtt-9">1</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">choose</span></span><span style="color:#005900"> <span class="ec-lmtt-9">between two options</span> 
</span><span class="label"><a id="x35-106097r2"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">f0</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 980;</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of first sinusoid (in telecom, of bit 0)</span> 
</span><span class="label"><a id="x35-106098r3"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">f1</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1180;</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of 2nd sinusoid (in telecom, of bit 1)</span> 
</span><span class="label"><a id="x35-106099r4"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">else</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">another</span></span><span style="color:#005900"> <span class="ec-lmtt-9">example</span> 
</span><span class="label"><a id="x35-106100r5"></a><span class="ec-lmr-6">5</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">f0</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1650;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">1</span></span><span style="color:#005900"><span class="ec-lmtt-9">st</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sinusoid</span> 
</span><span class="label"><a id="x35-106101r6"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">f1</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1850;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">2</span></span><span style="color:#005900"><span class="ec-lmtt-9">nd</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sinusoid</span> 
</span><span class="label"><a id="x35-106102r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x35-106103r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=9600;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">assumed</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sampling frequency</span> 
</span><span class="label"><a id="x35-106104r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">sumSinusoidFrequency</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= f0+f1;</span> 
</span><span class="label"><a id="x35-106105r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">subractSinusoidFrequency</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= f1-f0;</span> 
</span><span class="label"><a id="x35-106106r11"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">reduce</span></span><span style="color:#005900"> <span class="ec-lmtt-9">numbers to rational forms</span> 
</span><span class="label"><a id="x35-106107r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">m</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">rat</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">sumSinusoidFrequency</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x35-106108r13"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">q</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">rat</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">subractSinusoidFrequency</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x35-106109r14"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Nmin</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">lcm</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">q</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the least commom multiple</span> 
</span><span class="label"><a id="x35-106110r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Minimum</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">common period: </span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nmin</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x35-106111r16"></a></span><span style="color:#000000"><span class="ec-lmtt-9">T_duration</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= Nmin / Fs;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">minimum</span></span><span style="color:#005900"> <span class="ec-lmtt-9">number of samples in seconds</span> 
</span><span class="label"><a id="x35-106112r17"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">disp</span></span><span style="color:#005900"><span class="ec-lmtt-9">([</span><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">Maximum</span></span><span style="color:#005900"> <span class="ec-lmtt-9">symbol rate: </span><span class="ts1-lmtt9-">' </span><span class="ec-lmtt-9">num2str(1/T_symbolDuration) </span><span class="ts1-lmtt9-">' </span><span class="ec-lmtt-9">bauds</span><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">])</span> 
</span><span class="label"><a id="x35-106113r18"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Check if the product of the two sinusoids is really orthogonal</span> 
</span><span class="label"><a id="x35-106114r19"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Tsum</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1 / sumSinusoidFrequency;</span> 
</span><span class="label"><a id="x35-106115r20"></a><span class="ec-lmr-6">20</span></span><span style="color:#000000"><span class="ec-lmtt-9">Tsub</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1 / subractSinusoidFrequency;</span> 
</span><span class="label"><a id="x35-106116r21"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Numbers</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">below should be integers:</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x35-106117r22"></a></span><span style="color:#000000"><span class="ec-lmtt-9">T_duration</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Tsum</span></span> 
<span class="label"><a id="x35-106118r23"></a></span><span style="color:#000000"><span class="ec-lmtt-9">T_duration</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Tsub</span></span> 
<span class="label"><a id="x35-106119r24"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">interval</span> 
</span><span class="label"><a id="x35-106120r25"></a><span class="ec-lmr-6">25</span></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 0:Ts:T_duration-Ts;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(discrete) time</span> 
</span><span class="label"><a id="x35-106121r26"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">use</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sin or cos with arbitrary phase</span> 
</span><span class="label"><a id="x35-106122r27"></a></span><span style="color:#000000"><span class="ec-lmtt-9">b0</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">f0</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"><span class="ec-lmtt-9">+4)</span></span><span style="color:#000000"><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">column</span></span><span style="color:#005900"> <span class="ec-lmtt-9">vector</span> 
</span><span class="label"><a id="x35-106123r28"></a></span><span style="color:#000000"><span class="ec-lmtt-9">b1</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">f1</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">column</span></span><span style="color:#005900"> <span class="ec-lmtt-9">vector</span> 
</span><span class="label"><a id="x35-106124r29"></a></span><span style="color:#000000"><span class="ec-lmtt-9">normalizedInnerProduct</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">b0</span></span><span style="color:#000000"><span class="ec-lmtt-9">.*</span></span><span style="color:#000000"><span class="ec-lmtt-9">b1</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">/</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">b0</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">inner</span></span><span style="color:#005900"> <span class="ec-lmtt-9">product</span> 
</span><span class="label"><a id="x35-106125r30"></a><span class="ec-lmr-6">30</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> <span class="ec-lmtt-9">(normalizedInnerProduct &gt; 1e-13)</span> 
</span><span class="label"><a id="x35-106126r31"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">error</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">not</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">orthogonal! should not happen!</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x35-106127r32"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span>
  </pre>
<!-- l. 2132 -->
<p class="indent">
Modify Listing&nbsp;<a href="#x35-106094r7">2.7<!-- tex4ht:ref: code:ex_transforms_check_orthogonality  --></a> to use discrete-time sinusoids in radians, not Hz. Assume <!-- l. 2132 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math> and find a set of <!-- l. 2132 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math> sinusoids that are mutually orthogonal over an interval of eight consecutive samples. What was the maximum value of <!-- l. 2132 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math> that you could find? Now, consider the set of basis functions for a <!-- l. 2132 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>-point DFT and evaluate their orthogonality. Going back to the question about <!-- l. 2132 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math>, can it be larger than <!-- l. 2132 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>? Why? &nbsp;&nbsp;<!-- l. 2133 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2135 -->
<p class="noindent">
<a id="x35-106128r8"></a> <span id="textcolor148"><span class="ec-lmbx-10x-x-109">Application 2.8.</span></span> <span class="ec-lmbx-10x-x-109">Better visualizing the FFT spectrum: Using </span><span class="ec-lmssbx-10x-x-109">fftshift </span><span class="ec-lmbx-10x-x-109">to reorganize the spectrum and masking numerical errors. </span>Two improvements of the procedure adopted to obtain Figure&nbsp;<a href="ak_dsp_bookse22.html#x30-9500210">2.10<!-- tex4ht:ref: fig:dtfs_example  --></a> are typically used. The first one is with respect to the range <!-- l. 2137 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">⟨</mo><mi>N</mi><mo class="MathClass-close" stretchy="false">⟩</mo></mrow></math>. Figure&nbsp;<a href="ak_dsp_bookse22.html#x30-9500210">2.10<!-- tex4ht:ref: fig:dtfs_example  --></a> reminds that the definition of an <!-- l. 2138 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>-point DFT assumes <!-- l. 2138 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></math>. Sometimes it is more convenient to work with ranges that use “negative” frequencies. Typical ranges are <!-- l. 2138 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-bin" stretchy="false">−</mo><mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></math> when <!-- l. 2138 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is even and <!-- l. 2138 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mo class="MathClass-open" stretchy="false">(</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-bin" stretchy="false">−</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math> when <!-- l. 2138 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is odd. In these cases, to represent negative frequencies (or angles in discrete-time processing) the command <span class="ec-lmss-10x-x-109">fftshift </span>can be used. For example, <span class="ec-lmss-10x-x-109">fftshift([0 1 2 3]) </span>returns <span class="ec-lmss-10x-x-109">[2 3 0 1]</span>, while <span class="ec-lmss-10x-x-109">fftshift([0 1 2 3 4]) </span>returns <span class="ec-lmss-10x-x-109">[3 4 0 1 2]</span>.
</p>
<figure class="figure">
<p><a id="x35-10612930"></a></p>
<!-- l. 2142 -->
<p class="noindent">
<img alt="PIC" src="Figures/fftshift_example.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.30: </span><span class="content">Alternative representation of the DTFS / DFT of <!-- l. 2143 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mfrac><mrow><mi>π</mi></mrow> <mrow><mn>6</mn></mrow></mfrac> <mi>n</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>3</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> using <span class="ec-lmss-10x-x-109">fftshift</span>. Compare with Figure&nbsp;<a href="ak_dsp_bookse22.html#x30-9500210">2.10<!-- tex4ht:ref: fig:dtfs_example  --></a> and note that the current plots clearly indicates that when <!-- l. 2143 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is real, the magnitude and phase are even and odd functions, respectively.</span>
</figcaption>
<!-- tex4ht:label?: x35-10612930  -->
</figure>
<!-- l. 2146 -->
<p class="indent">
The second one aims at eliminating spurious values. Note that, due to numerical errors, the elements of <span class="ec-lmss-10x-x-109">X </span>that should be zero, have small values such as <span class="ec-lmss-10x-x-109">-1.4e-15 - j 3.3e-16</span>, which leads to random angles for <!-- l. 2147 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">≠</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>11</mn></mrow></math> in Figure&nbsp;<a href="ak_dsp_bookse22.html#x30-9500210">2.10<!-- tex4ht:ref: fig:dtfs_example  --></a>. It is a good practice to eliminate these random angles based on a threshold for the magnitude. This post-processing step can be done with a command such as <span class="ec-lmss-10x-x-109">X(abs(X)</span> <!-- l. 2148 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-rel" stretchy="false">&lt;</mo></mrow></math> <span class="ec-lmss-10x-x-109">1e-12)=0</span>, and is adopted in the Matlab/Octave <span class="ec-lmss-10x-x-109">fft </span>routine.
</p>
<!-- l. 2150 -->
<p class="indent">
Figure&nbsp;<a href="#x35-10612930">2.30<!-- tex4ht:ref: fig:fftshift_example  --></a> benefits from these two improvements and was obtained using Listing&nbsp;<a href="#x35-106130r8">2.8<!-- tex4ht:ref: code:snip_transforms_fftshift  --></a>.
</p>
<!-- l. 2151 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;2.8: </span><span class="content">MatlabOctaveCodeSnippets/snip_transforms_fftshift.m</span>
</figcaption>
<!-- tex4ht:label?: x35-106130r2.10  -->
<pre class="lstinputlisting" id="listing-57"><span class="label"><a id="x35-106132r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">=-</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">range</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with negative k (assume N is even)</span> 
</span><span class="label"><a id="x35-106133r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">&lt;1</span></span><span style="color:#000000"><span class="ec-lmtt-9">e</span></span><span style="color:#000000"><span class="ec-lmtt-9">-12)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">discard</span></span><span style="color:#005900"> <span class="ec-lmtt-9">small values (numerical errors)</span> 
</span><span class="label"><a id="x35-106134r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fftshift</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">rearrange</span></span><span style="color:#005900"> <span class="ec-lmtt-9">to represent negative freqs.</span> 
</span><span class="label"><a id="x35-106135r4"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(211)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(212)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">angle</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span>
  </pre>
<!-- l. 2153 -->
<p class="indent">
Note that <span class="ec-lmss-10x-x-109">fftshift </span>does not calculate the FFT but simply reorders the elements in a vector. &nbsp;&nbsp;<!-- l. 2154 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2157 -->
<p class="noindent">
<a id="x35-106138r9"></a> <span id="textcolor149"><span class="ec-lmbx-10x-x-109">Application 2.9.</span></span> <span class="ec-lmbx-10x-x-109">DTFS analysis of single cosines. </span>Figure&nbsp;<a href="#x35-10613931">2.31<!-- tex4ht:ref: fig:dftexamples  --></a> depicts five cosines <!-- l. 2158 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>i</mi></mrow></msub><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with angular frequencies <!-- l. 2158 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>i</mi><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn></mrow></math> rad, where <!-- l. 2158 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>i</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>16</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>31</mn></mrow></math>, and their respective DTFS spectrum calculated with a DFT of <!-- l. 2158 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> points and normalized by <!-- l. 2158 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>.
</p>
<figure class="figure">
<p><a id="x35-10613931"></a></p>
<!-- l. 2162 -->
<p class="noindent">
<img alt="PIC" src="Figures/dftexamples.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.31: </span><span class="content">Five cosine signals <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>i</mi></mrow></msub><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with frequencies <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math>, <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn></mrow></math>, <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>4</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn></mrow></math>, <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math>, <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>31</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>16</mn></mrow></math> for <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>i</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>16</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>32</mn></mrow></math>, and the real part of their DTFS using <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> points. </span>
</figcaption>
<!-- tex4ht:label?: x35-10613931  -->
</figure>
<!-- l. 2166 -->
<p class="indent">
The first <!-- l. 2166 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math> is a DC signal (<!-- l. 2166 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math>), the second is <!-- l. 2166 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, where <!-- l. 2166 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mn>32</mn></mrow></mfrac> </mrow></math> is the fundamental frequency in this DTFS analysis (given that <!-- l. 2166 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math>) and the other three signals are cosines with the following harmonic frequencies: <!-- l. 2166 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math>, <!-- l. 2166 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>16</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>16</mn><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math> and <!-- l. 2166 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>31</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>31</mn><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math> rad. Because the cosines are even functions, the imaginary part of their DTFS is zero.
</p>
<!-- l. 2168 -->
<p class="indent">
Note in Figure&nbsp;<a href="#x35-10613931">2.31<!-- tex4ht:ref: fig:dftexamples  --></a> that the frequency increases up to the <!-- l. 2168 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math>-th harmonic <!-- l. 2168 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>16</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>16</mn><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi></mrow></math>. When <!-- l. 2169 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is even, the coefficient of <!-- l. 2169 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math> corresponds to <!-- l. 2169 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mi>k</mi><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi></mrow></math>. It is important to note that the highest “frequency” of a discrete-time signal is always <!-- l. 2170 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi></mrow></math> rad.
</p>
<!-- l. 2173 -->
<p class="indent">
</p><p>Another aspect of Figure&nbsp;<a href="#x35-10613931">2.31<!-- tex4ht:ref: fig:dftexamples  --></a> is that for <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mn>16</mn></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, corresponding to the angles <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> and <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi></mrow></math>, the spectra have only one non-zero coefficient <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, while the other three signals are represented by two coefficients. Figure&nbsp;<a href="ak_dsp_bookse21.html#x29-870093">2.3<!-- tex4ht:ref: fig:circledivided  --></a>, for <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></mrow></math> and <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>6</mn></mrow></math> can be invoked to help interpreting why the coefficients for angles different than <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> and <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi></mrow></math> occur in pairs with Hermitian symmetry (i. e., <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mi>X</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">∗</mo></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> when <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is real). The basis functions for <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> and <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi></mrow></math> are real signals while the other angles lead to complex-valued signals. In the analysis of a real signal <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, using the <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math>-th complex basis requires also using the <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>k</mi></mrow></math>-th basis, such that their imaginary parts can cancel in the synthesis of a real <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. &nbsp;</p>
&nbsp;<!-- l. 2174 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
<p></p>
<!-- l. 2187 -->
<p class="noindent">
<a id="x35-106140r10"></a> <span id="textcolor150"><span class="ec-lmbx-10x-x-109">Application 2.10.</span></span> <span class="ec-lmbx-10x-x-109">DTFS analysis of a sum of sines and cosines. </span>This example aims at illustrating how the cosines and sines are mapped in the DTFS, especially when two of them have the same frequency. Figure&nbsp;<a href="#x35-10614932">2.32<!-- tex4ht:ref: fig:dftexamples3  --></a> shows the spectrum of a more complex example obtained with Listing&nbsp;<a href="#x35-106141r9">2.9<!-- tex4ht:ref: code:snip_transforms_DTFS_sinusoid  --></a>.
</p>
<!-- l. 2189 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;2.9: </span><span class="content">MatlabOctaveCodeSnippets/snip_transforms_DTFS_sinusoid.m</span>
</figcaption>
<!-- tex4ht:label?: x35-106141r2.10  -->
<pre class="lstinputlisting" id="listing-58"><span class="label"><a id="x35-106143r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=32;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of DFT-points</span> 
</span><span class="label"><a id="x35-106144r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">abscissa</span></span><span style="color:#005900"> <span class="ec-lmtt-9">to generate signal below</span> 
</span><span class="label"><a id="x35-106145r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2+3*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*6/32*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">+8*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*12/32*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-...</span></span> 
<span class="label"><a id="x35-106146r4"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"> <span class="ec-lmtt-9">4*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*7/32*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"> <span class="ec-lmtt-9">6*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*7/32*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x35-106147r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">DTFS spectrum via DFT</span> 
</span><span class="label"><a id="x35-106148r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">&lt;1</span></span><span style="color:#000000"><span class="ec-lmtt-9">e</span></span><span style="color:#000000"><span class="ec-lmtt-9">-12)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">mask</span></span><span style="color:#005900"> <span class="ec-lmtt-9">numerical errors</span></span>
  </pre>
<figure class="figure">
<p><a id="x35-10614932"></a></p>
<!-- l. 2202 -->
<p class="noindent">
<img alt="PIC" src="Figures/dftexamples3.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.32: </span><span class="content">Analysis with DFT of 32 points of <!-- l. 2203 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> composed by three sinusoids and a DC level. From top to bottom: <!-- l. 2203 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, real, imaginary, magnitude and phase of <!-- l. 2203 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>.</span>
</figcaption>
<!-- tex4ht:label?: x35-10614932  -->
</figure>
<!-- l. 2206 -->
<p class="indent">
Note in Figure&nbsp;<a href="#x35-10614932">2.32<!-- tex4ht:ref: fig:dftexamples3  --></a> that the coefficient <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn></mrow></math> is due to the DC level, <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1.5</mn></mrow></math> are due to the cosine <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>3</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mn>6</mn><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>12</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>4</mn><mi>j</mi></mrow></math> and <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>12</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn><mi>j</mi></mrow></math> are due to <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>8</mn><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mn>12</mn><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>7</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>3</mn><mi>j</mi></mrow></math> and <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>7</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>3</mn><mi>j</mi></mrow></math> are due to the two parcels of frequency <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>7</mn><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with the <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>4</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mn>7</mn><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> being represented by the real part (<!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>2</mn></mrow></math>) and <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>6</mn><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mn>7</mn><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> represented by the imaginary part (<!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>3</mn><mi>j</mi></mrow></math>). &nbsp;&nbsp;<!-- l. 2207 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2209 -->
<p class="noindent">
<a id="x35-106150r11"></a> <span id="textcolor151"><span class="ec-lmbx-10x-x-109">Application 2.11.</span></span> <span class="ec-lmbx-10x-x-109">Spurious frequency components: When the number</span> <!-- l. 2209 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> <span class="ec-lmbx-10x-x-109">of DFT points is not a multiple of the signal period. </span>Figure&nbsp;<a href="#x35-10615233">2.33<!-- tex4ht:ref: fig:dftexamples4  --></a> illustrates the DTFS spectrum of a signal <!-- l. 2211 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with period of 6 samples obtained via a 16-points DFT. Note that because 16 is not a multiple of 6, the spectrum has many non-zero spurious components. The coefficients <!-- l. 2211 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.99</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1.48</mn><mi>j</mi></mrow></math> and <!-- l. 2211 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.99</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1.48</mn><mi>j</mi></mrow></math>, both with magnitude 1.78, are the closest to representing the angle <!-- l. 2211 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>3</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>1.05</mn></mrow></math> rad. In fact, when using <!-- l. 2211 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>16</mn></mrow></math> points to divide <!-- l. 2211 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2</mn><mi>π</mi></mrow></math> (see Figure&nbsp;<a href="ak_dsp_bookse21.html#x29-870093">2.3<!-- tex4ht:ref: fig:circledivided  --></a>), the angle increment is
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2212 -->
<p class="indent">
</p>
<!-- l. 2212 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x35-106151r53"></mstyle><!-- endlabel --><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(2.53)
</td>
</tr>

</tbody></table>
<!-- l. 2216 -->
<p class="indent">
</p><p>which in this case is <!-- l. 2216 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>8</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.39</mn></mrow></math>, and the DFT / DTFS can deal only with the angles <!-- l. 2216 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>0.39</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>0.78</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1.18</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1.57</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mn>5.89</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> rad. This</p>
explains why <!-- l. 2216 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 2216 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> are concentrating most of the power <!-- l. 2216 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>P</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mn>4</mn></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math>. The other coefficients absorb the remaining power that “leaks” due to the imperfect match of the cosine frequency <!-- l. 2216 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>3</mn></mrow></math> with the discrete grid of 16 points imposed by the DFT / DFTS.
<p></p>
<figure class="figure">
<p><a id="x35-10615233"></a></p>
<!-- l. 2220 -->
<p class="noindent">
<img alt="PIC" src="Figures/dftexamples4.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.33: </span><span class="content">Spectrum of a signal <!-- l. 2221 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with period of 6 samples obtained with a 16-points DFT, which created spurious components.</span>
</figcaption>
<!-- tex4ht:label?: x35-10615233  -->
</figure>
<!-- l. 2224 -->
<p class="indent">
The creation of spurious components is associated to <span class="ec-lmri-10x-x-109">leakage</span><a id="dx35-106153"></a> and the <span class="ec-lmri-10x-x-109">picket-fence effect</span>, which are discussed in Section&nbsp;<a href="ak_dsp_bookse52.html#x62-2070004.3">4.3<!-- tex4ht:ref: sec:windows  --></a>. This phenomenon is very common when using the FFT to analyze signals that are non-periodic, have infinite duration, etc. In the current case, the spurious components could be avoided by choosing an appropriate number of points for the DFT / DTFS (a multiple of 6). In practice, spurious components due to FFT usage occur most of the times. Even when the original signal is periodic, say <!-- l. 2226 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with period <!-- l. 2226 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math>, it is typically not guaranteed that <!-- l. 2226 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> is a multiple of <!-- l. 2226 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math>, where <!-- l. 2226 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is the number of DFT points and <!-- l. 2226 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></math> the sampling period.
</p>
<figure class="figure">
<p><a id="x35-10615434"></a></p>
<!-- l. 2230 -->
<p class="noindent">
<img alt="PIC" src="Figures/leakage.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.34: </span><span class="content">Explicitly repeating the block of <!-- l. 2231 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> cosine samples from Figure&nbsp;<a href="#x35-10615233">2.33<!-- tex4ht:ref: fig:dftexamples4  --></a> to indicate that spurious components are a manifest of the lack of a perfect cosine in time-domain.</span>
</figcaption>
<!-- tex4ht:label?: x35-10615434  -->
</figure>
<!-- l. 2234 -->
<p class="indent">
Figure&nbsp;<a href="#x35-10615434">2.34<!-- tex4ht:ref: fig:leakage  --></a> shows part of the signal obtained by repeating the segment of 16 samples depicted in Figure&nbsp;<a href="#x35-10615233">2.33<!-- tex4ht:ref: fig:dftexamples4  --></a>. This represents the signal “assumed” by the DFT / DTFS. Spurious components appear because, in spite of <!-- l. 2234 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> having a period of <!-- l. 2234 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>6</mn></mrow></math>, an abrupt transition (from <!-- l. 2234 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>4</mn></mrow></math> to 4) occurs in the boundary of the segments of 16 samples. In general, the periodic extension (that is assumed by the FFT when approximating a DTFS) of a signal <!-- l. 2235 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> not commensurate<span class="footnote-mark"><a href="#fn18x4" id="fn18x4-bk"><sup class="textsuperscript">18</sup></a></span><a id="x35-106155f18"></a> with its period, leads to discontinuities at the boundaries of the replicas of <!-- l. 2236 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. &nbsp; &nbsp;<!-- l. 2237 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2239 -->
<p class="noindent">
<a id="x35-106157r12"></a> <span id="textcolor152"><span class="ec-lmbx-10x-x-109">Application 2.12.</span></span> <span class="ec-lmbx-10x-x-109">DTFS for periodic discrete-time pulses</span>. Assume a periodic train of pulses <!-- l. 2239 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> with period <!-- l. 2239 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> and one period described as <!-- l. 2239 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> from <!-- l. 2239 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> to <!-- l. 2239 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></math> and <!-- l. 2239 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> from <!-- l. 2239 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub></math> to <!-- l. 2239 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></math>. Its DTFS coefficients are given by
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2241 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><mi>N</mi></mrow></mfrac><munderover accent="false" accentunder="false"><mrow><mo>∑</mo> </mrow><mrow><mi>n</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mi mathvariant="italic">nk</mi></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><mi>N</mi></mrow></mfrac><munderover accent="false" accentunder="false"><mrow><mo>∑</mo> </mrow><mrow><mi>n</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mi mathvariant="italic">nk</mi></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><mi>N</mi></mrow></mfrac><munderover accent="false" accentunder="false"><mrow><mo>∑</mo> </mrow><mrow><mi>n</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><msup><mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mi>k</mi></mrow></msup></mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow><mrow><mi>n</mi></mrow></msup><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2244 -->
<p class="indent">
which is the sum of <!-- l. 2244 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub></math> terms of a geometric series with ratio <!-- l. 2244 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>r</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mi>k</mi></mrow></msup></mrow></math>. Applying Eq.&nbsp;(<a href="ak_dsp_bookse69.html#x81-262001r20">B.20<!-- tex4ht:ref: eq:sum_inf_pg  --></a>) leads to
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2245 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><mi>N</mi></mrow></mfrac> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>k</mi></mrow></msup></mrow> <mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mfrac><mrow><mn>2</mn><mi>π</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mi>k</mi></mrow></msup></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2248 -->
<p class="indent">
This expression can be simplified by applying Eq.&nbsp;(<a href="ak_dsp_bookse66.html#x78-259001r14">B.14<!-- tex4ht:ref: eq:complex_exp_trick_sin  --></a>) to both numerator and denominator:
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2249 -->
<p class="indent">
</p>
<!-- l. 2249 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x35-106158r54"></mstyle><!-- endlabel --><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><mi>N</mi></mrow></mfrac> <mfrac><mrow><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="italic">kπ</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac> <msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mfrac><mrow><mi mathvariant="italic">kπ</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></msup><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(2.54)
</td>
</tr>

</tbody></table>
<!-- l. 2253 -->
<p class="indent">
for <!-- l. 2253 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></math> and then periodically repeated in <!-- l. 2253 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math>. For <!-- l. 2253 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> the expression is undetermined (because of the <!-- l. 2253 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>0</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>0</mn></mrow></math> fraction) and L’Hospital’s rule leads to <!-- l. 2253 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math>.
</p>
<!-- l. 2255 -->
<p class="indent">
Listing&nbsp;<a href="#x35-106159r10">2.10<!-- tex4ht:ref: code:snip_transforms_DTFS_pulses  --></a> obtains the DTFS of the periodic pulses in two distinct ways.
</p>
<!-- l. 2256 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;2.10: </span><span class="content">MatlabOctaveCodeSnippets/snip_transforms_DTFS_pulses.m</span>
</figcaption>
<!-- tex4ht:label?: x35-106159r2.10  -->
<pre class="lstinputlisting" id="listing-59"><span class="label"><a id="x35-106161r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">N1=5; k=0:N-1;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">define</span></span><span style="color:#005900"> <span class="ec-lmtt-9">durations and k</span> 
</span><span class="label"><a id="x35-106162r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xk</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(1/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">./</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">.* ...</span> 
</span><span class="label"><a id="x35-106163r3"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(-</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">obtain</span></span><span style="color:#005900"> <span class="ec-lmtt-9">DTFS directly</span> 
</span><span class="label"><a id="x35-106164r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xk</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">eliminate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the NaN (not a number) in Xk(1)</span> 
</span><span class="label"><a id="x35-106165r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">second</span></span><span style="color:#005900"> <span class="ec-lmtt-9">alternative, via DFT. Generate x[n]:</span> 
</span><span class="label"><a id="x35-106166r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">xn</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ones</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">single</span></span><span style="color:#005900"> <span class="ec-lmtt-9">period of x[n]</span> 
</span><span class="label"><a id="x35-106167r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xk2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">xn</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">DTFS</span></span><span style="color:#005900"> <span class="ec-lmtt-9">via DFT, Xk2 is equal to Xk</span></span>
  </pre>
<figure class="figure">
<p><a id="x35-10617035"></a></p>
<!-- l. 2269 -->
<p class="noindent">
<img alt="PIC" src="Figures/dtfs_pulse.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.35: </span><span class="content">Three periods of each signal: pulse train <!-- l. 2270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> with <!-- l. 2270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math> and <!-- l. 2270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn></mrow></math> and amplitude assumed to be in Volts (a), the magnitude (b) and phase (c) of its DTFS.</span>
</figcaption>
<!-- tex4ht:label?: x35-10617035  -->
</figure>
<!-- l. 2273 -->
<p class="indent">
Figure&nbsp;<a href="#x35-10617035">2.35<!-- tex4ht:ref: fig:dtfs_pulse  --></a> illustrates the result using <!-- l. 2273 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>20</mn></mrow></math> and <!-- l. 2273 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math>. Note that <!-- l. 2273 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow></math> has the behavior of a sinc function, as expected. The DTFS phase in Figure&nbsp;<a href="#x35-10617035">2.35<!-- tex4ht:ref: fig:dtfs_pulse  --></a> c) is the combined effect of the linear phase <!-- l. 2273 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mfrac><mrow><mi mathvariant="italic">kπ</mi></mrow> <mrow><mi>N</mi></mrow></mfrac> <mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></msup></math> and the sign of <!-- l. 2273 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="italic">kπ</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in Eq.&nbsp;(<a href="#x35-106158r54">2.54<!-- tex4ht:ref: eq:dtfs_pulses  --></a>). This sign is responsible for Figure&nbsp;<a href="#x35-10617035">2.35<!-- tex4ht:ref: fig:dtfs_pulse  --></a> c) not being a linear function of frequency.
</p>
<figure class="figure">
<p><a id="x35-10617536"></a></p>
<pre><code>                                   &lt;div class='center'&gt;</code></pre>
<!-- l. 2276 -->
<p class="noindent">
<a id="x35-106171r1"></a>
</p>
<pre><code>                               &lt;div class='subfigure'&gt;&lt;table&gt;&lt;tr&gt;&lt;td style='text-align:left'&gt;&lt;img alt='PIC' src='Figures/dtfs_pulse_duty_4.png' /&gt;</code></pre>
<div class="subfigcaption">
<span class="ec-lmr-9">(a)</span> <!-- l. 2277 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></mrow></math>
</div>




</figure></main></div>
<a id="x35-106172r2"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img alt="PIC" src="Figures/dtfs_pulse_duty_3.png">
<div class="subfigcaption">
<span class="ec-lmr-9">(b)</span> <!-- l. 2278 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn></mrow></math>
</div>
</td>
</tr>

</tbody></table>
</div>
<br> <a id="x35-106173r3"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img alt="PIC" src="Figures/dtfs_pulse_duty_2.png">
<div class="subfigcaption">
<span class="ec-lmr-9">(c)</span> <!-- l. 2280 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn></mrow></math>
</div>
</td>
</tr>

</tbody></table>
</div>
<a id="x35-106174r4"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img alt="PIC" src="Figures/dtfs_pulse_duty_1.png">
<div class="subfigcaption">
<span class="ec-lmr-9">(d)</span> <!-- l. 2281 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>
</div>
</td>
</tr>

</tbody></table>
</div>

<figcaption class="caption">
<span class="id">Figure&nbsp;2.36: </span><span class="content">Behavior when <!-- l. 2283 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub></math> of Figure&nbsp;<a href="#x35-10617035">2.35<!-- tex4ht:ref: fig:dtfs_pulse  --></a> is decreased from <!-- l. 2283 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></mrow></math> to 1.</span>
</figcaption>
<!-- tex4ht:label?: x35-10617536  -->

<!-- l. 2287 -->
<p class="indent">
Figure&nbsp;<a href="#x35-10617536">2.36<!-- tex4ht:ref: fig:dtfs_pulse_duty  --></a> shows the behavior of the DTFS of <!-- l. 2287 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> when <!-- l. 2287 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub></math> of Figure&nbsp;<a href="#x35-10617035">2.35<!-- tex4ht:ref: fig:dtfs_pulse  --></a> is decreased from <!-- l. 2287 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></mrow></math> to 1 Note the duality between time and frequency: as the pulse duty cycle gets smaller (smaller <!-- l. 2288 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub></math>), the spectrum gets wider and with smaller maximum values. When <!-- l. 2288 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>, then <!-- l. 2288 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">|</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.05</mn></mrow></math>. Also, in this case, <!-- l. 2289 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub></math> dictates the number of nulls in the spectrum, while <!-- l. 2289 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> controls how the unit circle <!-- l. 2289 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup></math> is sampled by the DFT. &nbsp;&nbsp;<!-- l. 2290 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2292 -->
<p class="noindent">
<a id="x35-106176r13"></a> <span id="textcolor153"><span class="ec-lmbx-10x-x-109">Application 2.13.</span></span> <span class="ec-lmbx-10x-x-109">Calculating the DTFT of a pulse via the DFT. </span>Following steps similar to the ones that led to Eq.&nbsp;(<a href="#x35-106158r54">2.54<!-- tex4ht:ref: eq:dtfs_pulses  --></a>), the DTFT pair of a pulse is given by
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2294 -->
<p class="indent">
</p>
<!-- l. 2294 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x35-106177r55"></mstyle><!-- endlabel --><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mrow><mo fence="true" form="prefix"> {</mo><mrow> <mtable align="axis" class="array" columnlines="none none none none none none none none none none none none none none none none none none none" displaystyle="true" equalcolumns="false" equalrows="false" style=""> <mtr class="array-row"><mtd class="array-td" columnalign="center"> <mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mspace class="nbsp" width="0.33em"></mspace><mspace class="nbsp" width="0.33em"></mspace><mn>0</mn> <mo class="MathClass-rel" stretchy="false">≤</mo> <mi>n</mi> <mo class="MathClass-rel" stretchy="false">≤</mo> <msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn> </mtd> </mtr> <mtr class="array-row"><mtd class="array-td" columnalign="center"> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mstyle class="text"><mtext class="textrm" mathvariant="normal">otherwise</mtext></mstyle> </mtd></mtr> <!-- *{20}c --></mtable> <mspace class="thickpace" width="0.28em"></mspace> <mo class="MathClass-rel" stretchy="false">⇔</mo><mspace class="thickpace" width="0.28em"></mspace></mrow><mo fence="true" form="postfix"></mo></mrow><mfrac><mrow><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac> <msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mi mathvariant="normal">Ω</mi><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></msup> </mrow></math>
</td>
<td class="eq-no">
(2.55)
</td>
</tr>

</tbody></table>
<!-- l. 2299 -->
<p class="indent">
Listing&nbsp;<a href="#x35-106178r11">2.11<!-- tex4ht:ref: code:snip_transforms_DTFT_pulse  --></a> illustrates how to obtain samples of the DTFT for a pulse with <!-- l. 2299 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn></mrow></math> non-zero samples using a DFT of <!-- l. 2299 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>20</mn></mrow></math> points.
</p>
<!-- l. 2300 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;2.11: </span><span class="content">MatlabOctaveCodeSnippets/snip_transforms_DTFT_pulse.m</span>
</figcaption>
<!-- tex4ht:label?: x35-106178r2.10  -->
<pre class="lstinputlisting" id="listing-60"><span class="label"><a id="x35-106180r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=20;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">DFT</span></span><span style="color:#005900"> <span class="ec-lmtt-9">size</span> 
</span><span class="label"><a id="x35-106181r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">num</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> <span class="ec-lmtt-9">non-zero samples in the (aperiodic) pulse</span> 
</span><span class="label"><a id="x35-106182r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ones</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">signal</span></span><span style="color:#005900"> <span class="ec-lmtt-9">x[n]</span> 
</span><span class="label"><a id="x35-106183r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=512;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">num</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> <span class="ec-lmtt-9">samples of the DTFT theoretical expression</span> 
</span><span class="label"><a id="x35-106184r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N2</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">indices</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of freq. components</span> 
</span><span class="label"><a id="x35-106185r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">wk</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= k*2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N2</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">angular</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequencies</span> 
</span><span class="label"><a id="x35-106186r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_fft</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">use</span></span><span style="color:#005900"> <span class="ec-lmtt-9">N-point DFT to sample DTFT</span> 
</span><span class="label"><a id="x35-106187r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_theory</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">wk</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">./</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">wk</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(-</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">wk</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x35-106188r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_theory</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= N1;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">take</span></span><span style="color:#005900"> <span class="ec-lmtt-9">care of 0/0 (NaN) at k=0</span> 
</span><span class="label"><a id="x35-106189r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(211)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x35-106190r11"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on,</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">wk</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_theory</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">r</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x35-106191r12"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(212)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">angle</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x35-106192r13"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on,</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">wk</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">angle</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_theory</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">r</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span>
  </pre>
<!-- l. 2316 -->
<p class="indent">
The code plots the DTFT superimposed to the DFT result, as illustrated in Figure&nbsp;<a href="#x35-10619537">2.37<!-- tex4ht:ref: fig:dtft_via_dft  --></a>.
</p>
<figure class="figure">
<p><a id="x35-10619537"></a></p>
<!-- l. 2320 -->
<p class="noindent">
<img alt="PIC" src="Figures/dtft_via_dft.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.37: </span><span class="content">DTFT of an aperiodic pulse with <!-- l. 2321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>N</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn></mrow></math> non-zero samples and DTFT estimates obtained via a DFT of <!-- l. 2321 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>20</mn></mrow></math> points.</span>
</figcaption>
<!-- tex4ht:label?: x35-10619537  -->
</figure>
<!-- l. 2324 -->
<p class="indent">
As stated by Eq.&nbsp;(<a href="ak_dsp_bookse22.html#x30-99001r30">2.30<!-- tex4ht:ref: eq:dtft_via_dft  --></a>), Figure&nbsp;<a href="#x35-10619537">2.37<!-- tex4ht:ref: fig:dtft_via_dft  --></a> pictorially illustrates that the DFT values at the discrete frequencies <!-- l. 2325 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>k</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>k</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> coincide with the DTFT of the aperiodic pulse <!-- l. 2326 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> calculated at these frequencies using Eq.&nbsp;(<a href="#x35-106177r55">2.55<!-- tex4ht:ref: eq:dtft_pulse  --></a>).
</p>
<figure class="figure">
<p><a id="x35-10619638"></a></p>
<!-- l. 2331 -->
<p class="noindent">
<img alt="PIC" src="Figures/N256dtft_via_dft.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.38: </span><span class="content">A version of Figure&nbsp;<a href="#x35-10619537">2.37<!-- tex4ht:ref: fig:dtft_via_dft  --></a> using a DFT of <!-- l. 2332 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>256</mn></mrow></math> points.</span>
</figcaption>
<!-- tex4ht:label?: x35-10619638  -->
</figure>
<!-- l. 2335 -->
<p class="indent">
The DTFT can be calculated in a grid of frequencies with arbitrary resolution by increasing the number <!-- l. 2335 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> of DFT points. For example, using <!-- l. 2335 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>256</mn></mrow></math> leads to the spectrum in Figure&nbsp;<a href="#x35-10619638">2.38<!-- tex4ht:ref: fig:N256dtft_via_dft  --></a>. Note that if <span class="ec-lmss-10x-x-109">x </span>has less than <!-- l. 2336 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> samples, the command <span class="ec-lmss-10x-x-109">fft(x,N) </span>conveniently extends its duration with zero-padding. &nbsp; &nbsp;<!-- l. 2337 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2349 -->
<p class="noindent">
<a id="x35-106197r14"></a> <span id="textcolor154"><span class="ec-lmbx-10x-x-109">Application 2.14.</span></span> <span class="ec-lmbx-10x-x-109">Calculating the DTFT using Matlab/Octave’s </span><span class="ec-lmssbx-10x-x-109">freqz</span><span class="ec-lmbx-10x-x-109">. </span>When <!-- l. 2350 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is relatively large, it is more convenient to use <span class="ec-lmss-10x-x-109">plot </span>instead of <span class="ec-lmss-10x-x-109">stem </span>(as in Figure&nbsp;<a href="ak_dsp_bookse9.html#x16-5600545">1.45<!-- tex4ht:ref: fig:zeromean_randomsignal  --></a>), in spite of <!-- l. 2350 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> being discrete. This is also convenient when <!-- l. 2350 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is used to represent values of <!-- l. 2350 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> as in this example. Matlab/Octave has the command <span class="ec-lmss-10x-x-109">freqz </span>that uses the DFT to calculate the DTFT at a grid of discrete frequencies. Assuming the same vector <span class="ec-lmss-10x-x-109">x </span>of the previous code snippet, the command <span class="ec-lmss-10x-x-109">freqz(x) </span>generates Figure&nbsp;<a href="#x35-10619839">2.39<!-- tex4ht:ref: fig:dtft_via_freqz  --></a>.
</p>
<figure class="figure">
<p><a id="x35-10619839"></a></p>
<!-- l. 2354 -->
<p class="noindent">
<img alt="PIC" src="Figures/dtft_via_freqz.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.39: </span><span class="content">A version of Figure&nbsp;<a href="#x35-10619537">2.37<!-- tex4ht:ref: fig:dtft_via_dft  --></a> using <span class="ec-lmss-10x-x-109">freqz </span>with 512 points representing only the positive part of the spectrum.</span>
</figcaption>
<!-- tex4ht:label?: x35-10619839  -->
</figure>
<figure class="figure">
<p><a id="x35-10619940"></a></p>
<!-- l. 2360 -->
<p class="noindent">
<img alt="PIC" src="Figures/replicate_freqz.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;2.40: </span><span class="content">Reproducing the graphs generated by <span class="ec-lmss-10x-x-109">freqz </span>in Figure&nbsp;<a href="#x35-10619839">2.39<!-- tex4ht:ref: fig:dtft_via_freqz  --></a>.</span>
</figcaption>
<!-- tex4ht:label?: x35-10619940  -->
</figure>
<!-- l. 2364 -->
<p class="indent">
To better understand how <span class="ec-lmss-10x-x-109">freqz </span>works, Listing&nbsp;<a href="#x35-106200r12">2.12<!-- tex4ht:ref: code:snip_transforms_freqz  --></a> mimics <span class="ec-lmss-10x-x-109">freqz </span>and was used to obtain Figure&nbsp;<a href="#x35-10619940">2.40<!-- tex4ht:ref: fig:replicate_freqz  --></a>.
</p>
<!-- l. 2365 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;2.12: </span><span class="content">MatlabOctaveCodeSnippets/snip_transforms_freqz.m</span>
</figcaption>
<!-- tex4ht:label?: x35-106200r2.10  -->
<pre class="lstinputlisting" id="listing-61"><span class="label"><a id="x35-106202r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">num</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> <span class="ec-lmtt-9">non-zero samples in the (aperiodic) pulse</span> 
</span><span class="label"><a id="x35-106203r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ones</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N1</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">signal</span></span><span style="color:#005900"> <span class="ec-lmtt-9">x[n]</span> 
</span><span class="label"><a id="x35-106204r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">halfN</span></span><span style="color:#000000"><span class="ec-lmtt-9">=512;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">N=2*halfN;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">half</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of the DFT dimension and N</span> 
</span><span class="label"><a id="x35-106205r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">indices</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of freq. components</span> 
</span><span class="label"><a id="x35-106206r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">wk</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= k*2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">angular</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequencies</span> 
</span><span class="label"><a id="x35-106207r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">use</span></span><span style="color:#005900"> <span class="ec-lmtt-9">2N-DFT to get N positive freqs.</span> 
</span><span class="label"><a id="x35-106208r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:</span></span><span style="color:#000000"><span class="ec-lmtt-9">halfN</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">discard</span></span><span style="color:#005900"> <span class="ec-lmtt-9">negative freqs.</span> 
</span><span class="label"><a id="x35-106209r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">wk</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">halfN</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">positive</span></span><span style="color:#005900"> <span class="ec-lmtt-9">freq. grid</span> 
</span><span class="label"><a id="x35-106210r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(211)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">wk</span></span><span style="color:#000000"><span class="ec-lmtt-9">,20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> <span class="ec-lmtt-9">dB</span> 
</span><span class="label"><a id="x35-106211r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(212)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">wk</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">angle</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xk_fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*180/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> <span class="ec-lmtt-9">degrees</span></span>
  </pre>
<!-- l. 2379 -->
<p class="indent">
</p><p>It can be seen that Figure&nbsp;<a href="#x35-10619940">2.40<!-- tex4ht:ref: fig:replicate_freqz  --></a> is very similar to Figure&nbsp;<a href="#x35-10619839">2.39<!-- tex4ht:ref: fig:dtft_via_freqz  --></a>. The only distinction is that, by default, Matlab/Octave represents the abscissa normalizing <!-- l. 2379 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> by <!-- l. 2379 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math>, such that the maximum frequency is not <!-- l. 2379 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math> but 1. It is interesting to note that Matlab/Octave and GNU Radio, for example, indicate <!-- l. 2379 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> in rad/sample, while this and other publications assume <!-- l. 2379 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> is given in radians (<!-- l. 2379 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math> is dimensionless). &nbsp;&nbsp;<!-- l. 2380 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math></p>
<p></p>
<div class="footnotes">
<a id="x35-106054x13"></a> <!-- l. 2024 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn13x4-bk" id="fn13x4"><sup class="textsuperscript">13</sup>&nbsp;</a></span><span class="ec-lmr-9">Available from [url2ecg].</span>
</p>
<a id="x35-106062x14"></a> <!-- l. 2071 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn14x4-bk" id="fn14x4"><sup class="textsuperscript">14</sup>&nbsp;</a></span><span class="ec-lmr-9">A good way to visualize DCT in image coding is by running the (deprecated) </span><span class="ec-lmss-9">dctdemo.m </span><span class="ec-lmr-9">Matlab demonstration.</span>
</p>
<a id="x35-106087x15"></a> <!-- l. 2096 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn15x4-bk" id="fn15x4"><sup class="textsuperscript">15</sup>&nbsp;</a></span><span class="ec-lmr-9">A popular repository is [url2usc].</span>
</p>
<a id="x35-106090x16"></a> <!-- l. 2108 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn16x4-bk" id="fn16x4"><sup class="textsuperscript">16</sup>&nbsp;</a></span><span class="ec-lmr-9">See, e. g., page 451, Eq. (6.68), in [</span><span class="ec-lmbx-9">?</span><span class="ec-lmr-9">].</span>
</p>
<a id="x35-106092x17"></a> <!-- l. 2114 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn17x4-bk" id="fn17x4"><sup class="textsuperscript">17</sup>&nbsp;</a></span><span class="ec-lmr-9">See, e. g., page 534, Eq. (6.155), in [</span><span class="ec-lmbx-9">?</span><span class="ec-lmr-9">].</span>
</p>
<a id="x35-106156x18"></a> <!-- l. 2235 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn18x4-bk" id="fn18x4"><sup class="textsuperscript">18</sup>&nbsp;</a></span><span class="ec-lmr-9">See Example&nbsp;</span><a href="ak_dsp_bookse9.html#x16-58002r43"><span class="ec-lmr-9">1.43</span><!-- tex4ht:ref: ex:commensurate  --></a> <span class="ec-lmr-9">for a discussion of commensurate frequencies.</span>
</p>
<pre><code>                                      &lt;/div&gt;</code></pre>





 <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ak_dsp_bookse26.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Z Transform</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ak_dsp_bookse28.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Digital Signal Processing with Python, Matlab or Octave, Applications in Machine Learning Aldebaro Klautau Federal University of Pará (UFPA), Brazil</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>