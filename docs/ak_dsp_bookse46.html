<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aldebaro Klautau">

<title>Digital Signal Processing with Python, Matlab or Octave - 46&nbsp; Applications</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ak_dsp_bookse47.html" rel="next">
<link href="./ak_dsp_bookse45.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ak_dsp_bookch3.html">Analog and Digital Systems</a></li><li class="breadcrumb-item"><a href="./ak_dsp_bookse46.html"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Applications</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Digital Signal Processing with Python, Matlab or Octave</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Tables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listings</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Signals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analog, Digital and Discrete-Time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basic Signal Manipulation and Representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Block Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Complex-Valued and Sampled Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modeling the Stages in A/D and D/A Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Relating Frequencies in Continuous, Sampled and Discrete-time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">An Introduction to Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Signal Categorization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Power and Energy in Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Relating Power in Continuous and Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Correlation: Finding Trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Linear Model for Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforms and Signal Representation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Linear Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inner Products to Obtain the Transform Coefficients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Block Transforms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Fourier Transforms and Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Relating discrete and analog frequencies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Summary of equations for DFT / FFT Usage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Laplace Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Z Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Contrasting Signals and Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Analog and Digital Filters: A Quick Hands-On Tour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Linear Time-Invariant Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Sampling and Signal Reconstruction Revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse36.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Facts About First and Second-Order Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse37.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Bandwidth and Quality Factor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse38.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Importance of Linear Phase (or Constant Group Delay)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse39.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Filtering technologies: Surface acoustic wave (SAW) and others</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse40.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse41.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">IIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse42.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Bilinear Transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse43.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">FIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse44.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Realization of Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse45.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multirate Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse46.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse47.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse48.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse49.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spectral Estimation Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse51.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse52.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Windows for spectral analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse53.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">The ESD, PSD and MS Spectrum functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse54.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Filtering Random Signals and the Impact on PSDs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse55.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Periodogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse56.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Welch’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse57.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Parametric PSD Estimation via Autoregressive (AR) Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse58.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Time-frequency Analysis using the Spectrogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse59.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse60.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse61.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse62.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">ak_dsp_bookap2.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">ak_dsp_bookap3.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">ak_dsp_bookap4.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Applications</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>


<meta charset="utf-8">
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" type="text/css" href="ak_dsp_book.css">
<meta name="src" content="ak_dsp_book.tex">
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js"></script>


<h3 class="sectionHead anchored">
<span class="titlemark">3.16</span>&nbsp;&nbsp;<a id="x55-2000003.16"></a>Applications
</h3>
<!--l. 3667-->
<p class="noindent">
<a id="x55-200001r1"></a> <span id="textcolor222"><span class="ec-lmbx-10x-x-109">Application 3.1.</span></span> <span class="ec-lmbx-10x-x-109">Implementing a “universal” analog filter using</span> <span class="ec-lmbx-10x-x-109">the PC sound board and Playrec</span>. This application practices the system illustrated in Figure&nbsp;<a href="ak_dsp_bookse33.html#x42-1180017">3.7<!--tex4ht:ref: fig:canonical_interface --></a>, using a PC to implement the system <!--l. 3669--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> and the sound board for A/D and D/A conversions. It relies on a sound library to continuously read input samples from the ADC and send output samples to the DAC. There are many libraries for doing that, such as Java Sound, which has the advantage of a clean API and running on Windows, Linux and other operating systems. But a requirement for this example was to implement the signal processing in Matlab and Octave. Because of that, Playrec&nbsp;[url1pre] was adopted. The code based on Playrec is not optimized for this application because it continuously and dynamically allocates and frees memory. A more optimized implementation would use something as a circular buffer. But Playrec is flexible in the sense that allows using all Matlab/Octave powerful functions and can be compiled to both. In our case, the experiments were done using Playrec compiled for Octave on Linux. The reader is referred to Playrec’s web site at [url1pre] for installation instructions and it is assumed from now on that Playrec has been already installed and tested.
</p>
<!--l. 3671-->
<p class="indent">
Listing&nbsp;<a href="#x55-200002r38">3.38<!--tex4ht:ref: code:universalChannelInitialization --></a> lists the first lines of the initialization code, where the sampling frequency <!--l. 3671--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is defined. Hence, the application bandwidth is <!--l. 3671--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></math>. It should be mentioned that the values of the two first variables in Listing&nbsp;<a href="#x55-200002r38">3.38<!--tex4ht:ref: code:universalChannelInitialization --></a> may vary among different computers. The user must use Playrec’s scripts <span class="ec-lmss-10x-x-109">select_play </span>and <span class="ec-lmss-10x-x-109">select_rec </span>to investigate the proper identifiers (ID’s) in his/her system.
</p>
<!--l. 3673-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.38: </span><span class="content">MatlabOctaveThirdPartyFunctions/ak_universalChannelInitialization.m</span>
</figcaption>
<!--tex4ht:label?: x55-200002r3.16 -->
<pre class="lstinputlisting" id="listing-114"><span class="label"><a id="x55-200004r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">playDeviceID</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">device</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">ID</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">choose</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">it</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">select_play</span></span><span style="color:#005900"><span class="ec-lmtt-9">...</span></span> 
<span class="label"><a id="x55-200005r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">recDeviceID</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">device</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">ID</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">choose</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">it</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">select_rec</span></span><span style="color:#005900"><span class="ec-lmtt-9">...</span></span> 
<span class="label"><a id="x55-200006r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">playChan</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">channels</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">used</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">playback</span></span> 
<span class="label"><a id="x55-200007r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">recChan</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">channels</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">used</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">recording</span></span> 
<span class="label"><a id="x55-200008r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=44100;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span> 
<span class="label"><a id="x55-200009r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">debug</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">use</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">1</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">show</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">skipped</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">or</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">0</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">otherwise</span></span> 
<span class="label"><a id="x55-200010r7"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">other</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">definitions</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">follow</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">below</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span><span style="color:#005900"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">...</span></span>
  </pre>
<!--l. 3675-->
<p class="indent">
</p><p>Listing&nbsp;<a href="#x55-200011r39">3.39<!--tex4ht:ref: code:universalChannel1 --></a> provides an example of filtering using Playrec. Note that the first instruction is to run Listing&nbsp;<a href="#x55-200002r38">3.38<!--tex4ht:ref: code:universalChannelInitialization --></a> to initialize Playrec. Just after that, a Butterworth filter of order 30 is designed, with cutoff frequency</p>
<!--l. 3675-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>4</mn></math>&nbsp;Hz, which corresponds to <!--l. 3675--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></math>&nbsp;rad (or <!--l. 3675--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn></math> after normalizing by <!--l. 3675--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>π</mi></math>, as required by Matlab/Octave). The array <span class="ec-lmss-10x-x-109">memory </span>is created in the next line, to store the samples in the filter’s memory. The actual filtering processing is in line 23, within an eternal loop, and repeatedly updates <span class="ec-lmss-10x-x-109">memory</span>.
<p></p>
<!--l. 3677-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.39: </span><span class="content">MatlabOctaveThirdPartyFunctions/ak_universalChannel1.m</span>
</figcaption>
<!--tex4ht:label?: x55-200011r3.16 -->
<pre class="lstinputlisting" id="listing-115"><span class="label"><a id="x55-200013r1"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Example</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">LTI</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">channel</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">implemented</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">as</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">H</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"><span class="ec-lmtt-9">=</span></span><span style="color:#005900"><span class="ec-lmtt-9">B</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"><span class="ec-lmtt-9">/</span></span><span style="color:#005900"><span class="ec-lmtt-9">A</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">below</span></span> 
<span class="label"><a id="x55-200014r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">ak_universalChannelInitialization</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">initialize</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">sound</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">card</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">acquisition</span></span> 
<span class="label"><a id="x55-200015r3"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">script</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">above</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">defines</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Fs</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">sound</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">recording</span></span><span style="color:#005900"><span class="ec-lmtt-9">/</span></span><span style="color:#005900"><span class="ec-lmtt-9">playback</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">parameters</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200016r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(30,0.5)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">design</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">some</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">play</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">role</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">channel</span></span> 
<span class="label"><a id="x55-200017r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ans</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">memory</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,100)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">initialize</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">memory</span></span> 
<span class="label"><a id="x55-200018r6"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">while</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">true</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">script</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">runs</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">until</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">interrupted</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">by</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">CTRL</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">+</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">C</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">example</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200019r7"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">-1</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">is</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">record</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">same</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">playSampleBuffer</span></span> 
<span class="label"><a id="x55-200020r8"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">newPageNumber</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">playrec</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">playrec</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">playSampleBuffer</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">playChan</span></span><span style="color:#000000"><span class="ec-lmtt-9">,...</span></span> 
<span class="label"><a id="x55-200021r9"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">-1,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">recChan</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200022r10"></a><span class="ec-lmr-6">10</span></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">pageNumList</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">pageNumList</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">newPageNumber</span></span><span style="color:#000000"><span class="ec-lmtt-9">];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">add</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">end</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">list</span></span> 
<span class="label"><a id="x55-200023r11"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">runMaxSpeed</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">consumes</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">more</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">CPU</span></span> 
<span class="label"><a id="x55-200024r12"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">while</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">playrec</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">isFinished</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">pageNumList</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">==</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">0)</span></span> 
<span class="label"><a id="x55-200025r13"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x55-200026r14"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">else</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">less</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">CPU</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">demanding</span></span> 
<span class="label"><a id="x55-200027r15"></a><span class="ec-lmr-6">15</span></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">playrec</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">block</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">pageNumList</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">blocks</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">until</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">recording</span></span> 
<span class="label"><a id="x55-200028r16"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x55-200029r17"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">recSamples</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">playrec</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">getRec</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">pageNumList</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">get</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">rec</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span> 
<span class="label"><a id="x55-200030r18"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">playrec</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">delPage</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">pageNumList</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">delete</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">current</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">page</span></span> 
<span class="label"><a id="x55-200031r19"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">pageNumList</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">pageNumList</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">exclude</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">page</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">from</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">list</span></span> 
<span class="label"><a id="x55-200032r20"></a><span class="ec-lmr-6">20</span></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">(~</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">isempty</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">recSamples</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">DSP</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">code</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">section</span></span> 
<span class="label"><a id="x55-200033r21"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Your</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">DSP</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">code</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">must</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">go</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">here</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">inside</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">if</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">instruction</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">The</span></span> 
<span class="label"><a id="x55-200034r22"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">recSamples</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">playSampleBuffer</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">store</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span> 
<span class="label"><a id="x55-200035r23"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">channel</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">respectively</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span> 
<span class="label"><a id="x55-200036r24"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">playSampleBuffer</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">memory</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">recSamples</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">memory</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200037r25"></a><span class="ec-lmr-6">25</span></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x55-200038r26"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">debug</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">==</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">1</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">send</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">stdout</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">if</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">outside</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">loop</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">it</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">would</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">not</span></span> 
<span class="label"><a id="x55-200039r27"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">fprintf</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">%</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">d</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">samples</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">skipped</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">!\</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">n</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">...</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">print</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">due</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">CTRL</span></span><span style="color:#005900"><span class="ec-lmtt-9">+</span></span><span style="color:#005900"><span class="ec-lmtt-9">C</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200040r28"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">playrec</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">getSkippedSampleCount</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200041r29"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x55-200042r30"></a><span class="ec-lmr-6">30</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x55-200043r31"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">playrec</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">delPage</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">clean</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">exit</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">but</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">not</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">executed</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">due</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">user</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">CTRL</span></span><span style="color:#005900"><span class="ec-lmtt-9">+</span></span><span style="color:#005900"><span class="ec-lmtt-9">C</span></span>
  </pre>
<!--l. 3679-->
<p class="indent">
Expanding the setup in Application&nbsp;<a href="ak_dsp_bookse14.html#x21-75097r4">1.4<!--tex4ht:ref: app:latency --></a> to use two computers, with audio cables to connect the ADC and DAC of the first to the DAC and ADC of the second, respectively, it is possible to implement and test several DSP algorithms. For example, while one computer implements the analog filter based on <!--l. 3679--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math>, Audacity can be used to playback a file with a signal <!--l. 3679--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> composed by the sum of two sinusoids to be the filter input, and simultaneously obtain the filter output <!--l. 3679--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>.
</p>
<!--l. 3682-->
<p class="indent">
Another example is suggested in Listing&nbsp;<a href="#x55-200044r40">3.40<!--tex4ht:ref: code:universalChannel2 --></a>, which shows how to add random noise to the filter’s output.
</p>
<!--l. 3687-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.40: </span><span class="content">MatlabOctaveThirdPartyFunctions/ak_universalChannel2.m</span>
</figcaption>
<!--tex4ht:label?: x55-200044r3.16 -->
<pre class="lstinputlisting" id="listing-116"><span class="label"><a id="x55-200046r21"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">(~</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">isempty</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">recSamples</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">DSP</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">code</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">section</span></span> 
<span class="label"><a id="x55-200047r22"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Your</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">DSP</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">code</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">must</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">go</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">here</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">inside</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">if</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">instruction</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">The</span></span> 
<span class="label"><a id="x55-200048r23"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">recSamples</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">playSampleBuffer</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">store</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span> 
<span class="label"><a id="x55-200049r24"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">playSampleBuffer</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">memory</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">recSamples</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">memory</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200050r25"></a><span class="ec-lmr-6">25</span></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">noiseSamples</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">size</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">noiseSamples</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">new</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">noise</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span> 
<span class="label"><a id="x55-200051r26"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">playSampleBuffer</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">playSampleBuffer</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">noiseSamples</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">add</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">noise</span></span> 
<span class="label"><a id="x55-200052r27"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span>
  </pre>
<!--l. 3689-->
<p class="indent">
Note that the variable <span class="ec-lmss-10x-x-109">debug </span>in Listing&nbsp;<a href="#x55-200002r38">3.38<!--tex4ht:ref: code:universalChannelInitialization --></a> can be used to evaluate if the system is capable of not dropping samples (given the chosen <!--l. 3689--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> and DSP processing). &nbsp;&nbsp;<!--l. 3690--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
<!--l. 3692-->
<p class="noindent">
</p><p><a id="x55-200053r2"></a> <span id="textcolor223"><span class="ec-lmbx-10x-x-109">Application 3.2.</span></span> <span class="ec-lmbx-10x-x-109">Implementing a “universal” analog filter using the PC sound</span> <span class="ec-lmbx-10x-x-109">board and Java code</span>. This application discusses another implementation of a universal channel. Instead of the Playrec Matlab/Octave code adopted in Application&nbsp;<a href="#x55-200001r1">3.1<!--tex4ht:ref: app:playrec --></a>, Java is used here. The advantage of using Playrec is that the channel can be based on virtually all Matlab/Octave available functions. However, in many cases the channel just needs to implement a filter. In this situation, the task of compiling Playrec can be avoided. The</p>
portability of Java makes easier to run the filter using the provided code, which can have its source code modified to add noise, etc. Alternatively, the already compiled <span class="ec-lmss-10x-x-109">DigitalFilter.jar </span>can be executed, which requires only having Java installed on your machine.
<p></p>
<!--l. 3698-->
<p class="indent">
The DigitalFilter Java project can be found at folder <span class="ec-lmss-10x-x-109">Code/Java_Language </span>of the companion software. The code can be executed from a command prompt, going to folder <span class="ec-lmss-10x-x-109">Code/Java_Language/DigitalFilter/dist </span>and typing
</p>
<!--l. 3701-->
<pre class="lstlisting" id="listing-117"><span class="label"><a id="x55-200054r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">java</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">jar</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">DigitalFilter</span></span><span style="color:#000000"><span class="ec-lmtt-9">.</span></span><span style="color:#000000"><span class="ec-lmtt-9">jar</span></span></pre>
<!--l. 3704-->
<p class="indent">
which will open the GUI depicted in Figure&nbsp;<a href="#x55-20005566">3.66<!--tex4ht:ref: fig:DigitalFilterJava --></a>. The assumed sampling frequency is <!--l. 3705--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn><mn>4</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>1</mn></math>&nbsp;kHz, which can be modified by editing the source code and recompiling.
</p>
<figure class="figure">
<p><a id="x55-20005566"></a></p>
<!--l. 3711-->
<p class="noindent">
<img src="./FiguresNonScript/DigitalFilterJava.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.66: </span><span class="content">Screenshot of the DigitalFilter GUI after user informed the coefficients of the filter obtained with Matlab/Octave command <span class="ec-lmss-10x-x-109">[B,A]=butter(4,0.5)</span>.</span>
</figcaption>
<!--tex4ht:label?: x55-20005566 -->
</figure>
<!--l. 3715-->
<p class="indent">
The GUI has two text areas to specify the numerator <!--l. 3716--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>B</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> (top area) and denominator <!--l. 3716--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>A</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> (bottom area) of a filter’s system function <!--l. 3717--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>B</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mi>A</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math>. The coefficients must be separated by a blank space. Figure&nbsp;<a href="#x55-20005566">3.66<!--tex4ht:ref: fig:DigitalFilterJava --></a> shows the coefficients of an IIR filter obtained with Matlab/Octave command <span class="ec-lmss-10x-x-109">[B,A]=butter(4,0.5)</span>. The difference equation is implemented using a Direct Form II Transposed, as the <span class="ec-lmss-10x-x-109">filter </span>function in Matlab/Octave.
</p>
<!--l. 3721-->
<p class="indent">
After clicking <span class="ec-lmss-10x-x-109">Change filter </span>and then the <span class="ec-lmss-10x-x-109">Start </span>button, the signal acquired by the sound board ADC will be continuously filtered by <!--l. 3721--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> and the filter output sent to the sound board DAC, according to the scheme depicted in Figure&nbsp;<a href="ak_dsp_bookse33.html#x42-1180017">3.7<!--tex4ht:ref: fig:canonical_interface --></a>.
</p>
<figure class="figure">
<p><a id="x55-20005667"></a></p>
<!--l. 3726-->
<p class="noindent">
<img src="./FiguresNonScript/filterWith2Computers.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.67: </span><span class="content">Result of experiment with Listing&nbsp;<a href="#x55-200057r41">3.41<!--tex4ht:ref: code:snip_systems_realtimeLoopback --></a> and soundboards of two computers: an analog bandpass filter implemented with the canonical interface of Figure&nbsp;<a href="ak_dsp_bookse33.html#x42-1180017">3.7<!--tex4ht:ref: fig:canonical_interface --></a>.</span>
</figcaption>
<!--tex4ht:label?: x55-20005667 -->
</figure>
<!--l. 3730-->
<p class="indent">
Figure&nbsp;<a href="#x55-20005667">3.67<!--tex4ht:ref: fig:filterWith2Computers --></a> shows the plot obtained with the Matlab code of Listing&nbsp;<a href="#x55-200057r41">3.41<!--tex4ht:ref: code:snip_systems_realtimeLoopback --></a> (a modified version of Listing&nbsp;<a href="ak_dsp_bookse14.html#x21-75041r26">1.26<!--tex4ht:ref: code:snip_signals_realtimeLoopback --></a>). Two computers were used and two audio cables connected the ADC (mic in) of the first computer to the DAC (speaker out) of the second computer and vice-versa. The first computer executed the DigitalFilter Java code while the second executed Listing&nbsp;<a href="#x55-200057r41">3.41<!--tex4ht:ref: code:snip_systems_realtimeLoopback --></a>. The gains (volumes) of both computers were adjusted to avoid signal saturation. The filter that the Java code implemented was obtained with the command <span class="ec-lmss-10x-x-109">[B,A]=cheby1(4,1,[0.2 .5]) </span>(the coefficients are not the ones in Figure&nbsp;<a href="#x55-20005566">3.66<!--tex4ht:ref: fig:DigitalFilterJava --></a>), which corresponds to a bandpass filter.
</p>
<!--l. 3732-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.41: </span><span class="content">MatlabOnly/snip_systems_realtimeLoopback.m</span>
</figcaption>
<!--tex4ht:label?: x55-200057r3.16 -->
<pre class="lstinputlisting" id="listing-118"><span class="label"><a id="x55-200059r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">44100;</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">rate</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">must</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">be</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">same</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">as</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Java</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">code</span></span> 
<span class="label"><a id="x55-200060r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">numSamples</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">DAC</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">ADC</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">soundboard</span></span> 
<span class="label"><a id="x55-200061r3"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">while</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">1</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">eternal</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">loop</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">break</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">it</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">with</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">CTRL</span></span><span style="color:#005900"><span class="ec-lmtt-9">+</span></span><span style="color:#005900"><span class="ec-lmtt-9">C</span></span> 
<span class="label"><a id="x55-200062r4"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">outputSignal</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">numSamples</span></span><span style="color:#000000"><span class="ec-lmtt-9">,1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">white</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Gaussian</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">noise</span></span> 
<span class="label"><a id="x55-200063r5"></a><span class="ec-lmr-6">5</span></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">wavplay</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">outputSignal</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">async</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">non</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">blocking</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">playback</span></span> 
<span class="label"><a id="x55-200064r6"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">inputSignal</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">wavrecord</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">numSamples</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">int16</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">record</span></span> 
<span class="label"><a id="x55-200065r7"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(211)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">inputSignal</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">axis</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">tight</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">graph</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">time</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">domain</span></span> 
<span class="label"><a id="x55-200066r8"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(212)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">pwelch</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">double</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">inputSignal</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">domain</span></span> 
<span class="label"><a id="x55-200067r9"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">drawnow</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Force</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">graphics</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">update</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">immediately</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">inside</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">loop</span></span> 
<span class="label"><a id="x55-200068r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span>
  </pre>
<!--l. 3734-->
<p class="indent">
The shape of this bandpass filter can be observed in Figure&nbsp;<a href="#x55-20005667">3.67<!--tex4ht:ref: fig:filterWith2Computers --></a> but the stopband attenuation is not as good as the theoretical one (obtained with <span class="ec-lmss-10x-x-109">freqz</span>, for example). A caveat of the experiment can be observed from the top plot of Figure&nbsp;<a href="#x55-20005667">3.67<!--tex4ht:ref: fig:filterWith2Computers --></a>, which shows the signal acquired by the ADC of the second computer. The zero-valued samples in the middle of the noise signal are due to Matlab not being able to output WGN samples (Example&nbsp;<a href="ak_dsp_bookse12.html#x19-72001r50">1.50<!--tex4ht:ref: ex:autocorrelationWhite --></a> discusses WGN), record the input signal and performing the extra processing without this delay. A workaround is to use another software to output the WGN and use Matlab only to record the samples, process them and plot the results.
</p>
<figure class="figure">
<p><a id="x55-20006968"></a></p>
<!--l. 3738-->
<p class="noindent">
<img src="./FiguresNonScript/filterWith2ComputersAudacity.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.68: </span><span class="content">Result similar to Figure&nbsp;<a href="#x55-20005667">3.67<!--tex4ht:ref: fig:filterWith2Computers --></a> but without silence intervals in acquired signal (top plot).</span>
</figcaption>
<!--tex4ht:label?: x55-20006968 -->
</figure>
<!--l. 3742-->
<p class="indent">
Figure&nbsp;<a href="#x55-20006968">3.68<!--tex4ht:ref: fig:filterWith2ComputersAudacity --></a> illustrates the result of a second experiment, where Audacity was used to send WGN samples to the DAC of the second computer. This can be conveniently done by using Audacity’s menu <span class="ec-lmss-10x-x-109">Generate </span>and choosing <span class="ec-lmss-10x-x-109">Noise -&gt; White</span>. Then, the option <span class="ec-lmss-10x-x-109">Loop Play </span>of menu <span class="ec-lmss-10x-x-109">Transport </span>can be used to conveniently play the noise in an eternal loop. The second computer also executed Listing&nbsp;<a href="#x55-200057r41">3.41<!--tex4ht:ref: code:snip_systems_realtimeLoopback --></a> but with its fourth and fifth lines commented out such that Matlab simply reads from the ADC and shows the plots. It can be seen that there are no silence gaps as occurred in Figure&nbsp;<a href="#x55-20005667">3.67<!--tex4ht:ref: fig:filterWith2Computers --></a>.
</p>
<!--l. 3744-->
<p class="indent">
The user is invited to implement a system with larger attenuation in the stopband. One aspect is to use <!--l. 3744--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> with larger order. Another aspect is to get a better estimate of the spectrum by changing the values of <span class="ec-lmss-10x-x-109">numSamples </span>and input parameters of <span class="ec-lmss-10x-x-109">psd </span>(or <span class="ec-lmss-10x-x-109">pwelch</span>) in Listing&nbsp;<a href="#x55-200057r41">3.41<!--tex4ht:ref: code:snip_systems_realtimeLoopback --></a>. For example, it may help to increase the number of FFT points as discussed in Chapter&nbsp;<a href="ak_dsp_bookch4.html#x59-2040004">4<!--tex4ht:ref: ch:frequency --></a>. &nbsp; &nbsp;<!--l. 3745--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
<!--l. 3747-->
<p class="noindent">
<a id="x55-200070r3"></a> <span id="textcolor224"><span class="ec-lmbx-10x-x-109">Application 3.3.</span></span> <span class="ec-lmbx-10x-x-109">Relating power in continuous and discrete-time when the</span> <span class="ec-lmbx-10x-x-109">reconstruction filter has unitary energy.</span>
</p>
<!--l. 3751-->
<p class="indent">
In Section&nbsp;<a href="ak_dsp_bookse11.html#x18-670001.11">1.11<!--tex4ht:ref: sec:cont_disc_power --></a>, a ZOH reconstruction was assumed. Alternatively, if the reconstruction filter has an impulse response <!--l. 3752--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></math> with unitary energy, a reasoning similar to the one adopted in Section&nbsp;<a href="ak_dsp_bookse11.html#x18-670001.11">1.11<!--tex4ht:ref: sec:cont_disc_power --></a> leads to the conclusion that the power is <!--l. 3752--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></math>. Because of this, some textbooks denote <!--l. 3752--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>d</mi></mrow></msub></math> as the average energy (Joules) instead of power (Watts). This ambiguity can also be interpreted as a consequence of the fact that a discrete-time signal <!--l. 3752--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> does not have explicit information about time. Hence, the interpretation of its power in Watts requires a model or assumption for the reconstruction filter <!--l. 3752--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></math>, which must incorporate the whole reconstruction process, including filters and amplifiers. In this text the assumed model is zero-order hold reconstruction. &nbsp; &nbsp;<!--l. 3753--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
<!--l. 3755-->
<p class="noindent">
<a id="x55-200071r4"></a> <span id="textcolor225"><span class="ec-lmbx-10x-x-109">Application 3.4.</span></span> <span class="ec-lmbx-10x-x-109">Minimum phase systems</span>. A LTI discrete-time system <!--l. 3757--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> is causal and stable only if all its poles are inside the unit circle, but these two requirements do not impose restrictions on the zeros. The zeros of a causal and stable <!--l. 3757--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> can be anywhere in the Z plane. In many cases, it is useful to impose that the zeros must also be inside the unit circle. For a continuous-time system <!--l. 3757--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></math>, the equivalent requirement is to have all zeros inside the left-part of the S plane. A minimum-phase system has this property.
</p>
<!--l. 3759-->
<p class="indent">
</p><p>A LTI is <span class="ec-lmri-10x-x-109">minimum-phase</span><a id="dx55-200072"></a> if both the system</p>
<!--l. 3759-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi></math> itself and its inverse <!--l. 3759--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mi>H</mi></math> are causal and stable. Assuming, discrete-time, because the poles of the inverse <!--l. 3759--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> are the zeros of <!--l. 3759--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math>, only a system with all zeros inside the unit circle has a causal and stable inverse.
<p></p>
<!--l. 3761-->
<p class="indent">
A non-minimum-phase system <!--l. 3761--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>H</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">non</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> can always be transformed into a minimum-phase <!--l. 3761--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>H</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">min</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> that has the same magnitude, i. e., <!--l. 3761--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-rel" stretchy="false">|</mo><msub><mrow><mi>H</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">non</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-rel" stretchy="false">|</mo><msub><mrow><mi>H</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">min</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></math>. This is achieved by replacing the zeros of <!--l. 3761--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>H</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">non</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> that are outside the unit circle by their conjugate reciprocals.<a id="dx55-200073"></a><span class="footnote-mark"><a href="#fn35x5" id="fn35x5-bk"><sup class="textsuperscript">35</sup></a></span><a id="x55-200074f35"></a> That is, replace all zeros <!--l. 3761--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub></math> with <!--l. 3761--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-rel" stretchy="false">|</mo><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-rel" stretchy="false">|</mo> <mo class="MathClass-rel" stretchy="false">&gt;</mo> <mn>1</mn></math> by <!--l. 3761--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><msubsup><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow><mrow><mo class="MathClass-bin" stretchy="false">∗</mo></mrow></msubsup></math>. For example, if <!--l. 3762--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></msup></math> is a zero of <!--l. 3762--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>H</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">non</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math>, it should be replaced by <!--l. 3762--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><msubsup><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow><mrow><mo class="MathClass-bin" stretchy="false">∗</mo></mrow></msubsup> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></msup></math>. The function <span class="ec-lmss-10x-x-109">ak_forceStableMinimumPhase.m </span>implements this method and also decreases the magnitude of zeros on top of the unit circle.
</p>
<figure class="figure">
<p><a id="x55-20007669"></a></p>
<!--l. 3767-->
<p class="noindent">
<img src="./Figures/minphase_example.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.69: </span><span class="content">Frequency responses of <!--l. 3768--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>H</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">non</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> and its minimum-phase counterpart <!--l. 3768--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>H</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">min</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math>.</span>
</figcaption>
<!--tex4ht:label?: x55-20007669 -->
</figure>
<!--l. 3771-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.42: </span><span class="content">MatlabBookFigures/figs_systems_minphase</span>
</figcaption>
<!--tex4ht:label?: x55-200077r3.16 -->

<pre class="lstinputlisting" id="listing-119"><span class="label"><a id="x55-200079r1"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">clf</span></span> 
<span class="label"><a id="x55-200080r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">B_roots</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">[2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/4)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(-</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/4)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">...</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">define</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">roots</span></span> 
<span class="label"><a id="x55-200081r3"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">0.7*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/8)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">0.7*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(-</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/8)</span></span><span style="color:#000000"><span class="ec-lmtt-9">];</span></span> 
<span class="label"><a id="x55-200082r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">poly</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B_roots</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">construct</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">B</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">H</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"><span class="ec-lmtt-9">=</span></span><span style="color:#005900"><span class="ec-lmtt-9">B</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"><span class="ec-lmtt-9">/</span></span><span style="color:#005900"><span class="ec-lmtt-9">A</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200083r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">poly</span></span><span style="color:#000000"><span class="ec-lmtt-9">([0.4</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">0.5</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">0.6</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">0.5</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-0.5</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">0.3</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-0.3</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">arbitrary</span></span> 
<span class="label"><a id="x55-200084r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Bmin</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">ak_forceStableMinimumPhase</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">move</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">zeros</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">inside</span></span> 
<span class="label"><a id="x55-200085r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">freqz</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">response</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">original</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">H</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200086r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Hmin</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">freqz</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bmin</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">minimum</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">phase</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">H</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200087r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(211)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Hmin</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">--</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">axis</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">tight</span></span> 
<span class="label"><a id="x55-200088r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">legend1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">legend</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">non</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">-</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">min</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">min</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">-</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">phase</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(212)</span></span>
  </pre>
<!--l. 3775-->
<p class="indent">
Figure&nbsp;<a href="#x55-20007669">3.69<!--tex4ht:ref: fig:minphase_example --></a> was obtained with Listing&nbsp;<a href="#x55-200077r42">3.42<!--tex4ht:ref: code:minphase --></a>. Note that the magnitude is the same but the phase is distinct, with <!--l. 3776--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>H</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">min</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> having smaller values.
</p>
<!--l. 3778-->
<p class="indent">
Minimum-phase systems have interesting properties. As the name indicates, among all systems with a given magnitude, the minimum-phase is the one with the phase closest to zero. Figure&nbsp;<a href="#x55-20007669">3.69<!--tex4ht:ref: fig:minphase_example --></a> illustrates this behavior, which can also be observed via the group delay, as in Figure&nbsp;<a href="#x55-20008970">3.70<!--tex4ht:ref: fig:minphase_groupdelay --></a>.
</p>
<figure class="figure">
<p><a id="x55-20008970"></a></p>
<!--l. 3783-->
<p class="noindent">
<img src="./Figures/minphase_groupdelay.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.70: </span><span class="content">Group delay for the non-minimum and minimum phase systems of Figure&nbsp;<a href="#x55-20007669">3.69<!--tex4ht:ref: fig:minphase_example --></a>.</span>
</figcaption>
<!--tex4ht:label?: x55-20008970 -->
</figure>
<!--l. 3787-->
<p class="indent">
Besides, the impulse response <!--l. 3787--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> of a minimum-phase system has its energy concentrated toward time <!--l. 3787--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></math> more than any other causal signal having the same magnitude spectrum. &nbsp; &nbsp;<!--l. 3789--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
<!--l. 3791-->
<p class="noindent">
<a id="x55-200090r5"></a> <span id="textcolor226"><span class="ec-lmbx-10x-x-109">Application 3.5.</span></span> <span class="ec-lmbx-10x-x-109">Distinct ways of specifying the passband “ripple” / deviation.</span> There are several ways of specifying the maximum “ripple” or deviation at the passband of a filter. For example, it can be specified in dB or linear scale, which are called here <!--l. 3793--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>R</mi></mrow><mrow><mi>p</mi></mrow></msub></math> and <!--l. 3793--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>D</mi></mrow><mrow><mi>p</mi></mrow></msub></math>, respectively (as suggested by Matlab). If one assumes a lowpass filter with a unitary gain at DC, the maximum linear deviation <!--l. 3793--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>D</mi></mrow><mrow><mi>p</mi></mrow></msub></math> can be assumed to be within <!--l. 3793--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-open" stretchy="false">[</mo><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>D</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>D</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-close" stretchy="false">]</mo></math> or <!--l. 3793--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-open" stretchy="false">[</mo><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>D</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo></math>. The latter option is particularly useful if the filter magnitude monotonically decreases as for the Butterworth filters and is assumed here, meaning that the frequency response is 1 at DC and decreases in the passband to a value not smaller than <!--l. 3793--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>D</mi></mrow><mrow><mi>p</mi></mrow></msub></math>. For example, a specification can be that the passband magnitude does not deviate 5% of the gain at DC. In this case, <!--l. 3793--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>D</mi></mrow><mrow><mi>p</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>0</mn><mn>5</mn></math> and the minimum magnitude at passband is <!--l. 3793--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>D</mi></mrow><mrow><mi>p</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>9</mn><mn>5</mn></math>. Often, this value is specified in dB as
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!--l. 3794-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <msub><mrow><mi>R</mi></mrow><mrow><mi>p</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn><mn>0</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mrow><mrow><mn>1</mn><mn>0</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>D</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-punc" stretchy="false">.</mo> </math>
</td>
</tr>

</tbody></table>
<!--l. 3797-->
<p class="indent">
If the deviation is within <!--l. 3797--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-open" stretchy="false">[</mo><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>D</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo></math> in linear scale, then it is confined to <!--l. 3797--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><msub><mrow><mi>R</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo></math> in dB.
</p>
<!--l. 3799-->
<p class="indent">
</p><p>At the stopband, the magnitude in linear scale <!--l. 3799--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>D</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is also a “deviation” because the reference value is 0 (the desired magnitude at stopband). In other words, for the stopband, the deviation coincides with the magnitude itself and its value in</p>
dB is given by
<p></p>

<table class="equation-star">
<tbody><tr>
<td>
<!--l. 3800-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <msub><mrow><mi>R</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn><mn>0</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!--FUNCTION APPLICATION--> </mo><!--nolimits--></mrow><mrow><mn>1</mn><mn>0</mn></mrow></msub><msub><mrow><mi>D</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">.</mo> </math>
</td>
</tr>

</tbody></table>
<!--l. 3803-->
<p class="indent">
Often, the filter magnitude has a maximum value of 0&nbsp;dB and the values of <!--l. 3803--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>R</mi></mrow><mrow><mi>p</mi></mrow></msub></math> and <!--l. 3803--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>R</mi></mrow><mrow><mi>s</mi></mrow></msub></math> are positive.
</p>
<!--l. 3805-->
<p class="indent">
Matlab uses the same convention adopted here in its routines. This is exemplified in Listing&nbsp;<a href="#x55-200091r43">3.43<!--tex4ht:ref: code:snip_systems_IIR_design --></a>, which designs an IIR Butterworth.
</p>
<!--l. 3806-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.43: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_IIR_design.m</span>
</figcaption>
<!--tex4ht:label?: x55-200091r3.16 -->
<pre class="lstinputlisting" id="listing-120"><span class="label"><a id="x55-200093r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.3;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">normalized</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">passband</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">rad</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">/</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">pi</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200094r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Ws</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.7;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">normalized</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">stopband</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">rad</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">/</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">pi</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200095r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Rp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">maximum</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">passband</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">ripple</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">dB</span></span> 
<span class="label"><a id="x55-200096r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Rs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=40;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">minimum</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">stopband</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">attenuation</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">dB</span></span> 
<span class="label"><a id="x55-200097r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">buttord</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ws</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Butterworth</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">order</span></span> 
<span class="label"><a id="x55-200098r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(3*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">design</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Butterworth</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span> 
<span class="label"><a id="x55-200099r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">zp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">zs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ws</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Z</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">values</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Wp</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Ws</span></span> 
<span class="label"><a id="x55-200100r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">linearMagWp</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">zp</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">zp</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">mag</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Wp</span></span> 
<span class="label"><a id="x55-200101r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">linearMagWs</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">zs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">zs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">mag</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Ws</span></span> 
<span class="label"><a id="x55-200102r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">D_p</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">1-</span></span><span style="color:#000000"><span class="ec-lmtt-9">linearMagWp</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">linear</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">deviation</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Wp</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">linear</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200103r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">R_p</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1-</span></span><span style="color:#000000"><span class="ec-lmtt-9">D_p</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">deviation</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">ripple</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Wp</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">dB</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200104r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">D_s</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">linearMagWs</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">linear</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">deviation</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Ws</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">linear</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200105r13"></a></span><span style="color:#000000"><span class="ec-lmtt-9">R_s</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">D_s</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">deviation</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">ripple</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Ws</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">dB</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span>
  </pre>
<!--l. 3822-->
<p class="indent">
The filter has order <span class="ec-lmss-10x-x-109">n=4</span>, <span class="ec-lmss-10x-x-109">D_p=0.0044</span>, <span class="ec-lmss-10x-x-109">R_p=0.0380</span>, <span class="ec-lmss-10x-x-109">D_s=1.0e-006 </span>and <span class="ec-lmss-10x-x-109">R_s=119.9987</span>. Note that the requirements are met with slack. As a sanity check, adding the line
</p>
<!--l. 3824-->
<pre class="lstlisting" id="listing-121"><span class="label"><a id="x55-200108r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">n2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wn2</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">buttord</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ws</span></span><span style="color:#000000"><span class="ec-lmtt-9">,0.0380,119.9987)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Butterworth</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">order</span></span></pre>
<!--l. 3827-->
<p class="indent">
at the end of the previous code would give the same order <span class="ec-lmss-10x-x-109">n2=n=4</span> and cutoff frequency <span class="ec-lmss-10x-x-109">Wn2=Wn </span>as the previous invocation to <span class="ec-lmss-10x-x-109">buttord</span>. &nbsp; &nbsp;<!--l. 3828--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
<!--l. 3830-->
<p class="noindent">
<a id="x55-200109r6"></a> <span id="textcolor227"><span class="ec-lmbx-10x-x-109">Application 3.6.</span></span> <span class="ec-lmbx-10x-x-109">Influence of the poles quality factor on frequency response</span>. The goal here is to illustrate how the pole Q-factor influences a frequency response.
</p>
<figure class="figure">
<p><a id="x55-20011071"></a></p>
<!--l. 3836-->
<p class="noindent">
<img src="Figures/qfactor_resonator.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.71: </span><span class="content">Magnitudes of frequency responses for two resonators with <!--l. 3837--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></math> as in Eq.&nbsp;(<a href="ak_dsp_bookse36.html#x45-142001r29">3.29<!--tex4ht:ref: eq:resonator --></a>). The top plot corresponds to poles <!--l. 3837--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>p</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn><mn>0</mn><mn>0</mn> <mo class="MathClass-bin" stretchy="false">±</mo> <mi>j</mi><mn>4</mn><mn>0</mn><mn>0</mn><mn>0</mn></math> with <!--l. 3837--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>6</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn><mn>8</mn><mn>5</mn><mn>4</mn></math> and <!--l. 3837--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>ω</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>ω</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>4</mn><mn>0</mn><mn>0</mn><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>6</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn><mn>2</mn></math> dB. The bottom plot corresponds to <!--l. 3837--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>p</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn> <mo class="MathClass-bin" stretchy="false">±</mo> <mi>j</mi><mn>4</mn><mn>0</mn><mn>0</mn><mn>0</mn></math> with <!--l. 3837--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>6</mn><mn>6</mn><mn>6</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn><mn>7</mn></math> and <!--l. 3837--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>ω</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>ω</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>4</mn><mn>0</mn><mn>0</mn><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn><mn>6</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>4</mn><mn>8</mn></math> dB. The two data tips indicate approximately 3-dB frequencies.</span>
</figcaption>
<!--tex4ht:label?: x55-20011071 -->
</figure>
<!--l. 3841-->
<p class="indent">
First, Listing&nbsp;<a href="#x55-200111r44">3.44<!--tex4ht:ref: code:snip_systems_Qfactor --></a> shows how to calculate <!--l. 3841--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi></math> for a second-order system in Matlab/Octave using Eq.&nbsp;(<a href="ak_dsp_bookse37.html#x46-148003r40">3.40<!--tex4ht:ref: eq:q_factor_second_order --></a>).
</p>
<!--l. 3842-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.44: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_Qfactor.m</span>
</figcaption>
<!--tex4ht:label?: x55-200111r3.16 -->
<pre class="lstinputlisting" id="listing-122"><span class="label"><a id="x55-200113r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">p1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=-300+</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*4000;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">p2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=-300-</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*4000;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">pole</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">its</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">conjugate</span></span> 
<span class="label"><a id="x55-200114r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">poly</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#000000"><span class="ec-lmtt-9">p1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">p2</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convert</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">it</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">a</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">polynomial</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">A</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200115r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">omega_n</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sqrt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">(3)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">alpha</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">use</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">definitions</span></span> 
<span class="label"><a id="x55-200116r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Q</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">omega_n</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">alpha</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Q</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">factor</span></span>
  </pre>
<!--l. 3849-->
<p class="indent">
In this case, the poles are located at the frequency <!--l. 3849--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"> <mo class="MathClass-bin" stretchy="false">±</mo> <mn>4</mn><mn>0</mn><mn>0</mn><mn>0</mn></math> rad/s and have <!--l. 3849--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>6</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn><mn>8</mn><mn>5</mn><mn>4</mn></math>. For this example, the 3-dB bandwidth is defined (approximately) by <!--l. 3850--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn><mn>6</mn><mn>7</mn><mn>8</mn></math> and <!--l. 3850--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn><mn>2</mn><mn>7</mn><mn>6</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>3</mn></math> rad/s, which gives <!--l. 3850--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>9</mn><mn>5</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn></math> Hz. If we change the poles to <!--l. 3850--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>3</mn> <mo class="MathClass-bin" stretchy="false">±</mo> <mi>j</mi><mn>4</mn><mn>0</mn><mn>0</mn><mn>0</mn></math>, the <!--l. 3850--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi></math>-factor increases to <!--l. 3850--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>6</mn><mn>6</mn><mn>6</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn><mn>7</mn></math> and <!--l. 3850--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle></math> decreases to approximately 6 Hz. Figure&nbsp;<a href="#x55-20011071">3.71<!--tex4ht:ref: fig:qfactor_resonator --></a> compares these two situations.
</p>
<!--l. 3852-->
<p class="indent">
The approximations used in analog filter design differ in the strategy for locating the poles (and zeros). Typically, the approximations that use poles with larger <!--l. 3852--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi></math>-factor have better magnitude but worse phase responses. The Listing&nbsp;<a href="#x55-200119r45">3.45<!--tex4ht:ref: code:showQfactors --></a> compares the poles and their <!--l. 3852--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi></math> values for the Butterworth, Chebyshev (type 1) and Cauer (or elliptic).
</p>
<!--l. 3854-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.45: </span><span class="content">MatlabOctaveFunctions/ak_showQfactors.m</span>
</figcaption>
<!--tex4ht:label?: x55-200119r3.16 -->
<pre class="lstinputlisting" id="listing-123"><span class="label"><a id="x55-200121r1"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">function</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">ak_showQfactors</span></span> 
<span class="label"><a id="x55-200122r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=6;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">order</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span> 
<span class="label"><a id="x55-200123r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">=100;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">cutoff</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span> 
<span class="label"><a id="x55-200124r4"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">-</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">Butterworth</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">filter</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">:</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200125r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">design</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Butterworth</span></span> 
<span class="label"><a id="x55-200126r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">calculateQfactors</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">display</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Q</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">factors</span></span> 
<span class="label"><a id="x55-200127r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">-</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">Chebyshev</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">1</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">filter</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">:</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200128r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Rp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">maximum</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">ripple</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">passband</span></span> 
<span class="label"><a id="x55-200129r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">cheby1</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">design</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Chebyshev</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">type</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">1</span></span> 
<span class="label"><a id="x55-200130r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">calculateQfactors</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">display</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Q</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">factors</span></span> 
<span class="label"><a id="x55-200131r11"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">-</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">Elliptic</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">filter</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">:</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200132r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Rs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=30;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">minimum</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">attenuation</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">stopband</span></span> 
<span class="label"><a id="x55-200133r13"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">elliptic</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">natural</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">equals</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">cutoff</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span> 
<span class="label"><a id="x55-200134r14"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ellip</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">design</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Elliptic</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span> 
<span class="label"><a id="x55-200135r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#000000"><span class="ec-lmtt-9">calculateQfactors</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">display</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Q</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">factors</span></span> 
<span class="label"><a id="x55-200136r16"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">end</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">function</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">ak_showQfactors</span></span> 
<span class="label"><a id="x55-200137r17"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">function</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">calculateQfactors</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">p</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">has</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">poles</span></span> 
<span class="label"><a id="x55-200138r18"></a></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">find</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">imag</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">&gt;0)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">exclude</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">real</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">poles</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">complex</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">conjugates</span></span> 
<span class="label"><a id="x55-200139r19"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">complex</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">poles</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">with</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">non</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">zero</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">imaginary</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">parts</span></span> 
<span class="label"><a id="x55-200140r20"></a><span class="ec-lmr-6">20</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">for</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1:2:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span> 
<span class="label"><a id="x55-200141r21"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">pole</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200142r22"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">Q</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">pole</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">(2*(-</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">real</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">pole</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200143r23"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Poles</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">=</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">real</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">pole</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">+/-</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">j</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">...</span></span> 
<span class="label"><a id="x55-200144r24"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">imag</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">pole</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">=&gt;</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">Q</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">=</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Q</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200145r25"></a><span class="ec-lmr-6">25</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">end</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span> 
<span class="label"><a id="x55-200146r26"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">end</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">function</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">calculateQfactors</span></span>
  </pre>
<!--l. 3856-->
<p class="indent">
</p><p>The output of Listing&nbsp;<a href="#x55-200119r45">3.45<!--tex4ht:ref: code:showQfactors --></a> is the following:</p>
<p></p>
<pre class="verbatim" id="verbatim-7">-&nbsp;Butterworth&nbsp;filter:
Poles=-96.5926&nbsp;+/-&nbsp;j25.8819&nbsp;=&gt;&nbsp;Q=0.51764
Poles=-70.7107&nbsp;+/-&nbsp;j70.7107&nbsp;=&gt;&nbsp;Q=0.70711
Poles=-25.8819&nbsp;+/-&nbsp;j96.5926&nbsp;=&gt;&nbsp;Q=1.9319
-&nbsp;Chebyshev&nbsp;1&nbsp;filter:
Poles=-23.2063&nbsp;+/-&nbsp;j26.6184&nbsp;=&gt;&nbsp;Q=0.76087
Poles=-16.9882&nbsp;+/-&nbsp;j72.7227&nbsp;=&gt;&nbsp;Q=2.198
Poles=-6.2181&nbsp;+/-&nbsp;j99.3411&nbsp;=&gt;&nbsp;Q=8.0037
-&nbsp;Elliptic&nbsp;filter:
Poles=-34.9934&nbsp;+/-&nbsp;j49.0885&nbsp;=&gt;&nbsp;Q=0.86137
Poles=-9.154&nbsp;+/-&nbsp;j92.2792&nbsp;=&gt;&nbsp;Q=5.0651
Poles=-1.3808&nbsp;+/-&nbsp;j100.0259&nbsp;=&gt;&nbsp;Q=36.2244
</pre>
<!--l. 3870-->
<p class="nopar">
These results indicate that elliptic filters are more aggressive with respect to pole positioning (the poles are closer to the <!--l. 3871--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>j</mi><mi>ω</mi></math> axis) and have sharper magnitude responses. Butterworth filters, on the other hand, have poles with lower <!--l. 3871--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi></math> than Chebyshev and elliptic filters.
</p>
<figure class="figure">
<p><a id="x55-20014772"></a></p>
<!--l. 3878-->
<p class="noindent">
<img src="Figures/freq_response_butter6ord.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.72: </span><span class="content">Poles (left) and magnitude <!--l. 3879--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>ω</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></math> (right) for the sixth-order Butterworth filter of Listing&nbsp;<a href="#x55-200119r45">3.45<!--tex4ht:ref: code:showQfactors --></a>. The top plots are obtained with the pair of poles with the smallest <!--l. 3879--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi></math>, the middle plots with four poles and the bottom plots with all six poles.</span>
</figcaption>
<!--tex4ht:label?: x55-20014772 -->
</figure>
<figure class="figure">
<p><a id="x55-20014873"></a></p>
<!--l. 3884-->
<p class="noindent">
<img src="Figures/freq_response_cheby16ord.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.73: </span><span class="content">Similar to Figure&nbsp;<a href="#x55-20014772">3.72<!--tex4ht:ref: fig:freq_response_butter6ord --></a>, but with a sixth-order Chebyshev type 1 filter. Note the poles are closer to the <!--l. 3885--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>j</mi><mi>ω</mi></math> axis than for the Butterworth filter and there are ripples in the passband (one peak for each pole).</span>
</figcaption>
<!--tex4ht:label?: x55-20014873 -->
</figure>
<!--l. 3888-->
<p class="indent">
Figure&nbsp;<a href="#x55-20014772">3.72<!--tex4ht:ref: fig:freq_response_butter6ord --></a> and Figure&nbsp;<a href="#x55-20014873">3.73<!--tex4ht:ref: fig:freq_response_cheby16ord --></a> compare the Butterworth and Chebyshev approximations using sixth-order filters. Both lead to <span class="ec-lmri-10x-x-109">all-poles</span><a id="dx55-200149"></a> transfer functions, because there are no finite zeros (all zeros are at <!--l. 3888--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">±</mo><mi>∞</mi></math>). Finite zeros offer an additional degree of freedom but typically create additional abrupt changes in phase.
</p>
<figure class="figure">
<p><a id="x55-20015074"></a></p>
<!--l. 3892-->
<p class="noindent">
<img src="Figures/freq_response_ellip6ord.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.74: </span><span class="content">Zero-pole plot (top) and magnitude in dB (bottom) for the sixth-order elliptic filter of Listing&nbsp;<a href="#x55-200119r45">3.45<!--tex4ht:ref: code:showQfactors --></a>. This filter has zeros at <!--l. 3894--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">±</mo><mn>1</mn><mn>0</mn><mn>4</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn><mn>3</mn><mn>0</mn><mn>3</mn></math>, <!--l. 3894--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"> <mo class="MathClass-bin" stretchy="false">±</mo> <mn>1</mn><mn>1</mn><mn>6</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>8</mn><mn>8</mn><mn>6</mn><mn>8</mn></math>, <!--l. 3894--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"> <mo class="MathClass-bin" stretchy="false">±</mo> <mn>2</mn><mn>4</mn><mn>2</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>7</mn><mn>5</mn><mn>4</mn><mn>1</mn></math> rad/s, each one imposing a “valley” in the magnitude response, as the one indicated for <!--l. 3894--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>0</mn><mn>4</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn><mn>3</mn><mn>0</mn><mn>3</mn></math>.</span>
</figcaption>
<!--tex4ht:label?: x55-20015074 -->
</figure>
<!--l. 3897-->
<p class="indent">
The elliptic filters use finite zeros and achieve very short transition regions. Figure&nbsp;<a href="#x55-20015074">3.74<!--tex4ht:ref: fig:freq_response_ellip6ord --></a> illustrates a sixth-order elliptic filter to be compared to Figure&nbsp;<a href="#x55-20014772">3.72<!--tex4ht:ref: fig:freq_response_butter6ord --></a> and Figure&nbsp;<a href="#x55-20014873">3.73<!--tex4ht:ref: fig:freq_response_cheby16ord --></a> (their bottom-most plots). &nbsp;&nbsp;<!--l. 3898--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
<!--l. 3908-->
<p class="noindent">
<a id="x55-200151r7"></a> <span id="textcolor228"><span class="ec-lmbx-10x-x-109">Application 3.7.</span></span> <span class="ec-lmbx-10x-x-109">Estimating the frequency response of a sound</span> <span class="ec-lmbx-10x-x-109">board using a cable. </span>The idea here is to estimate an impulse response <!--l. 3909--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>δ</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></math> and then obtain a frequency response <!--l. 3909--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mstyle mathvariant="script"></mstyle><mi>F</mi><mo class="MathClass-open" stretchy="false">{</mo><mi>δ</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-close" stretchy="false">}</mo></math>, continuing the tests conducted in Application&nbsp;<a href="ak_dsp_bookse14.html#x21-75097r4">1.4<!--tex4ht:ref: app:latency --></a> (the same topic in be further discussed in Application&nbsp;<a href="ak_dsp_bookse59.html#x69-250037r5">4.5<!--tex4ht:ref: app:smoothingFFT --></a>).
</p>
<!--l. 3911-->
<p class="indent">
Note that shifting a signal in time does not alter the magnitude of the spectrum. But choosing the “time origin” is important for the spectrum phase. For the specific signal described in Application&nbsp;<a href="ak_dsp_bookse14.html#x21-75097r4">1.4<!--tex4ht:ref: app:latency --></a>, the first task is then to isolate one of the four “impulses” (recall they are just gross approximations to <!--l. 3917--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>δ</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></math>). Here it is chosen the segment that starts at sample <!--l. 3917--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>1</mn><mn>0</mn><mn>2</mn><mn>6</mn></math>, which is when the second impulse <!--l. 3917--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> is positioned.
</p>
<figure class="figure">
<p><a id="x55-20015275"></a></p>
<!--l. 3921-->
<p class="noindent">
<img src="./Figures/loopbackFreqResponsePhase.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.75: </span><span class="content">Sound system phase frequency response <!--l. 3922--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>∠</mi><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo></math> estimated from an impulse response.</span>
</figcaption>
<!--tex4ht:label?: x55-20015275 -->
</figure>
<!--l. 3925-->
<p class="indent">
Listing&nbsp;<a href="#x55-200153r46">3.46<!--tex4ht:ref: code:snip_systems_phase_estimation --></a> estimates the phase from the estimated <!--l. 3925--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo></math> considering the response to the second impulse <!--l. 3925--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> at <!--l. 3925--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>1</mn><mn>0</mn><mn>2</mn><mn>6</mn></math>.
</p>
<!--l. 3926-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.46: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_phase_estimation.m</span>
</figcaption>
<!--tex4ht:label?: x55-200153r3.16 -->
<pre class="lstinputlisting" id="listing-124"><span class="label"><a id="x55-200155r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">readwav</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">impulseResponses</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200156r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">nstart</span></span><span style="color:#000000"><span class="ec-lmtt-9">=11026;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">when</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">second</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">\</span></span><span style="color:#005900"><span class="ec-lmtt-9">delta</span></span><span style="color:#005900"><span class="ec-lmtt-9">[</span></span><span style="color:#005900"><span class="ec-lmtt-9">n</span></span><span style="color:#005900"><span class="ec-lmtt-9">]</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">occurs</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">impulses</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"><span class="ec-lmtt-9">wav</span></span> 
<span class="label"><a id="x55-200157r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">nend</span></span><span style="color:#000000"><span class="ec-lmtt-9">=22050;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">segment</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">ends</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">before</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">third</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">\</span></span><span style="color:#005900"><span class="ec-lmtt-9">delta</span></span><span style="color:#005900"><span class="ec-lmtt-9">[</span></span><span style="color:#005900"><span class="ec-lmtt-9">n</span></span><span style="color:#005900"><span class="ec-lmtt-9">]</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">impulses</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"><span class="ec-lmtt-9">wav</span></span> 
<span class="label"><a id="x55-200158r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">double</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">nstart</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">nend</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">segment</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">cast</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">h</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">double</span></span> 
<span class="label"><a id="x55-200159r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">it</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">convenient</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">make</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">N</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">an</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">even</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">use</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">N</span></span><span style="color:#005900"><span class="ec-lmtt-9">/2</span></span> 
<span class="label"><a id="x55-200160r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">FFT</span></span> 
<span class="label"><a id="x55-200161r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">unwrap</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">angle</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2+1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">unwrap</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">phase</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">positive</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">freqs</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span> 
<span class="label"><a id="x55-200162r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/1000;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">create</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">abscissa</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">kHz</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Fs</span></span><span style="color:#005900"><span class="ec-lmtt-9">/</span></span><span style="color:#005900"><span class="ec-lmtt-9">N</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">is</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bin</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">width</span></span> 
<span class="label"><a id="x55-200163r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">handler</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">xlabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">f</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">kHz</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">)</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ylabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">\</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">angle</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">{</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">H</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">f</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">)</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">}</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">rad</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">)</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x55-200164r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">k1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1500;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">k2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=4000;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">makedatatip</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">handler</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[</span></span><span style="color:#000000"><span class="ec-lmtt-9">k1</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">k2</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">choose</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">any</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">2</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">points</span></span> 
<span class="label"><a id="x55-200165r11"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Calculate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">derivative</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">as</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">slope</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Convert</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">from</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">kHz</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">rad</span></span><span style="color:#005900"><span class="ec-lmtt-9">/</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">first</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span> 
<span class="label"><a id="x55-200166r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">groupDelayInSeconds</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">atan2</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">k2</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">k1</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*1000*(</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">k2</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">k1</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span>
  </pre>
<!--l. 3941-->
<p class="indent">
Figure&nbsp;<a href="#x55-20015275">3.75<!--tex4ht:ref: fig:loopbackFreqResponsePhase --></a> shows the obtained phase. Because the phase is linear, the group delay can be estimated as suggested in Listing&nbsp;<a href="ak_dsp_bookse43.html#x52-187001r28">3.28<!--tex4ht:ref: code:groupDelayLinearPhase --></a>, by choosing two points and calculating the line slope in line 12. In this case the result was 45.573&nbsp;ms, which is consistent with the estimate conducted in time-domain in Application&nbsp;<a href="ak_dsp_bookse14.html#x21-75097r4">1.4<!--tex4ht:ref: app:latency --></a>. &nbsp; &nbsp;<!--l. 3946--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
<!--l. 3948-->
<p class="noindent">
<a id="x55-200169r8"></a> <span id="textcolor229"><span class="ec-lmbx-10x-x-109">Application 3.8.</span></span> <span class="ec-lmbx-10x-x-109">Interpreting the impulse response for line topology</span> <span class="ec-lmbx-10x-x-109">identification in DSL. </span>In DSL, loop qualification consists in determining if a given line under analysis is able to support the desired DSL service. Identifying the topology of a given telephone line means identifying its line sections and is helpful for the loop qualification. These sections can be serial sections or <span class="ec-lmri-10x-x-109">bridge</span> <span class="ec-lmri-10x-x-109">taps</span><a id="dx55-200170"></a>. Roughly speaking, a bridge tap is a derivation that is not terminated and causes unwanted signal reflections (echoes). Both types of sections have essentially two attributes: the length of the section and the type of cable used, which here is assumed to be entirely described by the gauge (or equivalently, the diameter) of the conductors. Therefore, the topology of a line under analysis can be considered as a set <!--l. 3950--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Θ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mrow><mo fence="true" form="prefix"> {</mo><mrow><msub><mrow><mi>𝜃</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><mspace width="0.28em" class="thickpace"></mspace><msub><mrow><mi>𝜃</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><mspace width="0.28em" class="thickpace"></mspace><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mspace width="0.28em" class="thickpace"></mspace><msub><mrow><mi>𝜃</mi></mrow><mrow><msub><mrow><mi>n</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></msub></mrow><mo fence="true" form="postfix">}</mo></mrow></math>, where the subset <!--l. 3951--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>𝜃</mi></mrow><mrow><mi>k</mi></mrow></msub></math>, with <!--l. 3951--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-punc" stretchy="false">.</mo><mo class="MathClass-punc" stretchy="false">.</mo><mo class="MathClass-punc" stretchy="false">.</mo><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>n</mi></mrow><mrow><mi>s</mi></mrow></msub></math>, represents the <!--l. 3951--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>k</mi></math>-th line section from a port at the central office to the port at the costumer premises equipment, and <!--l. 3951--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>n</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is the number of sections that composes the subscriber line. Each subset <!--l. 3951--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>𝜃</mi></mrow><mrow><mi>k</mi></mrow></msub></math> is composed by the parameters <!--l. 3952--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>𝜃</mi></mrow><mrow><mi>k</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mrow><mo fence="true" form="prefix"> {</mo><mrow><msub><mrow><mi>τ</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>l</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>ϕ</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow><mo fence="true" form="postfix">}</mo></mrow></math> where <!--l. 3953--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>τ</mi></mrow><mrow><mi>k</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">∈</mo><mo class="MathClass-open" stretchy="false">{</mo><mstyle class="text"><mtext class="textrm" mathvariant="normal">“serial”,“bridge&nbsp;tap”</mtext></mstyle><mo class="MathClass-close" stretchy="false">}</mo></math>, <!--l. 3953--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>l</mi></mrow><mrow><mi>k</mi></mrow></msub></math>, and <!--l. 3953--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>ϕ</mi></mrow><mrow><mi>k</mi></mrow></msub></math> are, respectively, the type of section, its length, and the cable gauge.
</p>
<!--l. 3955-->
<p class="indent">
</p><p>For many practical lines, the impulse response is composed by a series of positive (or upward) pulses delayed in time. Each succeeding pulse is generated by the part of the signal transmitted through the line discontinuities and multi-reflections suffered by the input</p>
signal. Each “path” taken by the input signal into the line defines a pulse in the output.
<p></p>
<!--l. 3957-->
<p class="indent">
The following discussion will suggest how the impulse response can be interpreted. Figure&nbsp;<a href="#x55-200171r1">3.76(a)<!--tex4ht:ref: fig:DELTpaths --></a> (top) depicts an example of a topology with six line sections and two bridge taps in the third and fifth line section, respectively. Figure&nbsp;<a href="#x55-200171r1">3.76(a)<!--tex4ht:ref: fig:DELTpaths --></a> (bottom) also shows the first four (strongest) possible paths that the input signal can follow, from port 1 to port 2. Figure&nbsp;<a href="#x55-200172r2">3.76(b)<!--tex4ht:ref: fig:DELTsignal --></a> shows the corresponding (simulated) impulse response <!--l. 3958--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></math> of the line topology depicted in Figure&nbsp;<a href="#x55-200171r1">3.76(a)<!--tex4ht:ref: fig:DELTpaths --></a>. The relation between the signal paths and the pulses in the <!--l. 3958--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></math> can be observed from the arrival times of the positive pulses, <!--l. 3958--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>t</mi></mrow><mrow><mn>1</mn></mrow></msub></math> to <!--l. 3958--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>t</mi></mrow><mrow><mn>4</mn></mrow></msub></math>.
</p>
<figure class="figure">
<p><a id="x55-20017376"></a></p>
<a id="x55-200171r1"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="FiguresNonScript/DELTpaths.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(a) </span>
</div>
</td>
</tr>

</tbody></table>
</div>
<a id="x55-200172r2"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="FiguresNonScript/DELTsignal.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(b) </span>
</div>
</td>
</tr>

</tbody></table>
</div>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.76: </span><span class="content">DSL line topology and corresponding impulse response: (a) from top to bottom: topology and some of the possible signal paths; (b) corresponding impulse response with points indicating the estimated time of arrival of the pulses.</span>
</figcaption>
<!--tex4ht:label?: x55-20017376 -->
</figure>
<!--l. 3969-->
<p class="indent">
For example, the length of path A can be estimated by processing <!--l. 3969--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></math> to extract the time of arrival <!--l. 3969--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>t</mi></mrow><mrow><mi>A</mi></mrow></msub></math> of the first pulse. Having the time, the path length is obtained by considering that the signal propagates at velocity <!--l. 3969--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>v</mi></mrow><mrow><mi>p</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn><mn>7</mn><mi>c</mi></math>, where <!--l. 3969--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>c</mi> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>3</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mn>8</mn></mrow></msup></math> m/s is the speed of light in vacuum. For example, assume the total serial length <!--l. 3969--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>5</mn><mn>0</mn><mn>0</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>3</mn><mn>0</mn><mn>0</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>3</mn><mn>5</mn><mn>0</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>8</mn><mn>5</mn><mn>0</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>0</mn><mn>0</mn><mn>0</mn></math>&nbsp;m of the line is not known and must be automatically estimated by the DSL service provider. Assume an estimate of <!--l. 3970--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></math> was available and <!--l. 3970--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>t</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>9</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>3</mn><mn>5</mn></math>&nbsp;<!--l. 3970--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>μ</mi></math>s is obtained by signal processing (in our case, by inspection of Figure&nbsp;<a href="#x55-200172r2">3.76(b)<!--tex4ht:ref: fig:DELTsignal --></a>). Hence, the estimate for the total length is <!--l. 3970--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>L</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>t</mi></mrow><mrow><mi>A</mi></mrow></msub><msub><mrow><mi>v</mi></mrow><mrow><mi>p</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>8</mn><mn>7</mn><mn>9</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>4</mn></math>&nbsp;m. The length of the bridge taps can also be estimated along this line of reasoning, assuming <!--l. 3971--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>L</mi></mrow><mrow><mi>A</mi></mrow></msub></math> has already been estimated.
</p>
<!--l. 3973-->
<p class="indent">
The presence of each bridge tap originates a new path and, as a consequence, a new pulse in the impulse response. In the example, the corresponding paths are B and C, which correspond to the arrival times <!--l. 3973--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>t</mi></mrow><mrow><mi>B</mi></mrow></msub></math> e <!--l. 3973--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>t</mi></mrow><mrow><mi>C</mi></mrow></msub></math>) of the second and third pulses, respectively. Given that the shortest bridge tap (the fifth section) has length <!--l. 3973--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>l</mi></mrow><mrow><mn>5</mn></mrow></msub></math>, the total length traveled by its corresponding pulse can be written as <!--l. 3974--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>L</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>L</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><msub><mrow><mi>l</mi></mrow><mrow><mn>5</mn></mrow></msub></math>. Thus, the length of the first bridge tap can be estimated by <!--l. 3976--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mover accent="true"><mrow><msub><mrow><mi>l</mi></mrow><mrow><mn>5</mn></mrow></msub></mrow><mo accent="true">^</mo></mover> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mrow><mo fence="true" form="prefix"> (</mo><mrow><msub><mrow><mi>t</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">−</mo><msub><mrow><mi>t</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow> <mrow><mn>2</mn></mrow></mfrac> <msub><mrow><mi>v</mi></mrow><mrow><mi>p</mi></mrow></msub></math>. Use the same reasoning to estimate the length of the longest bridge tap (third section).
</p>
<!--l. 3979-->
<p class="indent">
Topology identification is an involved problem. For example, the path D is caused by multiple reflections, which can cause several problems. And the presented analysis has restrictions. For example, it is not possible to determine the position of bridge taps from the impulse response. If the position of the bridge taps in Figure&nbsp;<a href="#x55-200171r1">3.76(a)<!--tex4ht:ref: fig:DELTpaths --></a> change, the path traveled by the signal remains the same and, consequently, its signature on <!--l. 3979--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></math> does not change. &nbsp;&nbsp;<!--l. 3980--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
<!--l. 3982-->
<p class="noindent">
</p><p><a id="x55-200174r9"></a> <span id="textcolor230"><span class="ec-lmbx-10x-x-109">Application 3.9.</span></span> <span class="ec-lmbx-10x-x-109">Understanding and compensating the delay imposed by a</span> <span class="ec-lmbx-10x-x-109">system. </span>All practical systems impose some delay or distortion to signals. For example, in communication systems the channel is typically <span class="ec-lmri-10x-x-109">frequency-selective</span><a id="dx55-200175"></a>, meaning that distinct frequency components of the signal get attenuated and delayed in a way that the output signal is a distorted version of the input signal. Besides this effect, systems impose a delay (the output is observed only after an interval of time from the instant the input was generated, as studied in Application&nbsp;<a href="ak_dsp_bookse14.html#x21-75119r5">1.5<!--tex4ht:ref: app:sound_board_quantizer --></a>) that is often characterized by its group-delay.</p>
Better understanding how to predict this delay when the system is LTI is the subject of the following discussion.
<p></p>
<figure class="figure">
<p><a id="x55-20017877"></a></p>
<a id="x55-200176r1"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="Figures/butter_8_impulse_response.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(a)</span> <span class="ec-lmr-9">Impulse</span> <span class="ec-lmr-9">response</span>
</div>
</td>
</tr>

</tbody></table>
</div>
<a id="x55-200177r2"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="Figures/butter_8_group_delay.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(b)</span> <span class="ec-lmr-9">Group</span> <span class="ec-lmr-9">delay</span>
</div>
</td>
</tr>

</tbody></table>
</div>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.77: </span><span class="content">Impulse response and group delay of IIR filter obtained with <span class="ec-lmss-10x-x-109">[B,A]=butter(8,0.3)</span>. The impulse response was truncated to 50 samples.</span>
</figcaption>
<!--tex4ht:label?: x55-20017877 -->
</figure>
<figure class="figure">
<p><a id="x55-20018178"></a></p>
<a id="x55-200179r1"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="Figures/butter_8_input_signal.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(a)</span> <span class="ec-lmr-9">Input</span> <span class="ec-lmr-9">signal</span>
</div>
</td>
</tr>

</tbody></table>
</div>
<a id="x55-200180r2"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="Figures/butter_8_input_fft.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(b)</span> <span class="ec-lmr-9">FFT</span> <span class="ec-lmr-9">of</span> <span class="ec-lmr-9">the</span> <span class="ec-lmr-9">input</span>
</div>
</td>
</tr>

</tbody></table>
</div>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.78: </span><span class="content">Input signal <!--l. 3999--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> and its FFT.</span>
</figcaption>
<!--tex4ht:label?: x55-20018178 -->
</figure>
<!--l. 4003-->
<p class="indent">
An example of filtering is provided in the sequel using an 8-th order IIR filter obtained and analyzed with Listing&nbsp;<a href="#x55-200182r47">3.47<!--tex4ht:ref: code:snip_systems_filtering --></a>.
</p>
<!--l. 4004-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.47: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_filtering.m</span>
</figcaption>
<!--tex4ht:label?: x55-200182r3.16 -->
<pre class="lstinputlisting" id="listing-125"><span class="label"><a id="x55-200184r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(8,0.3)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">IIR</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span> 
<span class="label"><a id="x55-200185r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">impz</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,50)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">obtain</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">h</span></span><span style="color:#005900"><span class="ec-lmtt-9">[</span></span><span style="color:#005900"><span class="ec-lmtt-9">n</span></span><span style="color:#005900"><span class="ec-lmtt-9">],</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">truncated</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">50</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span> 
<span class="label"><a id="x55-200186r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">grpdelay</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">plots</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">group</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">delay</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span> 
<span class="label"><a id="x55-200187r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[1:20,20:-1:1];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">signal</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">be</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filtered</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Volts</span></span> 
<span class="label"><a id="x55-200188r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">FFT</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">x</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">be</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">read</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Volts</span></span> 
<span class="label"><a id="x55-200189r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">conv</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convolution</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">y</span></span><span style="color:#005900"><span class="ec-lmtt-9">=</span></span><span style="color:#005900"><span class="ec-lmtt-9">x</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">h</span></span>
  </pre>
<!--l. 4013-->
<p class="indent">
The truncated impulse response of this filter is depicted in Figure&nbsp;<a href="#x55-200176r1">3.77(a)<!--tex4ht:ref: fig:butter_8_impulse_response --></a> and the group delay in Figure&nbsp;<a href="#x55-200177r2">3.77(b)<!--tex4ht:ref: fig:butter_8_group_delay --></a>. An input signal <span class="ec-lmss-10x-x-109">x </span>with a triangular shape was generated and is depicted in Figure&nbsp;<a href="#x55-20018178">3.78<!--tex4ht:ref: fig:butter_8_input --></a> together with its FFT.
</p>
<figure class="figure">
<p><a id="x55-20019279"></a></p>
<!--l. 4017-->
<p class="noindent">
<img src="Figures/filtered_triangle.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.79: </span><span class="content">Input <!--l. 4018--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> and output <!--l. 4018--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> signals obtained via convolution with truncated <!--l. 4018--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>.</span>
</figcaption>
<!--tex4ht:label?: x55-20019279 -->
</figure>
<!--l. 4021-->
<p class="indent">
The result of the convolution <span class="ec-lmss-10x-x-109">y=conv(x,h) </span>is shown in Figure&nbsp;<a href="#x55-20019279">3.79<!--tex4ht:ref: fig:filtered_triangle --></a>. The input has peaks at <!--l. 4021--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>9</mn></math> and <!--l. 4021--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mn>0</mn></math>, such that <span class="ec-lmss-10x-x-109">x[19]=x[20]=20</span>, while the output peaked at <!--l. 4021--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mn>5</mn></math> with <span class="ec-lmss-10x-x-109">y[25]=19.7</span>. This delay of 5 samples could be inferred by observing that the peak of <span class="ec-lmss-10x-x-109">h </span>in Figure&nbsp;<a href="#x55-200176r1">3.77(a)<!--tex4ht:ref: fig:butter_8_impulse_response --></a> is located at sample <!--l. 4023--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>6</mn></math>. A more accurate analysis can be done via the filter’s group delay. In the case of a linear-phase FIR, the group delay is constant (the same number of samples) in the whole passband. But the current IIR has a frequency dependent group delay and the spectrum of the input signal needs to be analyzed via Figure&nbsp;<a href="#x55-20018178">3.78<!--tex4ht:ref: fig:butter_8_input --></a>.
</p>
<!--l. 4025-->
<p class="indent">
Note that most of the input signal power is concentrated at DC and the FFT coefficient <!--l. 4025--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></math> for <!--l. 4025--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></math>, which corresponds to an angle <!--l. 4025--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>4</mn><mn>0</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>1</mn><mn>5</mn><mn>7</mn><mn>1</mn></math> rad, given that <span class="ec-lmss-10x-x-109">length(x)=40 </span>is the FFT length. From Figure&nbsp;<a href="#x55-200177r2">3.77(b)<!--tex4ht:ref: fig:butter_8_group_delay --></a> or directly calculating <span class="ec-lmss-10x-x-109">gd=grpdelay(B,A,[0 0.1571])</span>, it can be observed that the group delay <!--l. 4025--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>τ</mi></mrow><mrow><mi>g</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo class="MathClass-close" stretchy="false">)</mo></math> of the filter for components at <!--l. 4025--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></math> and <!--l. 4025--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></math> is <!--l. 4025--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>τ</mi></mrow><mrow><mi>g</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>0</mn><mn>3</mn></math> and <!--l. 4025--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>τ</mi></mrow><mrow><mi>g</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>1</mn><mn>5</mn><mn>7</mn><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>1</mn><mn>0</mn><mn>4</mn><mn>3</mn></math> samples, respectively. When using Figure&nbsp;<a href="#x55-200177r2">3.77(b)<!--tex4ht:ref: fig:butter_8_group_delay --></a>, note that <!--l. 4025--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi mathvariant="normal">Ω</mi></math> should be normalized and the value read at <!--l. 4025--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi mathvariant="normal">Ω</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>π</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>0</mn><mn>5</mn></math>. The group delay at the frequencies of interest is approximately 5 samples, which explains the delay imposed by the filter in Figure&nbsp;<a href="#x55-20019279">3.79<!--tex4ht:ref: fig:filtered_triangle --></a>.
</p>
<figure class="figure">
<p><a id="x55-20019380"></a></p>
<!--l. 4029-->
<p class="noindent">
<img src="Figures/filtered_triangle_with_filter.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.80: </span><span class="content">Input <!--l. 4030--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> and output <!--l. 4030--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> signals obtained via <span class="ec-lmss-10x-x-109">filter</span>.</span>
</figcaption>
<!--tex4ht:label?: x55-20019380 -->
</figure>
<!--l. 4033-->
<p class="indent">
Instead of using convolution, the output was obtained with <span class="ec-lmss-10x-x-109">y=filter(B,A,x)</span>. In this case, the vector <span class="ec-lmss-10x-x-109">y </span>is the one depicted in Figure&nbsp;<a href="#x55-20019380">3.80<!--tex4ht:ref: fig:filtered_triangle_with_filter --></a>, which should be compared to Figure&nbsp;<a href="#x55-20019279">3.79<!--tex4ht:ref: fig:filtered_triangle --></a>. Because <!--l. 4033--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>N</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn><mn>0</mn></math> and <!--l. 4033--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>N</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn><mn>0</mn></math> samples, the convolution in Figure&nbsp;<a href="#x55-20019279">3.79<!--tex4ht:ref: fig:filtered_triangle --></a> led to <!--l. 4033--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>N</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn><mn>0</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>5</mn><mn>0</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn><mn>9</mn></math> samples. In contrast, Figure&nbsp;<a href="#x55-20019380">3.80<!--tex4ht:ref: fig:filtered_triangle_with_filter --></a> shows that <span class="ec-lmss-10x-x-109">filter </span>makes sure that <!--l. 4033--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>N</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>N</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn><mn>0</mn></math> samples. To visualize the tail of the convolution, one should add zero samples to the end of <span class="ec-lmss-10x-x-109">x</span>. For example, the extra 20 samples in <span class="ec-lmss-10x-x-109">y=filter(B,A,[x zeros(1,20)]) </span>are enough to visualize the “triangle” in <span class="ec-lmss-10x-x-109">y</span>.
</p>
<figure class="figure">
<p><a id="x55-20019481"></a></p>
<!--l. 4037-->
<p class="noindent">
<img src="Figures/filtered_triangle_aligned.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.81: </span><span class="content">Output <!--l. 4038--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> aligned with the input <!--l. 4038--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> and corresponding error <!--l. 4038--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>.</span>
</figcaption>
<!--tex4ht:label?: x55-20019481 -->
</figure>
<!--l. 4041-->
<p class="indent">
In some situations it is necessary to compare the error between the input and filtered output signals. But this requires compensating the filter delay and eliminating the convolution tail. Figure&nbsp;<a href="#x55-20019481">3.81<!--tex4ht:ref: fig:filtered_triangle_aligned --></a> was obtained with:
</p>
<!--l. 4043-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.48: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_compensate_grpdelay.m</span>
</figcaption>
<!--tex4ht:label?: x55-200195r3.16 -->
<pre class="lstinputlisting" id="listing-126"><span class="label"><a id="x55-200197r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[1:20,20:-1:1];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">signal</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">be</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filtered</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Volts</span></span> 
<span class="label"><a id="x55-200198r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(8,0.3)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">IIR</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span> 
<span class="label"><a id="x55-200199r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">impz</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,50)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">truncate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">h</span></span><span style="color:#005900"><span class="ec-lmtt-9">[</span></span><span style="color:#005900"><span class="ec-lmtt-9">n</span></span><span style="color:#005900"><span class="ec-lmtt-9">]</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">50</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span> 
<span class="label"><a id="x55-200200r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">conv</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convolution</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">y</span></span><span style="color:#005900"><span class="ec-lmtt-9">=</span></span><span style="color:#005900"><span class="ec-lmtt-9">x</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">h</span></span> 
<span class="label"><a id="x55-200201r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">force</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">both</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">x</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">y</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">be</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">column</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">vectors</span></span> 
<span class="label"><a id="x55-200202r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">meanGroupDelay</span></span><span style="color:#000000"><span class="ec-lmtt-9">=5</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">estimated</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">"</span></span><span style="color:#005900"><span class="ec-lmtt-9">best</span></span><span style="color:#005900"><span class="ec-lmtt-9">"</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">delay</span></span> 
<span class="label"><a id="x55-200203r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:</span></span><span style="color:#000000"><span class="ec-lmtt-9">meanGroupDelay</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">compensate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">delay</span></span> 
<span class="label"><a id="x55-200204r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">+1:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">eliminate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">convolution</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">tail</span></span> 
<span class="label"><a id="x55-200205r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">mse</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">mean</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">squared</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">error</span></span> 
<span class="label"><a id="x55-200206r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">SNR</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">mse</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">estimate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">signal</span></span><span style="color:#005900"><span class="ec-lmtt-9">/</span></span><span style="color:#005900"><span class="ec-lmtt-9">noise</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">ratio</span></span> 
<span class="label"><a id="x55-200207r11"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">(0:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">on</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span> 
<span class="label"><a id="x55-200208r12"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">(0:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">r</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">aligned</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">with</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span> 
<span class="label"><a id="x55-200209r13"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">(0:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">k</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">e</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"><span class="ec-lmtt-9">g</span></span><span style="color:#005900"><span class="ec-lmtt-9">.,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">error</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">after</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">alignment</span></span>
  </pre>
<!--l. 4059-->
<p class="indent">
The mean squared error (MSE) in this case is 0.0363, which is equivalent to an SNR of 35.97&nbsp;dB.
</p>
<!--l. 4061-->
<p class="indent">
Decreasing the filter cutoff frequency to <!--l. 4061--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>1</mn></math> rad via <span class="ec-lmss-10x-x-109">[B,A]=butter(8,0.1) </span>and adjusting the variable <span class="ec-lmss-10x-x-109">meanGroupDelay </span>to 16 samples (<span class="ec-lmss-10x-x-109">meanGroupDelay=17 </span>leads to a slightly better result) makes the SNR decrease to 23.22&nbsp;dB because more high frequency components of <span class="ec-lmss-10x-x-109">x </span>are filtered out. &nbsp; &nbsp;<!--l. 4062--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
<!--l. 4064-->
<p class="noindent">
<a id="x55-200212r10"></a> <span id="textcolor231"><span class="ec-lmbx-10x-x-109">Application 3.10.</span></span> <span class="ec-lmbx-10x-x-109">Taking the filter memory in account. </span>When using <span class="ec-lmss-10x-x-109">filter </span>in block processing, it is important to take the filter’s memory in account. By default, this memory is assumed to be zero (the system is relaxed), but this can be modified with the command <span class="ec-lmss-10x-x-109">filtic</span>, which allows to set the filter’s initial conditions.
</p>
<figure class="figure">
<p><a id="x55-20021382"></a></p>
<!--l. 4070-->
<p class="noindent">
<img src="Figures/filtered_triangle_without_memory.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.82: </span><span class="content">Filtering in blocks of <!--l. 4071--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn></math> samples but not updating the filter’s memory.</span>
</figcaption>
<!--tex4ht:label?: x55-20021382 -->
</figure>
<!--l. 4074-->
<p class="indent">
Instead of using <span class="ec-lmss-10x-x-109">y=filter(B,A,x) </span>to completely filter <span class="ec-lmss-10x-x-109">x </span>in one function call, it is useful to know how to segment the input <span class="ec-lmss-10x-x-109">x </span>in blocks of <!--l. 4074--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>N</mi></math> samples and repeatedly invoke <span class="ec-lmss-10x-x-109">filter </span>until filtering all blocks. This is illustrated in Listing&nbsp;<a href="#x55-200214r49">3.49<!--tex4ht:ref: code:snip_systems_filtering_blocks --></a>.
</p>
<!--l. 4076-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.49: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_filtering_blocks.m</span>
</figcaption>
<!--tex4ht:label?: x55-200214r3.16 -->
<pre class="lstinputlisting" id="listing-127"><span class="label"><a id="x55-200216r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[1:20,20:-1:1];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">signal</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">be</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filtered</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Volts</span></span> 
<span class="label"><a id="x55-200217r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(8,0.3)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">IIR</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span> 
<span class="label"><a id="x55-200218r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">block</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">length</span></span> 
<span class="label"><a id="x55-200219r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">numBlocks</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">floor</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">blocks</span></span> 
<span class="label"><a id="x55-200220r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Zi</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">filtic</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,0)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">initialize</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">memory</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">with</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">zero</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span> 
<span class="label"><a id="x55-200221r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">size</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">pre</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">allocate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">space</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span> 
<span class="label"><a id="x55-200222r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">for</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">numBlocks</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1</span></span> 
<span class="label"><a id="x55-200223r8"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">startSample</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">begin</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">current</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">block</span></span> 
<span class="label"><a id="x55-200224r9"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">endSample</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">startSample</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">end</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">current</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">block</span></span> 
<span class="label"><a id="x55-200225r10"></a><span class="ec-lmr-6">10</span></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">xb</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">startSample</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">endSample</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">extract</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">current</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">block</span></span> 
<span class="label"><a id="x55-200226r11"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">yb</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Zi</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">xb</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Zi</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">update</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">memory</span></span> 
<span class="label"><a id="x55-200227r12"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">startSample</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">endSample</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">yb</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">update</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">vector</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">y</span></span> 
<span class="label"><a id="x55-200228r13"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span>
  </pre>
<!--l. 4090-->
<p class="indent">
These commands obtain the same results of Figure&nbsp;<a href="#x55-20019380">3.80<!--tex4ht:ref: fig:filtered_triangle_with_filter --></a> because the filter memory is updated via <span class="ec-lmss-10x-x-109">[yb,Zi]=filter(B,A,xb,Zi)</span>. However, a simple modification from this command to <span class="ec-lmss-10x-x-109">yb=filter(B,A,xb)</span>, which disregards the filter memory leads to the result in Figure&nbsp;<a href="#x55-20021382">3.82<!--tex4ht:ref: fig:filtered_triangle_without_memory --></a>. In this case, the filter has zeroed memory at the beginning of each block of <!--l. 4091--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn></math> samples. The strong distortion on <!--l. 4091--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> in this case indicates that it is crucial to take care of updating the filter memory when dealing with signal processing in blocks. &nbsp; &nbsp;<!--l. 4092--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
<!--l. 4094-->
<p class="noindent">
<a id="x55-200229r11"></a> <span id="textcolor232"><span class="ec-lmbx-10x-x-109">Application 3.11.</span></span> <span class="ec-lmbx-10x-x-109">Processing sample blocks using convolution in matrix</span> <span class="ec-lmbx-10x-x-109">notation.</span>
</p>
<!--l. 4097-->
<p class="indent">
As Eq.&nbsp;(<a href="ak_dsp_bookse34.html#x43-123001r6">3.6<!--tex4ht:ref: eq:convolutionInMatrixNotation --></a>) indicates, the convolution between two finite-length signals can be represented in matrix notation. However, in many applications, block processing is adopted, where one of the signals has an infinite duration and is segmented into successive blocks of <!--l. 4097--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>N</mi></math> samples, as in Eq.&nbsp;(<a href="ak_dsp_bookse4.html#x11-19003r8">1.8<!--tex4ht:ref: eq:block_processing --></a>).
</p>
<!--l. 4099-->
<p class="indent">
Listing&nbsp;<a href="#x55-200230r50">3.50<!--tex4ht:ref: code:snip_systems_matrixBlockConvolutions --></a> illustrates the extra manipulations that are required to use a matrix notation for the convolution of each block and get the correct convolution result.
</p>
<!--l. 4101-->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.50: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_matrixBlockConvolutions.m</span>
</figcaption>
<!--tex4ht:label?: x55-200230r3.16 -->
<pre class="lstinputlisting" id="listing-128"><span class="label"><a id="x55-200232r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">transpose</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:1000)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">eventually</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">long</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">signal</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"><span class="ec-lmtt-9">as</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">column</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">vector</span></span> 
<span class="label"><a id="x55-200233r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ones</span></span><span style="color:#000000"><span class="ec-lmtt-9">(3,1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">non</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">zero</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">finite</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">length</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">impulse</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">response</span></span> 
<span class="label"><a id="x55-200234r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Nh</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">impulse</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">response</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">non</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">zero</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span> 
<span class="label"><a id="x55-200235r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Nb</span></span><span style="color:#000000"><span class="ec-lmtt-9">=5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">block</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">segment</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">length</span></span> 
<span class="label"><a id="x55-200236r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nbout</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Nb</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nh</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">each</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">block</span></span> 
<span class="label"><a id="x55-200237r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Nx</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span> 
<span class="label"><a id="x55-200238r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">hmatrix</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">convmtx</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nb</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">impulse</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">resp</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">matrix</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">notation</span></span> 
<span class="label"><a id="x55-200239r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">beginNdx</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">initialize</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">index</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">first</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">sample</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">current</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">block</span></span> 
<span class="label"><a id="x55-200240r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nh</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nx</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1,1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">pre</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">allocate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">space</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">convolution</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span> 
<span class="label"><a id="x55-200241r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">for</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">beginNdx</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1:</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nb</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nx</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">loop</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">over</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">all</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">blocks</span></span> 
<span class="label"><a id="x55-200242r11"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">endIndex</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">beginNdx</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nb</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">current</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">block</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">end</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">index</span></span> 
<span class="label"><a id="x55-200243r12"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">xblock</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">beginNdx</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">endIndex</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">block</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">as</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">column</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">vector</span></span> 
<span class="label"><a id="x55-200244r13"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">yblock</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">hmatrix</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">xblock</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">perform</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">convolution</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">this</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">block</span></span> 
<span class="label"><a id="x55-200245r14"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">beginNdx</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">beginNdx</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nbout</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">beginNdx</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">beginNdx</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nbout</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">...</span></span> 
<span class="label"><a id="x55-200246r15"></a><span class="ec-lmr-6">15</span></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">yblock</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">add</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">parcial</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">result</span></span> 
<span class="label"><a id="x55-200247r16"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x55-200248r17"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">conv</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">compare</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">error</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">with</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">result</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">from</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">conv</span></span>
  </pre>
<!--l. 4103-->
<p class="indent">
</p><p>The basic idea is that the end samples (“tails”) of the partial convolution results need to be properly added to the final result. In the example of Listing&nbsp;<a href="#x55-200230r50">3.50<!--tex4ht:ref: code:snip_systems_matrixBlockConvolutions --></a>, the impulse response has <span class="ec-lmss-10x-x-109">Nh=3 </span>non-zero samples and the block length is <span class="ec-lmss-10x-x-109">Nb=5</span>. The convolution matrix <span class="ec-lmss-10x-x-109">hmatrix </span>has</p>
dimension <!--l. 4103--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>7</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>5</mn></math> and each partial convolution result corresponds to <span class="ec-lmss-10x-x-109">Nbout=7 </span>samples. For instance, the last two samples of <span class="ec-lmss-10x-x-109">yblock </span>of the first block need to be added to the first two samples of <span class="ec-lmss-10x-x-109">yblock </span>obtained of the second block, and so on. This is similar to the overlap-add method illustrated in Listing&nbsp;<a href="ak_dsp_bookse34.html#x43-128016r9">3.9<!--tex4ht:ref: code:snip_systems_overlapAdd --></a> but without the FFT-based processing. &nbsp; &nbsp;<!--l. 4104--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
<p></p>
<!--l. 4106-->
<p class="noindent">
<a id="x55-200249r12"></a> <span id="textcolor233"><span class="ec-lmbx-10x-x-109">Application 3.12.</span></span> <span class="ec-lmbx-10x-x-109">Power and energy at the output of a LTI system. </span>In many applications it is important to estimate the power at the output of a system. The following result is valid for LTI systems.
</p>
<div class="newtheorem">
<!--l. 4110-->
<p class="noindent">
<span class="head"> <a id="x55-200250r3"></a> <span class="ec-lmbx-10x-x-109">Theorem 3.</span> </span> <span class="ec-lmbx-10x-x-109">Power at the output of a discrete-time LTI system</span>.
</p>

<table class="equation">
<tbody><tr>
<td>
<!--l. 4112-->
<p class="indent">
</p>
<!--l. 4112-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <mstyle id="x55-200251r97" class="label"></mstyle><!--endlabel--><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>E</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><munderover accentunder="false" accent="false"><mrow><mo>∑</mo> </mrow><mrow><mi>i</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>L</mi></mrow></munderover><munderover accentunder="false" accent="false"><mrow><mo> ∑</mo></mrow><mrow> <mi>j</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mi>j</mi><mo class="MathClass-rel" stretchy="false">≠</mo><mi>i</mi></mrow><mrow><mi>L</mi></mrow></munderover><msub><mrow><mi>h</mi></mrow><mrow> <mi>i</mi></mrow></msub><msub><mrow><mi>h</mi></mrow><mrow><mi>j</mi></mrow></msub><msub><mrow><mi>R</mi></mrow><mrow><mi>x</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>j</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>i</mi><mo class="MathClass-close" stretchy="false">)</mo> </math>
</td>
<td class="eq-no">
(3.97)
</td>
</tr>

</tbody></table>
<!--l. 4116-->
<p class="indent">
where <!--l. 4116--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>R</mi></mrow><mrow><mi>x</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>j</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>i</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>𝔼</mi><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-open" stretchy="false">⟨</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mo class="MathClass-open" stretchy="false">(</mo><mi>j</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>i</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-close" stretchy="false">⟩</mo><mo class="MathClass-close" stretchy="false">]</mo></math> is the empirical (time-averaged) autocorrelation and <!--l. 4116--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>E</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><msubsup><mrow> <mi class="MathClass-op">∑</mi><mo> ⁡<!--FUNCTION APPLICATION--></mo> <!--nolimits--></mrow><mrow><mi>i</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>L</mi></mrow></msubsup><msubsup><mrow><mi>h</mi></mrow><mrow><mi>i</mi></mrow><mrow><mn>2</mn></mrow></msubsup></math> is the energy of <!--l. 4116--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>. If <!--l. 4116--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>R</mi></mrow><mrow><mi>x</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mi class="MathClass-op">∀</mi><mo> ⁡<!--FUNCTION APPLICATION--></mo><mi>k</mi></math> and <!--l. 4116--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>k</mi><mo class="MathClass-rel" stretchy="false">≠</mo><mn>0</mn></math>, then <!--l. 4116--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>E</mi></mrow><mrow><mi>h</mi></mrow></msub></math>.
</p>
<!--l. 4118-->
<p class="indent">
</p><p>Proof sketch: Assume a short impulse response <!--l. 4119--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>h</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>h</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>2</mn><mo class="MathClass-close" stretchy="false">]</mo></math> with <!--l. 4119--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>L</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn></math>. Take three consecutive output values starting at an arbitrary time instant, such as <!--l. 4119--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn></math>, for example. These values will be <!--l. 4120--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo><msub><mrow><mi>h</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>4</mn><mo class="MathClass-close" stretchy="false">]</mo><msub><mrow><mi>h</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo><msub><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></msub></math>, <!--l. 4120--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo><msub><mrow><mi>h</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo><msub><mrow><mi>h</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>4</mn><mo class="MathClass-close" stretchy="false">]</mo><msub><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></msub></math> and <!--l. 4120--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>7</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>7</mn><mo class="MathClass-close" stretchy="false">]</mo><msub><mrow><mi>h</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo><msub><mrow><mi>h</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo><msub><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></msub></math>. Calculating</p>
the energy <!--l. 4120--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>E</mi></mrow><mrow><mi>y</mi></mrow></msub></math> for these three samples is enough to provide insight on the solution:
<p></p>
<!--tex4ht:inline-->
<!--l. 4127-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="left" class="align-star"> <mtr><mtd columnalign="right" class="align-odd"><msub><mrow><mi>E</mi></mrow><mrow><mi>y</mi></mrow></msub></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mi>y</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>7</mn><mo class="MathClass-close" stretchy="false">]</mo><mspace width="2em"></mspace></mtd> <mtd columnalign="right" class="align-label"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr><mtr><mtd columnalign="right" class="align-odd"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">=</mo> <msubsup><mrow><mi>h</mi></mrow><mrow><mn>0</mn></mrow><mrow><mn>2</mn></mrow></msubsup><mrow><mo class="MathClass-open" fence="true" mathsize="1.19em">(</mo><mrow><msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>7</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow><mo class="MathClass-close" fence="true" mathsize="1.19em">)</mo></mrow> <mo class="MathClass-bin" stretchy="false">+</mo> <msubsup><mrow><mi>h</mi></mrow><mrow> <mn>1</mn></mrow><mrow><mn>2</mn></mrow></msubsup><mrow><mo class="MathClass-open" fence="true" mathsize="1.19em">(</mo><mrow><msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>4</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow><mo class="MathClass-close" fence="true" mathsize="1.19em">)</mo></mrow><mspace width="2em"></mspace></mtd> <mtd columnalign="right" class="align-label"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr><mtr><mtd columnalign="right" class="align-odd"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">+</mo><msubsup><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow><mrow><mn>2</mn></mrow></msubsup><mrow><mo class="MathClass-open" fence="true" mathsize="1.19em">(</mo><mrow><msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>4</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow><mo class="MathClass-close" fence="true" mathsize="1.19em">)</mo></mrow> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><msub><mrow><mi>h</mi></mrow><mrow> <mn>0</mn></mrow></msub><msub><mrow><mi>h</mi></mrow><mrow><mn>1</mn></mrow></msub><mrow><mo class="MathClass-open" fence="true" mathsize="1.19em">(</mo><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>4</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>7</mn><mo class="MathClass-close" stretchy="false">]</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow><mo class="MathClass-close" fence="true" mathsize="1.19em">)</mo></mrow><mspace width="2em"></mspace></mtd> <mtd columnalign="right" class="align-label"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr><mtr><mtd columnalign="right" class="align-odd"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">+</mo><mn>2</mn><msub><mrow><mi>h</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></msub><mrow><mo class="MathClass-open" fence="true" mathsize="1.19em">(</mo><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>4</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>7</mn><mo class="MathClass-close" stretchy="false">]</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow><mo class="MathClass-close" fence="true" mathsize="1.19em">)</mo></mrow> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><msub><mrow><mi>h</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>h</mi></mrow><mrow><mn>2</mn></mrow></msub><mrow><mo class="MathClass-open" fence="true" mathsize="1.19em">(</mo><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>4</mn><mo class="MathClass-close" stretchy="false">]</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>4</mn><mo class="MathClass-close" stretchy="false">]</mo><mspace width="2em"></mspace></mrow></mrow></mtd> <mtd columnalign="right" class="align-label"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr><mtr><mtd columnalign="right" class="align-odd"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">+</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>6</mn><mo class="MathClass-close" stretchy="false">]</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-close" fence="true" mathsize="1.19em">)</mo><mo class="MathClass-punc" stretchy="false">.</mo><mspace width="2em"></mspace></mtd> <mtd columnalign="right" class="align-label"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr></mtable></math> <!--l. 4128-->
<p class="noindent">
Taking all samples in account and using expectation, one can obtain a relation between the output and input energies <!--l. 4128--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>E</mi></mrow><mrow><mi>y</mi></mrow></msub></math> and <!--l. 4128--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>E</mi></mrow><mrow><mi>x</mi></mrow></msub></math>, respectively:
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!--l. 4129-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <msub><mrow><mi>E</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>E</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>E</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><munderover accentunder="false" accent="false"><mrow><mo>∑</mo> </mrow><mrow><mi>i</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>L</mi></mrow></munderover><munderover accentunder="false" accent="false"><mrow><mo> ∑</mo></mrow><mrow> <mi>j</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mi>j</mi><mo class="MathClass-rel" stretchy="false">≠</mo><mi>i</mi></mrow><mrow><mi>L</mi></mrow></munderover><msub><mrow><mi>h</mi></mrow><mrow> <mi>i</mi></mrow></msub><msub><mrow><mi>h</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class="MathClass-open" stretchy="false">⟨</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mo class="MathClass-open" stretchy="false">(</mo><mi>j</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>i</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-close" stretchy="false">⟩</mo> </math>
</td>
</tr>

</tbody></table>
<!--l. 4132-->
<p class="indent">
or, alternatively
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!--l. 4133-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>E</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><munderover accentunder="false" accent="false"><mrow><mo>∑</mo> </mrow><mrow><mi>i</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>L</mi></mrow></munderover><munderover accentunder="false" accent="false"><mrow><mo> ∑</mo></mrow><mrow> <mi>j</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mi>j</mi><mo class="MathClass-rel" stretchy="false">≠</mo><mi>i</mi></mrow><mrow><mi>L</mi></mrow></munderover><msub><mrow><mi>h</mi></mrow><mrow> <mi>i</mi></mrow></msub><msub><mrow><mi>h</mi></mrow><mrow><mi>j</mi></mrow></msub><msub><mrow><mi>R</mi></mrow><mrow><mi>x</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>j</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>i</mi><mo class="MathClass-close" stretchy="false">)</mo> </math>
</td>
</tr>

</tbody></table>
<!--l. 4136-->
<p class="indent">
given that <!--l. 4136--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mstyle mathvariant="script"></mstyle><mi>P</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>E</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></math>.
</p>
<!--l. 4138-->
<p class="indent">
If the input <!--l. 4138--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> does not have correlation among its samples, then it is a “white” signal (see Section&nbsp;<a href="ak_dsp_bookse12.html#x19-72000doc">1.12.1.0<!--tex4ht:ref: sec:examplesAutocorrelation --></a>) with <!--l. 4138--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>R</mi></mrow><mrow><mi>x</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></math> for <!--l. 4138--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>k</mi><mo class="MathClass-rel" stretchy="false">≠</mo><mn>0</mn></math>, such that
</p>

<table class="equation">
<tbody><tr>
<td>
<!--l. 4139-->
<p class="indent">
</p>
<!--l. 4139-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <mstyle id="x55-200252r98" class="label"></mstyle><!--endlabel--><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>E</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">.</mo> </math>
</td>
<td class="eq-no">
(3.98)
</td>
</tr>

</tbody></table>
<!--l. 4143-->
<p class="indent">
&nbsp;&nbsp;<!--l. 4143--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
</div>
<!--l. 4143-->
<p class="indent">
</p>
<!--l. 4145-->
<p class="indent">
For example, assume that <!--l. 4145--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo></math>, such that <!--l. 4145--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>E</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn><mn>5</mn></math> and <!--l. 4145--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>E</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><msub><mrow><mi>h</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>h</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>R</mi></mrow><mrow><mi>x</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></math>. Assuming the input is AWGN with power <!--l. 4145--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></math>, then Eq.&nbsp;(<a href="#x55-200252r98">3.98<!--tex4ht:ref: eq:powerOutputLTI --></a>) leads to <!--l. 4145--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub><msub><mrow><mi>E</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn><mn>5</mn></math> . The following code illustrates this fact:
</p>
<!--l. 4146-->
<pre class="lstlisting" id="listing-129"><span class="label"><a id="x55-200253r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1000000;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-0.5];</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">,1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200254r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Eh</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Px</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Py</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span></pre>
<!--l. 4150-->
<p class="indent">
</p><p>However, if <!--l. 4150--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> is not white, <!--l. 4150--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>R</mi></mrow><mrow><mi>x</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">)</mo></math> will impact the result.</p>
For the same filter, if <!--l. 4150--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mi class="MathClass-op">∀</mi><mo> ⁡<!--FUNCTION APPLICATION--></mo><mi>n</mi></math>, then <!--l. 4150--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>R</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></math> and <!--l. 4150--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></math>, such that <!--l. 4150--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn><mn>5</mn></math>. As a third example, consider the samples of a binary <!--l. 4150--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> are i.i.d with equiprobable 0 and 1 values. In this case, <!--l. 4150--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>R</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>4</mn></math> and <!--l. 4150--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn></math>, such that <!--l. 4150--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn><mn>5</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><mo class="MathClass-open" stretchy="false">(</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>4</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>3</mn><mn>7</mn><mn>5</mn></math>. The following commands
<p></p>
<!--l. 4151-->
<pre class="lstlisting" id="listing-130"><span class="label"><a id="x55-200255r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1000000;</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">round</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">rand</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-0.5];</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">,1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x55-200256r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Eh</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Px</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Py</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span></pre>
<!--l. 4155-->
<p class="indent">
can confirm the results. &nbsp;&nbsp;<!--l. 4156--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math>
</p>
<!--l. 4158-->
<p class="noindent">
<a id="x55-200257r13"></a> <span id="textcolor234"><span class="ec-lmbx-10x-x-109">Application 3.13.</span></span> <span class="ec-lmbx-10x-x-109">The delay and attenuation imposed by a channel</span>. Here the LTI system is assumed to be a communication channel. When the channel has a flat magnitude and a linear phase (or, equivalently, a constant group delay) over the bandwidth of the transmitted signal, the received signal is a delayed version of the transmitted signal. In this special case, the delay can be described by a single value. In general however, each frequency component is delayed by a different amount and this relation is described by the group delay function in Eq.&nbsp;(<a href="ak_dsp_bookse38.html#x47-152002r46">3.46<!--tex4ht:ref: eq:groupDelay --></a>).
</p>
<!--l. 4166-->
<p class="indent">
As discussed, roughly, the group delay is the time between the channel’s initial response and its peak response or, in other words, the group delay of a filter is a measure of the average delay of the filter as a function of frequency. Hence, for an arbitrary (non-constant) group delay, distinct frequency components of the transmitted signal get delayed by different delays, the signal gets distorted and there is not a single delay value to characterize the transmission. In practical communication systems, an estimator keeps tracking at the receiver of the best time instant to compensate the delay provoked by the channel. And in simulations, it is common to resort to a brute force approach, where this “optimum” delay compensation instant is searched by trying distinct values in a range and choosing the one that minimizes a figure of merit such as the bit error rate.
</p>
<!--l. 4168-->
<p class="indent">
</p><p>When the channel simulation requires filtering to shape the magnitude of the signal spectra but allows linear phase, it is convenient to use FIR filters with linear phase because the delay they impose is well-defined as indicated in Figure&nbsp;<a href="ak_dsp_bookse43.html#x52-18703049">3.49<!--tex4ht:ref: fig:groupDelayLinearPhase --></a>. Hence, in many cases the LTI channel is assumed to be causal and represented by a finite-length impulse response <!--l. 4169--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>h</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>h</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mo>…</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>h</mi></mrow><mrow><mi>L</mi></mrow></msub><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>L</mi><mo class="MathClass-close" stretchy="false">]</mo></math> with <!--l. 4169--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>L</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></math> non-zero values. The integer <!--l. 4169--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>L</mi></math> is the channel <span class="ec-lmri-10x-x-109">order </span>because in the Z-domain, <!--l. 4169--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>h</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>h</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mo>…</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>h</mi></mrow><mrow><mi>L</mi></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>L</mi></mrow></msup></math>. Assuming a linear phase FIR of <!--l. 4170--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>L</mi></math>-th order, where <!--l. 4170--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>L</mi></math> is even (or equivalently, the filter has an odd number of coefficients), the delay is simply</p>
<!--l. 4170-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>L</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></math>.
<p></p>
<!--l. 4172-->
<p class="indent">
Recall that, for FIR filters, the impulse response coincides with the filter coefficients. Adopting vectors, the impulse response can be represented by <span class="ec-lmss-10x-x-109">h=[h0 h1 … hL] </span>and the command <span class="ec-lmss-10x-x-109">y=filter(h,1,x) </span>used because the numerator <!--l. 4172--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>B</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> and denominator <!--l. 4172--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>A</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> of <!--l. 4172--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>B</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mi>A</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> are <span class="ec-lmss-10x-x-109">h </span>and <!--l. 4172--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>1</mn></math>, respectively.
</p>
<figure class="figure">
<p><a id="x55-20025883"></a></p>
<!--l. 4183-->
<p class="noindent">
<img src="Figures/compensatingFIRChannel.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.83: </span><span class="content">Linear phase FIR channel obtained with <span class="ec-lmss-10x-x-109">h=fir1(10,0.8)</span>. The output signal was scaled to have the same power as the input.</span>
</figcaption>
<!--tex4ht:label?: x55-20025883 -->
</figure>
<!--l. 4187-->
<p class="indent">
For example, consider the linear phase channel obtained with <span class="ec-lmss-10x-x-109">h=fir1(10,0.8)</span>. Figure&nbsp;<a href="#x55-20025883">3.83<!--tex4ht:ref: fig:compensatingFIRChannel --></a> depicts its impulse response, group delay and the output <!--l. 4188--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> for an input <!--l. 4188--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> representing symbols <!--l. 4188--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></math> with an oversampling of <!--l. 4188--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>L</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></math> samples per symbol and a shaping pulse with four samples equal to 1.
</p>
<!--l. 4190-->
<p class="indent">
Figure&nbsp;<a href="#x55-20025883">3.83<!--tex4ht:ref: fig:compensatingFIRChannel --></a> allows to observe that the input gets delayed by the group delay of <span class="ec-lmss-10x-x-109">h</span>, which in this case is 5. Note that the input peak at <span class="ec-lmss-10x-x-109">x[0] </span>corresponds to the output sample <span class="ec-lmss-10x-x-109">y[5]</span>. This simple signal delay happens because because <span class="ec-lmss-10x-x-109">h </span>in this example was chosen to be symmetric and have a linear phase, such that the group delay is 5 samples for all frequencies as indicated in Figure&nbsp;<a href="#x55-20025883">3.83<!--tex4ht:ref: fig:compensatingFIRChannel --></a>. In terms of seconds, a group delay of 5 samples corresponds to <!--l. 4190--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>5</mn><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>, where <!--l. 4190--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is given in Hz. In this case, the first 5 samples of the output should be eliminated for aligning with <!--l. 4191--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>. For example, the commands <span class="ec-lmss-10x-x-109">y(1:5)=[], x(end-4:end)=[] </span>could be used to align the corresponding vectors and keep them with the same number of samples.
</p>
<!--l. 4193-->
<p class="indent">
However, in a more general scenario, the group delay varies with frequency, such as for the non-symmetric FIR filter illustrated in Figure&nbsp;<a href="ak_dsp_bookse43.html#x52-18703150">3.50<!--tex4ht:ref: fig:groupDelayNonLinearPhase --></a>.
</p>
<!--l. 4196-->
<p class="indent">
Typically a channel attenuates the input signal and decreases its power. When the channel is LTI, the output power <!--l. 4197--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub></math> is related to the input power <!--l. 4197--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub></math> as informed by Theorem&nbsp;<a href="#x55-200250r3">3<!--tex4ht:ref: th:output-power-of-lti --></a> (page <span class="pageref"><a href="#x55-200250r3">§</a></span>).
</p>
<!--l. 4199-->
<p class="indent">
When comparing the input <!--l. 4199--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> and output <!--l. 4199--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> waveforms, it is useful to know the ratio <!--l. 4199--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>g</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub></math> and multiply <!--l. 4199--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> by <!--l. 4199--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msqrt><mrow><mi>g</mi></mrow></msqrt></math> in order to compare signals with equivalent amplitude ranges. However, in practice, it is hard to determine <!--l. 4200--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>g</mi></math> and typically an adaptive automatic gain control (AGC) is employed.
</p>
<!--l. 4202-->
<p class="indent">
Another example of compensating the delay and gain imposed by a channel is discussed in the sequel.
</p>
<!--l. 4206-->
<p class="indent">
If useful, one can mimic a perfect automatic gain control (AGC) and force the output to have the same power as the input with the following commands <span class="ec-lmss-10x-x-109">Px=mean(x.</span><span class="ec-lmss-10x-x-109">^2),</span> <span class="ec-lmss-10x-x-109">Py=mean(y.</span><span class="ec-lmss-10x-x-109">^2), y = sqrt(Px/Py)*y</span>.
</p>
<figure class="figure">
<p><a id="x55-20025984"></a></p>
<!--l. 4210-->
<p class="noindent">
<img src="Figures/compensatingButterworthChannel.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.84: </span><span class="content">IIR channel obtained with <span class="ec-lmss-10x-x-109">[B,A]=butter(5,0.8)</span>. The output signal was scaled to have the same power as the input.</span>
</figcaption>
<!--tex4ht:label?: x55-20025984 -->
</figure>
<!--l. 4214-->
<p class="indent">
</p><p>Similar to the procedure for generating Figure&nbsp;<a href="#x55-20025883">3.83<!--tex4ht:ref: fig:compensatingFIRChannel --></a>, an IIR filter was simulated to obtain Figure&nbsp;<a href="#x55-20025984">3.84<!--tex4ht:ref: fig:compensatingButterworthChannel --></a>. In this case the group delay is less than 1 for frequencies <!--l. 4215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">&lt;</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>4</mn><mn>7</mn><mi>π</mi></math> and the peak of <!--l. 4215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> is for <!--l. 4215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></math>. Observing the graphs of <!--l. 4215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> and <!--l. 4215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>, a good alignment would be obtained by shifting <!--l. 4215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> one sample to the left, i. e., <!--l. 4215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo></math> if manipulating algebraically or <span class="ec-lmss-10x-x-109">y(1)=[] </span>if using Matlab/Octave. &nbsp; &nbsp;<!--l. 4216--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-ord">□</mo></math></p>
<p></p>
<div class="footnotes">
<a id="x55-200075x35"></a> <!--l. 3761-->
<p class="indent">
<span class="footnote-mark"><a href="#fn35x5-bk" id="fn35x5"><sup class="textsuperscript">35</sup>&nbsp;</a></span><span class="ec-lmr-9">The reciprocal of a complex number </span><!--l. 3761--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>c</mi></math> <span class="ec-lmr-9">is </span><!--l. 3761--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mi>c</mi></math><span class="ec-lmr-9">.</span>
</p>
</div>





</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ak_dsp_bookse45.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multirate Processing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ak_dsp_bookse47.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Digital Signal Processing with Python, Matlab or Octave, Applications in Machine Learning Aldebaro Klautau Federal University of Pará (UFPA), Brazil</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>