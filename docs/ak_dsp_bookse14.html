<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aldebaro Klautau">

<title>Digital Signal Processing with Python, Matlab or Octave - 14&nbsp; Applications</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ak_dsp_bookse15.html" rel="next">
<link href="./ak_dsp_bookse13.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ak_dsp_bookch1.html">Analog and Digital Signals</a></li><li class="breadcrumb-item"><a href="./ak_dsp_bookse14.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Applications</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Digital Signal Processing with Python, Matlab or Octave</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Tables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listings</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Signals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analog, Digital and Discrete-Time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basic Signal Manipulation and Representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Block Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Complex-Valued and Sampled Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modeling the Stages in A/D and D/A Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Relating Frequencies in Continuous, Sampled and Discrete-time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">An Introduction to Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Signal Categorization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Power and Energy in Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Relating Power in Continuous and Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Correlation: Finding Trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Linear Model for Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse14.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforms and Signal Representation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Linear Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inner Products to Obtain the Transform Coefficients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Block Transforms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Fourier Transforms and Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Relating discrete and analog frequencies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Summary of equations for DFT / FFT Usage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Laplace Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Z Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Contrasting Signals and Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Analog and Digital Filters: A Quick Hands-On Tour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Linear Time-Invariant Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Sampling and Signal Reconstruction Revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse36.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Facts About First and Second-Order Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse37.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Bandwidth and Quality Factor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse38.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Importance of Linear Phase (or Constant Group Delay)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse39.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Filtering technologies: Surface acoustic wave (SAW) and others</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse40.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse41.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">IIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse42.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Bilinear Transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse43.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">FIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse44.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Realization of Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse45.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multirate Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse46.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse47.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse48.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse49.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spectral Estimation Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse51.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse52.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Windows for spectral analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse53.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">The ESD, PSD and MS Spectrum functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse54.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Filtering Random Signals and the Impact on PSDs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse55.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Periodogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse56.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Welch’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse57.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Parametric PSD Estimation via Autoregressive (AR) Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse58.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Time-frequency Analysis using the Spectrogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse59.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse60.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse61.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse62.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">ak_dsp_bookap2.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">ak_dsp_bookap3.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">ak_dsp_bookap4.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Applications</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<meta charset="utf-8">
<meta content="TeX4ht (https://tug.org/tex4ht/)" name="generator">
<meta content="width=device-width,initial-scale=1" name="viewport">
<link href="ak_dsp_book.css" rel="stylesheet" type="text/css">
<meta content="ak_dsp_book.tex" name="src">
<script async="async" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js" type="text/javascript"></script>


<!-- l. 2910 -->
<p class="noindent">
<a id="x21-75001r1"></a> <span id="textcolor55"><span class="ec-lmbx-10x-x-109">Application 1.1.</span></span> <span class="ec-lmbx-10x-x-109">Recording with a sound board</span>. It is relatively easy to record sound using a microcomputer. However, most softwares that capture sound are not very useful for studying DSP, because they assume the user is not interested in “low-level” details such as the number of bits per sample. But there many alternatives that do provide this kind of information. Two free and open-source (FOSS) softwares for manipulation sound files are Audacity&nbsp;[url1aud] and Sox&nbsp;[url1sox]. While Sox is very useful for converting among file formats and working from a command line, Audacity is adopted here because it has a graphical user interface (GUI) that allows, for example, to monitor recording and avoid saturating the ADC, which would distort the sound due to clipping of its amplitudes.
</p>
<!-- l. 2915 -->
<p class="indent">
Figure&nbsp;<a href="#x21-7500256">1.56<!-- tex4ht:ref: fig:audacity  --></a> shows a short segment of audio recorded with the default options of sampling frequency <!-- l. 2915 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>44</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>1</mn></mrow></math>&nbsp;kHz and number <!-- l. 2915 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>b</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> bits per sample in floating-point, as indicated by the letter A in the figure. The menu <span class="ec-lmss-10x-x-109">Edit - Preferences - Quality </span>of Audacity allows to change these values. Another option to change <!-- l. 2915 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is the “Project rate” in letter B of Figure&nbsp;<a href="#x21-7500256">1.56<!-- tex4ht:ref: fig:audacity  --></a>. The level meters indicated with letter C are activated during recording and playback and, in this case, suggest that the signal amplitude was clipped due to ADC saturation. Alternatively, this can be visualized using menu <span class="ec-lmss-10x-x-109">View - Show Clipping</span>. Each time a new recording starts (by clicking the button indicated by letter D), the audio track has the <!-- l. 2915 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> and <!-- l. 2915 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math> imposed by the current default options. Most sound boards have two channels and can record in stereo but here it is assumed that only one channel is of interest and the files are mono.
</p>
<figure class="figure">
<p><a id="x21-7500256"></a></p>
<!-- l. 2920 -->
<p class="noindent">
<img alt="PIC" src="FiguresNonScript/audacity.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.56: </span><span class="content">Example of sound recorded at <!-- l. 2921 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>44</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>1</mn></mrow></math>&nbsp;kHz with the Audacity sound editor.</span>
</figcaption>
<!-- tex4ht:label?: x21-7500256  -->
</figure>
<!-- l. 2924 -->
<p class="indent">
Audacity can save a signal in a variety of file formats, such as MP3, using the menu <span class="ec-lmss-10x-x-109">Export</span>. Our goal is to later read the saved file in another software (Matlab/Octave, etc.), so MP3 should be avoided and of special interest here are “wav” (actually the WAVE format, an instance of Microsoft’s RIFF file format) and raw (header-less).
</p>
<!-- l. 2926 -->
<p class="indent">
The “wav” format is just a wrapper for many codecs. In other words, within a “wav” file one can find uncompressed data requiring hundreds of kilobits to represent each second (kbps) of audio as well highly compressed data requesting less than five&nbsp;kbps. Unless the file size should be minimized, for increased portability it is better to use an uncompressed “PCM” format. Due to its adoption in digital communications, the result of A/D conversion is sometimes called pulse-coded modulation (PCM)<a id="dx21-75003"></a>. Hence, PCM can be seen as a codec but its output is equivalent to a signal simply sampled at <!-- l. 2926 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> and quantized (or encoded) with <!-- l. 2926 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math> bits/sample. If the adopted quantizer is uniform (see Eq.&nbsp;(<a href="ak_dsp_bookse8.html#x15-45001r26">1.26<!-- tex4ht:ref: eq:uniform_quantizer_levels  --></a>)), the PCM is called linear. The linear PCM is the best format with respect to portability but there are also two popular non-linear PCMs.
</p>
<!-- l. 2928 -->
<p class="indent">
Because the probability distribution of long segments of speech signals is approximately Laplacian, not uniform, the quantizer used in digital telephony is non-uniform. These quantizers are based on non-linear curves (approximately logarithmic) called A-law and <!-- l. 2928 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi></math>-law. Figure&nbsp;<a href="#x21-7500457">1.57<!-- tex4ht:ref: fig:audacity_wavoptions  --></a> shows some options when the user chooses <span class="ec-lmss-10x-x-109">Export - Other compressed files (in “type”) </span>and then <span class="ec-lmss-10x-x-109">Options</span>.
</p>
<figure class="figure">
<p><a id="x21-7500457"></a></p>
<!-- l. 2932 -->
<p class="noindent">
<img alt="PIC" src="FiguresNonScript/audacity_wavoptions.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.57: </span><span class="content">Some Audacity options for saving an uncompressed WAVE file. The two non-linear PCMs are indicated.</span>
</figcaption>
<!-- tex4ht:label?: x21-7500457  -->
</figure>
<!-- l. 2936 -->
<p class="indent">
Hence, use Audacity to record some sound with <!-- l. 2936 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math>&nbsp;kHz and export it as a file named <span class="ec-lmss-10x-x-109">myvoice.wav </span>in the “WAV (Microsoft) signed 16 bits” format. After that, read it with Matlab/Octave using:
</p>
<!-- l. 2937 -->
<pre class="lstlisting" id="listing-26"><span class="label"><a id="x21-75005r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">wavread</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">myvoice</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span></pre>
<!-- l. 2940 -->
<p class="indent">
It can be observed that <span class="ec-lmss-10x-x-109">Fs=8000 </span>and <span class="ec-lmss-10x-x-109">b=16</span>, as recorded. Note that by default the <span class="ec-lmss-10x-x-109">wavread</span> function outputs samples in floating-point and normalizes them to be within the range <!-- l. 2941 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. If the actual integer values are of interest, Matlab allows to use
</p>
<!-- l. 2942 -->
<pre class="lstlisting" id="listing-27"><span class="label"><a id="x21-75006r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">wavread</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">myvoice</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">native</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span></pre>
<!-- l. 2945 -->
<p class="indent">
Using the last two commands and comparing <span class="ec-lmss-10x-x-109">min(x), max(x) </span>and <span class="ec-lmss-10x-x-109">min(x2), max(x2)</span>, in the case of a specific audio file, the (native) integer values <!-- l. 2945 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>8488</mn></mrow></math> (min) and 5877 (max) were normalized to <!-- l. 2945 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.2590</mn></mrow></math> and 0.1794, respectively, when not using the option <span class="ec-lmss-10x-x-109">’native’</span>. The normalization consists in dividing the native integer values by <!-- l. 2945 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow><mn>2</mn></mrow><mrow><mi>b</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></math>, which takes in account that these values are originally within the range <!-- l. 2945 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><msup><mrow><mn>2</mn></mrow><mrow><mi>b</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup><mo class="MathClass-punc" stretchy="false">,</mo><msup><mrow><mn>2</mn></mrow><mrow><mi>b</mi></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. For example, in this case <!-- l. 2945 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>b</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>16</mn></mrow></math> and <!-- l. 2945 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>5877</mn><mo class="MathClass-bin" stretchy="false">∕</mo><msup><mrow><mn>2</mn></mrow><mrow><mn>15</mn></mrow></msup> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.1794</mn></mrow></math>.
</p>
<!-- l. 2947 -->
<p class="indent">
In case the file had used A-law non-linear PCM, Matlab would give the error message:<br class="newline"><span class="ec-lmss-10x-x-109">Data compression format (CCITT a-law) is not supported.</span><br class="newline">and Octave:<br class="newline"><span class="ec-lmss-10x-x-109">error: wavread: sample format 0x6 is not supported</span>
</p>
<!-- l. 2953 -->
<p class="indent">
Now, it is suggested to get more familiar with headerless files using Audacity to save a sound file as “raw”. It may be useful to check Appendix <a href="ak_dsp_bookse92.html#x105-329000C.2">C.2<!-- tex4ht:ref: app:files  --></a> for more details on how the information is organized in binary files. After recording in Audacity, choose <span class="ec-lmss-10x-x-109">Export - Other compressed files (in “type”) </span>as in Figure&nbsp;<a href="#x21-7500457">1.57<!-- tex4ht:ref: fig:audacity_wavoptions  --></a>, but this time select the header “RAW (header-less)” instead of “WAV (Microsoft)”. For the encoding, select “Signed 16 bit-PCM”, as before, and name the file <span class="ec-lmss-10x-x-109">’myvoice_raw.wav’</span>. In this case, it would be wiser to use another file extension and name it <span class="ec-lmss-10x-x-109">’myvoice.raw’</span>, for example. But the purpose of using “wav” is to make clear that the extension by itself cannot guarantee a file format is the expected one.
</p>
<!-- l. 2957 -->
<p class="indent">
</p><p>In this particular example, the file sizes are <!-- l. 2957 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>29</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>228</mn></mrow></math> and <!-- l. 2957 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>29</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>184</mn></mrow></math> for the WAVE and raw formats, respectively. In fact, in spite of a WAVE possibly having a sophisticated structure with several sections (chunks), most of them have a single chunk and one header consisting of the first 44 bytes,</p>
which is the difference between the two sizes given that both have the same <!-- l. 2957 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>29184</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>14592</mn></mrow></math>&nbsp;samples of 2 bytes each.
<p></p>
<!-- l. 2959 -->
<p class="indent">
Using the command <span class="ec-lmss-10x-x-109">wavread </span>for the raw file would generate error messages in Matlab/Octave. Based on Appendix&nbsp;<a href="ak_dsp_bookse92.html#x105-334000doc">C.2.4.0<!-- tex4ht:ref: app:matlab  --></a>, the following code properly reads the samples:
</p>
<!-- l. 2960 -->
<pre class="lstlisting" id="listing-28"><span class="label"><a id="x21-75007r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">fp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fopen</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">myvoice_raw</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">rb</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">open</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for reading in binary</span> 
</span><span class="label"><a id="x21-75008r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fread</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">fp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">Inf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">int16</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">read</span></span><span style="color:#005900"> <span class="ec-lmtt-9">all samples as signed 16-bits</span> 
</span><span class="label"><a id="x21-75009r3"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">fclose</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">fp</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">close</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the file</span></span></pre>
<!-- l. 2965 -->
<p class="indent">
As a sanity check, one can read the samples of the WAVE file, skip its header and compare with the result of <span class="ec-lmss-10x-x-109">wavread </span>with Listing&nbsp;<a href="#x21-75010r23">1.23<!-- tex4ht:ref: code:snip_signals_wavread  --></a> on Matlab.
</p>
<!-- l. 2966 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.23: </span><span class="content">MatlabOctaveCodeSnippets/snip_signals_wavread.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75010r1.14  -->
<pre class="lstinputlisting" id="listing-29"><span class="label"><a id="x21-75012r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">fp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fopen</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">myvoice</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">rb</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">open</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for reading in binary</span> 
</span><span class="label"><a id="x21-75013r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fread</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">fp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">Inf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">int16</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">read</span></span><span style="color:#005900"> <span class="ec-lmtt-9">all samples as signed 16-bits</span> 
</span><span class="label"><a id="x21-75014r3"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">fclose</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">fp</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">close</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the file</span> 
</span><span class="label"><a id="x21-75015r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:22)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">eliminate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the 44-bytes header</span> 
</span><span class="label"><a id="x21-75016r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">readwav</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">myvoice</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">r</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75017r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">double</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convert</span></span><span style="color:#005900"> <span class="ec-lmtt-9">integer to double for easier manipulation</span> 
</span><span class="label"><a id="x21-75018r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">x2</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">result</span></span><span style="color:#005900"> <span class="ec-lmtt-9">is 0, indicating they are identical</span></span>
  </pre>
<!-- l. 2977 -->
<p class="indent">
The advantage of using WAVE is that the header informs <!-- l. 2977 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>, <!-- l. 2977 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math>, whether its mono or stereo, etc. Also, the WAVE format takes care of endianness (see Appendix&nbsp;<a href="ak_dsp_bookse92.html#x105-332000C.2.3">C.2.3<!-- tex4ht:ref: app:endianness  --></a>). Not using <span class="ec-lmss-10x-x-109">wavread</span>, write code in Matlab/Octave to open a WAVE file (with only 1 chunk) and extract <!-- l. 2978 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>, <!-- l. 2978 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math> and the samples as integers. This code can be used by Octave users to mimic the option <span class="ec-lmss-10x-x-109">native </span>in Matlab’s <span class="ec-lmss-10x-x-109">wavread</span>. It may be useful to read Appendix&nbsp;<a href="ak_dsp_bookse92.html#x105-337000C.2.5">C.2.5<!-- tex4ht:ref: app:fileHeaders  --></a> and use the companion code <span class="ec-lmss-10x-x-109">laps_dump.c</span>, which can be compiled with most C compilers. A short description of the WAVE header is provided at [url1wav]. &nbsp; &nbsp;<!-- l. 2983 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2985 -->
<p class="noindent">
<a id="x21-75021r2"></a> <span id="textcolor56"><span class="ec-lmbx-10x-x-109">Application 1.2.</span></span> <span class="ec-lmbx-10x-x-109">Recording sound with Matlab</span>. This application discusses how to record sound directly with Matlab, which has several functions to deal with sound recording and playback. You can check <span class="ec-lmss-10x-x-109">soundsc, audiorecorder, wavplay </span>and <span class="ec-lmss-10x-x-109">wavrecord</span>, for example. Some functions work only on Windows.
</p>
<!-- l. 2988 -->
<p class="indent">
Octave has functions such as <span class="ec-lmss-10x-x-109">record </span>and <span class="ec-lmss-10x-x-109">sound </span>and its support to sound is more natural on Linux. There are solutions such as [url1rec] to record and play sound on Octave running on Windows, but the installation is not trivial.
</p>
<!-- l. 2990 -->
<p class="indent">
The following code was used in Matlab to record 5 seconds of one (mono) channel sound at a sampling rate of 11,025 Hz, using 16 bits to represent each sample:
</p>
<!-- l. 2991 -->
<pre class="lstlisting" id="listing-30"><span class="label"><a id="x21-75022r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">audiorecorder</span></span><span style="color:#000000"><span class="ec-lmtt-9">(11025,16,1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">create</span></span><span style="color:#005900"> <span class="ec-lmtt-9">audiorecorder object</span> 
</span><span class="label"><a id="x21-75023r2"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">record</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">,5)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">record</span></span><span style="color:#005900"> <span class="ec-lmtt-9">5 seconds and store inside object r</span></span></pre>
<!-- l. 2996 -->
<p class="indent">
</p><p>One can use <span class="ec-lmss-10x-x-109">play(r) </span>to listen the recorded sound or <span class="ec-lmss-10x-x-109">y = getaudiodata(r, ’int16’) </span>to obtain the samples from the audiorecorder object. However, if one of these commands immediately</p>
follows <span class="ec-lmss-10x-x-109">record(r,5)</span>, the error can be generated:<br class="newline"><span class="ec-lmss-10x-x-109">??? Cannot retrieve audio data while recording is in progress.</span><br class="newline">This means the software was still recording when it tried to execute the second command. An alternative is to use <span class="ec-lmss-10x-x-109">recordblocking </span>as in Listing&nbsp;<a href="#x21-75024r24">1.24<!-- tex4ht:ref: code:snip_signals_recordblocking  --></a>.
<p></p>
<!-- l. 3000 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.24: </span><span class="content">MatlabOnly/snip_signals_recordblocking.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75024r1.14  -->
<pre class="lstinputlisting" id="listing-31"><span class="label"><a id="x21-75026r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">audiorecorder</span></span><span style="color:#000000"><span class="ec-lmtt-9">(11025,16,1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">create</span></span><span style="color:#005900"> <span class="ec-lmtt-9">audiorecorder object</span> 
</span><span class="label"><a id="x21-75027r2"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">recordblocking</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">,5)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">record</span></span><span style="color:#005900"> <span class="ec-lmtt-9">5 seconds and store inside r</span> 
</span><span class="label"><a id="x21-75028r3"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">play</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">playback</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the sound</span> 
</span><span class="label"><a id="x21-75029r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">getaudiodata</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">int16</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">extract</span></span><span style="color:#005900"> <span class="ec-lmtt-9">samples as int16</span> 
</span><span class="label"><a id="x21-75030r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">show</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the graph</span></span>
  </pre>
<!-- l. 3009 -->
<p class="indent">
Note that <span class="ec-lmss-10x-x-109">y </span>in the above example is an array with elements of the type int16, i. e., 2 bytes per sample. This saves storage space when compared to the conventional real numbers stored in double (8 bytes) each, but limits the manipulations. For example, the command <span class="ec-lmss-10x-x-109">soundsc(y,11025) </span>generates an error message if <span class="ec-lmss-10x-x-109">y </span>is int16. In such cases, a conversion as <span class="ec-lmss-10x-x-109">y=double(y) </span>can be used before invoking <span class="ec-lmss-10x-x-109">soundsc </span>(use <span class="ec-lmss-10x-x-109">whos y </span>to check that the storage has quadruplicated).
</p>
<!-- l. 3011 -->
<p class="indent">
To write <span class="ec-lmss-10x-x-109">y </span>to a 16-bits per sample WAV file and read it back, use Listing&nbsp;<a href="#x21-75033r25">1.25<!-- tex4ht:ref: code:snip_signals_wavwrite  --></a> but the command <span class="ec-lmss-10x-x-109">double(z)./double(y) </span>shows that the normalization used by <span class="ec-lmss-10x-x-109">wavwrite </span>made <span class="ec-lmss-10x-x-109">z </span>approximately three times <span class="ec-lmss-10x-x-109">y</span>. The Voicebox toolbox ([url1voi]) has functions <span class="ec-lmss-10x-x-109">readwav </span>and <span class="ec-lmss-10x-x-109">writewav </span>that are smarter than Matlab’s with respect to avoiding the normalization.
</p>
<!-- l. 3014 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.25: </span><span class="content">MatlabOnly/snip_signals_wavwrite.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75033r1.14  -->
<pre class="lstinputlisting" id="listing-32"><span class="label"><a id="x21-75035r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">yd</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">double</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convert</span></span><span style="color:#005900"> <span class="ec-lmtt-9">from int16 (y from getaudiodata)</span> 
</span><span class="label"><a id="x21-75036r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">yd</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">yd</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">yd</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">normalize</span></span> 
<span class="label"><a id="x21-75037r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">writewav</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">yd</span></span><span style="color:#000000"><span class="ec-lmtt-9">,11025,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">somename</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">16</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">r</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">write</span></span><span style="color:#005900"> <span class="ec-lmtt-9">as 16-bits</span> 
</span><span class="label"><a id="x21-75038r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">readwav</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">somename</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">r</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">avoid</span></span><span style="color:#005900"> <span class="ec-lmtt-9">normalization</span></span>
  </pre>
<!-- l. 3022 -->
<p class="indent">
Some sound boards allow full-duplex operation, i. e., recording and playing at the same time. Typically the sampling frequency must be the same for both operations. On Windows one can try the <span class="ec-lmss-10x-x-109">wavplay </span>function with the option “async” as exemplified in Listing&nbsp;<a href="#x21-75041r26">1.26<!-- tex4ht:ref: code:snip_signals_realtimeLoopback  --></a>.
</p>
<!-- l. 3024 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.26: </span><span class="content">MatlabOnly/snip_signals_realtimeLoopback.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75041r1.14  -->
<pre class="lstinputlisting" id="listing-33"><span class="label"><a id="x21-75043r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 11025;</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">define</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sampling rate (Hz)</span> 
</span><span class="label"><a id="x21-75044r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">fc</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1500;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">cosine</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency (Hz)</span> 
</span><span class="label"><a id="x21-75045r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">recordingDuration</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">duration</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of recording, in seconds</span> 
</span><span class="label"><a id="x21-75046r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">audiorecorder</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,16,1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75047r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">while</span></span><span style="color:#000000"> <span class="ec-lmtt-9">1</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">infinite</span></span><span style="color:#005900"> <span class="ec-lmtt-9">loop, stop with CTRL+C</span> 
</span><span class="label"><a id="x21-75048r6"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">recordblocking</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">recordingDuration</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75049r7"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">inputSignal</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">getaudiodata</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75050r8"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">audioplayer</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75051r9"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(211)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">inputSignal</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">graph</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in time domain</span> 
</span><span class="label"><a id="x21-75052r10"></a><span class="ec-lmr-6">10</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(212)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">pwelch</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">double</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">inputSignal</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency domain</span> 
</span><span class="label"><a id="x21-75053r11"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">drawnow</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Force</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the graphics to update immediately inside the loop</span> 
</span><span class="label"><a id="x21-75054r12"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span>
  </pre>
<!-- l. 3032 -->
<p class="indent">
Listing&nbsp;<a href="#x21-75041r26">1.26<!-- tex4ht:ref: code:snip_signals_realtimeLoopback  --></a> shows the acquired signal (from the ADC) in both time and frequency domains. In this code, the call to <span class="ec-lmss-10x-x-109">wavplay </span>is non-blocking but samples are lost in the sense that <span class="ec-lmss-10x-x-109">inputSignal </span>is not a perfect cosine. Using a loopback cable, as in Application&nbsp;<a href="#x21-75097r4">1.4<!-- tex4ht:ref: app:latency  --></a>, allows to evaluate the system.
</p>
<figure class="figure">
<p><a id="x21-7505558"></a></p>
<!-- l. 3037 -->
<p class="noindent">
<img alt="PIC" src="./FiguresNonScript/cosineLoopBack.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.58: </span><span class="content">Cosine obtained with Listing&nbsp;<a href="#x21-75041r26">1.26<!-- tex4ht:ref: code:snip_signals_realtimeLoopback  --></a> and a loopback cable connecting the soundboard DAC and ADC.</span>
</figcaption>
<!-- tex4ht:label?: x21-7505558  -->
</figure>
<!-- l. 3041 -->
<p class="indent">
Figure&nbsp;<a href="#x21-7505558">1.58<!-- tex4ht:ref: fig:cosineLoopBack  --></a> was obtained with a loopback. Note from the top plot that approximately 300 samples are a transient and after that one can see the cosine at <!-- l. 3041 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1500</mn></mrow></math>&nbsp;Hz, which is mapped to <!-- l. 3041 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>1500</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.27</mn></mrow></math> (<!-- l. 3041 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>11025</mn></mrow></math>&nbsp;Hz) in the normalized axis of the bottom plot. In order to get this kind of system running, it is important to reduce the volume (DAC gain) to avoid saturation of the signals.
</p>
<!-- l. 3052 -->
<p class="indent">
As an exercise, digitize signals at different sampling frequencies and plot them with the axes properly normalized. Another interesting exploration is to obtain a sound signal <span class="ec-lmss-10x-x-109">inputSignal</span>, digitized at a given rate (e. g., <!-- l. 3053 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>11</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>025</mn></mrow></math> Hz) and represented by int16. Convert it to double with <span class="ec-lmss-10x-x-109">x=double(inputSignal) </span>in order to easily manipulate the signal and describe what is the result of each of the commands in Listing&nbsp;<a href="#x21-75056r27">1.27<!-- tex4ht:ref: code:snip_signals_digitize_signals  --></a>.
</p>
<!-- l. 3055 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.27: </span><span class="content">MatlabOnly/snip_signals_digitize_signals.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75056r1.14  -->
<pre class="lstinputlisting" id="listing-34"><span class="label"><a id="x21-75058r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=22050;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency</span> 
</span><span class="label"><a id="x21-75059r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">audiorecorder</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">16, 1);</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">create</span></span><span style="color:#005900"> <span class="ec-lmtt-9">audiorecorder object</span> 
</span><span class="label"><a id="x21-75060r3"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">recordblocking</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">,5)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">record</span></span><span style="color:#005900"> <span class="ec-lmtt-9">5 s and store inside object r</span> 
</span><span class="label"><a id="x21-75061r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">getaudiodata</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">int16</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">retrieve</span></span><span style="color:#005900"> <span class="ec-lmtt-9">samples as int16</span> 
</span><span class="label"><a id="x21-75062r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">double</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convert</span></span><span style="color:#005900"> <span class="ec-lmtt-9">from int16 to double</span> 
</span><span class="label"><a id="x21-75063r6"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">soundsc</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">play</span></span><span style="color:#005900"> <span class="ec-lmtt-9">at the sampling frequency</span> 
</span><span class="label"><a id="x21-75064r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">soundsc</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">round</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">play</span></span><span style="color:#005900"> <span class="ec-lmtt-9">at half of the sampling freq.</span> 
</span><span class="label"><a id="x21-75065r8"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">soundsc</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">play</span></span><span style="color:#005900"> <span class="ec-lmtt-9">at twice the sampling frequency</span> 
</span><span class="label"><a id="x21-75066r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:2:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">keep</span></span><span style="color:#005900"> <span class="ec-lmtt-9">only half of the samples</span> 
</span><span class="label"><a id="x21-75067r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">soundsc</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">play</span></span><span style="color:#005900"> <span class="ec-lmtt-9">at the original sampling frequency</span> 
</span><span class="label"><a id="x21-75068r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">vector</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with twice the size of x</span> 
</span><span class="label"><a id="x21-75069r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:2:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">copy</span></span><span style="color:#005900"> <span class="ec-lmtt-9">x into odd elements of z (even are 0)</span> 
</span><span class="label"><a id="x21-75070r13"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">soundsc</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">play</span></span><span style="color:#005900"> <span class="ec-lmtt-9">at the original sampling frequency</span></span>
  </pre>
<!-- l. 3072 -->
<p class="indent">
What should be the sampling frequency for vectors <span class="ec-lmss-10x-x-109">w </span>and <span class="ec-lmss-10x-x-109">z </span>in Listing&nbsp;<a href="#x21-75056r27">1.27<!-- tex4ht:ref: code:snip_signals_digitize_signals  --></a> to properly listen the audio? &nbsp;&nbsp;<!-- l. 3073 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 3075 -->
<p class="noindent">
<a id="x21-75073r3"></a> <span id="textcolor57"><span class="ec-lmbx-10x-x-109">Application 1.3.</span></span> <span class="ec-lmbx-10x-x-109">Real time sound processing with Matlab’s DSP System Toolbox</span>. Matlab’s DSP System Toolbox has extended support to interfacing with the sound board. Listing&nbsp;<a href="#x21-75074r28">1.28<!-- tex4ht:ref: code:snip_signals_realtimeWithDspSystem  --></a> provides a simple example that illustrates recording audio.
</p>
<!-- l. 3083 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.28: </span><span class="content">MatlabOnly/snip_signals_realtimeWithDspSystem.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75074r1.14  -->
<pre class="lstinputlisting" id="listing-35"><span class="label"><a id="x21-75076r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">exampleNumber</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">choose</span></span><span style="color:#005900"> <span class="ec-lmtt-9">1 (spectrum analyzer) or 2 (digital filter)</span> 
</span><span class="label"><a id="x21-75077r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 8000;</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">define</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sampling rate (Hz)</span> 
</span><span class="label"><a id="x21-75078r3"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">create</span></span><span style="color:#005900"> <span class="ec-lmtt-9">an audio recorder object:</span> 
</span><span class="label"><a id="x21-75079r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">microphone</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= dsp.AudioRecorder(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">NumChannels</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,1,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">SampleRate</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75080r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> <span class="ec-lmtt-9">exampleNumber==1</span> 
</span><span class="label"><a id="x21-75081r6"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">specAnalyzer</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= dsp.SpectrumAnalyzer;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">spectrum</span></span><span style="color:#005900"> <span class="ec-lmtt-9">analyzer object</span> 
</span><span class="label"><a id="x21-75082r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">else</span></span> 
<span class="label"><a id="x21-75083r8"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(4,0.05)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">4-</span></span><span style="color:#005900"><span class="ec-lmtt-9">th</span></span><span style="color:#005900"> <span class="ec-lmtt-9">order lowpass Butterworth filter</span> 
</span><span class="label"><a id="x21-75084r9"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">filterMemory</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">initialize</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the filter</span><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">s memory</span> 
</span><span class="label"><a id="x21-75085r10"></a><span class="ec-lmr-6">10</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">speaker</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= dsp.AudioPlayer(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">SampleRate</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">create</span></span><span style="color:#005900"> <span class="ec-lmtt-9">audio player</span> 
</span><span class="label"><a id="x21-75086r11"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x21-75087r12"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Infinite</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">loop, stop with CTRL+C...</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75088r13"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">while</span></span><span style="color:#000000"> <span class="ec-lmtt-9">1</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">infinite</span></span><span style="color:#005900"> <span class="ec-lmtt-9">loop, stop with CTRL+C</span> 
</span><span class="label"><a id="x21-75089r14"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">audio</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">step</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">microphone</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">record</span></span><span style="color:#005900"> <span class="ec-lmtt-9">audio</span> 
</span><span class="label"><a id="x21-75090r15"></a><span class="ec-lmr-6">15</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> <span class="ec-lmtt-9">exampleNumber==1</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">spectrum</span></span><span style="color:#005900"> <span class="ec-lmtt-9">analyzer</span> 
</span><span class="label"><a id="x21-75091r16"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">step</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">specAnalyzer</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">audio</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">observe</span></span><span style="color:#005900"> <span class="ec-lmtt-9">audio in frequency domain</span> 
</span><span class="label"><a id="x21-75092r17"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">else</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">perform</span></span><span style="color:#005900"> <span class="ec-lmtt-9">digital filtering</span> 
</span><span class="label"><a id="x21-75093r18"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">output</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">filterMemory</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">audio</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">filterMemory</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75094r19"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">step</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">speaker</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">output);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">send</span></span><span style="color:#005900"> <span class="ec-lmtt-9">filtered audio to player</span> 
</span><span class="label"><a id="x21-75095r20"></a><span class="ec-lmr-6">20</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x21-75096r21"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span>
  </pre>
<!-- l. 3085 -->
<p class="indent">
</p><p>Listing&nbsp;<a href="#x21-75074r28">1.28<!-- tex4ht:ref: code:snip_signals_realtimeWithDspSystem  --></a> indicates how to plot the signal in frequency domain or to perform digital filtering. The code may drop samples depending on the computer’s speed. Matlab’s documentation inform how to control the queue and buffer lengths, and also obtain the number of overruns. &nbsp;&nbsp;<!-- l. 3089 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math></p>
<p></p>
<!-- l. 3091 -->
<p class="noindent">
<a id="x21-75097r4"></a> <span id="textcolor58"><span class="ec-lmbx-10x-x-109">Application 1.4.</span></span> <span class="ec-lmbx-10x-x-109">Estimating latency using the sound board, Audacity and a loopback cable</span>. The goal here is to practice dealing with digital and analog signals, interfacing Audacity and Matlab/Octave. An audio cable and a single computer (with the sound system working) is all that is needed for many interesting experiments. The user is invited to construct or purchase a cable with the proper connectors for his/her computer. In most cases, a “3.5&nbsp;mm male to 3.5&nbsp;mm male audio cable” is the required one, as indicated in Figure&nbsp;<a href="#x21-7510059">1.59<!-- tex4ht:ref: fig:audioCableLoopback  --></a>. A single channel (mono) cable may suffice but stereo cables have almost the same cost and can be used in more elaborated experiments.<span class="footnote-mark"><a href="#fn18x3" id="fn18x3-bk"><sup class="textsuperscript">18</sup></a></span><a id="x21-75098f18"></a>
</p>
<figure class="figure">
<p><a id="x21-7510059"></a></p>
<!-- l. 3099 -->
<p class="noindent">
<img alt="PIC" src="FiguresNonScript/audioCableLoopback.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.59: </span><span class="content">Setup for loopback of the sound system using an audio cable, which is connected to the microphone input (or, alternatively, to the line in) and to the speaker output (or to the line out).</span>
</figcaption>
<!-- tex4ht:label?: x21-7510059  -->
</figure>
<!-- l. 3103 -->
<p class="indent">
The task is to estimate the <span class="ec-lmri-10x-x-109">latency </span>or <span class="ec-lmri-10x-x-109">channel delay</span>, which is the time interval between the signal is transmitted and its arrival at a receiver after passing through a channel. In this specific case, the channel is composed of the sound board hardware (buffers, etc.) and the used device drivers (low-level software that interfaces with the hardware) and application software (Audacity in this case). In sound processing, latency is especially important when <span class="ec-lmri-10x-x-109">overdubbing</span>, i. e., recording a track while playing back others. A detailed description of testing the latency with Audacity can be found at [url1lat].
</p>
<figure class="figure">
<p><a id="x21-7510160"></a></p>
<!-- l. 3108 -->
<p class="noindent">
<img alt="PIC" src="./FiguresNonScript/SoundBoardOptions.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.60: </span><span class="content">Example of options provided by Windows and the sound board. All the enhancements for both recording and playback devices should be disabled.</span>
</figcaption>
<!-- tex4ht:label?: x21-7510160  -->
</figure>
<!-- l. 3112 -->
<p class="indent">
To have a better control of the sound board, it is important to disable all special effects and enhancements for both recording and playback devices, such as automatic gain control for the input ADC signal. Figure&nbsp;<a href="#x21-7510160">1.60<!-- tex4ht:ref: fig:SoundBoardOptions  --></a> provides screenshots from Windows but users of other operating systems should be able to find how to choose the best sound options.
</p>
<!-- l. 3115 -->
<p class="indent">
After making sure the best configuration for your sound system was chosen, the task now is to generate some samples of a periodic train of impulses. Instead of impulses, the Audacity menu “Generate - Click Track” provides a dialog window with other options. But here the suggestion is to use Matlab/Octave and create a signal with <span class="ec-lmss-10x-x-109">N </span>discrete-time impulses <!-- l. 3115 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. Note that the analog signal corresponding to <!-- l. 3115 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> will never be the theoretical continuous-time <!-- l. 3115 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>δ</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. For example, assuming zero-order reconstruction (see Figure&nbsp;<a href="ak_dsp_bookse6.html#x13-3400223">1.23<!-- tex4ht:ref: fig:zoh  --></a>), the amplitude of <!-- l. 3115 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> would be held constant during the whole sampling interval <!-- l. 3115 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></math>. Aware of this limitation, Listing&nbsp;<a href="#x21-75102r29">1.29<!-- tex4ht:ref: code:snip_signals_inpulse_train  --></a> generates a train of <!-- l. 3116 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> discrete-time impulses and saves it to a WAVE file.
</p>
<!-- l. 3117 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.29: </span><span class="content">MatlabOctaveCodeSnippets/snip_signals_inpulse_train.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75102r1.14  -->
<pre class="lstinputlisting" id="listing-36"><span class="label"><a id="x21-75104r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 44100;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency</span> 
</span><span class="label"><a id="x21-75105r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1/Fs;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">period</span> 
</span><span class="label"><a id="x21-75106r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Timpulses</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 0.25;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">interval</span></span><span style="color:#005900"> <span class="ec-lmtt-9">between impules in seconds</span> 
</span><span class="label"><a id="x21-75107r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">floor</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Timpulses</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of samples between impulses</span> 
</span><span class="label"><a id="x21-75108r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 4;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of impulses</span> 
</span><span class="label"><a id="x21-75109r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">impulseTrain</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"><span class="ec-lmtt-9">,1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">allocate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">space with zeros</span> 
</span><span class="label"><a id="x21-75110r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">=16;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of bits per sample</span> 
</span><span class="label"><a id="x21-75111r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">amplitude</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 2^(b-1)-1;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">impulse</span></span><span style="color:#005900"> <span class="ec-lmtt-9">amplitude, max signed int</span> 
</span><span class="label"><a id="x21-75112r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">impulseTrain</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:</span></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">amplitude</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">impulses</span> 
</span><span class="label"><a id="x21-75113r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">writewav</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">impulseTrain</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">impulses</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">16</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">r</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">save</span></span><span style="color:#005900"> <span class="ec-lmtt-9">WAVE RIFF</span></span>
  </pre>
<figure class="figure">
<p><a id="x21-7511661"></a></p>
<!-- l. 3133 -->
<p class="noindent">
<img alt="PIC" src="FiguresNonScript/impulsesAudacity.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.61: </span><span class="content">Audacity window after reading in the ’impulses.wav’ file.</span>
</figcaption>
<!-- tex4ht:label?: x21-7511661  -->
</figure>
<!-- l. 3137 -->
<p class="indent">
Opening the generated file with Audacity should lead to Figure&nbsp;<a href="#x21-7511661">1.61<!-- tex4ht:ref: fig:impulsesAudacity  --></a>. Note the amplitudes have been normalized and the first impulse barely appears. In this case, as indicated by letter F in Figure&nbsp;<a href="#x21-7511661">1.61<!-- tex4ht:ref: fig:impulsesAudacity  --></a>, the selection region starts approximately at 1&nbsp;s. The interface is friendly and the letters C and D indicate how to switch between zooming the signal and enabling the cursor, respectively. After a segment is selected, letter E indicates how to easily zoom it to fit the selection. Instead of seconds (in letter F), it is sometimes convenient to use “samples”. Using the play button indicated with letter A plays the file.
</p>
<figure class="figure">
<p><a id="x21-7511762"></a></p>
<!-- l. 3143 -->
<p class="noindent">
<img alt="PIC" src="FiguresNonScript/latencyAudacity.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.62: </span><span class="content">Audacity window after simultaneously recording and playing ’impulses.wav’ with a loopback.</span>
</figcaption>
<!-- tex4ht:label?: x21-7511762  -->
</figure>
<!-- l. 3147 -->
<p class="indent">
At this point, a feature of Audacity that is useful for overdubbing can be used to simultaneously activate the DAC and ADC: when recording, Audacity also plays all the signals that are “open” (in this case, the “impulses” signal). With the audio cable connected in loopback, start recording (and playback) simply using button (letter B), stopping it after a second. The final situation should be similar to Figure&nbsp;<a href="#x21-7511762">1.62<!-- tex4ht:ref: fig:latencyAudacity  --></a>.
</p>
<!-- l. 3149 -->
<p class="indent">
From the code used to generate ’impulses.wav’ it can be seen that the impulses are separated by <!-- l. 3149 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>4</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>11025</mn></mrow></math> samples (the first one is at <!-- l. 3149 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>, the second at <!-- l. 3149 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>11026</mn></mrow></math> and so on). This information was used to impose the start selection (letter F in Figure&nbsp;<a href="#x21-7511661">1.61<!-- tex4ht:ref: fig:impulsesAudacity  --></a>) at sample 11,026 in Figure&nbsp;<a href="#x21-7511762">1.62<!-- tex4ht:ref: fig:latencyAudacity  --></a> (it is irrelevant here, but recall that the first index in Matlab/Octave is 1 but 0 in Audacity). The end of the selection was located approximately at the start of the second impulse of the recorded signal (bottom plot, identified as “Audio Track”). In this case, the number of samples of this selection indicate that the latency was approximately <!-- l. 3149 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2102</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>47</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>66</mn></mrow></math>&nbsp;ms.
</p>
<figure class="figure">
<p><a id="x21-7511863"></a></p>
<!-- l. 3153 -->
<p class="noindent">
<img alt="PIC" src="FiguresNonScript/estimatedImpulseResponse.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.63: </span><span class="content">Zoom of the response to the second impulse in Figure&nbsp;<a href="#x21-7511661">1.61<!-- tex4ht:ref: fig:impulsesAudacity  --></a>.</span>
</figcaption>
<!-- tex4ht:label?: x21-7511863  -->
</figure>
<!-- l. 3157 -->
<p class="indent">
At this point it may be useful to export the recorded signal as a WAVE file to be read in Matlab/Octave. First, you can close the window with the “impulses” signal (otherwise Audacity will ask if the two files should be merged) and use the “Export” menu. Assuming the output file name was <span class="ec-lmss-10x-x-109">impulseResponses.wav</span>, the command <span class="ec-lmss-10x-x-109">h=wavread(’impulseResponses.wav’) </span>can be used to generate the zoom of the second impulse response in Figure&nbsp;<a href="#x21-7511863">1.63<!-- tex4ht:ref: fig:estimatedImpulseResponse  --></a>. The concept of impulse response is very important, as discussed in Chapter&nbsp;<a href="ak_dsp_bookch3.html#x39-1100003">3<!-- tex4ht:ref: ch:systems  --></a>.
</p>
<!-- l. 3161 -->
<p class="indent">
Because the maximum absolute amplitude occurs at <!-- l. 3161 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>13037</mn></mrow></math> in Figure&nbsp;<a href="#x21-7511863">1.63<!-- tex4ht:ref: fig:estimatedImpulseResponse  --></a> and the corresponding impulse is located at <!-- l. 3161 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>11026</mn></mrow></math>, another estimate of the latency is <!-- l. 3161 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">(</mo><mn>13037</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>11026</mn><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>45</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn></mrow></math>&nbsp;ms. A detail is that for creating Figure&nbsp;<a href="#x21-7511863">1.63<!-- tex4ht:ref: fig:estimatedImpulseResponse  --></a>, the <span class="ec-lmss-10x-x-109">‘native’ </span>option of Matlab’s <span class="ec-lmss-10x-x-109">wavread</span> was used to avoid normalization and, consequently, the minimum signal value is <!-- l. 3162 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <msup><mrow><mn>2</mn></mrow><mrow><mi>b</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>32768</mn></mrow></math> not <!-- l. 3162 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></math>. &nbsp; &nbsp;<!-- l. 3163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 3165 -->
<p class="noindent">
<a id="x21-75119r5"></a> <span id="textcolor59"><span class="ec-lmbx-10x-x-109">Application 1.5.</span></span> <span class="ec-lmbx-10x-x-109">PC sound board quantizer</span>. Given a system with an ADC, typically one has to know beforehand or conduct measurements to obtain the quantizer step size <!-- l. 3167 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi></math>. This is the case when using a personal computer (PC) sound board. For a sound board, the value of <!-- l. 3167 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi></math> depends if the signal was acquired using the microphone input or the line-in input of the sound board. The microphone interface is designed for signals with peak value of <!-- l. 3167 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>X</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">max</mtext></mstyle></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math> to 100 mV while the peak for the line-in is typically 0.2 to 2&nbsp;V. Note that the voltage ranges of line inputs and microphones vary from card to card. See more details in [url1pcs]. For the sake of this discussion, one can assume a dynamic range of <!-- l. 3167 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>100</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>100</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> mV and a ADC of 8 bits per sample, such that <!-- l. 3167 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>200</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mn>2</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.78</mn></mrow></math> mV. The following example illustrates how to approximately recover the analog signal for visualization purposes. Assume the digital dynamic range is [0, 255] and the digital samples are <!-- l. 3168 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>D</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">[</mo><mn>13</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>126</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>3</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>34</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>254</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. If one simply uses <span class="ec-lmss-10x-x-109">stem(D)</span>, there is no information about time and amplitude. Listing&nbsp;<a href="#x21-75120r30">1.30<!-- tex4ht:ref: code:snip_signals_amplitude_normalization  --></a> shows the necessary normalizations to visualize the abscissa in seconds and the ordinate in Volts, which in this case corresponds to <span class="ec-lmss-10x-x-109">A=1000*[-89.70, -1.56, -97.50, -73.32, 98.28]</span>.
</p>
<!-- l. 3169 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.30: </span><span class="content">MatlabOctaveCodeSnippets/snip_signals_amplitude_normalization.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75120r1.14  -->
<pre class="lstinputlisting" id="listing-37"><span class="label"><a id="x21-75122r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">D</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[13</span></span><span style="color:#000000"> <span class="ec-lmtt-9">126 3 34 254];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">signal</span></span><span style="color:#005900"> <span class="ec-lmtt-9">as 8-bits unsigned [0, 255]</span> 
</span><span class="label"><a id="x21-75123r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[0:4];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sample</span></span><span style="color:#005900"> <span class="ec-lmtt-9">instants in the digital domain</span> 
</span><span class="label"><a id="x21-75124r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=8000;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency</span> 
</span><span class="label"><a id="x21-75125r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">delta</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.78</span></span><span style="color:#000000"><span class="ec-lmtt-9">e</span></span><span style="color:#000000"><span class="ec-lmtt-9">-3;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">step</span></span><span style="color:#005900"> <span class="ec-lmtt-9">size in Volts</span> 
</span><span class="label"><a id="x21-75126r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(</span></span><span style="color:#000000"><span class="ec-lmtt-9">D</span></span><span style="color:#000000"><span class="ec-lmtt-9">-128)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">delta</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">subtract</span></span><span style="color:#005900"> <span class="ec-lmtt-9">offset=128 and normalize by delta</span> 
</span><span class="label"><a id="x21-75127r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">interval in seconds</span> 
</span><span class="label"><a id="x21-75128r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">time</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">normalize</span></span><span style="color:#005900"> <span class="ec-lmtt-9">abscissa</span> 
</span><span class="label"><a id="x21-75129r8"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">time</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">compare</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with stem(n,D)</span> 
</span><span class="label"><a id="x21-75130r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">xlabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">time</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(s)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">ylabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">amplitude</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(V)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span>
                                                                              
                                                                              
  </pre>
<!-- l. 3182 -->
<p class="indent">
Now assume a PC computer with a sound board that uses a 16 bits ADC and supports at its input a dynamic range of <!-- l. 3183 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>185</mn></mrow></math> to <!-- l. 3183 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>185</mn></mrow></math>&nbsp;mV. The quantizer is similar to the one depicted in Figure&nbsp;<a href="ak_dsp_bookse8.html#x15-4600536">1.36<!-- tex4ht:ref: fig:quantizerdelta05  --></a>, but the quantization step should be <!-- l. 3183 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>185</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn></mrow></msup><mo class="MathClass-bin" stretchy="false">∕</mo><msup><mrow><mn>2</mn></mrow><mrow><mn>16</mn></mrow></msup> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>5.6</mn></mrow></math>&nbsp;<!-- l. 3183 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi></math>V. It is assumed here that <!-- l. 3183 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5.6</mn></mrow></math> <!-- l. 3183 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi></math>V&nbsp;and the quantizer is uniform from <!-- l. 3184 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <msup><mrow><mn>2</mn></mrow><mrow><mn>15</mn></mrow></msup><mi mathvariant="normal">Δ</mi></mrow></math> to <!-- l. 3184 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mn>2</mn></mrow><mrow><mn>15</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mi mathvariant="normal">Δ</mi></mrow></math>. In this case, the <!-- l. 3184 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>65</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>536</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mn>2</mn></mrow><mrow><mn>16</mn></mrow></msup></mrow></math> levels are organized as 32,767 positive levels, 32,768 negative levels and one level representing zero. The assumed coding scheme is the offset code of Table&nbsp;<a href="ak_dsp_bookse8.html#x15-520047">1.7<!-- tex4ht:ref: tab:outputcoding  --></a> with 32,768 as the offset. Hence, the smallest value <!-- l. 3184 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <msup><mrow><mn>2</mn></mrow><mrow><mn>15</mn></mrow></msup><mi mathvariant="normal">Δ</mi></mrow></math> is mapped to the 16-bits codeword “0000 0000 0000 0000”, <!-- l. 3184 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">(</mo><mo class="MathClass-bin" stretchy="false">−</mo><msup><mrow><mn>2</mn></mrow><mrow><mn>15</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mi mathvariant="normal">Δ</mi></mrow></math> to “0000 0000 0000 0001” and so on, with <!-- l. 3184 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mn>2</mn></mrow><mrow><mn>15</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mi mathvariant="normal">Δ</mi></mrow></math> being coded as “1111 1111 1111 1111”.
</p>
<!-- l. 3186 -->
<p class="indent">
If at a specific time <!-- l. 3186 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>t</mi></mrow><mrow><mn>0</mn></mrow></msub></math> the ADC input is <!-- l. 3186 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>t</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>x</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.003</mn></mrow></math> V, the ADC output is <!-- l. 3186 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>536</mn></mrow></math>, which corresponds to <!-- l. 3186 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>q</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.0030016</mn></mrow></math> V and leads to a quantization error <!-- l. 3186 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>e</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>x</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>x</mi></mrow><mrow><mi>q</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">≈</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>1.6</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>6</mn></mrow></msup></mrow></math> V. These results can be obtained in Matlab/Octave with
</p>
<!-- l. 3187 -->
<pre class="lstlisting" id="listing-38"><span class="label"><a id="x21-75133r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">delta</span></span><span style="color:#000000"><span class="ec-lmtt-9">=5.6</span></span><span style="color:#000000"><span class="ec-lmtt-9">e</span></span><span style="color:#000000"><span class="ec-lmtt-9">-6,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">b=16</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">define</span></span><span style="color:#005900"> <span class="ec-lmtt-9">parameters for the quantizer</span> 
</span><span class="label"><a id="x21-75134r2"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">format</span></span><span style="color:#000000"> <span class="ec-lmtt-9">long</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">see</span></span><span style="color:#005900"> <span class="ec-lmtt-9">numbers with many decimals</span> 
</span><span class="label"><a id="x21-75135r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=3</span></span><span style="color:#000000"><span class="ec-lmtt-9">e</span></span><span style="color:#000000"><span class="ec-lmtt-9">-3;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">[xq,xi]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ak_quantizer</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">delta</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">error</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">xq</span></span></pre>
<!-- l. 3192 -->
<p class="indent">
Based on similar reasoning, calculate the outputs <!-- l. 3192 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>x</mi></mrow><mrow><mi>i</mi></mrow></msub></math> of the quantizer, their respective <!-- l. 3192 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>x</mi></mrow><mrow><mi>q</mi></mrow></msub></math> values and the quantization error for <!-- l. 3192 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi> <mo class="MathClass-rel" stretchy="false">∈</mo><mo class="MathClass-open" stretchy="false">{</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>300</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>100</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>20</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>180</mn><mo class="MathClass-close" stretchy="false">}</mo></mrow></math> mV.
</p>
<!-- l. 3194 -->
<p class="indent">
If you have access to an oscilloscope and a function generator, try to estimate the value of <!-- l. 3194 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi></math> of your sound board, paying attention to the fact that some software/hardware combination use automatic gain control (AGC). You probably need to disable AGC to better control the acquisition.
</p>
<!-- l. 3196 -->
<p class="indent">
It is not trivial, but if you want to learn more about your sound board, try to evaluate its performance according to the procedure described at [url1bau]. &nbsp; &nbsp;<!-- l. 3197 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 3199 -->
<p class="noindent">
</p><p><a id="x21-75136r6"></a> <span id="textcolor60"><span class="ec-lmbx-10x-x-109">Application 1.6.</span></span> <span class="ec-lmbx-10x-x-109">Using </span><span class="ec-lmssbx-10x-x-109">rat </span><span class="ec-lmbx-10x-x-109">in Matlab/Octave to find the period of discrete-time sinusoids</span>. The Matlab/Octave function <span class="ec-lmss-10x-x-109">rat </span>for rational fraction approximation can be used for finding <!-- l. 3201 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math> and <!-- l. 3201 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>.</p>
But care must be exercised because <span class="ec-lmss-10x-x-109">rat </span>approximates the input argument within a given tolerance. The code below illustrates how this function can be used to obtain <!-- l. 3201 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math> and <!-- l. 3201 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>:
<p></p>
<!-- l. 3202 -->
<pre class="lstlisting" id="listing-39"><span class="label"><a id="x21-75137r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">=3*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/5</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">define</span></span><span style="color:#005900"> <span class="ec-lmtt-9">some angular frequency (rad)</span> 
</span><span class="label"><a id="x21-75138r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">m</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">rat</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">/(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> <span class="ec-lmtt-9">m and N</span></span></pre>
<!-- l. 3206 -->
<p class="indent">
In this case, the result is <span class="ec-lmss-10x-x-109">m=3, N=10</span>, as expected. However, note that <span class="ec-lmss-10x-x-109">w=0.2,[m,N]=rat(w/(2<em>pi)) </em></span><em>returns <span class="ec-lmss-10x-x-109">m=113, N=3550</span>, which is not precise (recall that if <!-- l. 3206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.2</mn></mrow></math> the sinusoid is non-periodic). Modifying the previous command to use a smaller tolerance <span class="ec-lmss-10x-x-109">w=0.2,[m,N]=rat(w/(2</span></em>pi),1e-300) gives much larger values for <span class="ec-lmss-10x-x-109">m,N</span>, which clearly indicates that the user must be aware that <span class="ec-lmss-10x-x-109">rat </span>uses approximations. Make sure you can generate discrete-time sinusoids with distinct values of <!-- l. 3207 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math> and <!-- l. 3207 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> and understand the roles played by these two values. &nbsp; &nbsp;<!-- l. 3208 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 3210 -->
<p class="noindent">
<a id="x21-75139r7"></a> <span id="textcolor61"><span class="ec-lmbx-10x-x-109">Application 1.7.</span></span> <span class="ec-lmbx-10x-x-109">Power of the sum of two signals</span>. Assume a signal <!-- l. 3212 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is generated by summing two real signals (similar result can be obtained for complex-valued signals) <!-- l. 3212 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 3212 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> with power <!-- l. 3212 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub></math> and <!-- l. 3212 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub></math>. The question is: What is the condition for having <!-- l. 3212 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>z</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub></mrow></math>?
</p>
<!-- l. 3214 -->
<p class="indent">
Assuming the two signals are random and using expected values (a similar result would hold for deterministic signals):
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 3215 -->
<p class="indent">
</p>
<!-- l. 3215 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x21-75140r69"></mstyle><!-- endlabel --><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>z</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>𝔼</mi><mo class="MathClass-open" stretchy="false">[</mo><msup><mrow><mstyle mathvariant="sans-serif"><mi>Z</mi></mstyle></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>𝔼</mi><mo class="MathClass-open" stretchy="false">[</mo><msup><mrow><mo class="MathClass-open" stretchy="false">(</mo><mstyle mathvariant="sans-serif"><mi>X</mi></mstyle> <mo class="MathClass-bin" stretchy="false">+</mo> <mstyle mathvariant="sans-serif"><mi>Y</mi></mstyle><mo class="MathClass-close" stretchy="false">)</mo></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow> <mi>x</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><mi>𝔼</mi><mo class="MathClass-open" stretchy="false">[</mo><mstyle mathvariant="sans-serif"><mi>X</mi></mstyle><mstyle mathvariant="sans-serif"><mi>Y</mi></mstyle><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(1.69)
</td>
</tr>

</tbody></table>
<!-- l. 3220 -->
<p class="indent">
</p><p>If <!-- l. 3220 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="sans-serif"><mi>X</mi></mstyle></math> and <!-- l. 3220 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle mathvariant="sans-serif"><mi>Y</mi></mstyle></math> are uncorrelated, i. e., <!-- l. 3220 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>𝔼</mi><mo class="MathClass-open" stretchy="false">[</mo><mstyle mathvariant="sans-serif"><mi>X</mi></mstyle><mstyle mathvariant="sans-serif"><mi>Y</mi></mstyle><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>𝔼</mi><mo class="MathClass-open" stretchy="false">[</mo><mstyle mathvariant="sans-serif"><mi>X</mi></mstyle><mo class="MathClass-close" stretchy="false">]</mo><mi>𝔼</mi><mo class="MathClass-open" stretchy="false">[</mo><mstyle mathvariant="sans-serif"><mi>Y</mi></mstyle><mo class="MathClass-close" stretchy="false">]</mo></mrow></math></p>
and at least one signal is zero-mean, Eq.&nbsp;(<a href="#x21-75140r69">1.69<!-- tex4ht:ref: eq:power_of_sum_correlated  --></a>) simplifies to
<p></p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 3221 -->
<p class="indent">
</p>
<!-- l. 3221 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x21-75141r70"></mstyle><!-- endlabel --><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>z</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>y</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(1.70)
</td>
</tr>

</tbody></table>
<!-- l. 3226 -->
<p class="indent">
This is a useful result for analyzing communication channels that model the noise as additive. These models assume the noise is uncorrelated to the transmitted signal and Eq.&nbsp;(<a href="#x21-75141r70">1.70<!-- tex4ht:ref: eq:power_of_sum_uncorrelated  --></a>) applies. &nbsp;&nbsp;<!-- l. 3229 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 3231 -->
<p class="noindent">
<a id="x21-75142r8"></a> <span id="textcolor62"><span class="ec-lmbx-10x-x-109">Application 1.8.</span></span> <span class="ec-lmbx-10x-x-109">Estimate the PDF of speech signals. </span>Via a normalized histogram, estimate the PDF of a speech signal with a long duration. After this estimation, you should convince yourself that uniform quantizers are not adequate for speech signals. In fact, when using a non-linear quantizer based on the A-law or <!-- l. 3231 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi></math>-law, it is possible to use only 8 bits to achieve the subjective quality of a linear PCM with 12 bits. Observe whether or not your histogram approaches a Laplacian density, as suggested by previous research in speech coding. &nbsp; &nbsp;<!-- l. 3233 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 3235 -->
<p class="noindent">
<a id="x21-75143r9"></a> <span id="textcolor63"><span class="ec-lmbx-10x-x-109">Application 1.9.</span></span> <span class="ec-lmbx-10x-x-109">A simple application of correlation analysis</span>. A company produces three distinct beauty creams: A, B and C. The task is the analysis of correlation in three databases, one for each product. The contents of each database can be represented by two vectors <!-- l. 3237 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></math> and <!-- l. 3237 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">y</mtext></mstyle></math>, with 1,000 elements each. Vector <!-- l. 3237 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">x</mtext></mstyle></math> informs the age of the consumer and <!-- l. 3237 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textbf" mathvariant="bold">y</mtext></mstyle></math> the number of his/her purchases of the respective cream (A, B or C) during one year, respectively. Figure&nbsp;<a href="#x21-7514464">1.64<!-- tex4ht:ref: fig:examplecorrelations  --></a> depicts scatter plots corresponding to each product.
</p>
<figure class="figure">
<p><a id="x21-7514464"></a></p>
<!-- l. 3241 -->
<p class="noindent">
<img alt="PIC" src="Figures/examplecorrelations.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.64: </span><span class="content">Scatter plot of customer age versus purchased units for three products. These two variables present positive correlation for product B, negative for C and are uncorrelated for product A.</span>
</figcaption>
<!-- tex4ht:label?: x21-7514464  -->
</figure>
<!-- l. 3245 -->
<p class="indent">
The empirical (the one calculated from the available data) covariance matrices and means were approximately the following: <!-- l. 3246 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">C</mtext></mstyle></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mtable align="axis" class="array" columnlines="none none none none none none none none none" displaystyle="true" equalcolumns="false" equalrows="false" style=""> <mtr class="array-row"><mtd class="array-td" columnalign="center"> <mn>4.08</mn> </mtd><mtd class="array-td" columnalign="center"> <mo class="MathClass-bin" stretchy="false">−</mo><mn>0.002</mn> </mtd></mtr> <mtr class="array-row"><mtd class="array-td" columnalign="center"> </mtd></mtr> <mtr class="array-row"><mtd class="array-td" columnalign="center"> </mtd></mtr> <mtr class="array-row"><mtd class="array-td" columnalign="center"> <mo class="MathClass-bin" stretchy="false">−</mo><mn>0.002</mn> </mtd> <mtd class="array-td" columnalign="center"> <mn>0.98</mn></mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable> </mrow><mo fence="true" form="postfix">]</mo></mrow></mrow></math>and <!-- l. 3254 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>μ</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">[</mo><mn>30</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>6.05</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, <!-- l. 3255 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">C</mtext></mstyle></mrow><mrow><mi>b</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mtable align="axis" class="array" columnlines="none none none none none none none none none" displaystyle="true" equalcolumns="false" equalrows="false" style=""> <mtr class="array-row"><mtd class="array-td" columnalign="center"> <mn>4.00</mn> </mtd><mtd class="array-td" columnalign="center"> <mn>0.99</mn> </mtd></mtr> <mtr class="array-row"><mtd class="array-td" columnalign="center"> </mtd></mtr> <mtr class="array-row"><mtd class="array-td" columnalign="center"> </mtd></mtr> <mtr class="array-row"><mtd class="array-td" columnalign="center"> <mn>0.99</mn> </mtd> <mtd class="array-td" columnalign="center"> <mn>1.00</mn></mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable> </mrow><mo fence="true" form="postfix">]</mo></mrow></mrow></math>and <!-- l. 3263 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>μ</mi></mrow><mrow><mi>b</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">[</mo><mn>30</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>12</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, <!-- l. 3264 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mstyle class="text"><mtext class="textbf" mathvariant="bold">C</mtext></mstyle></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mtable align="axis" class="array" columnlines="none none none none none none none none none" displaystyle="true" equalcolumns="false" equalrows="false" style=""> <mtr class="array-row"><mtd class="array-td" columnalign="center"> <mn>4.16</mn> </mtd><mtd class="array-td" columnalign="center"> <mo class="MathClass-bin" stretchy="false">−</mo><mn>1.46</mn> </mtd></mtr> <mtr class="array-row"><mtd class="array-td" columnalign="center"> </mtd></mtr> <mtr class="array-row"><mtd class="array-td" columnalign="center"> </mtd></mtr> <mtr class="array-row"><mtd class="array-td" columnalign="center"> <mo class="MathClass-bin" stretchy="false">−</mo><mn>1.46</mn> </mtd> <mtd class="array-td" columnalign="center"> <mn>2.02</mn></mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable> </mrow><mo fence="true" form="postfix">]</mo></mrow></mrow></math>and <!-- l. 3272 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>μ</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">[</mo><mn>30</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>13</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>7.99</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. The correlation coefficients are <!-- l. 3272 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>0.0011</mn></mrow></math>, <!-- l. 3272 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>b</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.4924</mn></mrow></math> and <!-- l. 3272 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ρ</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>0.5031</mn></mrow></math>.
</p>
<!-- l. 3274 -->
<p class="indent">
The plots and correlation coefficients indicate that when age increases, the sales of product B also increases (positive correlation). In contrast, the negative correlation of <!-- l. 3274 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ρ</mi></mrow><mrow><mi>b</mi></mrow></msub></math> indicates that the sales of product C decreases among older people. The sales of product A seem uncorrelated with age. The script <span class="ec-lmss-10x-x-109">figs_signals_correlationcoeff.m </span>allows to study how the data and figures were created. Your task is to learn how to generate two-dimensional Gaussians with arbitrary covariance matrices.
</p>
<!-- l. 3276 -->
<p class="indent">
Note that the correlation analysis was performed observing each product sales individually. You can assume the existence of a unique database, where each entry has four fields: age, sales of A, B and C. What kind of analysis do you foresee? For example, one could try a marketing campaign that combines two product if their sales are correlated. Or even use data mining tools to extract association rules that indicate how to organize the marketing. &nbsp; &nbsp;<!-- l. 3277 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 3279 -->
<p class="noindent">
</p><p><a id="x21-75145r10"></a> <span id="textcolor64"><span class="ec-lmbx-10x-x-109">Application 1.10.</span></span> <span class="ec-lmbx-10x-x-109">Playing with the autocorrelation function of white noise and sinusoids. </span>Using <span class="ec-lmss-10x-x-109">randn </span>in Matlab/Octave, generate a vector corresponding to a realization of a WGN process (see Example&nbsp;<a href="ak_dsp_bookse12.html#x19-72001r50">1.50<!-- tex4ht:ref: ex:autocorrelationWhite  --></a>): <span class="ec-lmss-10x-x-109">x=randn(1,1000)</span>. Check whether or not it is Gaussian by estimating the FDP (use <span class="ec-lmss-10x-x-109">hist</span>). Plot its autocorrelation with the proper axes. Generate a new signal that is uniformly distributed: <span class="ec-lmss-10x-x-109">y=rand(1,1000)-0.5; </span>and plot the same graphs as for the Gaussian signal. What does it happen with the autocorrelation if you add a DC level (add a constant to <span class="ec-lmss-10x-x-109">x </span>and <span class="ec-lmss-10x-x-109">y</span>)? And what if you multiply by a number (a “gain”)? Generate a cosine <span class="ec-lmss-10x-x-109">T=0.01; t=0:T:10-T; z=cos(2<em>pi</em>10*t); </span>of 10 Hz with a sampling frequency of 100 Hz. Take a look at the autocorrelation for lags from <!-- l. 3289 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>m</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>30</mn><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo><mo class="MathClass-punc" stretchy="false">,</mo><mn>30</mn></mrow></math> with <span class="ec-lmss-10x-x-109">[c,lags]=xcorr(z,30,’biased’);plot(lags,c)</span>. Compare this last plot with a zoom of the cosine: <span class="ec-lmss-10x-x-109">plot(z(1:30))</span>. Note that they have the same period. In fact, an autocorrelation <!-- l. 3292 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math> of <!-- l. 3292 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math> incorporates all the periodicity that is found in <!-- l. 3293 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math> as indicated by Eq.&nbsp;(<a href="ak_dsp_bookse12.html#x19-72005r64">1.64<!-- tex4ht:ref: eq:sinusoidcorrelation  --></a>). Make sure you can use Eq.&nbsp;(<a href="ak_dsp_bookse12.html#x19-72005r64">1.64<!-- tex4ht:ref: eq:sinusoidcorrelation  --></a>) to predict the plots you obtain with <span class="ec-lmss-10x-x-109">xcorr </span>when the signal is a sinusoid. &nbsp; &nbsp;<!-- l. 3295 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math></p>
<p></p>
<!-- l. 3297 -->
<p class="noindent">
<a id="x21-75146r11"></a> <span id="textcolor65"><span class="ec-lmbx-10x-x-109">Application 1.11.</span></span> <span class="ec-lmbx-10x-x-109">Using autocorrelation to estimate the cycle of sunspot activity</span>. The international sunspot number (also known as the Wolfer number) is a quantity that simultaneously measures the number and size of sunspots. A sunspot is a region on the Sun’s surface that is visible as dark spots. The number of sunspots correlates with the intensity of solar radiation: more sunspots means a brighter sun. This number has been collected and tabulated by researchers for around 300 years. They have found that sunspot activity is cyclical and reaches its maximum around every 9.5 to 11 years (in average, 10.4883 years).<span class="footnote-mark"><a href="#fn19x3" id="fn19x3-bk"><sup class="textsuperscript">19</sup></a></span><a id="x21-75147f19"></a> The autocorrelation can provide such estimate as indicated by the script below. Note that we are not interested in <!-- l. 3301 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>R</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, which is always the maximum value of <!-- l. 3301 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>R</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>τ</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. The lag of the largest absolute value of <!-- l. 3301 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>R</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>τ</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> other than <!-- l. 3301 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>R</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> indicates the signal fundamental period. Because theoretically no other value can be larger than <!-- l. 3301 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>R</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, the task of automatically finding the second peak (not the second largest sample), which is the one of interest, is not trivial. The code snippet below simply (not automatically) indicates the position of the second peak for the sunspot data.
</p>
<!-- l. 3302 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.31: </span><span class="content">MatlabOctaveCodeSnippets/snip_signals_peak_detection.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75149r1.14  -->
<pre class="lstinputlisting" id="listing-40"><span class="label"><a id="x21-75151r1"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">load</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sunspot</span></span><span style="color:#000000"><span class="ec-lmtt-9">.</span></span><span style="color:#000000"><span class="ec-lmtt-9">dat</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> <span class="ec-lmtt-9">data file</span> 
</span><span class="label"><a id="x21-75152r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">year</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sunspot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:,1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">first</span></span><span style="color:#005900"> <span class="ec-lmtt-9">column</span> 
</span><span class="label"><a id="x21-75153r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">wolfer</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sunspot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:,2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">second</span></span><span style="color:#005900"> <span class="ec-lmtt-9">column</span> 
</span><span class="label"><a id="x21-75154r4"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">plot</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">year</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"><span class="ec-lmtt-9">wolfer</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"> <span class="ec-lmtt-9">title(</span><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">Sunspot Data</span><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">) %plot raw data</span> 
</span><span class="label"><a id="x21-75155r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">wolfer</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">wolfer</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">remove</span></span><span style="color:#005900"> <span class="ec-lmtt-9">mean</span> 
</span><span class="label"><a id="x21-75156r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">R</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">lag</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">xcorr</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">autocorrelation</span> 
</span><span class="label"><a id="x21-75157r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">lag</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">R</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on;</span> 
</span><span class="label"><a id="x21-75158r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">index</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">find</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">lag</span></span><span style="color:#000000"><span class="ec-lmtt-9">==11)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">we</span></span><span style="color:#005900"> <span class="ec-lmtt-9">know the 2nd peak is lag=11</span> 
</span><span class="label"><a id="x21-75159r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">lag</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">index</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">R</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">index</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">r</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">MarkerSize</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,25)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75160r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">text</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">lag</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">index</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">+10,</span></span><span style="color:#000000"><span class="ec-lmtt-9">R</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">index</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">2</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">nd</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">peak at lag=11</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span>
  </pre>
<!-- l. 3315 -->
<p class="indent">
Figure&nbsp;<a href="#x21-7516365">1.65<!-- tex4ht:ref: fig:sunspotautocorrelation  --></a> shows the graph generated by the companion script <span class="ec-lmss-10x-x-109">figs_signals_correlation.m</span>. It complements the previous code snippet, showing how to extract the second peak automatically (this can be useful in other applications of the ACF). Your task is to study this code and get prepared to work with “pitch” estimation in Application&nbsp;<a href="#x21-75164r12">1.12<!-- tex4ht:ref: app:pitch  --></a>.
</p>
<figure class="figure">
<p><a id="x21-7516365"></a></p>
<!-- l. 3319 -->
<p class="noindent">
<img alt="PIC" src="Figures/sunspotautocorrelation.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.65: </span><span class="content">Autocorrelation of the sunspot data.</span>
</figcaption>
<!-- tex4ht:label?: x21-7516365  -->
</figure>
<!-- l. 3323 -->
<p class="indent">
An important aspect of the sunspot task is the interpretation of <!-- l. 3323 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>R</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>τ</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. As discussed, when the autocorrelation has a peak, it is an indication of high similarity, i. e., periodicity. In the sunspot application, the interval between two lags was one year. If the ACF is obtained from a signal sampled at <!-- l. 3324 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> Hz, this interval between lags is the sampling period <!-- l. 3324 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> and it is relatively easy to normalize the lag axis. The next example illustrates the procedure. &nbsp; &nbsp;<!-- l. 3325 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 3327 -->
<p class="noindent">
<a id="x21-75164r12"></a> <span id="textcolor66"><span class="ec-lmbx-10x-x-109">Application 1.12.</span></span> <span class="ec-lmbx-10x-x-109">Using autocorrelation to estimate the “pitch”</span>. This application studies a procedure to record speech, estimate the average fundamental frequency <!-- l. 3329 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mn>0</mn></mrow></math> (also erroneously but commonly called <span class="ec-lmri-10x-x-109">pitch</span>) via autocorrelation and play a sinusoid with a frequency proportional to <!-- l. 3329 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mn>0</mn></mrow></math>.
</p>
<!-- l. 3331 -->
<p class="indent">
One can estimate the fundamental frequency of a speech signal by looking for a peak in the delay interval corresponding to the normal pitch range in speech.<span class="footnote-mark"><a href="#fn20x3" id="fn20x3-bk"><sup class="textsuperscript">20</sup></a></span><a id="x21-75165f20"></a> The following script illustrates the procedure.
</p>
<!-- l. 3332 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.32: </span><span class="content">MatlabOctaveCodeSnippets/snip_signals_fundamental_frequency.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75167r1.14  -->
<pre class="lstinputlisting" id="listing-41"><span class="label"><a id="x21-75169r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=44100;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency</span> 
</span><span class="label"><a id="x21-75170r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">interval</span> 
</span><span class="label"><a id="x21-75171r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">minF0Frequency</span></span><span style="color:#000000"><span class="ec-lmtt-9">=80;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">minimum</span></span><span style="color:#005900"> <span class="ec-lmtt-9">F0 frequency in Hz</span> 
</span><span class="label"><a id="x21-75172r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">maxF0Frequency</span></span><span style="color:#000000"><span class="ec-lmtt-9">=300;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">minimum</span></span><span style="color:#005900"> <span class="ec-lmtt-9">F0 frequency in Hz</span> 
</span><span class="label"><a id="x21-75173r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">minF0Period</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1/minF0Frequency;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">correponding</span></span><span style="color:#005900"> <span class="ec-lmtt-9">F0 (sec)</span> 
</span><span class="label"><a id="x21-75174r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">maxF0Period</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1/maxF0Frequency;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">correponding</span></span><span style="color:#005900"> <span class="ec-lmtt-9">F0 (sec)</span> 
</span><span class="label"><a id="x21-75175r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Nbegin</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">round</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">maxF0Period</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of lags for max freq.</span> 
</span><span class="label"><a id="x21-75176r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Nend</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">round</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">minF0Period</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of lags for min freq.</span> 
</span><span class="label"><a id="x21-75177r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> <span class="ec-lmtt-9">0</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">record</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sound or test with 300 Hz cosine</span> 
</span><span class="label"><a id="x21-75178r10"></a><span class="ec-lmr-6">10</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">audiorecorder</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">16, 1);</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">object</span></span><span style="color:#005900"> <span class="ec-lmtt-9">audiorecorder</span> 
</span><span class="label"><a id="x21-75179r11"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Started</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">recording. Say a vowel a, e, i, o or u</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x21-75180r12"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">recordblocking</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">,2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">record</span></span><span style="color:#005900"> <span class="ec-lmtt-9">2 s and store in object r</span> 
</span><span class="label"><a id="x21-75181r13"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">finished</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">recording</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75182r14"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">double</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">getaudiodata</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">int16</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">get</span></span><span style="color:#005900"> <span class="ec-lmtt-9">recorded data</span> 
</span><span class="label"><a id="x21-75183r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">else</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">test</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with a cosine</span> 
</span><span class="label"><a id="x21-75184r16"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*300*[0:2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1]*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">300</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Hz, duration 2 secs</span> 
</span><span class="label"><a id="x21-75185r17"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x21-75186r18"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(211)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">*[0:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1],</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75187r19"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">xlabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">time</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(s)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">ylabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Signal</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">y(t)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x21-75188r20"></a><span class="ec-lmr-6">20</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">R</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">xcorr</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nend</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">biased</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">ACF</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with max lag Nend</span> 
</span><span class="label"><a id="x21-75189r21"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(212)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">autocorrelation</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with normalized abscissa</span> 
</span><span class="label"><a id="x21-75190r22"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">R</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">xlabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">lag</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(s)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75191r23"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">ylabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Autocorrelation</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">of y(t)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x21-75192r24"></a></span><span style="color:#000000"><span class="ec-lmtt-9">firstIndex</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">find</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">==</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nbegin</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> <span class="ec-lmtt-9">index of lag</span> 
</span><span class="label"><a id="x21-75193r25"></a><span class="ec-lmr-6">25</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rpartial</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= R(firstIndex:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">just</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the region of interest</span> 
</span><span class="label"><a id="x21-75194r26"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rmax</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">relative_index_max]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rpartial</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75195r27"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Rpartial</span></span><span style="color:#005900"> <span class="ec-lmtt-9">was just part of R, so recalculate the index:</span> 
</span><span class="label"><a id="x21-75196r28"></a></span><span style="color:#000000"><span class="ec-lmtt-9">index_max</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= firstIndex - 1 + relative_index_max;</span> 
</span><span class="label"><a id="x21-75197r29"></a></span><span style="color:#000000"><span class="ec-lmtt-9">lag_max</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= lags(index_max);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">get</span></span><span style="color:#005900"> <span class="ec-lmtt-9">lag corresponding to index</span> 
</span><span class="label"><a id="x21-75198r30"></a><span class="ec-lmr-6">30</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">show</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the point:</span> 
</span><span class="label"><a id="x21-75199r31"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">lag_max</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rmax</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">xr</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">markersize</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,20)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75200r32"></a></span><span style="color:#000000"><span class="ec-lmtt-9">F0</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1/(lag_max*Ts);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">estimated</span></span><span style="color:#005900"> <span class="ec-lmtt-9">F0 frequency (Hz)</span> 
</span><span class="label"><a id="x21-75201r33"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">fprintf</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Rmax</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">=%</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">g</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">lag_max=%g T=%g (s) Freq.=%g Hz\n</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,...</span></span> 
<span class="label"><a id="x21-75202r34"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">Rmax</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">lag_max</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">lag_max</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">F0</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75203r35"></a><span class="ec-lmr-6">35</span></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">:2;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">soundsc</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*3*</span></span><span style="color:#000000"><span class="ec-lmtt-9">F0</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">play</span></span><span style="color:#005900"> <span class="ec-lmtt-9">freq. 3*F0</span></span>
  </pre>
<!-- l. 3371 -->
<p class="indent">
Figure&nbsp;<a href="#x21-7520666">1.66<!-- tex4ht:ref: fig:sinusoidautocorrelation  --></a> was generated using the previous script with the signal <!-- l. 3371 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> consisting of a cosine of 300 Hz instead of digitized speech (simply change the logical condition of the “if”).
</p>
<figure class="figure">
<p><a id="x21-7520666"></a></p>
<!-- l. 3375 -->
<p class="noindent">
<img alt="PIC" src="Figures/sinusoidautocorrelation.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.66: </span><span class="content">Autocorrelation of a cosine of 300 Hz. The autocorrelation is also periodic. The period in terms of lags is 1/300 s.</span>
</figcaption>
<!-- tex4ht:label?: x21-7520666  -->
</figure>
<!-- l. 3378 -->
<p class="indent">
The code outputs the following results:<br class="newline"><span class="ec-lmss-10x-x-109">Rmax=0.49913 lag_max=147 T=0.00333333 (sec) Frequency=300 Hz</span><br class="newline">Note that the autocorrelation was normalized <span class="ec-lmss-10x-x-109">xcorr(y,Nend,’biased’)</span>, which led to <!-- l. 3380 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>R</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.5</mn></mrow></math> Watts, coinciding with the sinusoid power <!-- l. 3380 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mrow><mi>A</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math>, where <!-- l. 3380 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> V is the sinusoid amplitude.
</p>
<!-- l. 3382 -->
<p class="indent">
As commonly done, in spite of dealing with discrete-time signals, the graphs assume the signals are approximating a continuous-time signal and ACF. Hence, the abscissa is <!-- l. 3382 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math>, not <!-- l. 3382 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math>.
</p>
<!-- l. 3384 -->
<p class="indent">
Some PC sound boards heavily attenuate the signals around 100 Hz. Therefore, the last command multiplies the estimated <!-- l. 3384 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mn>0</mn></mrow></math> by 3, to provide a more audible tone. Modify the last line of the code to use <!-- l. 3384 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mn>0</mn></mrow></math> instead of <!-- l. 3384 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>3</mn><mi>F</mi><mn>0</mn></mrow></math> and observe the result of varying F0 with your own voice. Then try to improve the code to create your own F0 estimation algorithm. Find on the Web a Matlab/Octave F0 (or pitch) estimation algorithm to be the baseline (there is one at [url1pit]) and compare it with your code. Use the same input files for a fair comparison and superimpose the pitch tracks to spectrograms to better compare them. If you enjoy speech processing, try to get familiar with Praat&nbsp;[url1pra] and similar softwares and compare their F0 estimations with yours. &nbsp; &nbsp;<!-- l. 3388 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 3390 -->
<p class="noindent">
<a id="x21-75207r13"></a> <span id="textcolor67"><span class="ec-lmbx-10x-x-109">Application 1.13.</span></span> <span class="ec-lmbx-10x-x-109">Using cross-correlation for synchronization of two signals or time-alignment</span>. Assume a discrete-time signal <!-- l. 3392 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is transmitted through a communication channel and the receiver obtains a delayed and distorted version <!-- l. 3392 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. The task is to estimate the delay imposed by the channel. The transmitter does not “stamp” the time when the transmission starts, but uses a predefined preamble sequence <!-- l. 3392 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>p</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> that is known by the receiver. The receiver will then guess the beginning of the transmitted message by searching for the preamble sequence in <!-- l. 3392 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> via cross-correlation. Before trying an example that pretends to be realistic, some simple manipulations can clarify the procedure.
</p>
<!-- l. 3394 -->
<p class="indent">
</p><p>Assume we want to align the signal <!-- l. 3394 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>3</mn><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>2</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> with <!-- l. 3394 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>2</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>4</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. Intuitively, the signal <!-- l. 3394 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is a good match to <!-- l. 3394 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. Alternatively, <!-- l. 3394 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> matches <!-- l. 3394 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>.</p>
The Matlab/Octave command <span class="ec-lmss-10x-x-109">xcorr(x,y) </span>for cross-correlation can help finding the best lag <!-- l. 3394 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math> such that <!-- l. 3394 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>L</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> matches <!-- l. 3394 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. The procedure is illustrated below:
<p></p>
<!-- l. 3395 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.33: </span><span class="content">MatlabOctaveCodeSnippets/snip_signals_cross_correlation.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75208r1.14  -->
<pre class="lstinputlisting" id="listing-42"><span class="label"><a id="x21-75210r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1:3;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">some</span></span><span style="color:#005900"> <span class="ec-lmtt-9">signal</span> 
</span><span class="label"><a id="x21-75211r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[(3:-1:1)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> <span class="ec-lmtt-9">other signal</span> 
</span><span class="label"><a id="x21-75212r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">xcorr</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cross-correlation</span> 
</span><span class="label"><a id="x21-75213r4"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">show</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the maximum cross-correlation value</span> 
</span><span class="label"><a id="x21-75214r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= lags(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">find</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">==</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">lag</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for max cross-correlation</span> 
</span><span class="label"><a id="x21-75215r6"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">plot</span></span> 
<span class="label"><a id="x21-75216r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">xlabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">lag</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(samples)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">ylabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">cross</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">-</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">correlation</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span>
  </pre>
<!-- l. 3396 -->
<p class="indent">
The result is <!-- l. 3396 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>L</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn></mrow></math>. If the order is swapped to <span class="ec-lmss-10x-x-109">xcorr(y,x) </span>as below, the result is <!-- l. 3396 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>L</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn></mrow></math>.
</p>
<!-- l. 3397 -->
<pre class="lstlisting" id="listing-43"><span class="label"><a id="x21-75219r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">xcorr</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75220r2"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">show</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the maximum cross-correlation value</span> 
</span><span class="label"><a id="x21-75221r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">maxlag</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">find</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">==</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">max</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cross-correlation y,x lag</span></span></pre>
<!-- l. 3403 -->
<p class="indent">
It should be noticed that the cross-correlation is far from perfect with respect to capturing similarity between waveforms. For example, if <!-- l. 3403 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is changed to <span class="ec-lmss-10x-x-109">y=[(4:-1:1) x]</span>, the previous commands would indicate the best lag as <!-- l. 3403 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>L</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>. The reader is invited to play with simple signals and find more evidence of this limitation. As a rule of thumb, the cross-correlation will work well if one of the signals is a delayed version of the other, without significant distortion. However, in situations such as reverberant rooms where one of the signals is composed by a sum of multi-path (with distinct delays) versions of the other signal, more sophisticated techniques should be used.
</p>
<!-- l. 3406 -->
<p class="indent">
Another aspect is that, in some applications, the best similarity measure is the absolute value of the cross-correlation (i. e., <span class="ec-lmss-10x-x-109">L = lags(find(abs(c)==max(abs(c))))</span> instead of <span class="ec-lmss-10x-x-109">L = lags(find(c==max(c)))</span>). For example, this is the case when <!-- l. 3406 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> can be compared either to <!-- l. 3406 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> or <!-- l. 3406 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>.
</p>
<!-- l. 3408 -->
<p class="indent">
Listing&nbsp;<a href="#x21-75222r34">1.34<!-- tex4ht:ref: code:snip_signals_time_delay  --></a> illustrates the delay estimation between two signals <!-- l. 3408 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 3408 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. The vector <span class="ec-lmss-10x-x-109">y</span>, representing <!-- l. 3408 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, is obtained by delaying <span class="ec-lmss-10x-x-109">x </span>and adding Gaussian noise to have a given SNR.
</p>
<!-- l. 3409 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.34: </span><span class="content">MatlabOctaveCodeSnippets/snip_signals_time_delay.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75222r1.14  -->
<pre class="lstinputlisting" id="listing-44"><span class="label"><a id="x21-75224r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=8000;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency</span> 
</span><span class="label"><a id="x21-75225r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">interval</span> 
</span><span class="label"><a id="x21-75226r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1.5*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">1.5</span></span><span style="color:#005900"> <span class="ec-lmtt-9">seconds</span> 
</span><span class="label"><a id="x21-75227r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1]*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75228r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> <span class="ec-lmtt-9">1</span> 
</span><span class="label"><a id="x21-75229r6"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">rand</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-0.5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">zero</span></span><span style="color:#005900"> <span class="ec-lmtt-9">mean uniformly distributed</span> 
</span><span class="label"><a id="x21-75230r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">else</span></span> 
<span class="label"><a id="x21-75231r8"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*100*</span></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">cosine</span></span> 
<span class="label"><a id="x21-75232r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x21-75233r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">delayInSamples</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2000;</span></span> 
<span class="label"><a id="x21-75234r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">timeDelay</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= delayInSamples*Ts</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">delay</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in seconds</span> 
</span><span class="label"><a id="x21-75235r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">delayInSamples</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x(1:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">delayInSamples</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">];</span></span> 
<span class="label"><a id="x21-75236r13"></a></span><span style="color:#000000"><span class="ec-lmtt-9">SNRdb</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">specified</span></span><span style="color:#005900"> <span class="ec-lmtt-9">SNR</span> 
</span><span class="label"><a id="x21-75237r14"></a></span><span style="color:#000000"><span class="ec-lmtt-9">signalPower</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75238r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#000000"><span class="ec-lmtt-9">noisePower</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">signalPower</span></span><span style="color:#000000"><span class="ec-lmtt-9">/(10^(</span></span><span style="color:#000000"><span class="ec-lmtt-9">SNRdb</span></span><span style="color:#000000"><span class="ec-lmtt-9">/10)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75239r16"></a></span><span style="color:#000000"><span class="ec-lmtt-9">noise</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sqrt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">noisePower</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">size</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75240r17"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">noise</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75241r18"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(211)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75242r19"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">xcorr</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> <span class="ec-lmtt-9">crosscorrelation</span> 
</span><span class="label"><a id="x21-75243r20"></a><span class="ec-lmr-6">20</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(212)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75244r21"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the lag for maximum absolute crosscorrelation:</span> 
</span><span class="label"><a id="x21-75245r22"></a></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= lags(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">find</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">==</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75246r23"></a></span><span style="color:#000000"><span class="ec-lmtt-9">estimatedTimeDelay</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= L*Ts</span></span>
  </pre>
<!-- l. 3436 -->
<p class="indent">
Figure&nbsp;<a href="#x21-7524967">1.67<!-- tex4ht:ref: fig:delayestimation  --></a> illustrates the result of running the previous code. The random signals have zero mean and uniformly distributed samples. The estimated delay via <span class="ec-lmss-10x-x-109">xcorr(x,y) </span>was -0.25 s. The negative value indicates that <span class="ec-lmss-10x-x-109">x </span>is advanced with respect to <span class="ec-lmss-10x-x-109">y</span>. The command <span class="ec-lmss-10x-x-109">xcorr(y,x)</span> would lead to a positive delay of 0.25 s.
</p>
<figure class="figure">
<p><a id="x21-7524967"></a></p>
<!-- l. 3440 -->
<p class="noindent">
<img alt="PIC" src="Figures/delayestimation.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;1.67: </span><span class="content">First graph shows signals <!-- l. 3441 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 3441 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.25</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> contaminated by AWGN at an SNR of 10 dB. The signal <!-- l. 3441 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> can be identified by a smaller amplitude in the beginning, where its samples are due to noise only. The second graph shows their cross-correlation <!-- l. 3441 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>R</mi></mrow><mrow><mi mathvariant="italic">XY</mi> </mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>τ</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> indicating the delay of -0.25 s. </span>
</figcaption>
<!-- tex4ht:label?: x21-7524967  -->
</figure>
<!-- l. 3444 -->
<p class="indent">
After running the code as it is, observe what happens if <span class="ec-lmss-10x-x-109">x=rand(1,N)</span>, i. e., use a signal with a mean different than zero (0.5, in this case). In this case, the correlation is affected in a way that the peak indicating the delay is less pronounced. Another test is to use a cosine (modify the <span class="ec-lmss-10x-x-109">if</span>) with <span class="ec-lmss-10x-x-109">delayInSamples </span>assuming a small value with respect to the total length <span class="ec-lmss-10x-x-109">N </span>of the vectors. The estimation can fail, indicating the delay to be zero. Another parameter to play with is the SNR. Use values smaller than 10 dB to visualize how the correlation can be useful even with negative SNR.
</p>
<!-- l. 3446 -->
<p class="indent">
It is important to address another issue: comparing vectors of different length. Assume two signals <!-- l. 3446 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 3446 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> should be aligned in time and then compared sample-by-sample, for example to calculate the error <!-- l. 3446 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. There is a small problem for Matlab/Octave if the vectors have a different length. Assuming that <span class="ec-lmss-10x-x-109">xcorr(x,y) </span>indicated the best lag is positive (<!-- l. 3447 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>L</mi> <mo class="MathClass-rel" stretchy="false">&gt;</mo> <mn>0</mn></mrow></math>), an useful post-processing for comparing <!-- l. 3447 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 3447 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is to delete samples of <!-- l. 3447 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. If <!-- l. 3447 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math> is negative, the first samples of <!-- l. 3447 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> can be deleted. Listing&nbsp;<a href="#x21-75250r35">1.35<!-- tex4ht:ref: code:snip_signals_time_aligment  --></a> illustrates the operation and makes sure that the vectors representing the signals have the same length.
</p>
<!-- l. 3448 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;1.35: </span><span class="content">MatlabOctaveCodeSnippets/snip_signals_time_aligment.m</span>
</figcaption>
<!-- tex4ht:label?: x21-75250r1.14  -->
<pre class="lstinputlisting" id="listing-45"><span class="label"><a id="x21-75252r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[1</span></span><span style="color:#000000"> <span class="ec-lmtt-9">-2 3 4 5 -1];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">some</span></span><span style="color:#005900"> <span class="ec-lmtt-9">signal</span> 
</span><span class="label"><a id="x21-75253r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[3</span></span><span style="color:#000000"> <span class="ec-lmtt-9">1 -2 -2 1 -4 -3 -5 -10];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> <span class="ec-lmtt-9">other signal</span> 
</span><span class="label"><a id="x21-75254r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">xcorr</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> <span class="ec-lmtt-9">crosscorrelation</span> 
</span><span class="label"><a id="x21-75255r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= lags(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">find</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">==</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">lag</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for the maximum</span> 
</span><span class="label"><a id="x21-75256r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> <span class="ec-lmtt-9">L&gt;0</span> 
</span><span class="label"><a id="x21-75257r6"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:</span></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">delete</span></span><span style="color:#005900"> <span class="ec-lmtt-9">first L samples from x</span> 
</span><span class="label"><a id="x21-75258r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">else</span></span> 
<span class="label"><a id="x21-75259r8"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:-</span></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">delete</span></span><span style="color:#005900"> <span class="ec-lmtt-9">first L samples from y</span> 
</span><span class="label"><a id="x21-75260r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x21-75261r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">&gt;</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">make</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sure lengths are the same</span> 
</span><span class="label"><a id="x21-75262r11"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75263r12"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">else</span></span> 
<span class="label"><a id="x21-75264r13"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x21-75265r14"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x21-75266r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">title</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">error</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">between aligned x and y</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span>
  </pre>
<!-- l. 3466 -->
<p class="indent">
</p><p>Elaborate and execute the following experiment: record two utterances of the same word, storing the first in a vector <span class="ec-lmss-10x-x-109">x </span>and the second in <span class="ec-lmss-10x-x-109">y</span>. Align the two signals via cross-correlation and calculate the mean-squared error (MSE) between them (for the MSE calculation it may be necessary to have vectors of the same length, as discussed). &nbsp; &nbsp;<!-- l. 3467 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math></p>
<p></p>
<div class="footnotes">
<a id="x21-75099x18"></a> <!-- l. 3095 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn18x3-bk" id="fn18x3"><sup class="textsuperscript">18</sup>&nbsp;</a></span><span class="ec-lmr-9">Note that some computers do not have a sound input connector (microphone or line in) and an external (e. g., USB-based) sound board would be required.</span>
</p>
<a id="x21-75148x19"></a> <!-- l. 3300 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn19x3-bk" id="fn19x3"><sup class="textsuperscript">19</sup>&nbsp;</a></span><span class="ec-lmr-9">See, e. g., [url1sun] for more information. Note also that Matlab has a script </span><span class="ec-lmss-9">sunspots.m </span><span class="ec-lmr-9">that works in the frequency domain.</span>
</p>
<a id="x21-75166x20"></a> <!-- l. 3331 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn20x3-bk" id="fn20x3"><sup class="textsuperscript">20</sup>&nbsp;</a></span><span class="ec-lmr-9">Adult male speakers have a pitch range typically in the range [110,&nbsp;130] Hz, while females have pitch in [200,&nbsp;230] Hz. You may get an idea if you like Hollywood: it has been said that Sean Connery, Mel Gibson, Barbra Streisand and Julia Roberts have an average pitch of 158, 108, 228 and 171 Hz, respectively.</span>
</p>
<pre><code>                                                                                                              &lt;/div&gt;</code></pre>





</div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ak_dsp_bookse13.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Linear Model for Quantization</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ak_dsp_bookse15.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Digital Signal Processing with Python, Matlab or Octave, Applications in Machine Learning Aldebaro Klautau Federal University of Pará (UFPA), Brazil</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>