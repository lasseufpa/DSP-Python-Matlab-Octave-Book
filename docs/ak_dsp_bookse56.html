<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aldebaro Klautau">

<title>Digital Signal Processing with Python, Matlab or Octave - 56&nbsp; Nonparametric PSD Estimation via Welch’s method</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ak_dsp_bookse57.html" rel="next">
<link href="./ak_dsp_bookse55.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ak_dsp_bookch4.html">Spectral Estimation Techniques</a></li><li class="breadcrumb-item"><a href="./ak_dsp_bookse56.html"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Welch’s method</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Digital Signal Processing with Python, Matlab or Octave</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Tables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listings</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Signals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analog, Digital and Discrete-Time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basic Signal Manipulation and Representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Block Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Complex-Valued and Sampled Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modeling the Stages in A/D and D/A Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Relating Frequencies in Continuous, Sampled and Discrete-time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">An Introduction to Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Signal Categorization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Power and Energy in Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Relating Power in Continuous and Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Correlation: Finding Trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Linear Model for Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforms and Signal Representation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Linear Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inner Products to Obtain the Transform Coefficients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Block Transforms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Fourier Transforms and Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Relating discrete and analog frequencies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Summary of equations for DFT / FFT Usage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Laplace Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Z Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Contrasting Signals and Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Analog and Digital Filters: A Quick Hands-On Tour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Linear Time-Invariant Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Sampling and Signal Reconstruction Revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse36.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Facts About First and Second-Order Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse37.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Bandwidth and Quality Factor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse38.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Importance of Linear Phase (or Constant Group Delay)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse39.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Filtering technologies: Surface acoustic wave (SAW) and others</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse40.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse41.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">IIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse42.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Bilinear Transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse43.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">FIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse44.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Realization of Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse45.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multirate Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse46.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse47.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse48.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse49.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spectral Estimation Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse51.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse52.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Windows for spectral analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse53.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">The ESD, PSD and MS Spectrum functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse54.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Filtering Random Signals and the Impact on PSDs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse55.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Periodogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse56.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Welch’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse57.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Parametric PSD Estimation via Autoregressive (AR) Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse58.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Time-frequency Analysis using the Spectrogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse59.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse60.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse61.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse62.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">ak_dsp_bookap1.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Useful Mathematics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Useful Softwares and Programming Tricks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Welch’s method</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<meta charset="utf-8">
<meta content="TeX4ht (https://tug.org/tex4ht/)" name="generator">
<meta content="width=device-width,initial-scale=1" name="viewport">
<link href="ak_dsp_book.css" rel="stylesheet" type="text/css">
<meta content="ak_dsp_book.tex" name="src">
<script async="async" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js" type="text/javascript"></script>


<!-- l. 1582 -->
<p class="noindent">
This section discusses Welch’s method, one of the most popular nonparametric PSD Estimation method.
</p>
<!-- l. 1586 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.7.1</span>&nbsp;&nbsp;<a id="x66-2390004.7.1"></a>The periodogram variance does not decrease with <span class="ec-lmri-10x-x-109">N</span>
</h4>
<!-- l. 1588 -->
<p class="noindent">
It may seem counterintuitive but, as Figure&nbsp;<a href="ak_dsp_bookse55.html#x65-23606011">4.11<!-- tex4ht:ref: fig:periodogram  --></a> indicates, increasing the number <!-- l. 1589 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> of samples does not decrease the variance of the periodogram estimates <!-- l. 1589 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>.
</p>
<!-- l. 1592 -->
<p class="indent">
In fact, it is well-known in spectral analysis theory<span class="footnote-mark"><a href="#fn7x6" id="fn7x6-bk"><sup class="textsuperscript">7</sup></a></span><a id="x66-239001f7"></a> that the periodogram <!-- l. 1592 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is an unbiased estimator of the true PSD <!-- l. 1592 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, i. e.,
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 1593 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <munder class="msub"><mrow><mtext class="qopname">lim</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo> </mrow><mrow><mi>N</mi><mo class="MathClass-rel" stretchy="false">→</mo><mi>∞</mi></mrow></munder><mi>𝔼</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 1596 -->
<p class="indent">
In other words, the average periodogram converges to the right values as <!-- l. 1596 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> increases.
</p>
<!-- l. 1598 -->
<p class="indent">
However, the variance of the periodogram estimator is approximately <!-- l. 1598 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mrow><mi>S</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> even for large <!-- l. 1598 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>. This is a consequence of a result that is valid under mild conditions:
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1599 -->
<p class="indent">
</p>
<!-- l. 1599 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x66-239003r52"></mstyle><!-- endlabel --><mi>𝔼</mi><mo class="MathClass-open" stretchy="false">[</mo><msup><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-close" stretchy="false">)</mo></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mi>S</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>R</mi></mrow><mrow> <mi>N</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(4.52)
</td>
</tr>

</tbody></table>
<!-- l. 1603 -->
<p class="indent">
where <!-- l. 1603 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>R</mi></mrow><mrow><mi>N</mi></mrow></msub></math> tends to zero when <!-- l. 1603 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">→</mo><mi>∞</mi></mrow></math>. In other words, the standard deviation of the periodogram is approximately as large as the spectrum it should estimate. Using windows such as Hamming and Hann can improve the spectral analysis, but do not help with respect to the variance of the periodogram.
</p>
<!-- l. 1608 -->
<p class="indent">
One may expect that increasing the number <!-- l. 1608 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> of samples would lead to a better estimate of the PSD. In fact, the estimation does improve, but with respect to its frequency resolution <!-- l. 1608 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math>, not the variance.
</p>
<!-- l. 1610 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.7.2</span>&nbsp;&nbsp;<a id="x66-2400004.7.2"></a>Welch’s method for PSD estimation
</h4>
<!-- l. 1612 -->
<p class="noindent">
The main strategy to decrease the variance of a PSD estimation is to split the available data into <!-- l. 1612 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math> segments of <!-- l. 1612 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math> samples each, calculate the periodogram for each segment and then take their average. Methods such as Bartlett’s and Welch’s are based on this principle. The disadvantage of using less (<!-- l. 1613 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">&lt;</mo> <mi>N</mi></mrow></math>) samples is that the frequency resolution <!-- l. 1613 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi></mrow></math> decreases (from <!-- l. 1613 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> to <!-- l. 1613 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mi>M</mi></mrow></math>).
</p>
<!-- l. 1615 -->
<p class="indent">
</p><p>The main distinction between Bartlett’s and Welch’s methods is that the latter tries to combat the decrease in <!-- l. 1615 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi></mrow></math> by overlapping segments, such that for a given <!-- l. 1615 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math>, the value of <!-- l. 1615 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math> can be larger than <!-- l. 1615 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>K</mi></mrow></math>, where <!-- l. 1615 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is the total number of available samples. For example, an overlap of 50% of segments of length <!-- l. 1615 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></mrow></math> means that the first segment corresponds to samples with indices</p>
<!-- l. 1615 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>3</mn></mrow></math>, the second segment has samples with <!-- l. 1615 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>3</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>4</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>5</mn></mrow></math>, the third with <!-- l. 1615 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>5</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>6</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>7</mn></mrow></math> and so on.
<p></p>
<!-- l. 1617 -->
<p class="indent">
In Matlab/Octave, the command <span class="ec-lmss-10x-x-109">Sx=pwelch(x) </span>estimates a PSD via Welch’s method using default values (<!-- l. 1617 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>K</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math>, Hamming window and an overlap of 50%). An example of a complete command is
</p>
<!-- l. 1618 -->
<pre class="lstlisting" id="listing-155"><span class="label"><a id="x66-240001r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sx</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">pwelch</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">window</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Num_overlap</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N_fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">twosided</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span></pre>
<!-- l. 1621 -->
<p class="indent">
where <span class="ec-lmss-10x-x-109">window </span>is the window, <span class="ec-lmss-10x-x-109">Num_overlap </span>is the number of samples that are shared between two neighboring segments, <span class="ec-lmss-10x-x-109">N_fft </span>is the number <!-- l. 1621 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> of FFT points used for calculating the periodograms, <span class="ec-lmss-10x-x-109">Fs </span>is the sampling frequency and <span class="ec-lmss-10x-x-109">’twosided’ </span>can be used to force <span class="ec-lmss-10x-x-109">pwelch </span>to return values from 0 to <!-- l. 1621 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2</mn><mi>π</mi></mrow></math>, even if the signal is real. The number <!-- l. 1621 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math> of samples per segment corresponds to the window length. The companion function <span class="ec-lmss-10x-x-109">ak_psd.m </span>illustrates how to invoke <span class="ec-lmss-10x-x-109">pwelch.m </span>and is convenient when the sampling frequency is given in Hz.
</p>
<figure class="figure">
<p><a id="x66-24000214"></a></p>
<!-- l. 1626 -->
<p class="noindent">
<img alt="PIC" src="./Figures/welch_awgn_3000.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.14: </span><span class="content">PSD of a white noise <!-- l. 1627 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> with power equal to 600&nbsp;W estimated by Welch’s method with <!-- l. 1627 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> (top) and <!-- l. 1627 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>256</mn></mrow></math> (bottom) samples per segment.</span>
</figcaption>
<!-- tex4ht:label?: x66-24000214  -->
</figure>
<!-- l. 1630 -->
<p class="noindent">
<a id="x66-240003r21"></a> <span id="textcolor301">Example 4.21. </span><span class="ec-lmbx-10x-x-109">Variance reduction with Welch’s method</span>. Listing&nbsp;<a href="#x66-240004r17">4.17<!-- tex4ht:ref: code:snip_frequency_pwelch  --></a> provides an example of using <span class="ec-lmss-10x-x-109">pwelch </span>for PSD estimation of the same signal as Figure&nbsp;<a href="ak_dsp_bookse55.html#x65-23606011">4.11<!-- tex4ht:ref: fig:periodogram  --></a> and leads to Figure&nbsp;<a href="#x66-24000214">4.14<!-- tex4ht:ref: fig:welch_awgn_3000  --></a>. The top plot was obtained with <span class="ec-lmss-10x-x-109">Nfft=32 </span>and then, the code was modified to use <span class="ec-lmss-10x-x-109">Nfft=256 </span>and generate the bottom plot. Note that the total number of samples is <span class="ec-lmss-10x-x-109">N=3000 </span>in both cases. The standard deviations among the periodograms were 46.5 and 132.0, respectively. The smaller <span class="ec-lmss-10x-x-109">Nfft</span>, a larger number of periodograms is calculated and their averaging reduces the variance.
</p>
<!-- l. 1634 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.17: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_pwelch.m</span>
</figcaption>
<!-- tex4ht:label?: x66-240004r4.7.2  -->
<pre class="lstinputlisting" id="listing-156"><span class="label"><a id="x66-240006r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 3000;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">total</span></span><span style="color:#005900"> <span class="ec-lmtt-9">number of signal samples</span> 
</span><span class="label"><a id="x66-240007r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 32;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">segment</span></span><span style="color:#005900"> <span class="ec-lmtt-9">length M and also FFT-length</span> 
</span><span class="label"><a id="x66-240008r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">assumed</span></span><span style="color:#005900"> <span class="ec-lmtt-9">bandwidth for discrete-time signal</span> 
</span><span class="label"><a id="x66-240009r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 600;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">noise</span></span><span style="color:#005900"> <span class="ec-lmtt-9">power in Watts</span> 
</span><span class="label"><a id="x66-240010r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sqrt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">*</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Gaussian</span></span><span style="color:#005900"> <span class="ec-lmtt-9">white noise</span> 
</span><span class="label"><a id="x66-240011r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">F</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pwelch</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">hamming</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">twosided</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Parameter</span></span><span style="color:#005900"> <span class="ec-lmtt-9">[]</span> 
</span><span class="label"><a id="x66-240012r7"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">is</span></span><span style="color:#005900"> <span class="ec-lmtt-9">because in Matlab it is num. samples while Octave is percent (%)</span> 
</span><span class="label"><a id="x66-240013r8"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Periodogram</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">standard deviation=</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">std</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x66-240014r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">F</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with Fs=1 is discrete-time PSD</span> 
</span><span class="label"><a id="x66-240015r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on,</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ones</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">r</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">PSD</span></span><span style="color:#005900"> <span class="ec-lmtt-9">theoretical value</span></span>
  </pre>
<!-- l. 1636 -->
<p class="indent">
When comparing the plots in Figure&nbsp;<a href="#x66-24000214">4.14<!-- tex4ht:ref: fig:welch_awgn_3000  --></a> with the bottom plot in Figure&nbsp;<a href="ak_dsp_bookse55.html#x65-23606011">4.11<!-- tex4ht:ref: fig:periodogram  --></a>, which also used <!-- l. 1636 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3000</mn></mrow></math> samples, it is evident that averaging periodograms (for example, via Welch’s method) decreases the variance. Figure&nbsp;<a href="#x66-24000214">4.14<!-- tex4ht:ref: fig:welch_awgn_3000  --></a> also illustrates the tradeoff between variance reduction and frequency resolution as the top graph with <!-- l. 1638 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn></mrow></math> is much smoother than the bottom one with <!-- l. 1638 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>256</mn></mrow></math>.
</p>
<!-- l. 1640 -->
<p class="indent">
A detail is that Listing&nbsp;<a href="#x66-240004r17">4.17<!-- tex4ht:ref: code:snip_frequency_pwelch  --></a> uses the default of the window overlap (the third argument of <span class="ec-lmss-10x-x-109">pwelch.m </span>as <span class="ec-lmss-10x-x-109">[]</span>) because Octave assumes it is a percentage while Matlab assumes it is the number of samples. &nbsp;&nbsp;<!-- l. 1641 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 1643 -->
<p class="noindent">
<a id="x66-240016r22"></a> <span id="textcolor302">Example 4.22. </span><span class="ec-lmbx-10x-x-109">Estimating the PSD of filtered white noise via Welch’s method</span>.
</p>
<figure class="figure">
<p><a id="x66-24001715"></a></p>
<!-- l. 1646 -->
<p class="noindent">
<img alt="PIC" src="./Figures/periodogram_of_pulse.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.15: </span><span class="content">PSD of a filtered white noise <!-- l. 1647 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> estimated by Welch’s method.</span>
</figcaption>
<!-- tex4ht:label?: x66-24001715  -->
</figure>
<!-- l. 1650 -->
<p class="indent">
Listing&nbsp;<a href="#x66-240018r18">4.18<!-- tex4ht:ref: code:snip_frequency_filtered_noise_PSD  --></a> illustrates an application of <!-- l. 1650 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>S</mi></mrow><mrow><mi>y</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msubsup><mrow><mi>σ</mi></mrow><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msubsup><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow></math> (Eq.&nbsp;(<a href="ak_dsp_bookse54.html#x64-227002r43">4.43<!-- tex4ht:ref: eq:discrete_filtered_awgn  --></a>)), where the system impulse response is <span class="ec-lmss-10x-x-109">h=[1,1,1,1] </span>and <!-- l. 1650 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is a sinc.
</p>
<!-- l. 1652 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.18: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_filtered_noise_PSD.m</span>
</figcaption>
<!-- tex4ht:label?: x66-240018r4.7.2  -->
<pre class="lstinputlisting" id="listing-157"><span class="label"><a id="x66-240020r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 3000;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">total</span></span><span style="color:#005900"> <span class="ec-lmtt-9">number of signal samples</span> 
</span><span class="label"><a id="x66-240021r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 4;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of non-zero samples of h[n]</span> 
</span><span class="label"><a id="x66-240022r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 600;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">noise</span></span><span style="color:#005900"> <span class="ec-lmtt-9">power in Watts</span> 
</span><span class="label"><a id="x66-240023r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sqrt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">*</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Gaussian</span></span><span style="color:#005900"> <span class="ec-lmtt-9">white noise</span> 
</span><span class="label"><a id="x66-240024r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ones</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">shaping</span></span><span style="color:#005900"> <span class="ec-lmtt-9">pulse with square waveform</span> 
</span><span class="label"><a id="x66-240025r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">conv</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> <span class="ec-lmtt-9">signal x with filter</span> 
</span><span class="label"><a id="x66-240026r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 256;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">segment</span></span><span style="color:#005900"> <span class="ec-lmtt-9">length M and also FFT dimension</span> 
</span><span class="label"><a id="x66-240027r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency for discrete-time PSD</span> 
</span><span class="label"><a id="x66-240028r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sy_pwelch</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pwelch</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">hamming</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">twosided</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x66-240029r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">,4*</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">DTFT</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(sampled) of the impulse response</span> 
</span><span class="label"><a id="x66-240030r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Sy_th</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">PSD</span></span><span style="color:#005900"> <span class="ec-lmtt-9">theoretical expression</span> 
</span><span class="label"><a id="x66-240031r12"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">,2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sy_pwelch</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">scale</span></span><span style="color:#005900"> <span class="ec-lmtt-9">by 2*pi to get disc.time PSD</span> 
</span><span class="label"><a id="x66-240032r13"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">linspace</span></span><span style="color:#000000"><span class="ec-lmtt-9">(0,2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">r</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span>
  </pre>
<!-- l. 1654 -->
<p class="indent">
Listing&nbsp;<a href="#x66-240018r18">4.18<!-- tex4ht:ref: code:snip_frequency_filtered_noise_PSD  --></a> was used to generate Figure&nbsp;<a href="#x66-24001715">4.15<!-- tex4ht:ref: fig:periodogram_of_pulse  --></a>, where one can notice that, even with the averaging used in <span class="ec-lmss-10x-x-109">pwelch</span>, the variance continues proportional to the PSD magnitude, as indicated by Eq.&nbsp;(<a href="#x66-239003r52">4.52<!-- tex4ht:ref: eq:variancePSD  --></a>). &nbsp;&nbsp;<!-- l. 1655 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 1657 -->
<p class="noindent">
<a id="x66-240033r23"></a> <span id="textcolor303">Example 4.23. </span><span class="ec-lmbx-10x-x-109">Welch’s method using the Goertzel algorithm</span>. Note that in Matlab, when the call to <span class="ec-lmss-10x-x-109">pwelch </span>specifies the frequency points, <span class="ec-lmss-10x-x-109">pwelch </span>can use the Goertzel algorithm instead of an FFT. An example is the following code:
</p>
<!-- l. 1659 -->
<pre class="lstlisting" id="listing-158"><span class="label"><a id="x66-240034r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,10000)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Fs=1e4;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">some</span></span><span style="color:#005900"> <span class="ec-lmtt-9">random vector and sampling freq.</span> 
</span><span class="label"><a id="x66-240035r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">linspace</span></span><span style="color:#000000"><span class="ec-lmtt-9">(-</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2,1024)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">create</span></span><span style="color:#005900"> <span class="ec-lmtt-9">a frequency axis</span> 
</span><span class="label"><a id="x66-240036r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Px</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pwelch</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">hamming</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1024)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,512,</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Octave</span></span><span style="color:#005900"> <span class="ec-lmtt-9">has distinct syntax!</span> 
</span><span class="label"><a id="x66-240037r4"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">,10*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Px</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">show</span></span><span style="color:#005900"> <span class="ec-lmtt-9">PSD from -Fs/2 to Fs/2</span></span></pre>
<!-- l. 1665 -->
<p class="indent">
</p><p>The Goertzel algorithm<a id="dx66-240038"></a> can slow down the computations when compared to the FFT-based PSD estimation because it targets situations in which the frequencies are not uniformly spaced such as in DTMF detection algorithms (see Figure&nbsp;<a href="ak_dsp_bookse62.html#x72-25300232">4.32<!-- tex4ht:ref: fig:dtmf_spectrogram_exercise  --></a>). &nbsp; &nbsp;<!-- l. 1666 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math></p>
<p></p>
<div class="footnotes">
<a id="x66-239002x4.7.1"></a> <!-- l. 1592 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn7x6-bk" id="fn7x6"><sup class="textsuperscript">7</sup>&nbsp;</a></span><span class="ec-lmr-9">See, e. g.,&nbsp;&nbsp;[</span><span class="ec-lmbx-9">?</span><span class="ec-lmr-9">,</span><span class="ec-lmbx-9">?</span><span class="ec-lmr-9">] and [url4spe].</span>
</p>
<pre><code>                                                                                  &lt;/div&gt;</code></pre>





</div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ak_dsp_bookse55.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Periodogram</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ak_dsp_bookse57.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Parametric PSD Estimation via Autoregressive (AR) Modeling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Digital Signal Processing with Python, Matlab or Octave, Applications in Machine Learning Aldebaro Klautau Federal University of Pará (UFPA), Brazil</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>