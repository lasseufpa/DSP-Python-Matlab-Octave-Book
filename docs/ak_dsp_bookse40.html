<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aldebaro Klautau">

<title>Digital Signal Processing with Python, Matlab or Octave - 40&nbsp; Digital Filters</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ak_dsp_bookse41.html" rel="next">
<link href="./ak_dsp_bookse39.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ak_dsp_bookch3.html">Analog and Digital Systems</a></li><li class="breadcrumb-item"><a href="./ak_dsp_bookse40.html"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Digital Filters</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Digital Signal Processing with Python, Matlab or Octave</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Tables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listings</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Signals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analog, Digital and Discrete-Time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basic Signal Manipulation and Representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Block Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Complex-Valued and Sampled Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modeling the Stages in A/D and D/A Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Relating Frequencies in Continuous, Sampled and Discrete-time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">An Introduction to Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Signal Categorization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Power and Energy in Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Relating Power in Continuous and Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Correlation: Finding Trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Linear Model for Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforms and Signal Representation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Linear Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inner Products to Obtain the Transform Coefficients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Block Transforms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Fourier Transforms and Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Relating discrete and analog frequencies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Summary of equations for DFT / FFT Usage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Laplace Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Z Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Contrasting Signals and Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Analog and Digital Filters: A Quick Hands-On Tour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Linear Time-Invariant Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Sampling and Signal Reconstruction Revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse36.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Facts About First and Second-Order Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse37.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Bandwidth and Quality Factor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse38.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Importance of Linear Phase (or Constant Group Delay)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse39.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Filtering technologies: Surface acoustic wave (SAW) and others</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse40.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse41.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">IIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse42.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Bilinear Transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse43.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">FIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse44.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Realization of Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse45.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multirate Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse46.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse47.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse48.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse49.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spectral Estimation Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse51.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse52.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Windows for spectral analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse53.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">The ESD, PSD and MS Spectrum functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse54.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Filtering Random Signals and the Impact on PSDs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse55.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Periodogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse56.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Welch’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse57.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Parametric PSD Estimation via Autoregressive (AR) Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse58.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Time-frequency Analysis using the Spectrogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse59.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse60.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse61.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse62.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">ak_dsp_bookap1.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Useful Mathematics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Useful Softwares and Programming Tricks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Digital Filters</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<meta charset="utf-8">
<meta content="TeX4ht (https://tug.org/tex4ht/)" name="generator">
<meta content="width=device-width,initial-scale=1" name="viewport">
<link href="ak_dsp_book.css" rel="stylesheet" type="text/css">
<meta content="ak_dsp_book.tex" name="src">
<script async="async" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js" type="text/javascript"></script>


<!-- l. 1610 -->
<p class="noindent">
A digital filter is a discrete-time system that deals with quantized input <!-- l. 1610 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>q</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and output <!-- l. 1610 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>y</mi></mrow><mrow><mi>q</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> signals (quantized amplitudes). A possible practical scenario for a digital filter is the one shown in Figure&nbsp;<a href="ak_dsp_bookse33.html#x42-1180017">3.7<!-- tex4ht:ref: fig:canonical_interface  --></a>. There are many different kinds of digital filters but this section assumes filters that are based on linear constant-coefficient difference equations (LCCDE). As indicated in Figure&nbsp;<a href="ak_dsp_bookse34.html#x43-1190019">3.9<!-- tex4ht:ref: fig:ltidiagram  --></a>, when zero initial conditions are assumed, the LCCDE systems are a special case of LTI systems. But when one takes in account the non-linear quantization effects that occur in practical CPUs (or digital signal processors) due to their limited precision, the overall system is not strictly LTI. In spite of that, it is convenient to isolate the effects of quantization and finite-precision arithmetics, and study digital filters as LTI LCCDE systems. Later on, the impact of quantizing the filter coefficients and the roundoff errors due to finite-precision can be incorporated. Therefore, hereafter, the term digital filter refers to discrete-time LTI LCCDE systems. Besides, the systems are assumed to be causal.
</p>
<!-- l. 1612 -->
<p class="indent">
A system that has the output and input signals related by a LCCDE such as
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1613 -->
<p class="indent">
</p>
<!-- l. 1613 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x49-154001r50"></mstyle><!-- endlabel --><munderover accent="false" accentunder="false"><mrow><mo>∑</mo> </mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow> <mi>k</mi></mrow></msub><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo><munderover accent="false" accentunder="false"><mrow><mo> ∑</mo> </mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>M</mi></mrow></munderover><msub><mrow><mi>b</mi></mrow><mrow> <mi>k</mi></mrow></msub><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> </mrow></math>
</td>
<td class="eq-no">
(3.50)
</td>
</tr>

</tbody></table>
<!-- l. 1617 -->
<p class="indent">
can be represented by (taking the Z-transform on both sides of the LCCDE)
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 1618 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>Y</mi> <mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><munderover accent="false" accentunder="false"><mrow><mo>∑</mo> </mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow> <mi>k</mi></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>k</mi></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><munderover accent="false" accentunder="false"><mrow><mtext>∑</mtext></mrow><mrow> <mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>M</mi></mrow></munderover><msub><mrow><mi>b</mi></mrow><mrow> <mi>k</mi></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>k</mi></mrow></msup><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 1621 -->
<p class="indent">
In this case, the transfer function is
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1622 -->
<p class="indent">
</p>
<!-- l. 1622 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x49-154002r51"></mstyle><!-- endlabel --><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mi>Y</mi> <mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><munderover accent="false" accentunder="false"><mrow><mo>∑</mo> </mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>M</mi></mrow></munderover><msub><mrow><mi>b</mi></mrow><mrow><mi>k</mi></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>k</mi></mrow></msup></mrow> <mrow><munderover accent="false" accentunder="false"><mrow><mo> ∑</mo> </mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>k</mi></mrow></msup></mrow></mfrac><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(3.51)
</td>
</tr>

</tbody></table>
<!-- l. 1626 -->
<p class="indent">
which, after eventual algebraic simplifications, can be written as the ratio
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1627 -->
<p class="indent">
</p>
<!-- l. 1627 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x49-154003r52"></mstyle><!-- endlabel --><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mi>B</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><mi>A</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac> </mrow></math>
</td>
<td class="eq-no">
(3.52)
</td>
</tr>

</tbody></table>
<!-- l. 1631 -->
<p class="indent">
of two polynomials in <!-- l. 1631 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math>. Calculating the zeros <!-- l. 1631 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>z</mi></mrow><mrow><mi>k</mi></mrow></msub></math> (roots of the numerator <!-- l. 1631 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>B</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>) and the poles <!-- l. 1631 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>p</mi></mrow><mrow><mi>k</mi></mrow></msub></math> (roots of the denominator <!-- l. 1631 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>), one can write
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 1632 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>g</mi><mfrac><mrow><munderover accent="false" accentunder="false"><mrow><mo>∏</mo> </mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>1</mn></mrow><mrow><mi>M</mi></mrow></munderover><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><munderover accent="false" accentunder="false"><mrow><mo>∏</mo> </mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>1</mn></mrow><mrow><mi>N</mi></mrow></munderover><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>p</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac> <mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 1635 -->
<p class="indent">
where <!-- l. 1635 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math> is a gain. The coefficients of Eq.&nbsp;(<a href="#x49-154001r50">3.50<!-- tex4ht:ref: eq:lccde  --></a>) can be real or complex. For simplicity, they will be assumed real (<!-- l. 1635 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>b</mi></mrow><mrow><mi>k</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℝ</mi></mrow></math>) unless otherwise stated. In this case, <!-- l. 1635 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>g</mi> <mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℝ</mi></mrow></math> and the roots <!-- l. 1635 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>p</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></math> are real or, for each root <!-- l. 1635 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>r</mi><msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant="italic">j𝜃</mi></mrow></msup></mrow></math>, its complex conjugate <!-- l. 1635 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>r</mi><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi mathvariant="italic">j𝜃</mi></mrow></msup></mrow></math> is also a root such that the product <!-- l. 1635 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>r</mi><msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant="italic">j𝜃</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>r</mi><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi mathvariant="italic">j𝜃</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mi>z</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><mi>r</mi><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi>𝜃</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mi>r</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math> leads to a second-order polynomial with real coefficients.
</p>
<!-- l. 1637 -->
<p class="indent">
It is useful to know that the value of <!-- l. 1637 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> at <!-- l. 1637 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> and <!-- l. 1637 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></math> correspond to the values of the frequency response <!-- l. 1637 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> at <!-- l. 1637 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> (DC) and <!-- l. 1637 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi></mrow></math> rad, respectively, which can be written as
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1638 -->
<p class="indent">
</p>
<!-- l. 1638 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x49-154004r53"></mstyle><!-- endlabel --><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>z</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi mathvariant="normal"> Ω</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow></msub><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;&nbsp;&nbsp;</mtext></mstyle><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>z</mi><mo class="MathClass-rel" stretchy="false">=</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi mathvariant="normal"> Ω</mi><mo class="MathClass-rel" stretchy="false">=</mo><mi>π</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.53)
</td>
</tr>

</tbody></table>
<!-- l. 1642 -->
<p class="indent">
For example <!-- l. 1642 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow></math> has a frequency response with <!-- l. 1642 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi mathvariant="normal">Ω</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></mrow></math> and <!-- l. 1642 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi mathvariant="normal">Ω</mi><mo class="MathClass-rel" stretchy="false">=</mo><mi>π</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn></mrow></math>.
</p>
<!-- l. 1644 -->
<p class="noindent">
</p><p><a id="x49-154005r16"></a> <span id="textcolor204">Example 3.16. </span><span class="ec-lmbx-10x-x-109">Specifying a filter in Hz, rad or normalized frequency</span>. When designing digital filters, it is important to remember the fundamental relation</p>
<!-- l. 1645 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="normal">Ω</mi><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>, first presented in Eq.&nbsp;(<a href="ak_dsp_bookse7.html#x14-39001r22">1.22<!-- tex4ht:ref: eq:freqdiscrete2continuous  --></a>). Figure&nbsp;<a href="#x49-15400932">3.32<!-- tex4ht:ref: fig:specs_three  --></a> illustrates how this relation can be used to convert a specification for a lowpass analog filter with passband and stopband frequencies of 500 and 850 Hz, respectively, into a specification of a digital filter with <!-- l. 1645 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2000</mn><mi mathvariant="italic">Hz</mi></mrow></math>, which leads to passband and stopband frequencies of <!-- l. 1645 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2</mn><mi>π</mi><mn>500</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2000</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>1.57</mn></mrow></math> and <!-- l. 1645 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2</mn><mi>π</mi><mn>850</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2000</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>2.67</mn></mrow></math> rad, respectively.
<p></p>
<figure class="figure">
<p><a id="x49-15400932"></a></p>
<a id="x49-154006r1"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img alt="PIC" src="FiguresNonScript/spec-in-hz.png" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(a) Analog (</span><!-- l. 1649 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math> <span class="ec-lmr-9">in Hz)</span>
</div>
</td>
</tr>

</tbody></table>
</div>
<a id="x49-154007r2"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img alt="PIC" src="FiguresNonScript/spec-in-rad.png" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(b) Digital (</span><!-- l. 1650 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> <span class="ec-lmr-9">in rad)</span>
</div>
</td>
</tr>

</tbody></table>
</div>
<a id="x49-154008r3"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img alt="PIC" src="FiguresNonScript/spec-in-matlab.png" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(c) Digital (</span><!-- l. 1651 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mi>N</mi></mrow></msub></math> <span class="ec-lmr-9">in</span> <!-- l. 1651 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>π</mi></mrow></math><span class="ec-lmr-9">)</span>
</div>
</td>
</tr>

</tbody></table>
</div>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.32: </span><span class="content">Comparison of analog filter specification (a) and two corresponding digital versions assuming <!-- l. 1652 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2000</mn></mrow></math> Hz: (b) was obtained with <!-- l. 1652 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="normal">Ω</mi><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> and (c) uses the convention adopted in Matlab/Octave.</span>
</figcaption>
<!-- tex4ht:label?: x49-15400932  -->
</figure>
<!-- l. 1656 -->
<p class="indent">
Figure&nbsp;<a href="#x49-15400932">3.32<!-- tex4ht:ref: fig:specs_three  --></a> also shows the convention used by Matlab/Octave, which gets rid of the irrational number <!-- l. 1656 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math> by using a normalized axis <!-- l. 1656 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>N</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="normal">Ω</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>π</mi></mrow></math>, as listed in Table&nbsp;<a href="ak_dsp_bookse7.html#x14-410034">1.4<!-- tex4ht:ref: tab:nyquist_frequency  --></a>. In this case, <!-- l. 1656 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="normal">Ω</mi><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> can be written as <!-- l. 1656 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2</mn><mi mathvariant="italic">πf</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>f</mi></mrow><mrow><mi>N</mi></mrow></msub><mi>π</mi><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>, which simplifies to obtaining <!-- l. 1656 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>N</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>f</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with the normalization of <!-- l. 1656 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math> by the Nyquist frequency <!-- l. 1656 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math>. For example, <!-- l. 1656 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>500</mn></mrow></math> Hz in Figure&nbsp;<a href="#x49-154006r1">3.32(a)<!-- tex4ht:ref: fig:spec-in-hz  --></a> turns into <!-- l. 1656 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>N</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>500</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>1000</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math> in Figure&nbsp;<a href="#x49-154008r3">3.32(c)<!-- tex4ht:ref: fig:spec-in-matlab  --></a>. This normalization by the Nyquist frequency is sensible because digital filters are always constrained to work with frequencies of at most <!-- l. 1656 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math>&nbsp;Hz, which corresponds to <!-- l. 1656 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math>&nbsp;rad. &nbsp;&nbsp;<!-- l. 1657 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">3.10.1</span>&nbsp;&nbsp;<a id="x49-1550003.10.1"></a>FIR, IIR, AR, MA and ARMA systems
</h4>
<!-- l. 1662 -->
<p class="noindent">
An important characteristic of a digital filter is the <span class="ec-lmri-10x-x-109">duration of its impulse response</span>, which allows to classify it as a finite impulse response (FIR) or infinite impulse response (IIR) filter. For example, a filter with <!-- l. 1662 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>h</mi></mrow><mrow><mi>f</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><mi>δ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is FIR and a filter with <!-- l. 1662 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>h</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><msup><mrow><mn>8</mn></mrow><mrow><mi>n</mi></mrow></msup><mi>u</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is IIR. Note that if one plots <!-- l. 1662 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>h</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> in a computer, due to the limited precision, the values of <!-- l. 1662 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>h</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> would underflow to zero for large enough <!-- l. 1662 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math>, but theoretically this impulse response has infinite duration.
</p>
<!-- l. 1664 -->
<p class="indent">
Another characteristic is whether the filter is <span class="ec-lmri-10x-x-109">recursive </span>or not. A recursive filter has the output <!-- l. 1664 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> depending on past values of the output itself (<!-- l. 1664 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">,</mo><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>2</mn><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">,</mo><mo>…</mo></mrow></math>) while the output of a non-recursive filter depends only on the input <!-- l. 1664 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and its past values (assuming causality). The system function <!-- l. 1664 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> of a non-recursive filter has <!-- l. 1664 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> in Eq.&nbsp;(<a href="#x49-154002r51">3.51<!-- tex4ht:ref: eq:hz_transfer_function  --></a>) and no finite poles.
</p>
<!-- l. 1666 -->
<p class="indent">
</p><p>In practice, FIR can be associated to non-recursive filters and IIR to recursive filters. But recursiveness and impulse response duration are two distinct concepts! It is possible to create a recursive filter with an impulse response of finite duration using cancellation of poles and zeros, for example.</p>
<p></p>
<!-- l. 1669 -->
<p class="indent">
IIR and FIR filters will be discussed in the sequel. While the subject is presented in the context of digital filtering, many conclusions are valid for systems in general. In other words, IIR and FIR systems can be found in applications in which the goal is not filtering, but system identification, equalization, control, tracking, statistics, etc. In some of these areas, <!-- l. 1669 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is not classified as FIR or IIR, but as MA, AR or ARMA “model”.
</p>
<!-- l. 1671 -->
<p class="indent">
A moving-average (MA) model <!-- l. 1671 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is a non-recursive FIR filter and an autoregressive (AR) filter is a special case of a recursive IIR filter for which <!-- l. 1671 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> in Eq.&nbsp;(<a href="#x49-154002r51">3.51<!-- tex4ht:ref: eq:hz_transfer_function  --></a>). The AR IIR filter does not have finite zeros other than at the origin <!-- l. 1671 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> and is given by
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1672 -->
<p class="indent">
</p>
<!-- l. 1672 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x49-155001r54"></mstyle><!-- endlabel --><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>g</mi> <mfrac><mrow><msup><mrow><mi>z</mi></mrow><mrow><mi>N</mi></mrow></msup></mrow> <mrow><munderover accent="false" accentunder="false"><mrow><mo> ∏</mo> </mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>1</mn></mrow><mrow><mi>N</mi></mrow></munderover><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>p</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mi>g</mi></mrow> <mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mo>…</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mi>N</mi></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>N</mi></mrow></msup></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.54)
</td>
</tr>

</tbody></table>
<!-- l. 1676 -->
<p class="indent">
Note in Eq.&nbsp;(<a href="#x49-155001r54">3.54<!-- tex4ht:ref: eq:ar_model  --></a>) that the gain value <!-- l. 1676 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math> for the numerator is chosen such that the denominator coefficient <!-- l. 1676 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub></math> of Eq.&nbsp;(<a href="#x49-154002r51">3.51<!-- tex4ht:ref: eq:hz_transfer_function  --></a>) is equal to 1. The numerator <!-- l. 1676 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow><mi>z</mi></mrow><mrow><mi>N</mi></mrow></msup></math> leads to <!-- l. 1676 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> zeros at <!-- l. 1676 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> and makes <!-- l. 1676 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> causal.
</p>
<!-- l. 1678 -->
<p class="indent">
The autoregressive-moving-average (ARMA) model is a generic <!-- l. 1678 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> model composed by an AR (denominator) and MA (numerator) sections. There are many generalizations of these basic models, which are adopted in areas such as statistics. <span class="ec-lmri-10x-x-109">Parametric modeling</span><a id="dx49-155002"></a> is the task of, according to a predefined criterion such as least-squares, fit the data to the assumed model. In spite of being defined in distinct scenarios, filter design and parametric modeling share several fundamental results.
</p>
<!-- l. 1682 -->
<p class="indent">
</p><p>Before discussing the design of IIR and FIR filters, it is useful to note the importance of frequency scaling.</p>
<p></p>
<!-- l. 1685 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">3.10.2</span>&nbsp;&nbsp;<a id="x49-1560003.10.2"></a>Filter frequency scaling
</h4>
<!-- l. 1687 -->
<p class="noindent">
Computational routines often produce a prototype with normalized frequencies (e. g., a cuttof frequency of 1&nbsp;rad/s) that are then converted (eventually by another routine) to the required frequencies via <span class="ec-lmri-10x-x-109">frequency scaling</span><a id="dx49-156001"></a>.
</p>
<!-- l. 1689 -->
<p class="indent">
With frequency scaling one can modify a filter to obtain a different cutoff frequency. For example, if <!-- l. 1689 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> has a cutoff of <!-- l. 1689 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub></math> rad/s, the transformation <!-- l. 1689 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">→</mo> <mi>s</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>k</mi></mrow></math> moves this cutoff frequency to <!-- l. 1689 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub></mrow></math> rad/s. The operation is similar to using <!-- l. 1689 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> to double the “speed” of a signal represented by <!-- l. 1689 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, which leads to <!-- l. 1689 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> having half of the support of <!-- l. 1689 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. Similarly, <!-- l. 1689 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> has twice the support of <!-- l. 1689 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. More specifically, if the prototype <!-- l. 1690 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> has a cutoff frequency of 1&nbsp;rad/s, then
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1691 -->
<p class="indent">
</p>
<!-- l. 1691 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x49-156002r55"></mstyle><!-- endlabel --><mi>G</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>s</mi><mo class="MathClass-rel" stretchy="false">=</mo><mi>s</mi><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub></mrow></msub> </mrow></math>
</td>
<td class="eq-no">
(3.55)
</td>
</tr>

</tbody></table>
<!-- l. 1695 -->
<p class="indent">
scales the complex plane, and consequently <!-- l. 1695 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="italic">jω</mi></mrow></math>, such that <!-- l. 1695 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub></math> is the cutoff frequency of the new filter <!-- l. 1696 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>G</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<!-- l. 1698 -->
<p class="indent">
</p><p>There are computational routines that provide a prototype filter with (normalized) cutoff frequency of <!-- l. 1698 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math>&nbsp;rad/s, which can then be converted to a new filter with an arbitrary cutoff frequency <!-- l. 1698 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub></math> with the transformation <!-- l. 1698 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">→</mo> <mi>s</mi><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub></mrow></math>. For example, this change in cutoff frequency can be done in Matlab by applying the function <span class="ec-lmss-10x-x-109">lp2lp </span>to a lowpass analog prototype (current version of Octave misses this functionality) as indicated in Listing&nbsp;<a href="#x49-156003r13">3.13<!-- tex4ht:ref: code:snip_systems_filter_conversion  --></a>.</p>
<p></p>
<!-- l. 1700 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.13: </span><span class="content">MatlabOnly/snip_systems_filter_conversion.m</span>
</figcaption>
<!-- tex4ht:label?: x49-156003r3.10.2  -->
<pre class="lstinputlisting" id="listing-77"><span class="label"><a id="x49-156005r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 5;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> <span class="ec-lmtt-9">order</span> 
</span><span class="label"><a id="x49-156006r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,1,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">prototype</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with cutoff=1 rad/s</span> 
</span><span class="label"><a id="x49-156007r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bnew</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Anew</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">lp2lp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,100)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convert</span></span><span style="color:#005900"> <span class="ec-lmtt-9">to cutoff=100 rad/s</span> 
</span><span class="label"><a id="x49-156008r4"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">freqs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bnew</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Anew</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">plot</span></span><span style="color:#005900"> <span class="ec-lmtt-9">mag (linear scale) and phase</span></span>
  </pre>
<!-- l. 1702 -->
<p class="indent">
Note that <span class="ec-lmss-10x-x-109">lp2lp </span>requires the prototype to have a cutoff frequency of <!-- l. 1702 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>&nbsp;rad/s (besides being an analog lowpass filter).
</p>
<!-- l. 1704 -->
<p class="noindent">
<a id="x49-156011r17"></a> <span id="textcolor205">Example 3.17. </span><span class="ec-lmbx-10x-x-109">Frequency conversion when the prototype does not have a cutoff frequency of 1&nbsp;rad/s</span>. Assume that a frequency conversion must be applied to <!-- l. 1705 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>100</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>100</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> such that its cutoff frequency of <!-- l. 1706 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>100</mn></mrow></math>&nbsp;rad/s is shifted to 30&nbsp;rad/s. Because this is a simple first-order filter, the final result <!-- l. 1707 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>G</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>30</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>30</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> can be immediately obtained. But the whole procedure is described because it is useful for higher-order filters.
</p>
<!-- l. 1710 -->
<p class="indent">
A convenient step is to move the cutoff frequency of <!-- l. 1710 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> to 1&nbsp;rad/s using a substitution of <!-- l. 1711 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math> by <!-- l. 1711 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>100</mn><mi>s</mi></mrow></math>, which leads to
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 1712 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>F</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>100</mn><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>100</mn></mrow> <mrow><mn>100</mn><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>100</mn></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 1715 -->
<p class="indent">
Now, the final filter can be obtained by expanding <!-- l. 1715 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub></math> to 30 by substituting <!-- l. 1716 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math> in <!-- l. 1716 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> by <!-- l. 1716 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>30</mn></mrow></math>:
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 1717 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>G</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>F</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>30</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow> <mfrac><mrow><mi>s</mi></mrow> <mrow><mn>30</mn></mrow></mfrac> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>30</mn></mrow> <mrow><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>30</mn></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 1720 -->
<p class="indent">
Alternatively, one could directly use <!-- l. 1720 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>G</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>100</mn><mi>s</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>30</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. These frequency conversions are widely used in the design of IIR filters as will be discussed. &nbsp;&nbsp;<!-- l. 1722 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 1724 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">3.10.3</span>&nbsp;&nbsp;<a id="x49-1570003.10.3"></a>Filter bandform transformation: Lowpass to highpass, etc.
</h4>
<!-- l. 1726 -->
<p class="noindent">
There are many transformations to convert a <span class="ec-lmri-10x-x-109">prototype</span><a id="dx49-157001"></a> (or reference) filter into another one. Section&nbsp;<a href="#x49-1560003.10.2">3.10.2<!-- tex4ht:ref: sec:frequencyScaling  --></a> briefly discussed frequency scaling. It is also possible to convert a lowpass prototype filter into a highpass, bandpass and bandstop, for example, which is called <span class="ec-lmri-10x-x-109">bandform transformation</span><a id="dx49-157002"></a>.
</p>
<!-- l. 1730 -->
<p class="indent">
When dealing with analog filters, it is often necessary to apply <span class="ec-lmri-10x-x-109">impedance scaling</span><a id="dx49-157003"></a> to have the filter input and/or output with a desired impedance. The intent in this case is not to change the transfer function, but to perform impedance matching. All these three kinds of filter transformations are well-discussed in the literature<span class="footnote-mark"><a href="#fn18x5" id="fn18x5-bk"><sup class="textsuperscript">18</sup></a></span><a id="x49-157004f18"></a>. In the sequel, bandform transformation is briefly discussed.
</p>
<!-- l. 1732 -->
<p class="indent">
Bandform transformations can be used to create a bandpass from a lowpass prototype, for example. These transformations differ considerably for analog and digital frequencies, especially due to the fact that a digital filter has a periodic spectrum.<span class="footnote-mark"><a href="#fn19x5" id="fn19x5-bk"><sup class="textsuperscript">19</sup></a></span><a id="x49-157006f19"></a> Having a lowpass analog prototype, a Matlab user<span class="footnote-mark"><a href="#fn20x5" id="fn20x5-bk"><sup class="textsuperscript">20</sup></a></span><a id="x49-157008f20"></a> can use the functions <span class="ec-lmss-10x-x-109">lp2bp</span>, <span class="ec-lmss-10x-x-109">lp2bs </span>and <span class="ec-lmss-10x-x-109">lp2hp </span>to convert it to bandpass, bandstop and highpass filters, respectively.
</p>
<!-- l. 1734 -->
<p class="indent">
Sometimes frequency scaling is incorporated to bandform transformation such that a routine converts a lowpass prototype with normalized 1&nbsp;rad/s cutoff frequency into another filter with desired bandwidth and frequencies. For example, the Matlab’s function <span class="ec-lmss-10x-x-109">lp2bp</span> converts a normalized lowpass into a bandpass with the desired center frequency and bandwidth as illustrated in Listing&nbsp;<a href="#x49-157010r14">3.14<!-- tex4ht:ref: code:snip_systems_lowpass_to_bandpass  --></a>.
</p>
<!-- l. 1735 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.14: </span><span class="content">MatlabOnly/snip_systems_lowpass_to_bandpass.m</span>
</figcaption>
<!-- tex4ht:label?: x49-157010r3.10.3  -->
<pre class="lstinputlisting" id="listing-78"><span class="label"><a id="x49-157012r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 4;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">prototype</span></span><span style="color:#005900"> <span class="ec-lmtt-9">order (bandpass order is 2N = 8)</span> 
</span><span class="label"><a id="x49-157013r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,1,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">prototype</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with cutoff=1 rad/s</span> 
</span><span class="label"><a id="x49-157014r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bnew</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Anew</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">lp2bp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,50,30)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convert</span></span><span style="color:#005900"> <span class="ec-lmtt-9">to cutoff=50 rad/s</span> 
</span><span class="label"><a id="x49-157015r4"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">freqs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bnew</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Anew</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">plot</span></span><span style="color:#005900"> <span class="ec-lmtt-9">mag (linear scale) and phase</span></span>
  </pre>
<!-- l. 1743 -->
<p class="indent">
The functions <span class="ec-lmss-10x-x-109">lp2bp</span>, <span class="ec-lmss-10x-x-109">lp2bs</span>, <span class="ec-lmss-10x-x-109">lp2hp </span>and <span class="ec-lmss-10x-x-109">lp2lp </span>are restricted to analog filters. Transformations of digital filters can be achieved via a mapping provided by <span class="ec-lmri-10x-x-109">allpass filters</span><a id="dx49-157018"></a>, which are filters that have unitary magnitude for all frequencies and just change the phase of the input signal. Besides frequency transformation, allpass filters are adopted for phase equalization and other applications. Some Matlab functions that provide support to digital filter transformations are <span class="ec-lmss-10x-x-109">iirlp2bs</span>, <span class="ec-lmss-10x-x-109">iirlp2bp</span>, <span class="ec-lmss-10x-x-109">iirlp2xn</span>, <span class="ec-lmss-10x-x-109">iirftransf</span>, <span class="ec-lmss-10x-x-109">allpasslp2xn </span>and <span class="ec-lmss-10x-x-109">zpklp2xn</span>.
</p>
<!-- l. 1745 -->
<p class="indent">
For example, Listing&nbsp;<a href="#x49-157020r15">3.15<!-- tex4ht:ref: code:snip_systems_bandstop_conversion  --></a> compares the conversion of a Butterworth and a elliptic lowpass prototypes, both with cutoff frequency <!-- l. 1745 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math>&nbsp;rad, into stopband versions with cutoff frequencies <!-- l. 1745 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math> and <!-- l. 1745 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.8</mn></mrow></math>&nbsp;rad. The two prototypes are <span class="ec-lmri-10x-x-109">halfband filters</span><a id="dx49-157019"></a> because their cutoff frequencies is <!-- l. 1745 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>0.5</mn></mrow></math>&nbsp;rad.
</p>
<!-- l. 1747 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.15: </span><span class="content">MatlabOnly/snip_systems_bandstop_conversion.m</span>
</figcaption>
<!-- tex4ht:label?: x49-157020r3.10.3  -->
<pre class="lstinputlisting" id="listing-79"><span class="label"><a id="x49-157022r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">cutoff</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(normalized) frequency of prototype filter</span> 
</span><span class="label"><a id="x49-157023r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wstop</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [0.5 0.8];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">stopband</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cutoff frequencies</span> 
</span><span class="label"><a id="x49-157024r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=3;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">order</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of prototype filter</span> 
</span><span class="label"><a id="x49-157025r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Butterworth</span></span><span style="color:#005900"> <span class="ec-lmtt-9">prototype</span> 
</span><span class="label"><a id="x49-157026r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bnew</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Anew</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">iirlp2bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wstop</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Bandstop</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Butterworth</span> 
</span><span class="label"><a id="x49-157027r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">A2] =</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">ellip</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">3, 30, Wc);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Elliptic</span></span><span style="color:#005900"> <span class="ec-lmtt-9">prototype</span> 
</span><span class="label"><a id="x49-157028r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bnew2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Anew2</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">iirlp2bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wc</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wstop</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Bandstop</span></span><span style="color:#005900"> <span class="ec-lmtt-9">elliptic</span> 
</span><span class="label"><a id="x49-157029r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">fvtool</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bnew2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Anew2, Bnew, Anew);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">compare</span></span><span style="color:#005900"> <span class="ec-lmtt-9">freq. responses</span></span>
  </pre>
<!-- l. 1759 -->
<p class="indent">
For the comparison, it was used the Matlab’s <span class="ec-lmri-10x-x-109">Filter Visualization Tool</span><a id="dx49-157032"></a> (<span class="ec-lmss-10x-x-109">fvtool</span>). Note that the fourth argument of <span class="ec-lmss-10x-x-109">ellip </span>is the passband frequency (not necessarily the cutoff frequency). In this case, a maximum ripple of 3&nbsp;dB was specified using the second argument of <span class="ec-lmss-10x-x-109">ellip </span>to have the passband frequency coinciding with the cutoff frequency <span class="ec-lmss-10x-x-109">Wc</span> (<!-- l. 1759 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math>&nbsp;rad). Besides, a minimum attenuation of <!-- l. 1759 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>30</mn></mrow></math>&nbsp;dB was required for the stopband of the elliptic lowpass prototype.
</p>
<!-- l. 1761 -->
<p class="indent">
As another example, the following Matlab code converts a Butterworth lowpass prototype with cutoff frequency <!-- l. 1761 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math>&nbsp;rad into a bandpass with cutoff frequencies <!-- l. 1761 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.25</mn></mrow></math> and <!-- l. 1761 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.75</mn></mrow></math>&nbsp;rad.
</p>
<!-- l. 1762 -->
<pre class="lstlisting" id="listing-80"><span class="label"><a id="x49-157033r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 5;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> <span class="ec-lmtt-9">order</span> 
</span><span class="label"><a id="x49-157034r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,0.5)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">prototype</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with cutoff=0.5 rad</span> 
</span><span class="label"><a id="x49-157035r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bnew</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Anew</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">iirlp2xn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[-0.5</span></span><span style="color:#000000"> <span class="ec-lmtt-9">0.5],[0.25 0.75],</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">pass</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span></pre>
<!-- l. 1767 -->
<p class="indent">
</p><p>The third and fourth arguments of function <span class="ec-lmss-10x-x-109">iirlp2xn </span>(<span class="ec-lmss-10x-x-109">[-0.5 0.5] </span>and <span class="ec-lmss-10x-x-109">[0.25 0.75]</span>) indicate frequency points in the original filter and to what frequencies they should be mapped. In this case, <!-- l. 1767 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>0.5</mn></mrow></math>&nbsp;rad should be</p>
mapped to <!-- l. 1767 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.25</mn></mrow></math>&nbsp;rad and <!-- l. 1767 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math> to <!-- l. 1767 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.75</mn></mrow></math>&nbsp;rad.
<p></p>
<!-- l. 1769 -->
<p class="indent">
Instead of creating a prototype and then converting to the desired filter, most routines allow to directly design the filter. The following commands illustrate the design of highpass, bandpass and bandstop elliptic filters.
</p>
<!-- l. 1771 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.16: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_elliptic_filter_design.m</span>
</figcaption>
<!-- tex4ht:label?: x49-157036r3.10.3  -->
<pre class="lstinputlisting" id="listing-81"><span class="label"><a id="x49-157038r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> <span class="ec-lmtt-9">order for the lowpass prototype (e.g., bandpass is 2*N)</span> 
</span><span class="label"><a id="x49-157039r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Rp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">maximum</span></span><span style="color:#005900"> <span class="ec-lmtt-9">ripple in passband (dB)</span> 
</span><span class="label"><a id="x49-157040r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Rs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=30;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">minimum</span></span><span style="color:#005900"> <span class="ec-lmtt-9">attenuation in stopband (dB)</span> 
</span><span class="label"><a id="x49-157041r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ellip</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,0.4,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">high</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">highpass</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cutoff=0.4 rad</span> 
</span><span class="label"><a id="x49-157042r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ellip</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[0.5</span></span><span style="color:#000000"> <span class="ec-lmtt-9">0.8]);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">bandpass</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> <span class="ec-lmtt-9">BW=[0.5, 0.8], order=2*N</span> 
</span><span class="label"><a id="x49-157043r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ellip</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Rs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[0.5</span></span><span style="color:#000000"> <span class="ec-lmtt-9">0.8],</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">stop</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">BW</span></span><span style="color:#005900"><span class="ec-lmtt-9">=[0.5,</span></span><span style="color:#005900"> <span class="ec-lmtt-9">0.8], order=2*N</span></span>
  </pre>
<!-- l. 1780 -->
<p class="indent">
Similarly, FIR design routines provide support to directly designing filters other than lowpass ones. For example, Listing&nbsp;<a href="#x49-157044r17">3.17<!-- tex4ht:ref: code:snip_systems_FIR_filter_design  --></a> designs a stopband filter. Note the normalization by the Nyquist frequency <span class="ec-lmss-10x-x-109">Fs/2</span>.
</p>
<!-- l. 1781 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.17: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_FIR_filter_design.m</span>
</figcaption>
<!-- tex4ht:label?: x49-157044r3.10.3  -->
<pre class="lstinputlisting" id="listing-82"><span class="label"><a id="x49-157046r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 44100;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">freq. (all freqs. in Hz)</span> 
</span><span class="label"><a id="x49-157047r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> <span class="ec-lmtt-9">100;</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> <span class="ec-lmtt-9">order (N+1 coefficientes)</span> 
</span><span class="label"><a id="x49-157048r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fc1</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> <span class="ec-lmtt-9">8400;</span> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">First cuttof frequency</span> 
</span><span class="label"><a id="x49-157049r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fc2</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> <span class="ec-lmtt-9">13200;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Second cuttof frequency</span> 
</span><span class="label"><a id="x49-157050r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"> </span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> <span class="ec-lmtt-9">fir1(N, [Fc1 Fc2]/(Fs/2),</span> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">stop</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">hamming</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">+1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span>
  </pre>
<!-- l. 1790 -->
<p class="indent">
</p><p>Because there are plenty of routines for bandform transformation, the discussion about IIR and FIR filter design concentrates on lowpass filters.</p>
<p></p>
<div class="footnotes">
<a id="x49-157005x3.10.3"></a> <!-- l. 1730 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn18x5-bk" id="fn18x5"><sup class="textsuperscript">18</sup>&nbsp;</a></span><span class="ec-lmr-9">See references in [url3tra].</span>
</p>
<a id="x49-157007x3.10.3"></a> <!-- l. 1732 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn19x5-bk" id="fn19x5"><sup class="textsuperscript">19</sup>&nbsp;</a></span><span class="ec-lmr-9">Compare Matlab’s documentation for “Digital frequency transformations” and “Analog filter transformation”, currently at [url3mad] and [url3maa], respectively.</span>
</p>
<a id="x49-157009x3.10.3"></a> <!-- l. 1732 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn20x5-bk" id="fn20x5"><sup class="textsuperscript">20</sup>&nbsp;</a></span><span class="ec-lmr-9">As indicated, the current version of Octave misses this functionality.</span>
</p>
<pre><code>                                 &lt;/div&gt;</code></pre>





</div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ak_dsp_bookse39.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Filtering technologies: Surface acoustic wave (SAW) and others</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ak_dsp_bookse41.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">IIR Filter Design</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Digital Signal Processing with Python, Matlab or Octave, Applications in Machine Learning Aldebaro Klautau Federal University of Pará (UFPA), Brazil</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>