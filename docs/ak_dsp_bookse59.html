<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aldebaro Klautau">

<title>Digital Signal Processing with Python, Matlab or Octave – ak_dsp_bookse59</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ak_dsp_bookse60.html" rel="next">
<link href="./ak_dsp_bookse58.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ak_dsp_bookse59.html"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">ak_dsp_bookse59.html</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Digital Signal Processing with Python, Matlab or Octave</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookad1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">ak_dsp_bookad1.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">ak_dsp_bookap1.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">ak_dsp_bookap2.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">ak_dsp_bookap3.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ak_dsp_bookap4.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">ak_dsp_bookch1.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">ak_dsp_bookch2.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">ak_dsp_bookch3.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">ak_dsp_bookch4.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">ak_dsp_bookli1.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">ak_dsp_bookli2.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">ak_dsp_bookli3.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">ak_dsp_bookli4.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">ak_dsp_book.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">ak_dsp_bookse1.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">ak_dsp_bookse2.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">ak_dsp_bookse3.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">ak_dsp_bookse4.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">ak_dsp_bookse5.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">ak_dsp_bookse6.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">ak_dsp_bookse7.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">ak_dsp_bookse8.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">ak_dsp_bookse9.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">ak_dsp_bookse10.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ak_dsp_bookse11.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">ak_dsp_bookse12.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">ak_dsp_bookse13.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">ak_dsp_bookse14.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">ak_dsp_bookse15.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">ak_dsp_bookse16.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">ak_dsp_bookse17.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">ak_dsp_bookse18.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">ak_dsp_bookse19.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">ak_dsp_bookse20.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">ak_dsp_bookse21.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">ak_dsp_bookse22.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">ak_dsp_bookse23.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">ak_dsp_bookse24.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">ak_dsp_bookse25.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">ak_dsp_bookse26.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">ak_dsp_bookse27.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">ak_dsp_bookse28.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">ak_dsp_bookse29.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">ak_dsp_bookse30.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">ak_dsp_bookse31.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">ak_dsp_bookse32.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">ak_dsp_bookse33.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ak_dsp_bookse34.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">ak_dsp_bookse35.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse36.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">ak_dsp_bookse36.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse37.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">ak_dsp_bookse37.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse38.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">ak_dsp_bookse38.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse39.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">ak_dsp_bookse39.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse40.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">ak_dsp_bookse40.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse41.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">ak_dsp_bookse41.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse42.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">ak_dsp_bookse42.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse43.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">ak_dsp_bookse43.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse44.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">ak_dsp_bookse44.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse45.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">ak_dsp_bookse45.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse46.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">ak_dsp_bookse46.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse47.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">ak_dsp_bookse47.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse48.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">ak_dsp_bookse48.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse49.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">ak_dsp_bookse49.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">ak_dsp_bookse50.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse51.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">ak_dsp_bookse51.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse52.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">ak_dsp_bookse52.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse53.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">ak_dsp_bookse53.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse54.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">ak_dsp_bookse54.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse55.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">ak_dsp_bookse55.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse56.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">ak_dsp_bookse56.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse57.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">ak_dsp_bookse57.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse58.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">ak_dsp_bookse58.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse59.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">ak_dsp_bookse59.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse60.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">ak_dsp_bookse60.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse61.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">ak_dsp_bookse61.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse62.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">ak_dsp_bookse62.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse63.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">ak_dsp_bookse63.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse64.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">ak_dsp_bookse64.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse65.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">ak_dsp_bookse65.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse66.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">ak_dsp_bookse66.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse67.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">ak_dsp_bookse67.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse68.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">ak_dsp_bookse68.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse69.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">ak_dsp_bookse69.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse70.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">ak_dsp_bookse70.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse71.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">85</span>&nbsp; <span class="chapter-title">ak_dsp_bookse71.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse72.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">86</span>&nbsp; <span class="chapter-title">ak_dsp_bookse72.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse73.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">87</span>&nbsp; <span class="chapter-title">ak_dsp_bookse73.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse74.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">88</span>&nbsp; <span class="chapter-title">ak_dsp_bookse74.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse75.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">89</span>&nbsp; <span class="chapter-title">ak_dsp_bookse75.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse76.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">90</span>&nbsp; <span class="chapter-title">ak_dsp_bookse76.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse77.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">91</span>&nbsp; <span class="chapter-title">ak_dsp_bookse77.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse78.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">92</span>&nbsp; <span class="chapter-title">ak_dsp_bookse78.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse79.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">93</span>&nbsp; <span class="chapter-title">ak_dsp_bookse79.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse80.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">94</span>&nbsp; <span class="chapter-title">ak_dsp_bookse80.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse81.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">95</span>&nbsp; <span class="chapter-title">ak_dsp_bookse81.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse82.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">96</span>&nbsp; <span class="chapter-title">ak_dsp_bookse82.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse83.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">97</span>&nbsp; <span class="chapter-title">ak_dsp_bookse83.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse84.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">98</span>&nbsp; <span class="chapter-title">ak_dsp_bookse84.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse85.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">99</span>&nbsp; <span class="chapter-title">ak_dsp_bookse85.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse86.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">100</span>&nbsp; <span class="chapter-title">ak_dsp_bookse86.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse87.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">101</span>&nbsp; <span class="chapter-title">ak_dsp_bookse87.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse88.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">102</span>&nbsp; <span class="chapter-title">ak_dsp_bookse88.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse89.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">103</span>&nbsp; <span class="chapter-title">ak_dsp_bookse89.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse90.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">104</span>&nbsp; <span class="chapter-title">ak_dsp_bookse90.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse91.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">105</span>&nbsp; <span class="chapter-title">ak_dsp_bookse91.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse92.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">106</span>&nbsp; <span class="chapter-title">ak_dsp_bookse92.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse93.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">107</span>&nbsp; <span class="chapter-title">ak_dsp_bookse93.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse94.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">108</span>&nbsp; <span class="chapter-title">ak_dsp_bookse94.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse95.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">109</span>&nbsp; <span class="chapter-title">ak_dsp_bookse95.html</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">



&lt;!DOCTYPE html&gt;


<title>
Applications
</title>
<meta charset="utf-8">
<meta content="TeX4ht (https://tug.org/tex4ht/)" name="generator">
<meta content="width=device-width,initial-scale=1" name="viewport">
<link href="ak_dsp_book.css" rel="stylesheet" type="text/css">
<meta content="ak_dsp_book.tex" name="src">
<script async="async" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js" type="text/javascript"></script>


<h3 class="sectionHead anchored">
<span class="titlemark">4.10</span>&nbsp;&nbsp;<a id="x69-2500004.10"></a>Applications
</h3>
<!-- l. 2239 -->
<p class="noindent">
<a id="x69-250001r1"></a> <span id="textcolor308"><span class="ec-lmbx-10x-x-109">Application 4.1.</span></span> <span class="ec-lmbx-10x-x-109">FFT leakage and picket-fence effects</span>. This application explores a script that illustrates the results discussed in Section&nbsp;<a href="ak_dsp_bookse52.html#x62-2130004.3.6">4.3.6<!-- tex4ht:ref: sec:ExampleLeakagePicketFence  --></a> and can be found at folder <span class="ec-lmss-10x-x-109">Applications/FFTLeakagePicketFenceEffects</span>. The version <span class="ec-lmss-10x-x-109">ak_window4_noGUI.m</span> runs on both Matlab and Octave while <span class="ec-lmss-10x-x-109">ak_window4gui.m </span>incorporates a Matlab GUI.<span class="footnote-mark"><a href="#fn10x6" id="fn10x6-bk"><sup class="textsuperscript">10</sup></a></span><a id="x69-250002f10"></a>
</p>
<!-- l. 2242 -->
<p class="indent">
Basically the software varies the frequency <!-- l. 2242 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub></math> of a cosine and compares the magnitudes of its DTFT and FFT. The goal is to show how the cosine is represented by two frequency components <!-- l. 2242 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">±</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub></mrow></math>, and the interaction of the corresponding “positive” and “negative” sinc functions for composing the DTFT by their sum. Also, the script indicates how the FFT discretizes the frequency axis, which creates the picket-fence effect, and the leakage that an FFT user observes when <!-- l. 2242 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub></math> does not coincide with a frequency bin.
</p>
<!-- l. 2244 -->
<p class="indent">
Figure&nbsp;<a href="#x69-25000423">4.23<!-- tex4ht:ref: fig:fftEffectsOnlyDTFT  --></a> is a screenshot when the cosine frequency is <!-- l. 2244 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1.7279</mn></mrow></math>&nbsp;rad and the corresponding DTFT magnitude. The cosine is represented by two spectral lines (tones), at normalized frequencies <!-- l. 2244 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">±</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mi>π</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">±</mo><mn>0.55</mn></mrow></math>. The (dashed) reference line indicates the value <!-- l. 2244 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>A</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>24</mn></mrow></math> given the FFT-length <!-- l. 2244 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math> and cosine amplitude <!-- l. 2244 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>6</mn></mrow></math>. Note that the DTFT, which is the sum of two sinc functions, surpasses this reference value for normalized frequencies around <!-- l. 2244 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">±</mo> <mn>0.55</mn></mrow></math>.
</p>
<figure class="figure">
<p><a id="x69-25000423"></a></p>
<!-- l. 2248 -->
<p class="noindent">
<img alt="PIC" src="./FiguresNonScript/fftEffectsOnlyDTFT.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.23: </span><span class="content">DTFT magnitude of a cosine of frequency <!-- l. 2249 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1.7279</mn></mrow></math>&nbsp;rad.</span>
</figcaption>
<!-- tex4ht:label?: x69-25000423  -->
</figure>
<!-- l. 2252 -->
<p class="indent">
Figure&nbsp;<a href="#x69-25000524">4.24<!-- tex4ht:ref: fig:fftEffectsFFTandDTFT  --></a> corresponds to a situation where <!-- l. 2252 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2.1206</mn></mrow></math>&nbsp;rad and the FFT magnitude values are superimposed to the DTFT. Besides, the two sinc functions centered at normalized frequencies <!-- l. 2252 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">±</mo> <mn>0.675</mn></mrow></math> are also displayed such that one can see the DTFT being composed by their summation.
</p>
<figure class="figure">
<p><a id="x69-25000524"></a></p>
<!-- l. 2256 -->
<p class="noindent">
<img alt="PIC" src="./FiguresNonScript/fftEffectsFFTandDTFT.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.24: </span><span class="content">DTFT and FFT magnitudes of a cosine of frequency <!-- l. 2257 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2.1206</mn></mrow></math>&nbsp;rad.</span>
</figcaption>
<!-- tex4ht:label?: x69-25000524  -->
</figure>
<!-- l. 2260 -->
<p class="indent">
In Figure&nbsp;<a href="#x69-25000524">4.24<!-- tex4ht:ref: fig:fftEffectsFFTandDTFT  --></a>, <!-- l. 2260 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>c</mi></mrow></msub></math> does not coincide with an FFT bin and the leakage is observed by the FFT values, which are samples of the DTFT. The picket-fence is clearly seen because in this case the resolution is low, and only <!-- l. 2260 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math> DTFT values in the range <!-- l. 2260 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><mi>π</mi><mo class="MathClass-punc" stretchy="false">,</mo><mi>π</mi><mo class="MathClass-open" stretchy="false">[</mo></mrow></math> are obtained by the FFT. Increasing <!-- l. 2260 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> alleviates this effect. The reader is invited to run the code with different settings. &nbsp; &nbsp;<!-- l. 2261 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2291 -->
<p class="noindent">
<a id="x69-250006r2"></a> <span id="textcolor309"><span class="ec-lmbx-10x-x-109">Application 4.2.</span></span> <span class="ec-lmbx-10x-x-109">Using Welch’s method to estimate the mean square (MS) spectrum</span>. As explained, to decrease the variance of the estimated spectrum, it is useful to adopt Welch’s method. In this case, one should consider the effect of the window <!-- l. 2292 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> of <!-- l. 2292 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math> samples on the estimation.
</p>
<!-- l. 2294 -->
<p class="indent">
In Matlab/Octave it is convenient to estimate a MS spectrum using <span class="ec-lmss-10x-x-109">pwelch</span>, which takes care of segmenting the input signal. Matlab has support for MS spectrum estimation using <span class="ec-lmss-10x-x-109">pwelch </span>while Octave does not.
</p>
<!-- l. 2296 -->
<p class="indent">
When used for PSD estimation, <span class="ec-lmss-10x-x-109">pwelch.m </span>scales the periodogram dividing it by the energy of the window:
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2297 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>E</mi> <mo class="MathClass-rel" stretchy="false">=</mo><munderover accent="false" accentunder="false"><mrow><mo> ∑</mo> </mrow><mrow><mi>n</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>L</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><msup><mrow><mi>w</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2300 -->
<p class="indent">
In contrast, when estimating a MS spectrum, the periodogram should be divided by the square of the window DC value
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2301 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <msubsup><mrow><mi>W</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">DC</mtext></mstyle></mrow><mrow><mn>2</mn></mrow></msubsup> <mo class="MathClass-rel" stretchy="false">=</mo><msup><mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow><munderover accent="false" accentunder="false"><mrow><mtext>∑</mtext></mrow><mrow> <mi>n</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>L</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2304 -->
<p class="indent">
The reason is that the window is convolved with each power spectrum peak and <!-- l. 2304 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>W</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">DC</mtext></mstyle></mrow></msub></math> should be 1 to avoid modifying the peak height.
</p>
<!-- l. 2306 -->
<p class="indent">
Matlab has the undocumented option of invoking <span class="ec-lmss-10x-x-109">pwelch.m </span>with the argument ’ms’ for MS spectrum, such as in:
</p>
<!-- l. 2307 -->
<pre class="lstlisting" id="listing-172"><span class="label"><a id="x69-250007r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">pwelch</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">window</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],[],</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">twosided</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">ms</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span></pre>
<!-- l. 2310 -->
<p class="indent">
which uses the adequate scaling factor to estimate a MS spectrum.
</p>
<!-- l. 2312 -->
<p class="indent">
Because ’ms’ is not supported in Octave, Listing&nbsp;<a href="#x69-250008r28">4.28<!-- tex4ht:ref: code:snip_frequency_msspectrum  --></a> illustrates that a workaround is to multiply the estimated spectrum by <!-- l. 2312 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>E</mi><mo class="MathClass-bin" stretchy="false">∕</mo><msubsup><mrow><mi>W</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">DC</mtext></mstyle></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></math>.
</p>
<!-- l. 2314 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.28: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_msspectrum.m</span>
</figcaption>
<!-- tex4ht:label?: x69-250008r4.10  -->
<pre class="lstinputlisting" id="listing-173"><span class="label"><a id="x69-250010r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1024;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x =</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">transpose</span></span><span style="color:#000000"><span class="ec-lmtt-9">(10*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*3/64*(0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">a cosine</span> 
</span><span class="label"><a id="x69-250011r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xk</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= (</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">MS</span></span><span style="color:#005900"> <span class="ec-lmtt-9">spectrum: |DTFS|^2</span> 
</span><span class="label"><a id="x69-250012r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">myWindow =</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">hamming</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">specify</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Fs and a Hamming window</span> 
</span><span class="label"><a id="x69-250013r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= Fs*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pwelch</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">myWindow</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">twosided</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Welch</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> <span class="ec-lmtt-9">estimate. Third</span> 
</span><span class="label"><a id="x69-250014r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">parameter</span></span><span style="color:#005900"> <span class="ec-lmtt-9">is [] because in Matlab is num. samples while Octave is %</span> 
</span><span class="label"><a id="x69-250015r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= H *</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">myWindow</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">myWindow</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">^2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">scale</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for MS</span> 
</span><span class="label"><a id="x69-250016r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xk</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">x</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">-</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on,</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">or</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">-</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">compare</span></span>
  </pre>
<!-- l. 2316 -->
<p class="indent">
Using either Matlab or Octave, this code provides a pair of peaks of approximately 25&nbsp;W for <span class="ec-lmss-10x-x-109">H</span>, estimated via Welch’s method. Note that the cosine is not bin-centered and there is leakage. Matlab users<span class="footnote-mark"><a href="#fn11x6" id="fn11x6-bk"><sup class="textsuperscript">11</sup></a></span><a id="x69-250017f11"></a> can try a flat top window<a id="dx69-250019"></a> in place of Hamming’s with the command <span class="ec-lmss-10x-x-109">myWindow=flattopwin(N)</span>. When estimating the MS spectrum, a flat top window helps because it widens any peak in the original spectrum, such that the wider range of values has more chances of coinciding with a FFT bin. In other words, the flat top is not accurate to locate the sinusoid in frequency (bad frequency resolution) but helps when the goal is to find the sinusoid amplitude.
</p>
<!-- l. 2324 -->
<p class="indent">
Another example with a sinusoid that is not bin-centered is provided below. It allows to observe the better performance of averaging segments of the signal using <span class="ec-lmss-10x-x-109">pwelch.m</span>, as indicated in Listing&nbsp;<a href="#x69-250020r29">4.29<!-- tex4ht:ref: code:snip_frequency_not_bin_cent_pwelch  --></a>.
</p>
<!-- l. 2325 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.29: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_not_bin_cent_pwelch.m</span>
</figcaption>
<!-- tex4ht:label?: x69-250020r4.10  -->
<pre class="lstinputlisting" id="listing-174"><span class="label"><a id="x69-250022r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1000;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x = 10*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/64*(0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">a cosine</span> 
</span><span class="label"><a id="x69-250023r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Xk</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= (</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">MS</span></span><span style="color:#005900"> <span class="ec-lmtt-9">spectrum |Xk|^2</span> 
</span><span class="label"><a id="x69-250024r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">window =</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">hamming</span></span><span style="color:#000000"><span class="ec-lmtt-9">(128)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">specify</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Fs and window</span> 
</span><span class="label"><a id="x69-250025r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pwelch</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">window</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],128,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">twosided</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Welch</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> <span class="ec-lmtt-9">estimate</span> 
</span><span class="label"><a id="x69-250026r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= H *</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">window</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">window</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">^2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">scale</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for MS</span> 
</span><span class="label"><a id="x69-250027r6"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Peak</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">from pwelch = </span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">Watts</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x69-250028r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Peak</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">when using one FFT = </span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Xk</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">W</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span>
  </pre>
<!-- l. 2335 -->
<p class="indent">
This code informs that <span class="ec-lmss-10x-x-109">Xk </span>has peaks of 15.66&nbsp;W and <span class="ec-lmss-10x-x-109">H </span>(estimated via <span class="ec-lmss-10x-x-109">pwelch.m </span>with segments of <!-- l. 2335 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>128</mn></mrow></math> samples) has peaks of 25.02&nbsp;W (recall that the correct value is 25&nbsp;W). In this and many practical cases, averaging windowed segments with <span class="ec-lmss-10x-x-109">pwelch.m </span>leads to better results than using a single FFT. &nbsp;&nbsp;<!-- l. 2337 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2340 -->
<p class="noindent">
<a id="x69-250031r3"></a> <span id="textcolor310"><span class="ec-lmbx-10x-x-109">Application 4.3.</span></span> <span class="ec-lmbx-10x-x-109">Relation between roots location and spectrum</span>. A window <!-- l. 2341 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is used to multiply a signal in time-domain, but for the sake of observing its spectrum, it can be interpreted as the impulse response of a FIR filter, which does not have finite poles, only zeros. Under this assumption, there is an interesting relation between the zeros of the windows, and its spectrum <!-- l. 2342 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>W</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<figure class="figure">
<p><a id="x69-25003225"></a></p>
<!-- l. 2346 -->
<p class="noindent">
<img alt="PIC" src="./FiguresNonScript/windows_root_zeros.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.25: </span><span class="content">Relationship between roots location and spectrum for a rectangular window with <!-- l. 2347 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> samples.</span>
</figcaption>
<!-- tex4ht:label?: x69-25003225  -->
</figure>
<!-- l. 2350 -->
<p class="indent">
Figure&nbsp;<a href="#x69-25003225">4.25<!-- tex4ht:ref: fig:windows_root_zeros  --></a> shows the spectrum (left plot) of a rectangular window with <!-- l. 2350 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> and the roots (right plot) of this window. This plot outlines that there are <!-- l. 2350 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></math> zeros (the amount of roots of a polynomial of order <!-- l. 2350 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>) and the width of the main-lobe is obtained from the angle <!-- l. 2350 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Θ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> (in this case, <!-- l. 2350 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Θ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>32</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.1963</mn></mrow></math>&nbsp;rad) of the first root, given that there is no root at <!-- l. 2350 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> and the <!-- l. 2350 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow></math> roots are uniformly spaced around the unit circle.
</p>
<figure class="figure">
<p><a id="x69-25003326"></a></p>
<!-- l. 2354 -->
<p class="noindent">
<img alt="PIC" src="./FiguresNonScript/windows_kaiser_root_zeros.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.26: </span><span class="content">Relationship between roots location and spectrum for a Kaiser window with <!-- l. 2355 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>32</mn></mrow></math> samples.</span>
</figcaption>
<!-- tex4ht:label?: x69-25003326  -->
</figure>
<!-- l. 2358 -->
<p class="indent">
Figure&nbsp;<a href="#x69-25003326">4.26<!-- tex4ht:ref: fig:windows_kaiser_root_zeros  --></a> shows that a greater concentration of zeros in the region of the main-lobe, allows the Kaiser window (with <!-- l. 2358 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>β</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>7.85</mn></mrow></math>) achieve a very small first side-lobe. However, the width of the main-lobe increases considerably when compared to the rectangular window in Figure&nbsp;<a href="#x69-25003225">4.25<!-- tex4ht:ref: fig:windows_root_zeros  --></a>, due to the increase of <!-- l. 2358 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>Θ</mi></math>. In summary, the rectangular window has the smallest main-lobe, but its first sidelobe level is just <!-- l. 2359 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>13</mn></mrow></math>&nbsp;dB below the main-lobe level. On the other hand, the Kaiser window has a wider main-lobe, but this window has very small sidelobe levels. &nbsp; &nbsp;<!-- l. 2360 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2362 -->
<p class="noindent">
<a id="x69-250034r4"></a> <span id="textcolor311"><span class="ec-lmbx-10x-x-109">Application 4.4.</span></span> <span class="ec-lmbx-10x-x-109">FFT Interpreted as a Filter Bank</span>. Filter banks are often used for performing spectrum analysis and signal synthesis. A DFT can be seen as a <span class="ec-lmri-10x-x-109">uniform </span>filter bank due to the fact that all filters have the same bandwidth.
</p>
<!-- l. 2366 -->
<p class="indent">
The interpretation of FFT and other transforms as filter banks lead to improved insight. For example, the good result obtained by the rectangular window in Figure&nbsp;<a href="ak_dsp_bookse52.html#x62-2140134">4.4<!-- tex4ht:ref: fig:windowsHarmonicAnalysis  --></a> is due to a particular property of its side-lobe structure: all side-lobes are zero in the center of the bins. When the spectrum being analyzed has non-zero components only in bin centers, the leakage due to the side-lobes will not appear in the final FFT result. The leakage could be seen in the DTFT though.
</p>
<figure class="figure">
<p><a id="x69-25003527"></a></p>
<!-- l. 2370 -->
<p class="noindent">
<img alt="PIC" src="./Figures/dftFilterBankRectangular.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.27: </span><span class="content">DFT filter bank with rectangular window of <!-- l. 2371 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math> samples. The circles mark the DFT bin centers. The filter for <!-- l. 2371 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn></mrow></math> is emphasized.</span>
</figcaption>
<!-- tex4ht:label?: x69-25003527  -->
</figure>
<figure class="figure">
<p><a id="x69-25003628"></a></p>
<!-- l. 2376 -->
<p class="noindent">
<img alt="PIC" src="./Figures/dftFilterBankKaiser.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.28: </span><span class="content">DFT filter bank with Kaiser window of <!-- l. 2377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math> samples. The filter for <!-- l. 2377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>6</mn></mrow></math> is emphasized.</span>
</figcaption>
<!-- tex4ht:label?: x69-25003628  -->
</figure>
<!-- l. 2380 -->
<p class="indent">
Figure&nbsp;<a href="#x69-25003628">4.28<!-- tex4ht:ref: fig:dftFilterBankKaiser  --></a> and Figure&nbsp;<a href="#x69-25003527">4.27<!-- tex4ht:ref: fig:dftFilterBankRectangular  --></a> indicate the filter banks corresponding to an FFT with rectangular and Kaiser windows, respectively. The rectangular has larger side-lobe levels, but all of them achieve a zero in the bin centers. The Kaiser window does not have side-lobes with amplitude equal to zero in the bin centers, but these side-lobe levels are very small. Modifying the scripts that obtained these figures allows to show the scalloping loss of each window, as discussed in [<span class="ec-lmbx-10x-x-109">?</span>]. &nbsp; &nbsp;<!-- l. 2383 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2402 -->
<p class="noindent">
<a id="x69-250037r5"></a> <span id="textcolor312"><span class="ec-lmbx-10x-x-109">Application 4.5.</span></span> <span class="ec-lmbx-10x-x-109">Smoothing an FFT result by segmenting the signal and averaging the individual FFTs. </span>When the task is to calculate the FFT of a noisy signal with <!-- l. 2404 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> samples, it helps to segment it in <!-- l. 2404 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math> blocks and average the result of <!-- l. 2404 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math> FFTs. This is a basic strategy in spectral estimation, which is adopted in Welch’s method, for example. Here, the noisy signal is assumed to be the one recorded in the file <span class="ec-lmss-10x-x-109">impulseResponses.wav</span>, as suggested in Application&nbsp;<a href="ak_dsp_bookse14.html#x21-75097r4">1.4<!-- tex4ht:ref: app:latency  --></a>.
</p>
<!-- l. 2409 -->
<p class="indent">
For isolating the response to an impulse using the signal described in Application&nbsp;<a href="ak_dsp_bookse14.html#x21-75097r4">1.4<!-- tex4ht:ref: app:latency  --></a>, after zooming Figure&nbsp;<a href="ak_dsp_bookse14.html#x21-7511863">1.63<!-- tex4ht:ref: fig:estimatedImpulseResponse  --></a> it was decided to consider the range of samples from <!-- l. 2411 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>12650</mn></mrow></math> to 22050 (given the third impulse was generated at <!-- l. 2411 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>22051</mn></mrow></math>). This way the selected signal does not have many samples with small amplitudes before it actually begins.
</p>
<!-- l. 2413 -->
<p class="indent">
In case you do not have available the companion file <span class="ec-lmss-10x-x-109">impulseResponses.wav </span>and cannot generate yours due to the lack of a loopback cable, then use the signal suggested in the script below by changing the <span class="ec-lmss-10x-x-109">if </span>instruction in line 3:
</p>
<!-- l. 2414 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.30: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_smothing_FFT.m</span>
</figcaption>
<!-- tex4ht:label?: x69-250038r4.10  -->
<pre class="lstinputlisting" id="listing-175"><span class="label"><a id="x69-250040r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">nstart</span></span><span style="color:#000000"><span class="ec-lmtt-9">=12650;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">chosen</span></span><span style="color:#005900"> <span class="ec-lmtt-9">after zooming the signal in impulseResponses.wav</span> 
</span><span class="label"><a id="x69-250041r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">nend</span></span><span style="color:#000000"><span class="ec-lmtt-9">=22050;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">this</span></span><span style="color:#005900"> <span class="ec-lmtt-9">was the chosen segment. Adjust them for your data!</span> 
</span><span class="label"><a id="x69-250042r3"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> <span class="ec-lmtt-9">1</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">if</span></span><span style="color:#005900"> <span class="ec-lmtt-9">you have impulseResponses.wav available</span> 
</span><span class="label"><a id="x69-250043r4"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">readwav</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">impulseResponses</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x69-250044r5"></a><span class="ec-lmr-6">5</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">double</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">nstart</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">nend</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">segment</span></span><span style="color:#005900"> <span class="ec-lmtt-9">and cast h to double</span> 
</span><span class="label"><a id="x69-250045r6"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">else</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">use</span></span><span style="color:#005900"> <span class="ec-lmtt-9">signal with few samples extracted from impulseResponses.wav</span> 
</span><span class="label"><a id="x69-250046r7"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">duration</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">floor</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">nend</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">nstart</span></span><span style="color:#000000"><span class="ec-lmtt-9">+1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">same</span></span><span style="color:#005900"> <span class="ec-lmtt-9">duration as h above</span> 
</span><span class="label"><a id="x69-250047r8"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=[-1051, 4155, -32678, -11250, 5536, -4756, 2941, -3162];</span> 
</span><span class="label"><a id="x69-250048r9"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [h</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">duration</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">pad</span></span><span style="color:#005900"> <span class="ec-lmtt-9">with zeros</span> 
</span><span class="label"><a id="x69-250049r10"></a><span class="ec-lmr-6">10</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= h + 10*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">add</span></span><span style="color:#005900"> <span class="ec-lmtt-9">some noise</span> 
</span><span class="label"><a id="x69-250050r11"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=44100;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">chosen</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sampling frequency</span> 
</span><span class="label"><a id="x69-250051r12"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x69-250052r13"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1024;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of FFT points</span> 
</span><span class="label"><a id="x69-250053r14"></a></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">floor</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of segments of N samples each</span> 
</span><span class="label"><a id="x69-250054r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">h=h(:);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">make</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sure h is a column vector with N*M samples</span> 
</span><span class="label"><a id="x69-250055r16"></a></span><span style="color:#000000"><span class="ec-lmtt-9">xsegments</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">reshape</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">segment</span></span><span style="color:#005900"> <span class="ec-lmtt-9">h into M blocks</span> 
</span><span class="label"><a id="x69-250056r17"></a></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">xsegments</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">obtain</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the magnitude for each segment</span> 
</span><span class="label"><a id="x69-250057r18"></a></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">transpose</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">transpose</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the mean has to be over the FFTs</span> 
</span><span class="label"><a id="x69-250058r19"></a></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/1000;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">create</span></span><span style="color:#005900"> <span class="ec-lmtt-9">abscissa in kHz. Fs/N is the bin width</span> 
</span><span class="label"><a id="x69-250059r20"></a><span class="ec-lmr-6">20</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">,20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2+1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">xlabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">f</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(kHz)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ylabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">|</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">H</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">f</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">)</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">|</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(dBW)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span>
  </pre>
<!-- l. 2438 -->
<p class="indent">
Instead of the FFT, another option is to use the command <span class="ec-lmss-10x-x-109">pwelch(h,N,N/2,N,Fs) </span>to observe the PSD.
</p>
<figure class="figure">
<p><a id="x69-25006229"></a></p>
<!-- l. 2443 -->
<p class="noindent">
<img alt="PIC" src="./Figures/loopbackFreqResponse.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.29: </span><span class="content">Sound system magnitude frequency response <!-- l. 2444 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow></math> estimated from an impulse response.</span>
</figcaption>
<!-- tex4ht:label?: x69-25006229  -->
</figure>
<!-- l. 2447 -->
<p class="indent">
Figure&nbsp;<a href="#x69-25006229">4.29<!-- tex4ht:ref: fig:loopbackFreqResponse  --></a> is the result obtained by running the previous script. It can be seen that the filters along the processing chain that includes the DAC and ADC present strong attenuation after 20&nbsp;kHz and extra gain from DC to approximately 800&nbsp;Hz. Choosing <!-- l. 2450 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> different than 44.1&nbsp;kHz would move the cutoff frequencies <!-- l. 2450 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mi>c</mi></mrow></msub></math> of the anti-aliasing and reconstruction filters. These filters are analog, but are programmable in the sense that <!-- l. 2451 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mi>c</mi></mrow></msub></math> can be modified by software (after the user chooses a new <!-- l. 2451 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> in Audacity, for example). For example, <span class="ec-lmri-10x-x-109">switched-capacitor filters</span><a id="dx69-250063"></a> use a technology that allows this programmability feature. To check this feature in your sound board, repeat the experiment with <!-- l. 2451 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>000</mn></mrow></math> and 22,050&nbsp;Hz.
</p>
<!-- l. 2453 -->
<p class="indent">
Another alternative for obtaining an estimate of <!-- l. 2453 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow></math> is to use a white noise as input to the system and use Eq.&nbsp;(<a href="ak_dsp_bookse54.html#x64-224001r36">4.36<!-- tex4ht:ref: eq:wss_continuous_lti_output_psd  --></a>).
</p>
<figure class="figure">
<p><a id="x69-25006430"></a></p>
<!-- l. 2458 -->
<p class="noindent">
<img alt="PIC" src="./Figures/loopbackFreqResponseViaNoise.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.30: </span><span class="content">Sound system magnitude frequency response <!-- l. 2459 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow></math> estimated from a white noise input.</span>
</figcaption>
<!-- tex4ht:label?: x69-25006430  -->
</figure>
<!-- l. 2462 -->
<p class="indent">
Audacity can conveniently generate white noise via the menu “Generate - Noise”. Another option is to create the noise in Matlab/Octave, save as a WAVE file and read it with Audacity. Figure&nbsp;<a href="#x69-25006430">4.30<!-- tex4ht:ref: fig:loopbackFreqResponseViaNoise  --></a> was obtained using the former procedure to generate noise, play it back and record the system response using a loopback cable as for Figure&nbsp;<a href="#x69-25006229">4.29<!-- tex4ht:ref: fig:loopbackFreqResponse  --></a>. Then, the transient in the beginning of the recorded signal was discarded and approximately 32 thousand samples were saved as a WAVE file for processing in Matlab/Octave via the script:
</p>
<!-- l. 2463 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.31: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_recorded_noise.m</span>
</figcaption>
<!-- tex4ht:label?: x69-250065r4.10  -->
<pre class="lstinputlisting" id="listing-176"><span class="label"><a id="x69-250067r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">readwav</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">filteredNoise</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">recorded</span></span><span style="color:#005900"> <span class="ec-lmtt-9">output</span> 
</span><span class="label"><a id="x69-250068r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1024;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of FFT points</span> 
</span><span class="label"><a id="x69-250069r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">floor</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of segments of N samples each</span> 
</span><span class="label"><a id="x69-250070r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x=x(:);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">make</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sure x is a column vector with N*M samples</span> 
</span><span class="label"><a id="x69-250071r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">xsegments</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">reshape</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">segment</span></span><span style="color:#005900"> <span class="ec-lmtt-9">x into M blocks</span> 
</span><span class="label"><a id="x69-250072r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">xsegments</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">obtain</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the magnitude for each segment</span> 
</span><span class="label"><a id="x69-250073r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">transpose</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">transpose</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the mean has to be over the FFTs</span> 
</span><span class="label"><a id="x69-250074r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/1000;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">create</span></span><span style="color:#005900"> <span class="ec-lmtt-9">abscissa in kHz. Fs/N is the bin width</span> 
</span><span class="label"><a id="x69-250075r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">,20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2+1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">xlabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">f</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(kHz)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ylabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">|</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">H</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">f</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">)</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">|</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(dBW)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span>
  </pre>
<!-- l. 2475 -->
<p class="indent">
Figure&nbsp;<a href="#x69-25006430">4.30<!-- tex4ht:ref: fig:loopbackFreqResponseViaNoise  --></a> and Figure&nbsp;<a href="#x69-25006229">4.29<!-- tex4ht:ref: fig:loopbackFreqResponse  --></a> are consistent but differ with respect to ordinate values and variance of the estimate. Eq.&nbsp;(<a href="ak_dsp_bookse54.html#x64-225006r41">4.41<!-- tex4ht:ref: eq:whiteNoiseLTIOutput  --></a>) states that the input noise level scales the output PSD. Take this in account and repeat the experiment with an input noise of controlled power, such that you can use Eq.&nbsp;(<a href="ak_dsp_bookse54.html#x64-225006r41">4.41<!-- tex4ht:ref: eq:whiteNoiseLTIOutput  --></a>) to properly scale the estimate and make the values closer to the ones in Figure&nbsp;<a href="#x69-25006229">4.29<!-- tex4ht:ref: fig:loopbackFreqResponse  --></a>. Investigate other factors that improve the relation between the two figures. &nbsp;&nbsp;<!-- l. 2476 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2478 -->
<p class="noindent">
<a id="x69-250078r6"></a> <span id="textcolor313"><span class="ec-lmbx-10x-x-109">Application 4.6.</span></span> <span class="ec-lmbx-10x-x-109">Speech formant frequencies via LPC analysis</span>.
</p>
<!-- l. 2480 -->
<p class="indent">
An interesting application of LPC analysis is to estimate the <span class="ec-lmri-10x-x-109">formant </span>speech frequencies. The formants are related to the peaks of the spectrum of a vowel sound and are relatively well-defined in a sentence such as “We were away”, which does not have consonant sounds.
</p>
<figure class="figure">
<p><a id="x69-25007931"></a></p>
<!-- l. 2484 -->
<p class="noindent">
<img alt="PIC" src="./Figures/formantsAndSpectrogram.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.31: </span><span class="content">Spectrogram and tracks of the first four formant frequencies estimated via LPC for a speech sentence “We were away”.</span>
</figcaption>
<!-- tex4ht:label?: x69-25007931  -->
</figure>
<!-- l. 2488 -->
<p class="indent">
Listing&nbsp;<a href="#x69-250080r32">4.32<!-- tex4ht:ref: code:snip_frequency_formant_frequencies  --></a> was used to obtain Figure&nbsp;<a href="#x69-25007931">4.31<!-- tex4ht:ref: fig:formantsAndSpectrogram  --></a>.
</p>
<!-- l. 2489 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.32: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_formant_frequencies.m</span>
</figcaption>
<!-- tex4ht:label?: x69-250080r4.10  -->
<pre class="lstinputlisting" id="listing-177"><span class="label"><a id="x69-250082r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">numbits</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">readwav</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">WeWereAway</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">.</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">wav</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">read</span></span><span style="color:#005900"> <span class="ec-lmtt-9">wav file</span> 
</span><span class="label"><a id="x69-250083r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= s -</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">extract</span></span><span style="color:#005900"> <span class="ec-lmtt-9">any eventual DC level</span> 
</span><span class="label"><a id="x69-250084r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1024;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of FFT points</span> 
</span><span class="label"><a id="x69-250085r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of samples in signal</span> 
</span><span class="label"><a id="x69-250086r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">frame_duration</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 160;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">frame</span></span><span style="color:#005900"> <span class="ec-lmtt-9">duration</span> 
</span><span class="label"><a id="x69-250087r6"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">step</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 80;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of samples the window is shifted</span> 
</span><span class="label"><a id="x69-250088r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">order</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 10</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">LPC</span></span><span style="color:#005900"> <span class="ec-lmtt-9">order</span> 
</span><span class="label"><a id="x69-250089r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">numFormants</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 4</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">desired</span></span><span style="color:#005900"> <span class="ec-lmtt-9">number of formants</span> 
</span><span class="label"><a id="x69-250090r9"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the number of frames in signal</span> 
</span><span class="label"><a id="x69-250091r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">numFrames</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">floor</span></span><span style="color:#000000"><span class="ec-lmtt-9">((</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">frame_duration</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">/</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">step</span></span><span style="color:#000000"> <span class="ec-lmtt-9">) + 1</span> 
</span><span class="label"><a id="x69-250092r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">window</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">hamming</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">frame_duration</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">window</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for LPC analysis</span> 
</span><span class="label"><a id="x69-250093r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">formants</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">numFrames</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">numFormants</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">pre</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">allocate</span></span> 
<span class="label"><a id="x69-250094r13"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">for</span></span><span style="color:#000000"> <span class="ec-lmtt-9">i=1:numFrames</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">go</span></span><span style="color:#005900"> <span class="ec-lmtt-9">over all frames</span> 
</span><span class="label"><a id="x69-250095r14"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">startSample</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1+(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">step</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">first</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sample of frame</span> 
</span><span class="label"><a id="x69-250096r15"></a><span class="ec-lmr-6">15</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">endSample</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">startSample</span></span><span style="color:#000000"> <span class="ec-lmtt-9">+ frame_duration - 1;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">frame</span></span><span style="color:#005900"> <span class="ec-lmtt-9">end</span> 
</span><span class="label"><a id="x69-250097r16"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= s(startSample:endSample);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">extract</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frame samples</span> 
</span><span class="label"><a id="x69-250098r17"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= x.* window;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">windowing</span></span> 
<span class="label"><a id="x69-250099r18"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">a</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= aryule(x,order);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">LPC</span></span><span style="color:#005900"> <span class="ec-lmtt-9">analysis</span> 
</span><span class="label"><a id="x69-250100r19"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">poles</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">roots</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">a</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Roots</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of filter 1/A(z)</span> 
</span><span class="label"><a id="x69-250101r20"></a><span class="ec-lmr-6">20</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">freqsInRads</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">atan2</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">imag</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">poles</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">real</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">poles</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">angles</span></span> 
<span class="label"><a id="x69-250102r21"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">freqsHz</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">round</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sort</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">freqsInRads</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Hz</span> 
</span><span class="label"><a id="x69-250103r22"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">frequencies</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">freqsHz</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">freqsHz</span></span><span style="color:#000000"><span class="ec-lmtt-9">&gt;5)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">keeps</span></span><span style="color:#005900"> <span class="ec-lmtt-9">only &gt; 5 Hz</span> 
</span><span class="label"><a id="x69-250104r23"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">formants</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">,:)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= frequencies(1:numFormants);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">formants</span></span> 
<span class="label"><a id="x69-250105r24"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x69-250106r25"></a><span class="ec-lmr-6">25</span></span><span style="color:#000000"><span class="ec-lmtt-9">window</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= blackman(64);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">window</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for the spectrogram</span> 
</span><span class="label"><a id="x69-250107r26"></a></span><span style="color:#000000"><span class="ec-lmtt-9">specgram</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">window</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">round</span></span><span style="color:#000000"><span class="ec-lmtt-9">(3/4*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">window</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x69-250108r27"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">ylabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Frequency</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(Hz)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">xlabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Time</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(sec)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on;</span> 
</span><span class="label"><a id="x69-250109r28"></a></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">linspace</span></span><span style="color:#000000"><span class="ec-lmtt-9">(0,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">N / Fs, numFrames);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">abscissa</span></span> 
<span class="label"><a id="x69-250110r29"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">for</span></span><span style="color:#000000"> <span class="ec-lmtt-9">i=1:numFormants</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">plot</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the formants</span> 
</span><span class="label"><a id="x69-250111r30"></a><span class="ec-lmr-6">30</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">text</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">formants</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:,</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">color</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">blue</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x69-250112r31"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span>
  </pre>
<!-- l. 2523 -->
<p class="indent">
The code illustrates how a long signal can be segmented via windowing. It is interesting to notice that the Hamming window is typically adopted in LPC analysis, and the code uses another (Blackman) window for the spectrogram. An LPC of order 10 was used to estimate four formants. The code eliminates frequencies below 5&nbsp;Hz because LPC sometimes returns real poles that correspond to a zero frequency.
</p>
<!-- l. 2526 -->
<p class="indent">
Figure&nbsp;<a href="#x69-25007931">4.31<!-- tex4ht:ref: fig:formantsAndSpectrogram  --></a> indicates that at the sentence endpoints and at the pauses between words, when the vowel sounds are not well-defined, the formant estimation is noisy. In the middle of the sentence, around 0.5&nbsp;s, the four formants are clearly identified. In the region around 0.2&nbsp;s and also the one around 0.8&nbsp;s, the estimation is problematic because more than four formants are necessary to describe the signal. &nbsp; &nbsp;<!-- l. 2527 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2529 -->
<p class="noindent">
<a id="x69-250115r7"></a> <span id="textcolor314"><span class="ec-lmbx-10x-x-109">Application 4.7.</span></span> <span class="ec-lmbx-10x-x-109">Spectral distortion</span>. When the task is to compare two PSDs, the spectral distortion (SD) can be used. It is given by
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2532 -->
<p class="indent">
</p>
<!-- l. 2532 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x69-250116r66"></mstyle><!-- endlabel --><mstyle class="text"><mtext class="textrm" mathvariant="normal">SD</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <msqrt><mrow> <mfrac> <mrow> <mn>1</mn></mrow> <mrow><mn>2</mn><mi>π</mi></mrow></mfrac><msubsup><mrow><mo>∫ <!-- nolimits --></mo><!-- nolimits --></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>π</mi></mrow><mrow><mi>π</mi></mrow></msubsup><msup><mrow> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><msub><mrow><mi>S</mi></mrow><mrow><mi>x</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><msub><mrow><mi>S</mi></mrow><mrow><mi>y</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow></mrow><mo fence="true" form="postfix">]</mo></mrow></mrow><mrow><mn>2</mn></mrow></msup><mspace class="thinspace" width="0.17em"></mspace><mi>d</mi><mi mathvariant="normal">Ω</mi></mrow></msqrt> </mrow></math>
</td>
<td class="eq-no">
(4.66)
</td>
</tr>

</tbody></table>
<!-- l. 2536 -->
<p class="indent">
</p><p>where <!-- l. 2536 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 2536 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> are discrete-time signals and <!-- l. 2536 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>S</mi></mrow><mrow><mi>x</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 2536 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>S</mi></mrow><mrow><mi>y</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> their respective PSDs. SD is given in dB and corresponds to the root mean square value of the error between <!-- l. 2537 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>x</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 2537 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>y</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> over frequency <!-- l. 2537 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math>. It should be noted that the SD can also be used to compare two MS spectra.</p>
<p></p>
<!-- l. 2539 -->
<p class="indent">
Because both the PSD and MS spectrum are normalized versions of the squared magnitude of a DTFT and the SD divides two spectra, any normalization factor is canceled out in Eq.&nbsp;(<a href="#x69-250116r66">4.66<!-- tex4ht:ref: eq:sd1  --></a>). Therefore, Eq.&nbsp;(<a href="#x69-250116r66">4.66<!-- tex4ht:ref: eq:sd1  --></a>) can be written in terms of DTFTs as
</p>
<!-- tex4ht:inline -->
<!-- l. 2544 -->
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable class="align" columnalign="left" displaystyle="true"> <mtr><mtd class="align-odd" columnalign="right"><mstyle class="text"><mtext class="textrm" mathvariant="normal">SD</mtext></mstyle></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">=</mo> <msqrt><mrow> <mfrac> <mrow> <mn>1</mn></mrow> <mrow><mn>2</mn><mi>π</mi></mrow></mfrac><msubsup><mrow><mo>∫ <!-- nolimits --></mo><!-- nolimits --></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>π</mi></mrow><mrow><mi>π</mi></mrow></msubsup><msup><mrow> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow> <mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>Y</mi> <mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow></mrow><mo fence="true" form="postfix">]</mo></mrow> </mrow><mrow><mn>2</mn></mrow></msup><mspace class="thinspace" width="0.17em"></mspace><mi>d</mi><mi mathvariant="normal">Ω</mi></mrow></msqrt><mspace width="2em"></mspace></mtd> <mtd class="align-label" columnalign="right"><mstyle class="label" id="x69-250117r67"></mstyle><!-- endlabel --><mstyle class="maketag"><mtext>(4.67)</mtext></mstyle><mspace class="nbsp" width="0.33em"></mspace> </mtd></mtr><mtr><mtd class="align-odd" columnalign="right"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">=</mo> <msqrt><mrow> <mfrac> <mrow> <mn>1</mn></mrow> <mrow><mn>2</mn><mi>π</mi></mrow></mfrac><msubsup><mrow><mo>∫ <!-- nolimits --></mo><!-- nolimits --></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>π</mi></mrow><mrow><mi>π</mi></mrow></msubsup><msup><mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mn>20</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-rel" stretchy="false">|</mo><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo><mo class="MathClass-bin" stretchy="false">−</mo> <mn>20</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-rel" stretchy="false">|</mo><mi>Y</mi> <mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow><mrow><mn>2</mn></mrow></msup><mspace class="thinspace" width="0.17em"></mspace><mi>d</mi><mi mathvariant="normal">Ω</mi></mrow></msqrt><mspace width="2em"></mspace></mtd> <mtd class="align-label" columnalign="right"><mstyle class="label" id="x69-250118r68"></mstyle><!-- endlabel --><mstyle class="maketag"><mtext>(4.68)</mtext></mstyle><mspace class="nbsp" width="0.33em"></mspace> </mtd></mtr></mtable></math> <!-- l. 2545 -->
<p class="noindent">
where <!-- l. 2545 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 2545 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Y</mi> <mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> are the respective DTFTs.
</p>
<!-- l. 2548 -->
<p class="indent">
Eq.&nbsp;(<a href="#x69-250118r68">4.68<!-- tex4ht:ref: eq:sd2  --></a>) can be approximated by
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2549 -->
<p class="indent">
</p>
<!-- l. 2549 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x69-250119r69"></mstyle><!-- endlabel --><mstyle class="text"><mtext class="textrm" mathvariant="normal">SD</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">≈</mo><msqrt><mrow> <mfrac> <mrow> <mn>1</mn></mrow> <mrow><mi>N</mi></mrow></mfrac><munderover accent="false" accentunder="false"><mrow><mo>∑</mo> </mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><msup><mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mn>20</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-rel" stretchy="false">|</mo><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">|</mo><mo class="MathClass-bin" stretchy="false">−</mo> <mn>20</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-rel" stretchy="false">|</mo><mi>Y</mi> <mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow><mrow><mn>2</mn></mrow></msup></mrow></msqrt> </mrow></math>
</td>
<td class="eq-no">
(4.69)
</td>
</tr>

</tbody></table>
<!-- l. 2553 -->
<p class="indent">
where <!-- l. 2553 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>X</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 2553 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Y</mi> <mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> are the respective <!-- l. 2553 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>-points FFTs. Listing&nbsp;<a href="#x69-250120r33">4.33<!-- tex4ht:ref: code:ak_spectralDistortion  --></a> illustrates a software routine to calculate SD.
</p>
<!-- l. 2556 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.33: </span><span class="content">MatlabOctaveFunctions/ak_spectralDistortion.m</span>
</figcaption>
<!-- tex4ht:label?: x69-250120r4.10  -->
<pre class="lstinputlisting" id="listing-178"><span class="label"><a id="x69-250122r1"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">function</span></span><span style="color:#000000"> <span class="ec-lmtt-9">distortion = ak_spectralDistortion(x,y,Nfft,thresholdIndB)</span> 
</span><span class="label"><a id="x69-250123r2"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">function distortion = ak_spectralDistortion(x,y,Nfft,thresholdIndB)</span> 
</span><span class="label"><a id="x69-250124r3"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Returns</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the spectral distortion (SD) in dB as defined at</span> 
</span><span class="label"><a id="x69-250125r4"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">http://en.wikipedia.org/wiki/Log-spectral_distance</span> 
</span><span class="label"><a id="x69-250126r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Calculate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">magnitude values of DTFTs</span> 
</span><span class="label"><a id="x69-250127r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x69-250128r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">logX</span></span><span style="color:#000000"><span class="ec-lmtt-9">=20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">X</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Convert</span></span><span style="color:#005900"> <span class="ec-lmtt-9">to dB and use factor=20 to convert ...</span> 
</span><span class="label"><a id="x69-250129r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">logY</span></span><span style="color:#000000"><span class="ec-lmtt-9">=20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">DTFTs</span></span><span style="color:#005900"> <span class="ec-lmtt-9">into power spectra using log(X^2)=2*log(X)</span> 
</span><span class="label"><a id="x69-250130r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">maximumValue</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">logX</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">max</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">logY</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Avoid</span></span><span style="color:#005900"> <span class="ec-lmtt-9">numerical problems</span> 
</span><span class="label"><a id="x69-250131r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">minimumValue</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= maximumValue - thresholdIndB;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">such</span></span><span style="color:#005900"> <span class="ec-lmtt-9">as log of 0</span> 
</span><span class="label"><a id="x69-250132r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">logX</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">logX</span></span><span style="color:#000000"><span class="ec-lmtt-9">&lt;</span></span><span style="color:#000000"><span class="ec-lmtt-9">minimumValue</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">minimumValue</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Impose</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the floor value</span> 
</span><span class="label"><a id="x69-250133r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">logY</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">logY</span></span><span style="color:#000000"><span class="ec-lmtt-9">&lt;</span></span><span style="color:#000000"><span class="ec-lmtt-9">minimumValue</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">minimumValue</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x69-250134r13"></a></span><span style="color:#000000"><span class="ec-lmtt-9">distortion</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sqrt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">((</span></span><span style="color:#000000"><span class="ec-lmtt-9">logX</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">logY</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">SD as a mean-squared error</span></span>
  </pre>
<!-- l. 2558 -->
<p class="indent">
One issue when using logarithms is to deal with argument values equal to zero. For example, in Matlab/Octave, <span class="ec-lmss-10x-x-109">log(0) </span>gives <span class="ec-lmss-10x-x-109">-Inf </span>and can lead to <span class="ec-lmss-10x-x-109">NaN </span>after operations such as <span class="ec-lmss-10x-x-109">0*log(0)</span>. To avoid numerical problems, Listing&nbsp;<a href="#x69-250120r33">4.33<!-- tex4ht:ref: code:ak_spectralDistortion  --></a> uses a floor value based on a threshold to limit the minimum value of an argument for logarithm functions. Some lines of Listing&nbsp;<a href="#x69-250120r33">4.33<!-- tex4ht:ref: code:ak_spectralDistortion  --></a> that are not being shown also deal with special situations and are an example of how to prevent problems via proper exception treatment when using software. For example, some lines of Listing&nbsp;<a href="#x69-250120r33">4.33<!-- tex4ht:ref: code:ak_spectralDistortion  --></a> deal with the situation where both signals <!-- l. 2560 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 2560 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> have only zero values. &nbsp;&nbsp;<!-- l. 2561 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2563 -->
<p class="noindent">
<a id="x69-250135r8"></a> <span id="textcolor315"><span class="ec-lmbx-10x-x-109">Application 4.8.</span></span> <span class="ec-lmbx-10x-x-109">Spectral distortion of speech autoregressive models</span>. In speech coding applications, the signal is segmented into frames. Given two speech signals, it is discussed here how to compare their spectra using AR models in a frame-by-frame basis. While Application&nbsp;<a href="#x69-250115r7">4.7<!-- tex4ht:ref: sec:spectral_distortion  --></a> used one value of SD for the whole duration of the signals, here the SD is calculated for each frame.
</p>
<!-- l. 2566 -->
<p class="indent">
The pair of signals can be found at folder <span class="ec-lmss-10x-x-109">Applications/SpeechAnalysis</span>. One of the files correspond to the digit “eight” spoken by a male speaker. The other file was generated by a computer (more specifically, using the Klatt speech synthesizer) and aims at sounding indistinguishable from the first, or target speech.
</p>
<!-- l. 2568 -->
<p class="indent">
Listing&nbsp;<a href="#x69-250136r34">4.34<!-- tex4ht:ref: code:spectralDistortion  --></a> shows a code snippet with the part that segments the signals into frames and calculates the SD as described in Listing&nbsp;<a href="#x69-250120r33">4.33<!-- tex4ht:ref: code:ak_spectralDistortion  --></a> and also two other SD versions. These SD versions are comparisons between autoregressive models and are calculated with the function <span class="ec-lmss-10x-x-109">ak_ARSpectralDistortion.m</span>. Listing&nbsp;<a href="#x69-250136r34">4.34<!-- tex4ht:ref: code:spectralDistortion  --></a> uses the array <span class="ec-lmss-10x-x-109">isNotSilence</span>, which was obtained from function <span class="ec-lmss-10x-x-109">Applications/SpeechAnalysis/endpointsDetector.m</span>, to avoid computing the SD values for frames that have a low power and can be considered as silence, not speech.
</p>
<!-- l. 2571 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.34: </span><span class="content">Applications/SpeechAnalysis/spectralDistortion.m</span>
</figcaption>
<!-- tex4ht:label?: x69-250136r4.10  -->
<pre class="lstinputlisting" id="listing-179"><span class="label"><a id="x69-250138r26"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">for</span></span><span style="color:#000000"> <span class="ec-lmtt-9">i=1:M</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">do</span></span><span style="color:#005900"> <span class="ec-lmtt-9">not use last frame, because it may use zero padding</span> 
</span><span class="label"><a id="x69-250139r27"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> <span class="ec-lmtt-9">isNotSilence(i)==0</span> 
</span><span class="label"><a id="x69-250140r28"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">continue</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">skip</span></span><span style="color:#005900"> <span class="ec-lmtt-9">because this is a silence frame</span> 
</span><span class="label"><a id="x69-250141r29"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x69-250142r30"></a><span class="ec-lmr-6">30</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">firstSample</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1+(i-1)*S;</span> 
</span><span class="label"><a id="x69-250143r31"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">lastSample</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= firstSample + L - 1;</span> 
</span><span class="label"><a id="x69-250144r32"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">target</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">firstSample</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">lastSample</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">frame</span></span><span style="color:#005900"> <span class="ec-lmtt-9">from target signal</span> 
</span><span class="label"><a id="x69-250145r33"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">synthetic</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">firstSample</span></span><span style="color:#000000"><span class="ec-lmtt-9">:</span></span><span style="color:#000000"><span class="ec-lmtt-9">lastSample</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">frame</span></span><span style="color:#005900"> <span class="ec-lmtt-9">from the other signal</span> 
</span><span class="label"><a id="x69-250146r34"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">sd_all</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">ak_spectralDistortion</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x69-250147r35"></a><span class="ec-lmr-6">35</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">sdAR_all</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">ak_ARSpectralDistortion</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">,10,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x69-250148r36"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">sdARp_all</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">ak_ARSpectralDistortion</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">,10,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">,60,1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x69-250149r37"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">#</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">:</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">SD=</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">sd_all</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">AR SD=</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> <span class="ec-lmtt-9">...</span> 
</span><span class="label"><a id="x69-250150r38"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">sdAR_all</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">and AR SD (power)= </span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> <span class="ec-lmtt-9">...</span> 
</span><span class="label"><a id="x69-250151r39"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">sdARp_all</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x69-250152r40"></a><span class="ec-lmr-6">40</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span>
  </pre>
<!-- l. 2573 -->
<p class="indent">
</p><p>Autoregressive models are widely used in speech coding applications and their quantization is often evaluated according to the AR version of the SD. In this context, <span class="ec-lmri-10x-x-109">transparent quantization </span>is obtained when the average SD is not larger than 1&nbsp;dB, having no</p>
<p>outliers with SD larger than 4&nbsp;dB and at most 2% of frames with SD between 2 and 4&nbsp;dB. &nbsp; &nbsp;<!-- l. 2574 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math></p>
<p></p>
<div class="footnotes">
<a id="x69-250003x10"></a> <!-- l. 2240 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn10x6-bk" id="fn10x6"><sup class="textsuperscript">10</sup>&nbsp;</a></span><span class="ec-lmr-9">The files </span><span class="ec-lmss-9">ak_window4gui.m </span><span class="ec-lmr-9">and </span><span class="ec-lmss-9">ak_window4gui.fig </span><span class="ec-lmr-9">should be at the same folder.</span>
</p>
<a id="x69-250018x11"></a> <!-- l. 2318 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn11x6-bk" id="fn11x6"><sup class="textsuperscript">11</sup>&nbsp;</a></span><span class="ec-lmr-9">Because the flat top window has negative values, it trigs a bug&nbsp;[urlobug] in Octave’s </span><span class="ec-lmss-9">pwelch </span><span class="ec-lmr-9">(</span><span class="ec-lmss-9">signal </span><span class="ec-lmr-9">package, version 1.2.2).</span>
</p>
<pre><code>                                                                                               &lt;/div&gt;</code></pre>





</div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ak_dsp_bookse58.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">ak_dsp_bookse58.html</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ak_dsp_bookse60.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">ak_dsp_bookse60.html</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Digital Signal Processing with Python, Matlab or Octave, Applications in Machine Learning Aldebaro Klautau Federal University of Pará (UFPA), Brazil</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>