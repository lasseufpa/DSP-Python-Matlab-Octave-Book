<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aldebaro Klautau">

<title>Digital Signal Processing with Python, Matlab or Octave - 42&nbsp; Bilinear Transformation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ak_dsp_bookse43.html" rel="next">
<link href="./ak_dsp_bookse41.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ak_dsp_bookch3.html">Analog and Digital Systems</a></li><li class="breadcrumb-item"><a href="./ak_dsp_bookse42.html"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Bilinear Transformation</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Digital Signal Processing with Python, Matlab or Octave</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Tables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listings</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Signals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analog, Digital and Discrete-Time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basic Signal Manipulation and Representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Block Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Complex-Valued and Sampled Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modeling the Stages in A/D and D/A Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Relating Frequencies in Continuous, Sampled and Discrete-time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">An Introduction to Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Signal Categorization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Power and Energy in Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Relating Power in Continuous and Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Correlation: Finding Trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Linear Model for Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforms and Signal Representation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Linear Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inner Products to Obtain the Transform Coefficients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Block Transforms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Fourier Transforms and Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Relating discrete and analog frequencies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Summary of equations for DFT / FFT Usage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Laplace Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Z Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Contrasting Signals and Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Analog and Digital Filters: A Quick Hands-On Tour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Linear Time-Invariant Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Sampling and Signal Reconstruction Revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse36.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Facts About First and Second-Order Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse37.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Bandwidth and Quality Factor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse38.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Importance of Linear Phase (or Constant Group Delay)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse39.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Filtering technologies: Surface acoustic wave (SAW) and others</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse40.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse41.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">IIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse42.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Bilinear Transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse43.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">FIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse44.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Realization of Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse45.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multirate Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse46.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse47.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse48.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse49.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spectral Estimation Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse51.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse52.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Windows for spectral analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse53.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">The ESD, PSD and MS Spectrum functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse54.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Filtering Random Signals and the Impact on PSDs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse55.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Periodogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse56.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Welch’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse57.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Parametric PSD Estimation via Autoregressive (AR) Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse58.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Time-frequency Analysis using the Spectrogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse59.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse60.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse61.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse62.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">ak_dsp_bookap1.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Useful Mathematics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Useful Softwares and Programming Tricks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Bilinear Transformation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<meta charset="utf-8">
<meta content="TeX4ht (https://tug.org/tex4ht/)" name="generator">
<meta content="width=device-width,initial-scale=1" name="viewport">
<link href="ak_dsp_book.css" rel="stylesheet" type="text/css">
<meta content="ak_dsp_book.tex" name="src">
<script async="async" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js" type="text/javascript"></script>


<p>
<a id="dx51-169001"></a>
</p>
<!-- l. 2049 -->
<p class="noindent">
The most popular approach to designing conventional lowpass, highpass, bandpass and bandstop IIR filters is the <span class="ec-lmri-10x-x-109">bilinear </span>transformation because it is capable of preserving in <!-- l. 2049 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, most of the good features of the original <!-- l. 2049 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. In this method, the discrete-time filter is obtained by:
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2050 -->
<p class="indent">
</p>
<!-- l. 2050 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-169002r64"></mstyle><!-- endlabel --><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>s</mi><mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> <mfrac><mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> </mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>s</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>2</mn><msub><mrow><mi>F</mi></mrow><mrow> <mi>s</mi></mrow></msub><mfrac><mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> </mrow></msub><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.64)
</td>
</tr>

</tbody></table>
<!-- l. 2055 -->
<p class="indent">
As depicted in Figure&nbsp;<a href="#x51-16900333">3.33<!-- tex4ht:ref: fig:bilinear_fs  --></a>, the sampling frequency <!-- l. 2055 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> can assume any value when the bilinear is used to design a digital filter. In contrast, if a digital controller <!-- l. 2055 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>G</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> must be obtained from a continuous-time version <!-- l. 2055 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>G</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> to properly control a given <span class="ec-lmri-10x-x-109">plant </span><!-- l. 2055 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, the value of <!-- l. 2055 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> must be chosen according to the characteristics of the involved signals and impact the hardware (ADC and DAC) used in the actual digital control system deployment.
</p>
<figure class="figure">
<p><a id="x51-16900333"></a></p>
<!-- l. 2059 -->
<p class="noindent">
<img alt="PIC" src="FiguresNonScript/bilinear_fs.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.33: </span><span class="content">The choice of the sampling frequency <!-- l. 2060 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> in the bilinear transformation depends on the application, and can be arbitrary in the case of digital filter design.</span>
</figcaption>
<!-- tex4ht:label?: x51-16900333  -->
</figure>
<!-- l. 2063 -->
<p class="indent">
In the following paragraphs, it will be assumed that <!-- l. 2063 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is not arbitrarily chosen, until we discuss Section&nbsp;<a href="#x51-1730003.12.3">3.12.3<!-- tex4ht:ref: sec:bilinear_for_iir  --></a>. The following examples illustrate the bilinear transform.
</p>
<!-- l. 2066 -->
<p class="noindent">
<a id="x51-169004r21"></a> <span id="textcolor209">Example 3.21. </span><span class="ec-lmbx-10x-x-109">Examples of bilinear transformations</span>. Assuming <!-- l. 2068 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1000</mn></mrow></math>&nbsp;Hz, the bilinear transform of <!-- l. 2068 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><mi>s</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>2</mn></mrow></mfrac></mrow></math> (used in Figure&nbsp;<a href="ak_dsp_bookse34.html#x43-12600412">3.12<!-- tex4ht:ref: fig:freq_response_onepole  --></a>) is
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2069 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><mn>2</mn><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mfrac><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><mn>2002</mn></mrow></mfrac> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></mrow> <mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mfrac><mrow><mn>1998</mn></mrow> <mrow><mn>2002</mn></mrow></mfrac></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4.995</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>4</mn></mrow></msup> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></mrow> <mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.998</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2072 -->
<p class="indent">
This operation can be very tedious when the order of <!-- l. 2072 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is high. But Matlab/Octave has the handy <span class="ec-lmss-10x-x-109">bilinear </span>function. Because it differs from Octave’s, the Matlab’s <span class="ec-lmss-10x-x-109">bilinear </span>syntax will be adopted here unless otherwise stated.<span class="footnote-mark"><a href="#fn23x5" id="fn23x5-bk"><sup class="textsuperscript">23</sup></a></span><a id="x51-169005f23"></a> The previous result could be obtained with <span class="ec-lmss-10x-x-109">[HzNum,HzDen]=bilinear(1,[1 2],1000)</span>. Alternatively, it is possible to work with poles and zeros: <span class="ec-lmss-10x-x-109">[HzZeros,HzPoles,gain]=bilinear([],-2,1,1000)</span>.
</p>
<!-- l. 2074 -->
<p class="indent">
As a second example, consider the conversion of <!-- l. 2074 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>3</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4</mn><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>5</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> (the poles are <!-- l. 2074 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>2</mn> <mo class="MathClass-bin" stretchy="false">±</mo> <mi>j</mi></mrow></math> and the zero is <!-- l. 2074 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn></math>) assuming <!-- l. 2074 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math> Hz:
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2075 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> <mfrac><mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>3</mn></mrow> <mrow><msup><mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> <mfrac><mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4</mn> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> <mfrac><mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>5</mn></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>0.035</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.012</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.047</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow> <mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1.629</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.670</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow></mfrac> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2078 -->
<p class="indent">
which can be obtained with the command <span class="ec-lmss-10x-x-109">[HzNum,HzDen]=bilinear([1 -3],[1 4 5],10)</span>.<br class="newline">An alternative call would be <span class="ec-lmss-10x-x-109">[HzZeros,HzPoles,gain]=bilinear(3,transpose([-2+j -2-j]),1,10)</span> that leads to
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2080 -->
<p class="indent">
</p>
<!-- l. 2080 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-169007r65"></mstyle><!-- endlabel --><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>0.035</mn><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1.353</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.81</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>j</mi><mn>0.082</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.81</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>j</mi><mn>0.082</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.65)
</td>
</tr>

</tbody></table>
<!-- l. 2084 -->
<p class="indent">
But note that when using the function <span class="ec-lmss-10x-x-109">bilinear </span>with poles and zeros, one needs to use column instead of the row vectors used with transfer functions. &nbsp; &nbsp;<!-- l. 2085 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2088 -->
<p class="noindent">
<a id="x51-169008r22"></a> <span id="textcolor210">Example 3.22. </span><span class="ec-lmbx-10x-x-109">Bilinear transform of second order</span> <!-- l. 2088 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> <span class="ec-lmbx-10x-x-109">systems using Matlab’s symbolic math</span>. The second order <!-- l. 2089 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> given by Eq.&nbsp;(<a href="ak_dsp_bookse36.html#x45-142004r30">3.30<!-- tex4ht:ref: eq:secondOrder1  --></a>) can be converted to a discrete-time version <!-- l. 2089 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> using Listing&nbsp;<a href="#x51-169009r20">3.20<!-- tex4ht:ref: code:snip_systems_sos_bilinear  --></a>.
</p>
<!-- l. 2091 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.20: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_sos_bilinear.m</span>
</figcaption>
<!-- tex4ht:label?: x51-169009r3.12  -->
<pre class="lstinputlisting" id="listing-86"><span class="label"><a id="x51-169011r1"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">define</span></span><span style="color:#005900"> <span class="ec-lmtt-9">s, z, natural frequency, damping ratio and sampling interval</span> 
</span><span class="label"><a id="x51-169012r2"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">syms</span></span><span style="color:#000000"> <span class="ec-lmtt-9">s z wn zeta Ts</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">all</span></span><span style="color:#005900"> <span class="ec-lmtt-9">as symbolic variables</span> 
</span><span class="label"><a id="x51-169013r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Hs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">^2/(</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">^2+2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">zeta</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">^2)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">H</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Use pretty(Hs) to see it</span> 
</span><span class="label"><a id="x51-169014r4"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Hs</span></span><span style="color:#005900"><span class="ec-lmtt-9">=(2*</span></span><span style="color:#005900"><span class="ec-lmtt-9">zeta</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">wn</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"><span class="ec-lmtt-9">+</span></span><span style="color:#005900"><span class="ec-lmtt-9">wn</span></span><span style="color:#005900"><span class="ec-lmtt-9">^2)</span></span><span style="color:#005900"><span class="ec-lmtt-9">/(</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"><span class="ec-lmtt-9">^2+2*</span></span><span style="color:#005900"><span class="ec-lmtt-9">zeta</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">wn</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"><span class="ec-lmtt-9">+</span></span><span style="color:#005900"><span class="ec-lmtt-9">wn</span></span><span style="color:#005900"><span class="ec-lmtt-9">^2)</span></span><span style="color:#005900"> <span class="ec-lmtt-9">%Another H(s)</span> 
</span><span class="label"><a id="x51-169015r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Hz</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">subs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Hs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">,(2/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*((</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/(</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">+1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">bilinear</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span><span style="color:#005900"> <span class="ec-lmtt-9">s &lt;- 2/Ts*(z-1)/(z+1)</span> 
</span><span class="label"><a id="x51-169016r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Hz</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">simplify</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Hz</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">simplify</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the expression</span> 
</span><span class="label"><a id="x51-169017r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">pretty</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Hz</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">show</span></span><span style="color:#005900"> <span class="ec-lmtt-9">it using an alternative view</span></span>
  </pre>
<!-- l. 2093 -->
<p class="indent">
The bilinear transform of Eq.&nbsp;(<a href="ak_dsp_bookse36.html#x45-142004r30">3.30<!-- tex4ht:ref: eq:secondOrder1  --></a>) is obtained as
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2094 -->
<p class="indent">
</p>
<!-- l. 2094 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-169018r66"></mstyle><!-- endlabel --><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><msubsup><mrow><mi>ω</mi></mrow><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msubsup><msup><mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow><mrow><mn>2</mn></mrow></msup><msup><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow> <mrow><mo class="MathClass-open" stretchy="false">(</mo><mn>4</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4</mn><mi>ζ</mi><msub><mrow><mi>ω</mi></mrow><mrow><mi>n</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>ω</mi></mrow><mrow><mi>n</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mi>z</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><msup><mrow><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>ω</mi></mrow><mrow><mi>n</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>8</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>4</mn><mi>ζ</mi><msub><mrow><mi>ω</mi></mrow><mrow><mi>n</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>ω</mi></mrow><mrow><mi>n</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(3.66)
</td>
</tr>

</tbody></table>
<!-- l. 2098 -->
<p class="indent">
which can be simplified using Eq.&nbsp;(<a href="ak_dsp_bookse7.html#x14-39001r22">1.22<!-- tex4ht:ref: eq:freqdiscrete2continuous  --></a>), i. e., substituting <!-- l. 2098 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>n</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow></msub></mrow></math> to obtain
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2099 -->
<p class="indent">
</p>
<!-- l. 2099 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-169019r67"></mstyle><!-- endlabel --><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><msubsup><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msubsup><msup><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow> <mrow><mo class="MathClass-open" stretchy="false">(</mo><mn>4</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4</mn><mi>ζ</mi><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo><msubsup><mrow> <mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msubsup><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mi>z</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><msubsup><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msubsup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>8</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>4</mn><mi>ζ</mi><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo><msubsup><mrow> <mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.67)
</td>
</tr>

</tbody></table>
<!-- l. 2103 -->
<p class="indent">
Similarly, Listing&nbsp;<a href="#x51-169009r20">3.20<!-- tex4ht:ref: code:snip_systems_sos_bilinear  --></a> can be used to find the bilinear transform of Eq.&nbsp;(<a href="ak_dsp_bookse36.html#x45-142007r33">3.33<!-- tex4ht:ref: eq:secondOrder4  --></a>) as
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2105 -->
<p class="indent">
</p>
<!-- l. 2105 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-169020r68"></mstyle><!-- endlabel --><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mo class="MathClass-open" stretchy="false">(</mo><mn>4</mn><mi>ζ</mi><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo><msubsup><mrow> <mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msubsup><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mi>z</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><msubsup><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msubsup><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo><msub><mrow> <mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>4</mn><mi>ζ</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><mo class="MathClass-open" stretchy="false">(</mo><mn>4</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4</mn><mi>ζ</mi><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo><msubsup><mrow> <mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msubsup><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mi>z</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><msubsup><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msubsup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>8</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>4</mn><mi>ζ</mi><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo><msubsup><mrow> <mi mathvariant="normal">Ω</mi></mrow><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.68)
</td>
</tr>

</tbody></table>
<!-- l. 2110 -->
<p class="indent">
Listing&nbsp;<a href="#x51-169021r21">3.21<!-- tex4ht:ref: code:snip_systems_check_sosbilinear  --></a> can be used to verify Eq.&nbsp;(<a href="#x51-169018r66">3.66<!-- tex4ht:ref: eq:sosBilinear1  --></a>) and Eq.&nbsp;(<a href="#x51-169020r68">3.68<!-- tex4ht:ref: eq:sosBilinear4  --></a>)
</p>
<!-- l. 2112 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.21: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_check_sosbilinear.m</span>
</figcaption>
<!-- tex4ht:label?: x51-169021r3.12  -->
<pre class="lstinputlisting" id="listing-87"><span class="label"><a id="x51-169023r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">natural</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency in rad/s</span> 
</span><span class="label"><a id="x51-169024r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">zeta</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">damping</span></span><span style="color:#005900"> <span class="ec-lmtt-9">ratio</span> 
</span><span class="label"><a id="x51-169025r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10*</span></span><span style="color:#000000"><span class="ec-lmtt-9">wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">/(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Fs</span></span><span style="color:#005900"> <span class="ec-lmtt-9">chosen as 10 times the natural freq. in Hz</span> 
</span><span class="label"><a id="x51-169026r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">*(1/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convert</span></span><span style="color:#005900"> <span class="ec-lmtt-9">angular freq. from continuous to discrete-time</span> 
</span><span class="label"><a id="x51-169027r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> <span class="ec-lmtt-9">1</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Hs</span></span><span style="color:#005900"><span class="ec-lmtt-9">=</span></span><span style="color:#005900"><span class="ec-lmtt-9">wn</span></span><span style="color:#005900"><span class="ec-lmtt-9">^2/(</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"><span class="ec-lmtt-9">^2+2*</span></span><span style="color:#005900"><span class="ec-lmtt-9">zeta</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">wn</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"><span class="ec-lmtt-9">+</span></span><span style="color:#005900"><span class="ec-lmtt-9">wn</span></span><span style="color:#005900"><span class="ec-lmtt-9">^2)</span></span> 
<span class="label"><a id="x51-169028r6"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">bilinear</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">^2,[1</span></span><span style="color:#000000"> <span class="ec-lmtt-9">2*zeta*wn +wn^2],Fs)</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> <span class="ec-lmtt-9">compare below</span> 
</span><span class="label"><a id="x51-169029r7"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">Bz2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">^2*[1</span></span><span style="color:#000000"> <span class="ec-lmtt-9">2 1];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">expression</span></span><span style="color:#005900"> <span class="ec-lmtt-9">from this textbook</span> 
</span><span class="label"><a id="x51-169030r8"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">Az2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[4+4*</span></span><span style="color:#000000"><span class="ec-lmtt-9">zeta</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">^2</span></span><span style="color:#000000"> <span class="ec-lmtt-9">2*Wn^2-8 4-4*zeta*Wn+Wn^2];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">from</span></span><span style="color:#005900"> <span class="ec-lmtt-9">textbook</span> 
</span><span class="label"><a id="x51-169031r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">else</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Hs</span></span><span style="color:#005900"><span class="ec-lmtt-9">=(2*</span></span><span style="color:#005900"><span class="ec-lmtt-9">zeta</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">wn</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"><span class="ec-lmtt-9">+</span></span><span style="color:#005900"><span class="ec-lmtt-9">wn</span></span><span style="color:#005900"><span class="ec-lmtt-9">^2)</span></span><span style="color:#005900"><span class="ec-lmtt-9">/(</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"><span class="ec-lmtt-9">^2+2*</span></span><span style="color:#005900"><span class="ec-lmtt-9">zeta</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">wn</span></span><span style="color:#005900"><span class="ec-lmtt-9">*</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"><span class="ec-lmtt-9">+</span></span><span style="color:#005900"><span class="ec-lmtt-9">wn</span></span><span style="color:#005900"><span class="ec-lmtt-9">^2)</span></span><span style="color:#005900"> <span class="ec-lmtt-9">%Another H(s)</span> 
</span><span class="label"><a id="x51-169032r10"></a><span class="ec-lmr-6">10</span></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">bilinear</span></span><span style="color:#000000"><span class="ec-lmtt-9">([2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">zeta</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">wn</span></span><span style="color:#000000"> <span class="ec-lmtt-9">wn^2],[1 2*zeta*wn +wn^2],Fs)</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">compare</span></span> 
<span class="label"><a id="x51-169033r11"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">Bz2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[4*</span></span><span style="color:#000000"><span class="ec-lmtt-9">zeta</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">^2</span></span><span style="color:#000000"> <span class="ec-lmtt-9">2*Wn^2 Wn*(Wn-4*zeta)];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">from</span></span><span style="color:#005900"> <span class="ec-lmtt-9">textbook</span> 
</span><span class="label"><a id="x51-169034r12"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">Az2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[4+4*</span></span><span style="color:#000000"><span class="ec-lmtt-9">zeta</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wn</span></span><span style="color:#000000"><span class="ec-lmtt-9">^2</span></span><span style="color:#000000"> <span class="ec-lmtt-9">2*Wn^2-8 4-4*zeta*Wn+Wn^2];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">from</span></span><span style="color:#005900"> <span class="ec-lmtt-9">textbook</span> 
</span><span class="label"><a id="x51-169035r13"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x51-169036r14"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Bz2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz2</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az2</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Az2=Az2/Az2(1)</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">normalize</span></span><span style="color:#005900"> <span class="ec-lmtt-9">as done by bilinear.m</span></span>
  </pre>
<!-- l. 2114 -->
<p class="indent">
Together, Listing&nbsp;<a href="#x51-169009r20">3.20<!-- tex4ht:ref: code:snip_systems_sos_bilinear  --></a> and Listing&nbsp;<a href="#x51-169021r21">3.21<!-- tex4ht:ref: code:snip_systems_check_sosbilinear  --></a> indicate the power of combining symbolic math and numerical functions in Matlab. &nbsp; &nbsp;<!-- l. 2121 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<h5 class="subsubsectionHead anchored">
<a id="x51-170000"></a>Derivation of the bilinear transform
</h5>
<!-- l. 2125 -->
<p class="noindent">
There are several ways to explain and/or motivate the bilinear method. One of them is by modifying the matched Z-transform of Eq.&nbsp;(<a href="ak_dsp_bookse26.html#x34-103004r48">2.48<!-- tex4ht:ref: eq:relating_s_z  --></a>), which relates z and s by <!-- l. 2125 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi>s</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></msup></mrow></math>. Multiplying this relation by <!-- l. 2125 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>s</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></msup><mo class="MathClass-bin" stretchy="false">∕</mo><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>s</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></msup></mrow></math> and using the Taylor expansion <!-- l. 2125 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mrow><mi>e</mi></mrow><mrow><mi>x</mi></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mo>…</mo></mrow></math> truncated to the first order <!-- l. 2125 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mrow><mi>e</mi></mrow><mrow><mi>x</mi></mrow></msup> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>1</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi></mrow></math>, leads to<span class="footnote-mark"><a href="#fn24x5" id="fn24x5-bk"><sup class="textsuperscript">24</sup></a></span><a id="x51-170001f24"></a>
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2126 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>z</mi><mover class="stackrel"><mrow><mo class="MathClass-rel" stretchy="false">=</mo></mrow><mrow><mrow><mstyle class="text"><mtext>def</mtext></mstyle></mrow></mrow></mover><msup><mrow><mi>e</mi></mrow><mrow><mi>s</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> </mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><msup><mrow><mi>e</mi></mrow><mrow><mi>s</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></msup></mrow> <mrow><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>s</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></msup></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">≈</mo> <mfrac><mrow><mn>2</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>s</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow> <mrow><mn>2</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>s</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2129 -->
<p class="indent">
Solving for <!-- l. 2129 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math>, one obtains the bilinear transform:
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2136 -->
<p class="indent">
</p>
<!-- l. 2136 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-170003r69"></mstyle><!-- endlabel --><mi>s</mi> <mo class="MathClass-rel" stretchy="false">≈</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> <mrow><mo fence="true" form="prefix"> [</mo><mrow><mfrac><mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow> <mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">]</mo></mrow> </mrow></math>
</td>
<td class="eq-no">
(3.69)
</td>
</tr>

</tbody></table>
<!-- l. 2140 -->
<p class="indent">
and, therefore, the conversion is performed with Eq.&nbsp;(<a href="#x51-169002r64">3.64<!-- tex4ht:ref: eq:bilinearTransform  --></a>).
</p>
<!-- l. 2142 -->
<p class="indent">
The approximation <!-- l. 2142 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mrow><mi>e</mi></mrow><mrow><mi>x</mi></mrow></msup> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>1</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>x</mi></mrow></math> requires <!-- l. 2142 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math> to be close to 0, which in the bilinear transform corresponds to having <!-- l. 2142 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0</mn></mrow></math>, i. e., having <!-- l. 2142 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></math> small enough (a high sampling frequency) for the values of <!-- l. 2142 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math> of interest.
</p>
<!-- l. 2144 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">3.12.1</span>&nbsp;&nbsp;<a id="x51-1710003.12.1"></a>Bilinear mapping between s and z planes and vice-versa
</h4>
<!-- l. 2146 -->
<p class="noindent">
Eq.&nbsp;(<a href="#x51-169002r64">3.64<!-- tex4ht:ref: eq:bilinearTransform  --></a>) imposes a mapping between the s and z planes that depends only on <!-- l. 2146 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>. The code <span class="ec-lmss-10x-x-109">ak_map_s_into_z.m </span>and <span class="ec-lmss-10x-x-109">ak_map_z_into_s.m </span>allows to explore the mapping from s into z and vice-versa, respectively. The first mapping (from Eq.&nbsp;(<a href="#x51-169002r64">3.64<!-- tex4ht:ref: eq:bilinearTransform  --></a>)) is
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2148 -->
<p class="indent">
</p>
<!-- l. 2148 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-171001r70"></mstyle><!-- endlabel --><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> <mfrac><mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow> <mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></mrow></mfrac> </mrow></math>
</td>
<td class="eq-no">
(3.70)
</td>
</tr>

</tbody></table>
<!-- l. 2152 -->
<p class="indent">
and the mapping from s to z can be derived by isolating z:
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2153 -->
<p class="indent">
</p>
<!-- l. 2153 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-171002r71"></mstyle><!-- endlabel --><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mi>s</mi></mrow> <mrow><mn>2</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mi>s</mi></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.71)
</td>
</tr>

</tbody></table>
<!-- l. 2159 -->
<p class="noindent">
<a id="x51-171003r23"></a> <span id="textcolor211">Example 3.23. </span><span class="ec-lmbx-10x-x-109">Interpreting the mapping imposed by the bilinear transform</span>. According to Eq.&nbsp;(<a href="#x51-169002r64">3.64<!-- tex4ht:ref: eq:bilinearTransform  --></a>), the bilinear transform obtains the value of <!-- l. 2160 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> for a given <!-- l. 2161 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub></math>, from the value of <!-- l. 2161 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>s</mi><mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> <mfrac><mrow><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow> <mrow><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> </mrow></msub></mrow></math>. For instance, assuming <!-- l. 2162 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>j</mi><mn>4</mn></mrow></math> and <!-- l. 2162 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math>&nbsp;seconds, then <!-- l. 2162 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>s</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0.75</mn><mo class="MathClass-bin" stretchy="false">+</mo><mi>j</mi><mn>0.25</mn></mrow></msub></mrow></math>. To avoid confusion and disambiguate <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, it is useful to use a subindex and denote them <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, respectively. The result of the previous example can now be conveniently written as <!-- l. 2163 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>3</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>j</mi><mn>4</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>0.75</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>j</mi><mn>0.25</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. &nbsp; &nbsp;<!-- l. 2164 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<figure class="figure">
<p><a id="x51-17100834"></a></p>
<pre><code>                                   &lt;div class='center'&gt;</code></pre>
<!-- l. 2167 -->
<p class="noindent">
<a id="x51-171004r1"></a>
</p>
<pre><code>                         &lt;div class='subfigure'&gt;&lt;table&gt;&lt;tr&gt;&lt;td style='text-align:left'&gt;&lt;img alt='PIC' src='Figures/bilinear_map1.png' /&gt;</code></pre>
<div class="subfigcaption">
<span class="ec-lmr-9">(a) z in unit circle,</span> <!-- l. 2168 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math><span class="ec-lmr-9">&nbsp;Hz</span>
</div>




</figure></main></div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a id="x51-171005r2"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img alt="PIC" src="Figures/bilinear_map2.png">
<div class="subfigcaption">
<span class="ec-lmr-9">(b) z in unit circle,</span> <!-- l. 2169 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>150</mn></mrow></math><span class="ec-lmr-9">&nbsp;Hz</span>
</div>
</td>
</tr>

</tbody></table>
</div>
<br> <a id="x51-171006r3"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img alt="PIC" src="Figures/bilinear_map3.png">
<div class="subfigcaption">
<span class="ec-lmr-9">(c)</span> <!-- l. 2171 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="italic">jω</mi></mrow></math><span class="ec-lmr-9">,</span> <!-- l. 2171 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math><span class="ec-lmr-9">&nbsp;Hz</span>
</div>
</td>
</tr>

</tbody></table>
</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a id="x51-171007r4"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img alt="PIC" src="Figures/bilinear_map4.png">
<div class="subfigcaption">
<span class="ec-lmr-9">(d) s in left and right sides,</span> <!-- l. 2173 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math><span class="ec-lmr-9">&nbsp;Hz</span>
</div>
</td>
</tr>

</tbody></table>
</div>

<figcaption class="caption">
<span class="id">Figure&nbsp;3.34: </span><span class="content">Examples (a) and (b) of bilinear mappings from the unit circle in z to s plane. Mappings (c) and (d) of chosen points in s to z plane. Each example shows the points identified by numbers in their original and mapped planes.</span>
</figcaption>
<!-- tex4ht:label?: x51-17100834  -->

<!-- l. 2179 -->
<p class="indent">
Figure&nbsp;<a href="#x51-17100834">3.34<!-- tex4ht:ref: fig:bilinear_maps  --></a> shows some examples of the mapping imposed by the bilinear transformation. Figure&nbsp;<a href="#x51-171004r1">3.34(a)<!-- tex4ht:ref: fig:bilinear_map1  --></a> illustrates how 11 points uniformly spaced in the unit circle of the plane z are mapped to s when assuming <!-- l. 2179 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math>&nbsp;Hz. Their corresponding positions in both planes are indicated by the numbers (point 1 in z plane is mapped into point 1 in s plane, and so on). For instance, the pair of points “1” show that <!-- l. 2179 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> (DC) is mapped into <!-- l. 2179 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math>. The points in the range “2” to “6” correspond to positive frequencies, while points “7” to “11” represent negative frequencies. As a point gets closer to <!-- l. 2179 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></math> (that is <!-- l. 2179 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi></mrow></math>) in plane z, its corresponding mapping into the s plane converges to <!-- l. 2179 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="italic">j∞</mi></mrow></math> or <!-- l. 2179 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mi mathvariant="italic">j∞</mi></mrow></math>, depending if the limit is approached from a positive or negative frequency, respectively.
</p>
<!-- l. 2181 -->
<p class="indent">
Figure&nbsp;<a href="#x51-171005r2">3.34(b)<!-- tex4ht:ref: fig:bilinear_map2  --></a> uses the same choice of points in z as in Figure&nbsp;<a href="#x51-171004r1">3.34(a)<!-- tex4ht:ref: fig:bilinear_map1  --></a>, but now with <!-- l. 2181 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> increased from <!-- l. 2181 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mn>8</mn></math> to 150&nbsp;Hz. Comparing these two figures, one can notice that the same point “6” in plane z leads to <!-- l. 2181 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>j</mi><msub><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math> where <!-- l. 2181 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is larger than 2000 rad/s in Figure&nbsp;<a href="#x51-171005r2">3.34(b)<!-- tex4ht:ref: fig:bilinear_map2  --></a> and less than 120 rad/s in Figure&nbsp;<a href="#x51-171004r1">3.34(a)<!-- tex4ht:ref: fig:bilinear_map1  --></a>.
</p>
<!-- l. 2183 -->
<p class="indent">
Figure&nbsp;<a href="#x51-171006r3">3.34(c)<!-- tex4ht:ref: fig:bilinear_map3  --></a> shows that the points in <!-- l. 2183 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="italic">jω</mi></mrow></math> are mapped into the z unit circle. Figure&nbsp;<a href="#x51-171007r4">3.34(d)<!-- tex4ht:ref: fig:bilinear_map4  --></a> illustrates that points at the left half s plane are mapped inside the unit circle in z, while the points at the right half s plane are outside this circle. This fact explains the mentioned property of the bilinear transform: causal and stable filters <!-- l. 2183 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> are mapped to causal and stable filters <!-- l. 2183 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<!-- l. 2185 -->
<p class="indent">
Careful observation of Figure&nbsp;<a href="#x51-171006r3">3.34(c)<!-- tex4ht:ref: fig:bilinear_map3  --></a> allows to conclude that a linear spacing among the points in the s plane corresponds to a non-linear spacing in the z plane. This fact is further studied in the next subsection.
</p>
<h4 class="subsectionHead">
<span class="titlemark">3.12.2</span>&nbsp;&nbsp;<a id="x51-1720003.12.2"></a>Non-linear frequency warping imposed by bilinear
</h4>
<!-- l. 2189 -->
<p class="noindent">
</p><p>Assume the bilinear transform was used to map <!-- l. 2189 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> into <!-- l. 2189 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> (the subscripts will make easier to distinguish the two transfer functions). The current task is to observe the relation between frequencies <!-- l. 2189 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> and <!-- l. 2189 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math> in the discrete and continuous-time, respectively, when the bilinear is used. This mapping between</p>
<!-- l. 2189 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> and <!-- l. 2189 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math> was illustrated in Figure&nbsp;<a href="#x51-171004r1">3.34(a)<!-- tex4ht:ref: fig:bilinear_map1  --></a> to Figure&nbsp;<a href="#x51-171006r3">3.34(c)<!-- tex4ht:ref: fig:bilinear_map3  --></a>.
<p></p>
<!-- l. 2191 -->
<p class="indent">
By the definition of bilinear in Eq.&nbsp;(<a href="#x51-169002r64">3.64<!-- tex4ht:ref: eq:bilinearTransform  --></a>), the mapping between the frequency responses can be found by substituting <!-- l. 2193 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="italic">jω</mi></mrow></math> and <!-- l. 2193 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup></mrow></math> into Eq.&nbsp;(<a href="#x51-171001r70">3.70<!-- tex4ht:ref: eq:bilinear_z_to_s  --></a>). This leads to
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2195 -->
<p class="indent">
</p>
<!-- l. 2195 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-172001r72"></mstyle><!-- endlabel --><mi mathvariant="italic">jω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn><mi>j</mi><mtext class="qopname">sin</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mtext class="qopname"> cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(3.72)
</td>
</tr>

</tbody></table>
<!-- l. 2199 -->
<p class="indent">
where the second equality follows from the tricks of Eq.&nbsp;(<a href="ak_dsp_bookse66.html#x78-259001r14">B.14<!-- tex4ht:ref: eq:complex_exp_trick_sin  --></a>) and Eq.&nbsp;(<a href="ak_dsp_bookse66.html#x78-259002r15">B.15<!-- tex4ht:ref: eq:complex_exp_trick_cos  --></a>) applied to numerator and denominator, respectively. Consequently, Eq.&nbsp;(<a href="#x51-172001r72">3.72<!-- tex4ht:ref: eq:bilinearIntermediateResult  --></a>) can be written as
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2200 -->
<p class="indent">
</p>
<!-- l. 2200 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-172002r73"></mstyle><!-- endlabel --><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi mathvariant="normal">Ω</mi></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(3.73)
</td>
</tr>

</tbody></table>
<!-- l. 2204 -->
<p class="indent">
</p><p>which indicates how the bilinear relates <!-- l. 2204 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math> (rad/s) and <!-- l. 2204 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> (rad). When the bilinear transform relates <!-- l. 2205 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 2205 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, the system function <!-- l. 2205 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> behaves at frequency <!-- l. 2205 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> in the same way that <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> behaves at frequency <!-- l. 2206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math>.</p>
<p></p>
<!-- l. 2218 -->
<p class="indent">
In spite of this nonlinear frequency warping imposed by the tangent in Eq.&nbsp;(<a href="#x51-172002r73">3.73<!-- tex4ht:ref: eq:prewarping  --></a>), the “shape” of <!-- l. 2218 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is typically a good approximation of <!-- l. 2218 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. For example, the ripples are maintained. In particular, “equal ripple” filters such as Chebyshev and elliptic have the ripples preserved.
</p>
<!-- l. 2222 -->
<p class="indent">
As mentioned, an arbitrary <!-- l. 2222 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> such as a differentiator (see its mask in Figure&nbsp;<a href="ak_dsp_bookse43.html#x52-18300146">3.46<!-- tex4ht:ref: fig:differentiator_mask  --></a>) may get severely distorted when converted to <!-- l. 2222 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> using the bilinear transformation. Hence, the bilinear is the most used in practice to design the conventional lowpass, highpass, bandpass and bandstop IIR filters, which aim at a flat magnitude over the passband.
</p>
<figure class="figure">
<p><a id="x51-17200335"></a></p>
<!-- l. 2229 -->
<p class="noindent">
<img alt="PIC" src="FiguresNonScript/frequency_axes_bilinear_simpler.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.35: </span><span class="content">Version of Figure&nbsp;<a href="ak_dsp_bookse7.html#x14-4100433">1.33<!-- tex4ht:ref: fig:frequency_axes  --></a> in which the mapping between <!-- l. 2230 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math> and <!-- l. 2230 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> uses the bilinear transformation instead of the fundamental equation <!-- l. 2230 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="normal">Ω</mi><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> of Eq.&nbsp;(<a href="ak_dsp_bookse7.html#x14-39001r22">1.22<!-- tex4ht:ref: eq:freqdiscrete2continuous  --></a>).</span>
</figcaption>
<!-- tex4ht:label?: x51-17200335  -->
</figure>
<!-- l. 2233 -->
<p class="indent">
From Eq.&nbsp;(<a href="#x51-172002r73">3.73<!-- tex4ht:ref: eq:prewarping  --></a>), it can be shown that the sampling (<!-- l. 2233 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>) and Nyquist (<!-- l. 2233 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math>) frequencies, are mapped approximately to the digital frequencies <!-- l. 2233 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2.5</mn></mrow></math> and 2&nbsp;rad, respectively. This is illustrated in Figure&nbsp;<a href="#x51-17200335">3.35<!-- tex4ht:ref: fig:frequency_axes_bilinear_simpler  --></a>. When <!-- l. 2234 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">→</mo><mi>∞</mi></mrow></math>, it is mapped by the bilinear into <!-- l. 2234 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi></mrow></math>&nbsp;rad. In summary, the specific values <!-- l. 2235 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><mi>∞</mi></mrow></math> of the continuous-time frequency <!-- l. 2235 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>ω</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> are mapped, respectively into <!-- l. 2235 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>2.5</mn></mrow></math> and <!-- l. 2235 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math>.
</p>
<!-- l. 2237 -->
<p class="indent">
Note that <!-- l. 2237 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="normal">Ω</mi><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> (Eq.&nbsp;(<a href="ak_dsp_bookse7.html#x14-39001r22">1.22<!-- tex4ht:ref: eq:freqdiscrete2continuous  --></a>)), represented in Figure&nbsp;<a href="ak_dsp_bookse7.html#x14-4100433">1.33<!-- tex4ht:ref: fig:frequency_axes  --></a>, is used when mapping from continuous-time to discrete-time via periodic sampling. The mapping between <!-- l. 2237 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math> and <!-- l. 2237 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> illustrated in Figure&nbsp;<a href="#x51-17200335">3.35<!-- tex4ht:ref: fig:frequency_axes_bilinear_simpler  --></a> is imposed by the bilinear transformation and happens in a very distinct situation: when using Eq.&nbsp;(<a href="#x51-169002r64">3.64<!-- tex4ht:ref: eq:bilinearTransform  --></a>) to convert <!-- l. 2237 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> into <!-- l. 2237 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. Some examples are provided in the next paragraphs to illustrate the bilinear frequency warping.
</p>
<!-- l. 2239 -->
<p class="noindent">
<a id="x51-172004r24"></a> <span id="textcolor212">Example 3.24. </span><span class="ec-lmbx-10x-x-109">Nonlinear relation among frequencies obtained with the bilinear transform</span>. Figure&nbsp;<a href="#x51-17200536">3.36<!-- tex4ht:ref: fig:bilinearWarp  --></a> illustrates the plot obtained with Listing&nbsp;<a href="#x51-172006r22">3.22<!-- tex4ht:ref: code:snip_systems_bilinearmap  --></a>, which assumes <!-- l. 2241 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math>&nbsp;Hz. Note that the three passbands have the same bandwidth in <!-- l. 2241 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math> (<!-- l. 2241 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>b</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>b</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.4</mn></mrow></math>&nbsp;rad/s), but the bilinear mapping generates three distinct corresponding bandwidths <!-- l. 2241 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>B</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">&gt;</mo> <msub><mrow><mi>B</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">&gt;</mo> <msub><mrow><mi>B</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></math> in <!-- l. 2241 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math>. The “nonlinear warping” that led to different bandwidths, would also occur in the other way around: considering a situation with equal bandwidths in <!-- l. 2242 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math>.
</p>
<figure class="figure">
<p><a id="x51-17200536"></a></p>
<!-- l. 2246 -->
<p class="noindent">
<img alt="PIC" src="FiguresTex/bilinearWarp.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.36: </span><span class="content">Bilinear leads to a nonlinear warping between <!-- l. 2248 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math> (rad/s) and <!-- l. 2248 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> (rad). This example uses <!-- l. 2248 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math>&nbsp;Hz such that <!-- l. 2248 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.</span>
</figcaption>
<!-- tex4ht:label?: x51-17200536  -->
</figure>
<!-- l. 2251 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.22: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_bilinearmap.m</span>
</figcaption>
<!-- tex4ht:label?: x51-172006r3.12.2  -->
<pre class="lstinputlisting" id="listing-88"><span class="label"><a id="x51-172008r1"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Plot the bilinear frequency relation</span> 
</span><span class="label"><a id="x51-172009r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency. Use a convenient value.</span> 
</span><span class="label"><a id="x51-172010r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">linspace</span></span><span style="color:#000000"><span class="ec-lmtt-9">(0,3*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/4,100)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">digital</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequencies in rad</span> 
</span><span class="label"><a id="x51-172011r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">tan</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">analog</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(warped) frequencies in rad/s</span> 
</span><span class="label"><a id="x51-172012r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">xlabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">\</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Omega</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(rad)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">ylabel</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">\</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">omega</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">(rad/s)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x51-172013r6"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Same bandwidths in w (rad/s) lead to decreasing bands in W (rad)</span> 
</span><span class="label"><a id="x51-172014r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">deltaw</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.4;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">w=[0.2+(1:6)*deltaw];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">frequencies</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in w (rad/s)</span> 
</span><span class="label"><a id="x51-172015r8"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">b1</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">b2</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">b3</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">=</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">deltaw</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">rad/s (all have same value)</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x51-172016r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">atan</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">/(2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the corresponding frequencies in W (rad)</span> 
</span><span class="label"><a id="x51-172017r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">B1</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">B2</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">B3</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">=</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"> <span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">(4)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">(3)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"> <span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> <span class="ec-lmtt-9">...</span> 
</span><span class="label"><a id="x51-172018r11"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">(6)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">(5)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">rad, respectively</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span>
  </pre>
<!-- l. 2253 -->
<p class="indent">
</p><p>More specifically, executing Listing&nbsp;<a href="#x51-172006r22">3.22<!-- tex4ht:ref: code:snip_systems_bilinearmap  --></a> leads to:</p>
<p></p>
<pre class="verbatim" id="verbatim-3">b1,b2,b3=0.4&nbsp;rad/s&nbsp;(all&nbsp;have&nbsp;same&nbsp;value)
B1,B2,B3=0.48996,&nbsp;0.2263,&nbsp;0.11891&nbsp;rad,&nbsp;respectively
</pre>
<!-- l. 2257 -->
<p class="nopar">
which confirms the nonlinear frequency warping indicated in Figure&nbsp;<a href="#x51-17200536">3.36<!-- tex4ht:ref: fig:bilinearWarp  --></a>. &nbsp; &nbsp;<!-- l. 2259 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2261 -->
<p class="noindent">
<a id="x51-172019r25"></a> <span id="textcolor213">Example 3.25. </span><span class="ec-lmbx-10x-x-109">Example of how frequencies</span> <!-- l. 2261 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> <span class="ec-lmbx-10x-x-109">and</span> <!-- l. 2261 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math> <span class="ec-lmbx-10x-x-109">are warped when related via the bilinear transform</span>. The warping of Eq.&nbsp;(<a href="#x51-172002r73">3.73<!-- tex4ht:ref: eq:prewarping  --></a>) is illustrated in Figure&nbsp;<a href="#x51-17202037">3.37<!-- tex4ht:ref: fig:bilinear_freqs  --></a> for <!-- l. 2262 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>100</mn></mrow></math> Hz.
</p>
<figure class="figure">
<p><a id="x51-17202037"></a></p>
<!-- l. 2266 -->
<p class="noindent">
<img alt="PIC" src="Figures/bilinear_freqs.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.37: </span><span class="content">Relation imposed by the bilinear transform between <!-- l. 2267 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math> (rad/s) and <!-- l. 2267 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> (rad) for <!-- l. 2267 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>100</mn></mrow></math> Hz. In this case, the frequency <!-- l. 2267 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>540</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>4</mn></mrow></math> rad/s is mapped to <!-- l. 2267 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2.433</mn> <mo class="MathClass-bin" stretchy="false">±</mo> <mi>k</mi><mn>2</mn><mi>π</mi></mrow></math> rad.</span>
</figcaption>
<!-- tex4ht:label?: x51-17202037  -->
</figure>
<!-- l. 2270 -->
<p class="indent">
For instance, with <!-- l. 2270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>100</mn></mrow></math>&nbsp;Hz, a given continuous-time angular frequency <!-- l. 2270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>540</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>4</mn></mrow></math> rad/s is mapped into <!-- l. 2270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2.433</mn></mrow></math> rad (or equivalently the multiples <!-- l. 2270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">±</mo> <mi>k</mi><mn>2</mn><mi>π</mi><mo class="MathClass-punc" stretchy="false">,</mo><mi>k</mi> <mo class="MathClass-rel" stretchy="false">∈</mo> <mi>ℤ</mi></mrow></math>), i. e., <!-- l. 2270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>540</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>4</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>2.433</mn><mo class="MathClass-bin" stretchy="false">±</mo><mi>k</mi><mn>2</mn><mi>π</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. Figure&nbsp;<a href="#x51-17202037">3.37<!-- tex4ht:ref: fig:bilinear_freqs  --></a> shows the discrete-time frequencies (angles) <!-- l. 2270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math> corresponding to <!-- l. 2270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn></mrow></math>.
</p>
<!-- l. 2272 -->
<p class="indent">
Using the plot for <!-- l. 2272 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math>, <!-- l. 2272 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><mn>100</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>628</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>3</mn></mrow></math>&nbsp;rad/s is mapped, as expected from Eq.&nbsp;(<a href="#x51-172002r73">3.73<!-- tex4ht:ref: eq:prewarping  --></a>), to <!-- l. 2272 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>2.5</mn></mrow></math>&nbsp;rad. As discussed, the bilinear maps frequencies from <!-- l. 2272 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>&nbsp;Hz to <!-- l. 2272 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>2.5</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>&nbsp;rad, and <!-- l. 2272 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>f</mi> <mo class="MathClass-rel" stretchy="false">&gt;</mo> <msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> to <!-- l. 2272 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo><mo class="MathClass-close" stretchy="false">]</mo><mn>2.5</mn><mo class="MathClass-punc" stretchy="false">,</mo><mi>π</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>&nbsp;rad. &nbsp; &nbsp;<!-- l. 2273 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2275 -->
<p class="noindent">
<a id="x51-172021r26"></a> <span id="textcolor214">Example 3.26. </span><span class="ec-lmbx-10x-x-109">Using 2-d and 3-d graphs to observe how the bilinear maps s and z planes</span>. This is another example that indicates how <!-- l. 2277 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is mapped into the z-plane by the bilinear transform. Consider the system function
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2279 -->
<p class="indent">
</p>
<!-- l. 2279 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-172022r74"></mstyle><!-- endlabel --><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>101</mn><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>2</mn><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>s</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>3</mn><msup><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>103</mn><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>101</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(3.74)
</td>
</tr>

</tbody></table>
<!-- l. 2283 -->
<p class="indent">
which can be obtained using
</p>
<!-- l. 2284 -->
<pre class="lstlisting" id="listing-89"><span class="label"><a id="x51-172023r1"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">Hs_num</span></span><span style="color:#000000"><span class="ec-lmtt-9">=101*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">poly</span></span><span style="color:#000000"><span class="ec-lmtt-9">([1</span></span><span style="color:#000000"> <span class="ec-lmtt-9">1]);</span> 
</span><span class="label"><a id="x51-172024r2"></a></span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">Hs_den</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">poly</span></span><span style="color:#000000"><span class="ec-lmtt-9">([-1</span></span><span style="color:#000000"> <span class="ec-lmtt-9">-1+1j*10 -1-1j*10]);</span></span></pre>
<!-- l. 2288 -->
<p class="indent">
</p><p>and has <!-- l. 2288 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math>&nbsp;rad/s as the highest pole frequency. The poles at <!-- l. 2289 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn> <mo class="MathClass-bin" stretchy="false">±</mo> <mi>j</mi><mn>10</mn></mrow></math> create a peak at <!-- l. 2289 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math>&nbsp;rad/s, which has a frequency of <!-- l. 2289 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>1.6</mn></mrow></math>&nbsp;Hz as</p>
shown in Figure&nbsp;<a href="#x51-17202538">3.38<!-- tex4ht:ref: fig:bilinear_example_differentiator  --></a>. This <!-- l. 2290 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> was chosen because it is not a standard filter realization with a flat passband, as illustrated in Figure&nbsp;<a href="#x51-17202538">3.38<!-- tex4ht:ref: fig:bilinear_example_differentiator  --></a>. It is not evident in Figure&nbsp;<a href="#x51-17202538">3.38<!-- tex4ht:ref: fig:bilinear_example_differentiator  --></a>, but <!-- l. 2291 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> when <!-- l. 2291 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>f</mi> <mo class="MathClass-rel" stretchy="false">→</mo><mi>∞</mi></mrow></math> due to the asymptotic decay with <!-- l. 2291 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>20</mn></mrow></math>&nbsp;dB per decade imposed by the denominator order being 3 while the numerator’s is 2.
<p></p>
<figure class="figure">
<p><a id="x51-17202538"></a></p>
<!-- l. 2295 -->
<p class="noindent">
<img alt="PIC" src="Figures/bilinear_example_differentiator.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.38: </span><span class="content"><!-- l. 2296 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow></math> corresponding to <!-- l. 2296 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>101</mn><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>j</mi><mn>10</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mi>j</mi><mn>10</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> of Eq.&nbsp;(<a href="#x51-172022r74">3.74<!-- tex4ht:ref: eq:hs_for_bilinear  --></a>), to illustrate the bilinear transformation.</span>
</figcaption>
<!-- tex4ht:label?: x51-17202538  -->
</figure>
<figure class="figure">
<p><a id="x51-17202639"></a></p>
<!-- l. 2301 -->
<p class="noindent">
<img alt="PIC" src="Figures/fs_on_bilinear_freqz.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.39: </span><span class="content">Frequency responses from <!-- l. 2302 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> obtained via the bilinear transform of <!-- l. 2302 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in Eq.&nbsp;(<a href="#x51-172022r74">3.74<!-- tex4ht:ref: eq:hs_for_bilinear  --></a>) using <!-- l. 2302 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo></mrow></math> 1, 3, 5 and 7&nbsp;Hz.</span>
</figcaption>
<!-- tex4ht:label?: x51-17202639  -->
</figure>
<!-- l. 2305 -->
<p class="indent">
Figure&nbsp;<a href="#x51-17202639">3.39<!-- tex4ht:ref: fig:fs_on_bilinear_freqz  --></a> shows the magnitude (in dB) of four frequency responses from distinct <!-- l. 2306 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> obtained with the bilinear transform of <!-- l. 2306 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> using the following sampling frequencies <!-- l. 2306 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>: 1, 3, 5 and 7&nbsp;Hz. The plots illustrate aspects such as that the behavior of <!-- l. 2307 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow></math> when <!-- l. 2307 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>f</mi> <mo class="MathClass-rel" stretchy="false">→</mo><mi>∞</mi></mrow></math> (goes to <!-- l. 2307 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo><mi>∞</mi></mrow></math> in dB scale, in this case) is mapped to <!-- l. 2307 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi></mrow></math>&nbsp;rad.
</p>
<!-- l. 2309 -->
<p class="indent">
Comparing Figure&nbsp;<a href="#x51-17202538">3.38<!-- tex4ht:ref: fig:bilinear_example_differentiator  --></a> and Figure&nbsp;<a href="#x51-17202639">3.39<!-- tex4ht:ref: fig:fs_on_bilinear_freqz  --></a>, one can observe that the bilinear transform may impose severe modifications when converting the function from the s to the z plane. That should be expected because it is desired to map the infinitely long <!-- l. 2309 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="italic">jω</mi></mrow></math> axis into the unit circle <!-- l. 2309 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup></math> and, to accomplish that, the bilinear mapping corresponds to the nonlinear <span class="ec-lmri-10x-x-109">warping </span>of <!-- l. 2311 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="italic">jω</mi></mrow></math> imposed by Eq.&nbsp;(<a href="#x51-172002r73">3.73<!-- tex4ht:ref: eq:prewarping  --></a>).
</p>
<!-- l. 2313 -->
<p class="indent">
Observing Figure&nbsp;<a href="#x51-17202639">3.39<!-- tex4ht:ref: fig:fs_on_bilinear_freqz  --></a> for the extreme case of <!-- l. 2313 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>&nbsp;Hz and recalling that <!-- l. 2314 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is always mapped to approximately <!-- l. 2315 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn></mrow></math>&nbsp;rad, the pole peak at <!-- l. 2315 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1.6</mn> <mo class="MathClass-rel" stretchy="false">&gt;</mo> <msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> in Figure&nbsp;<a href="#x51-17202538">3.38<!-- tex4ht:ref: fig:bilinear_example_differentiator  --></a> is then mapped to <!-- l. 2316 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">∈</mo><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mo class="MathClass-close" stretchy="false">]</mo><mn>2</mn><mo class="MathClass-punc" stretchy="false">,</mo><mi>π</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>&nbsp;rad. In this case, the linear increase with frequency of the magnitude in dB scale observed in <!-- l. 2318 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow></math> from <!-- l. 2318 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> to 1.6&nbsp;Hz is severely distorted in <!-- l. 2318 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow></math>.
</p>
<figure class="figure">
<p><a id="x51-17202740"></a></p>
<!-- l. 2324 -->
<p class="noindent">
<img alt="PIC" src="Figures/impact_fs_on_bilinear.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.40: </span><span class="content">Magnitude (in dB) for bilinear transforms of <!-- l. 2325 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in Eq.&nbsp;(<a href="#x51-172022r74">3.74<!-- tex4ht:ref: eq:hs_for_bilinear  --></a>) for <!-- l. 2325 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> (top-left), 3 (top-right), 5 (bottom-left) and 7&nbsp;Hz. The values that <!-- l. 2325 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> assumes for the unit circle <!-- l. 2325 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>z</mi><mo class="MathClass-rel" stretchy="false">|</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> are indicated by the black contours. The corresponding 2-d frequency response magnitudes are depicted in Figure&nbsp;<a href="#x51-17202639">3.39<!-- tex4ht:ref: fig:fs_on_bilinear_freqz  --></a>.</span>
</figcaption>
<!-- tex4ht:label?: x51-17202740  -->
</figure>
<!-- l. 2329 -->
<p class="indent">
The 3-d plots of <!-- l. 2329 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow></math> for the whole Z plane can further illustrate the impact of <!-- l. 2329 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> in the bilinear transformation. The function <span class="ec-lmss-10x-x-109">ak_bilinearPlotZPlane.m </span>was used to obtain Figure&nbsp;<a href="#x51-17202740">3.40<!-- tex4ht:ref: fig:impact_fs_on_bilinear  --></a>. Given <!-- l. 2332 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, varying <!-- l. 2332 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> locates the three poles in different positions. While for <!-- l. 2333 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>&nbsp;Hz the pair of complex-conjugate poles have angles closer to <!-- l. 2334 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">±</mo> <mi>π</mi></mrow></math>&nbsp;rad, the angles move towards 0 when <!-- l. 2334 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> increases, such that they are approximately <!-- l. 2335 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">±</mo> <mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math>&nbsp;rad when <!-- l. 2335 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn></mrow></math>&nbsp;Hz. This 3-d view complements the information in Figure&nbsp;<a href="#x51-17202639">3.39<!-- tex4ht:ref: fig:fs_on_bilinear_freqz  --></a>. &nbsp; &nbsp;<!-- l. 2337 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2343 -->
<p class="indent">
<span class="ec-lmbx-10x-x-109">Choosing the sampling frequency value is important or not for the bilinear transformation?</span>
</p>
<!-- l. 2345 -->
<p class="indent">
Example&nbsp;<a href="#x51-172021r26">3.26<!-- tex4ht:ref: ex:bilinearGraphs  --></a> just shows the strong impact that <!-- l. 2345 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> may have when the bilinear transformation is applied. However, when using the bilinear in the specific task of designing a digital filter, the chosen value for <!-- l. 2345 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> may cancel out and have no influence on the design. This was discussed in Figure&nbsp;<a href="#x51-16900333">3.33<!-- tex4ht:ref: fig:bilinear_fs  --></a>. There are three important facts related to that:
</p>
<dl class="enumerate-enumitem">
<dt class="enumerate-enumitem">
<span class="ec-lmbx-10x-x-109">f</span> 1.
</dt>
<dd class="enumerate-enumitem">
The <!-- l. 2347 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> value adopted for the bilinear can be different from the one actually used when implementing the digital filter <!-- l. 2347 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> (for instance, in an embedded system with ADC and DAC chips). We will use <!-- l. 2347 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> to denote the value used in the bilinear transformation and reserve <!-- l. 2347 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> to the adopted sampling frequency when implementing <!-- l. 2347 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</dd>
<dt class="enumerate-enumitem">
<span class="ec-lmbx-10x-x-109">f</span> 2.
</dt>
<dd class="enumerate-enumitem">
<p>When the bilinear is used for IIR filter design, the sampling frequency <!-- l. 2348 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> can be chosen arbitrarily because it is later “canceled out”. In this case,<span class="footnote-mark"><a href="#fn25x5" id="fn25x5-bk"><sup class="textsuperscript">25</sup></a></span><a id="x51-172030f25"></a> <!-- l. 2349 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> is chosen to be 0.5 or 1, for instance, and one just needs to avoid choosing a too small or large value for <!-- l. 2349 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>,</p>
<pre><code> which could eventually lead to numerical issues in the bilinear transformation
 from &lt;!-- l. 2349 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;
 to &lt;!-- l. 2349 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;.
 &lt;/dd&gt;&lt;dt class='enumerate-enumitem'&gt;&lt;span class='ec-lmbx-10x-x-109'&gt;f&lt;/span&gt;</code></pre>
<ol start="3" type="1">
<li>
<dd class="enumerate-enumitem">
In applications of the bilinear transformation other than IIR design, such as control systems, the continuous-time controller <!-- l. 2351 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> (or <!-- l. 2351 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>G</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>) is already provided and it is more direct and clear to consider the actual adopted value of <!-- l. 2352 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> for implementing the digital system.
</dd>
</li></ol></dd></dl>
<!-- l. 2355 -->
<p class="indent">
The arbitrary choice of <!-- l. 2355 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> when using the bilinear for IIR design may sound confusing, but will be made clear in the next subsection in which the bilinear is used exclusively for filter design. Later, in Section&nbsp;<a href="#x51-1780003.12.8">3.12.8<!-- tex4ht:ref: sec:bilinearAdvanced  --></a>, the bilinear is discussed in the context of control systems, in which the choice of a sensible <!-- l. 2355 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> becomes important again.
</p>
<h4 class="subsectionHead">
<span class="titlemark">3.12.3</span>&nbsp;&nbsp;<a id="x51-1730003.12.3"></a>Bilinear for IIR filter design using pre-warping
</h4>
<p>
<a id="dx51-173001"></a>
</p>
<!-- l. 2360 -->
<p class="noindent">
This subsection assumes the goal is to design an IIR filter <!-- l. 2360 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. There is no concern about the sampling frequency that will be used in the actual filter deployment. Pre-warping is used to properly position the frequencies of interest. In this case, before obtaining the “final” <!-- l. 2362 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> that will be adopted for the bilinear transformation, it is important to <span class="ec-lmri-10x-x-109">pre-warp</span><a id="dx51-173002"></a> the frequencies of interest using Eq.&nbsp;(<a href="#x51-172002r73">3.73<!-- tex4ht:ref: eq:prewarping  --></a>). This way, the non-linear behavior imposed by the bilinear transform (see, e. g. Figure&nbsp;<a href="#x51-17202037">3.37<!-- tex4ht:ref: fig:bilinear_freqs  --></a> and Figure&nbsp;<a href="#x51-17200536">3.36<!-- tex4ht:ref: fig:bilinearWarp  --></a>) is pre-compensated by the filter designer. For example, when designing a bandpass filter, all frequencies of interest can be pre-warped and the design of <!-- l. 2367 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> based on these modified frequencies. When <!-- l. 2367 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is obtained, the bilinear transform will “undo” the pre-warping and locate the frequencies in the desired positions. The following example illustrates pre-warping.
</p>
<!-- l. 2371 -->
<p class="noindent">
<a id="x51-173003r27"></a> <span id="textcolor215">Example 3.27. </span><span class="ec-lmbx-10x-x-109">Design a digital lowpass filter using the bilinear transform</span>. The task is to design a Butterworth lowpass digital filter <!-- l. 2373 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with passband <!-- l. 2374 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>p</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>5</mn></mrow></math> and stopband <!-- l. 2374 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>10</mn></mrow></math> frequencies, respectively, both in rad. Note that the specifications are in discrete-time. The maximum and minimum attenuations in pass and stopbands are

<!-- l. 2376 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>A</mi></mrow><mrow><mi>p</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></mrow></math>&nbsp;dB and <!-- l. 2377 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>A</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math>&nbsp;dB, respectively.
</p>
<!-- l. 2379 -->
<p class="indent">
In order to use classic methods for designing analog filter <!-- l. 2379 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, the discrete-time frequencies <!-- l. 2380 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>p</mi></mrow></msub></math> and <!-- l. 2380 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>s</mi></mrow></msub></math> are converted to continuous-time assuming an arbitrary sampling frequency. Here we will assume <!-- l. 2381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math>&nbsp;Hz for convenience. Hence, using Eq.&nbsp;(<a href="#x51-172002r73">3.73<!-- tex4ht:ref: eq:prewarping  --></a>) the frequencies of interest are pre-warped to <!-- l. 2381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>p</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.325</mn></mrow></math> and <!-- l. 2381 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>r</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.509</mn></mrow></math>&nbsp;rad/s.
</p>
<!-- l. 2383 -->
<p class="indent">
To find the minimum order of a Butterworth that obeys the requirements, one case use:
</p>
<!-- l. 2384 -->
<pre class="lstlisting" id="listing-90"><span class="label"><a id="x51-173004r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Ap</span></span><span style="color:#000000"><span class="ec-lmtt-9">=4;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> <span class="ec-lmtt-9">dB</span> 
</span><span class="label"><a id="x51-173005r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> <span class="ec-lmtt-9">dB</span> 
</span><span class="label"><a id="x51-173006r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.325;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> <span class="ec-lmtt-9">rad/s</span> 
</span><span class="label"><a id="x51-173007r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">ws</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.509;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> <span class="ec-lmtt-9">rad/s</span> 
</span><span class="label"><a id="x51-173008r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w_cutoff</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">buttord</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">ws</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ap</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x51-173009r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w_cutoff</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span></pre>
<!-- l. 2392 -->
<p class="indent">
The second-order Butterworth with 3-dB cutoff frequency of 0.294&nbsp;rad/s obeys the corresponding mask and has the system function <!-- l. 2394 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.086</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.416</mn><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.086</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<!-- l. 2396 -->
<p class="indent">
Having obtained <!-- l. 2396 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, using Eq.&nbsp;(<a href="#x51-169002r64">3.64<!-- tex4ht:ref: eq:bilinearTransform  --></a>) with <!-- l. 2397 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math>&nbsp;Hz leads to
</p>
<!-- tex4ht:inline -->
<!-- l. 2402 -->
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable class="align-star" columnalign="left" displaystyle="true"> <mtr><mtd class="align-odd" columnalign="right"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>0.086</mn></mrow> <mrow><msup><mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.416</mn> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.086</mn></mrow></mfrac><mspace width="2em"></mspace></mtd> <mtd class="align-label" columnalign="right"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr><mtr><mtd class="align-odd" columnalign="right"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>0.086</mn><msup><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow> <mrow><msup><mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.416</mn> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></mrow><mo fence="true" form="postfix">)</mo></mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.086</mn><msup><mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac><mspace width="2em"></mspace></mtd> <mtd class="align-label" columnalign="right"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr><mtr><mtd class="align-odd" columnalign="right"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">≈</mo> <mfrac><mrow><mn>0.0575</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.1150</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.0575</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow> <mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1.2166</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.4466</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow></mfrac> <mo class="MathClass-punc" stretchy="false">.</mo><mspace width="2em"></mspace></mtd> <mtd class="align-label" columnalign="right"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr></mtable></math> <!-- l. 2403 -->
<p class="noindent">
</p><p>The frequency response of the designed <!-- l. 2403 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> has magnitudes <!-- l. 2403 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-rel" stretchy="false">|</mo><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>p</mi></mrow></msub></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>3.96</mn></mrow></math> and <!-- l. 2404 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-rel" stretchy="false">|</mo><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>r</mi></mrow></msub></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>10</mn></mrow></math>&nbsp;dB, which obey the requirements. Note that there is some slack at <!-- l. 2405 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>p</mi></mrow></msub></math> while the filter matches</p>
exactly the requirement at <!-- l. 2405 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>s</mi></mrow></msub></math>. &nbsp;&nbsp;<!-- l. 2406 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
<p></p>
<!-- l. 2408 -->
<p class="noindent">
<a id="x51-173010r28"></a> <span id="textcolor216">Example 3.28. </span><span class="ec-lmbx-10x-x-109">Design a digital bandpass filter using the bilinear transform</span>. The goal is to design a filter with a bandpass from <!-- l. 2409 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>0.2</mn><mi>π</mi></mrow></math> to <!-- l. 2409 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>0.4</mn><mi>π</mi></mrow></math>&nbsp;rad, and stopbands from 0 to <!-- l. 2409 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>0.1</mn><mi>π</mi></mrow></math> and from <!-- l. 2409 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>0.5</mn><mi>π</mi></mrow></math> to <!-- l. 2409 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math>&nbsp;rad. The filter must have less than 3&nbsp;dB of ripple in the passband and at least 30&nbsp;dB of attenuation in the stopbands. In this example, we will adopt the Chebyshev Type II approximation, which does not have the ripples at the passband that Chebyshev Type I has.
</p>
<!-- l. 2413 -->
<p class="indent">
Listing&nbsp;<a href="#x51-173011r23">3.23<!-- tex4ht:ref: code:snip_systems_iir_bilinear  --></a> indicates how to perform this filter design using Matlab/Octave.
</p>
<!-- l. 2416 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.23: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_iir_bilinear.m</span>
</figcaption>
<!-- tex4ht:label?: x51-173011r3.12.3  -->
<pre class="lstinputlisting" id="listing-91"><span class="label"><a id="x51-173013r1"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Passband specifications given in discrete-time:</span> 
</span><span class="label"><a id="x51-173014r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*[0.2</span></span><span style="color:#000000"> <span class="ec-lmtt-9">0.4];</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Passband Frequencies (rad)</span> 
</span><span class="label"><a id="x51-173015r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wr</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*[0.1</span></span><span style="color:#000000"> <span class="ec-lmtt-9">0.5];</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Stopband (rejection) Frequencies (rad)</span> 
</span><span class="label"><a id="x51-173016r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Apass</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 3;</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Maximum passband attenuation (ripple) (dB)</span> 
</span><span class="label"><a id="x51-173017r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Astop</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 30;</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Minimum stopband attenuation (dB)</span> 
</span><span class="label"><a id="x51-173018r6"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Choose convenient sampling frequency</span> 
</span><span class="label"><a id="x51-173019r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in Hertz</span> 
</span><span class="label"><a id="x51-173020r8"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Map from discrete to continuous-time using pre-warping</span> 
</span><span class="label"><a id="x51-173021r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">tan</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in rad/s</span> 
</span><span class="label"><a id="x51-173022r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">wr</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">tan</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wr</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in rad/s</span> 
</span><span class="label"><a id="x51-173023r11"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Design analog filter (use </span><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">s</span><span class="ts1-lmtt9-">' </span><span class="ec-lmtt-9">to impose continuous-time)</span> 
</span><span class="label"><a id="x51-173024r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w_design</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= cheb2ord(wp,wr,Apass,Astop,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the filter order</span> 
</span><span class="label"><a id="x51-173025r13"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">cheby2</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Astop</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w_design</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">bandpass</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">obtain</span></span><span style="color:#005900"> <span class="ec-lmtt-9">H(s) = Bs/As</span> 
</span><span class="label"><a id="x51-173026r14"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">figure</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">freqs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">plot</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the frequency response of H(s)</span> 
</span><span class="label"><a id="x51-173027r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Convert to discrete-time using bilinear</span> 
</span><span class="label"><a id="x51-173028r16"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">bilinear</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">obtain</span></span><span style="color:#005900"> <span class="ec-lmtt-9">H(z) from H(s) with given Fs</span> 
</span><span class="label"><a id="x51-173029r17"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Check some results:</span> 
</span><span class="label"><a id="x51-173030r18"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">figure</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">freqz</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">plot</span></span><span style="color:#005900"> <span class="ec-lmtt-9">DTFT of H(z). Check values at Wp and Wr</span> 
</span><span class="label"><a id="x51-173031r19"></a></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Hs_at_wp=20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">cutoff</span></span> 
<span class="label"><a id="x51-173032r20"></a><span class="ec-lmr-6">20</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">H_at_Wp=20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x51-173033r21"></a></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wr</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">H_at_Wr=20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span>
  </pre>
<!-- l. 2418 -->
<p class="indent">
In case the sampling frequency <span class="ec-lmss-10x-x-109">Fs=0.5 </span>is changed in Listing&nbsp;<a href="#x51-173011r23">3.23<!-- tex4ht:ref: code:snip_systems_iir_bilinear  --></a>, one can observe that this does not alter the final filter <!-- l. 2419 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> given by <span class="ec-lmss-10x-x-109">[Bz, Az]</span>. &nbsp;&nbsp;<!-- l. 2420 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2422 -->
<p class="indent">
Instead of using the function <span class="ec-lmss-10x-x-109">bilinear</span>, one can directly design IIR filters using <span class="ec-lmss-10x-x-109">butter</span>, <span class="ec-lmss-10x-x-109">cheby2 </span>and others. These functions automatically invoke a bilinear routine.
</p>
<!-- l. 2425 -->
<p class="noindent">
</p>
<h4 class="subsectionHead">
<span class="titlemark">3.12.4</span>&nbsp;&nbsp;<a id="x51-1740003.12.4"></a>Bilinear design of IIR filter from continuous-time specifications
</h4>
<!-- l. 2427 -->
<p class="noindent">
The design of a digital filter can start from specifications already in the digital domain, or in the analog domain. Figure&nbsp;<a href="#x51-17400141">3.41<!-- tex4ht:ref: fig:bilinear_steps  --></a> summarizes a project flow that includes designing <!-- l. 2429 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and then using the bilinear transform to obtain <!-- l. 2429 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<figure class="figure">
<p><a id="x51-17400141"></a></p>
<!-- l. 2435 -->
<p class="noindent">
<img alt="PIC" src="FiguresNonScript/bilinear_steps.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.41: </span><span class="content">Steps for using the bilinear transform to design <!-- l. 2438 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and then convert to <!-- l. 2438 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. The set of requirements can be in discrete (<!-- l. 2438 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>Φ</mi></math>) or continuous-time (<!-- l. 2438 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math>).</span>
</figcaption>
<!-- tex4ht:label?: x51-17400141  -->
</figure>
<!-- l. 2441 -->
<p class="indent">
In Figure&nbsp;<a href="#x51-17400141">3.41<!-- tex4ht:ref: fig:bilinear_steps  --></a>, it is considered the possibility of having a set of filter requirements specified either in continuous (<!-- l. 2442 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math>) or discrete-time (<!-- l. 2442 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>Φ</mi></math>). For example, a discrete-time lowpass filter can be specified by <!-- l. 2444 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Φ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">{</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>r</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>r</mi></mrow></msub><mo class="MathClass-close" stretchy="false">}</mo></mrow></math>, where the subscripts <!-- l. 2444 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math> and <!-- l. 2444 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math> distinguish the frequencies and attenuations of the passband and stopband, respectively. Similarly, <!-- l. 2446 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ϕ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">{</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>r</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>r</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-close" stretchy="false">}</mo></mrow></math> is a possible lowpass filter requirement in continuous-time, as depicted in Figure&nbsp;<a href="ak_dsp_bookse33.html#x42-115001r1">3.3(a)<!-- tex4ht:ref: fig:lowpass-mask  --></a>. Note that <!-- l. 2448 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math> includes the sampling frequency <!-- l. 2448 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> used in the hardware implementation of the digital filter while <!-- l. 2449 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>Φ</mi></math> does not.
</p>
<!-- l. 2451 -->
<p class="indent">
It is easier to start by assuming that the filter requirements were provided in discrete-time and <!-- l. 2452 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is not part of the design process. The designer simply wants to obtain an IIR filter <!-- l. 2453 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. Consequently, the steps for the bilinear in Figure&nbsp;<a href="#x51-17400141">3.41<!-- tex4ht:ref: fig:bilinear_steps  --></a> are simply the ones in the sequence “<!-- l. 2455 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>3</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>4</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>5</mn></mrow></math>”, as done in Example&nbsp;<a href="#x51-173003r27">3.27<!-- tex4ht:ref: ex:bilinear_simple  --></a>.
</p>
<!-- l. 2465 -->
<p class="indent">
When the specification of the filter to be designed is given in continuous-time, one should know the sampling frequency <!-- l. 2466 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> that will actually be used when implementing the filter. The next example illustrates this kind of design using bilinear.
</p>
<!-- l. 2469 -->
<p class="noindent">
<a id="x51-174002r29"></a> <span id="textcolor217">Example 3.29. </span><span class="ec-lmbx-10x-x-109">Design a digital lowpass filter using the bilinear transform with the specification in continuous-time</span>. The task is to design an elliptic lowpass digital filter <!-- l. 2471 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> that when implemented on a hardware operating at <!-- l. 2472 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>500</mn></mrow></math>&nbsp;Hz obeys the requirements <!-- l. 2473 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ϕ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">{</mo><mn>100</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>150</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>4</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>20</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>500</mn><mo class="MathClass-close" stretchy="false">}</mo></mrow></math>, where <!-- l. 2473 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ϕ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">{</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>r</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>r</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-close" stretchy="false">}</mo></mrow></math> with frequencies given in Hz.
</p>
<!-- l. 2477 -->
<p class="indent">
</p><p>According to Block 2 of Figure&nbsp;<a href="#x51-17400141">3.41<!-- tex4ht:ref: fig:bilinear_steps  --></a>, using <!-- l. 2477 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mi mathvariant="normal">Ω</mi></mrow></math>, <!-- l. 2478 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math> can be converted to <!-- l. 2478 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Φ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">{</mo><mn>0.4</mn><mi>π</mi><mo class="MathClass-punc" stretchy="false">,</mo><mn>0.6</mn><mi>π</mi><mo class="MathClass-punc" stretchy="false">,</mo><mn>4</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>20</mn><mo class="MathClass-close" stretchy="false">}</mo></mrow></math>, where <!-- l. 2478 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Φ</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">{</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>r</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>r</mi></mrow></msub><mo class="MathClass-close" stretchy="false">}</mo></mrow></math> with frequencies given in rad. After this, one can continue to use <!-- l. 2480 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>500</mn></mrow></math>&nbsp;Hz or a new value for the sampling frequency can be chosen. For pedagogical purposes, a new value</p>
<!-- l. 2481 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math>&nbsp;Hz is chosen here. Note that an important point is to use <!-- l. 2482 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>500</mn></mrow></math>&nbsp;Hz when implementing <!-- l. 2482 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> on “hardware”, not <!-- l. 2482 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>, which will be exclusively used for the design of <!-- l. 2483 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
<p></p>
<!-- l. 2485 -->
<p class="indent">
From Eq.&nbsp;(<a href="#x51-172002r73">3.73<!-- tex4ht:ref: eq:prewarping  --></a>) with <!-- l. 2485 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math>, the frequencies of interest are pre-warped to <!-- l. 2485 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>p</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.7265</mn></mrow></math> and <!-- l. 2485 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>r</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>r</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>1.3764</mn></mrow></math>&nbsp;rad/s. Given the pre-warped specifications in continuous-time <!-- l. 2486 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ϕ</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">{</mo><mn>0.7265</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1.3764</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>4</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>20</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>0.5</mn><mo class="MathClass-close" stretchy="false">}</mo></mrow></math>, one can obtain the second-order elliptic filter <!-- l. 2487 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">(</mo><mn>0.1</mn><msup><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.24</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.3542</mn><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.3803</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> that obeys the corresponding mask.
</p>
<!-- l. 2489 -->
<p class="indent">
Eq.&nbsp;(<a href="#x51-169002r64">3.64<!-- tex4ht:ref: eq:bilinearTransform  --></a>) (with <!-- l. 2489 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.5</mn></mrow></math>&nbsp;Hz) allows to convert <!-- l. 2489 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> into <!-- l. 2489 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">(</mo><mn>0.196</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.1614</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.196</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.7145</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.5915</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, which has <!-- l. 2489 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-rel" stretchy="false">|</mo><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>p</mi></mrow></msub></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>4</mn></mrow></math> and <!-- l. 2490 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-rel" stretchy="false">|</mo><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>r</mi></mrow></msub></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>29</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>961</mn></mrow></math>&nbsp;dB. Note that there is significant slack (almost 10&nbsp;dB) at <!-- l. 2491 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>r</mi></mrow></msub></math> while the approximation matches exactly the requirement at <!-- l. 2491 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>p</mi></mrow></msub></math>. Listing&nbsp;<a href="#x51-174003r24">3.24<!-- tex4ht:ref: code:snip_systems_iir_elliptic  --></a> indicates how to perform this filter design using Matlab.
</p>
<!-- l. 2495 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;3.24: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_iir_elliptic.m</span>
</figcaption>
<!-- tex4ht:label?: x51-174003r3.12.4  -->
<pre class="lstinputlisting" id="listing-92"><span class="label"><a id="x51-174005r1"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Specifications given in continuous-time:</span> 
</span><span class="label"><a id="x51-174006r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fp</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 100;</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Passband Frequency (Hz)</span> 
</span><span class="label"><a id="x51-174007r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fr</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 150;</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Stopband Frequency (Hz)</span> 
</span><span class="label"><a id="x51-174008r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Apass</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 4;</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Maximum passband attenuation (ripple) (dB)</span> 
</span><span class="label"><a id="x51-174009r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Astop</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 20;</span> </span><span class="ec-lmtt-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Minimum stopband attenuation (dB)</span> 
</span><span class="label"><a id="x51-174010r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=500;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in Hertz</span> 
</span><span class="label"><a id="x51-174011r7"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Convert to discrete-time using the fundamental relation w = W Fs</span> 
</span><span class="label"><a id="x51-174012r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fp</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> <span class="ec-lmtt-9">rad</span> 
</span><span class="label"><a id="x51-174013r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wr</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fr</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> <span class="ec-lmtt-9">rad</span> 
</span><span class="label"><a id="x51-174014r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Convert to continuous-time using pre-warping. Can pick another Fs</span> 
</span><span class="label"><a id="x51-174015r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0.5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">could</span></span><span style="color:#005900"> <span class="ec-lmtt-9">continue with Fs=500, but will illustrate a new value</span> 
</span><span class="label"><a id="x51-174016r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs2</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">tan</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in rad/s</span> 
</span><span class="label"><a id="x51-174017r13"></a></span><span style="color:#000000"><span class="ec-lmtt-9">wr</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs2</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">tan</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wr</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in rad/s</span> 
</span><span class="label"><a id="x51-174018r14"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Design analog filter (use </span><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">s</span><span class="ts1-lmtt9-">' </span><span class="ec-lmtt-9">to impose continuous-time)</span> 
</span><span class="label"><a id="x51-174019r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w_passband</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ellipord</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">wr</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Apass</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Astop</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">find</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the filter order</span> 
</span><span class="label"><a id="x51-174020r16"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ellip</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Apass</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Astop</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w_passband</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">obtain</span></span><span style="color:#005900"> <span class="ec-lmtt-9">H(s) = Bs/As</span> 
</span><span class="label"><a id="x51-174021r17"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Convert to discrete-time using bilinear</span> 
</span><span class="label"><a id="x51-174022r18"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">bilinear</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs2</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">obtain</span></span><span style="color:#005900"> <span class="ec-lmtt-9">H(z) from H(s) with given Fs</span> 
</span><span class="label"><a id="x51-174023r19"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Check some results:</span> 
</span><span class="label"><a id="x51-174024r20"></a><span class="ec-lmr-6">20</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">freqz</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">Bz</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"><span class="ec-lmtt-9">Az</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> <span class="ec-lmtt-9">%plot the DTFT of H(z). Now check values at Wp and Wr:</span> 
</span><span class="label"><a id="x51-174025r21"></a></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Hs_at_wp=20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x51-174026r22"></a></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">wr</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Hs_at_wr=20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">s</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x51-174027r23"></a></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Hz_at_Wp=20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x51-174028r24"></a></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wr</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Hz_at_Wr=20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x51-174029r25"></a><span class="ec-lmr-6">25</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Let the sofware do all the hard work (hiding the "bilinear"):</span> 
</span><span class="label"><a id="x51-174030r26"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">W_passband</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ellipord</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wr</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Apass</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Astop</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">digital</span></span><span style="color:#005900"> <span class="ec-lmtt-9">filter</span> 
</span><span class="label"><a id="x51-174031r27"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az2</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ellip</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Apass</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Astop</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">W_passband</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">obtains</span></span><span style="color:#005900"> <span class="ec-lmtt-9">same H(z)</span></span>
  </pre>
<!-- l. 2497 -->
<p class="indent">
Executing Listing&nbsp;<a href="#x51-174003r24">3.24<!-- tex4ht:ref: code:snip_systems_iir_elliptic  --></a> allows to confirm that, due to pre-warping, the values of <span class="ec-lmss-10x-x-109">Hs_at_wp </span>and <span class="ec-lmss-10x-x-109">Hs_at_wr </span>coincide with <span class="ec-lmss-10x-x-109">Hz_at_Wp </span>and <span class="ec-lmss-10x-x-109">Hz_at_Wr</span>, respectively. &nbsp; &nbsp;<!-- l. 2499 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<h4 class="subsectionHead">
<span class="titlemark">3.12.5</span>&nbsp;&nbsp;<a id="x51-1750003.12.5"></a>Bilinear for IIR design when continuous-time system function is provided
</h4>
<!-- l. 2504 -->
<p class="noindent">
</p><p>When an IIR filter <!-- l. 2504 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is designed using <!-- l. 2504 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> as starting point and later implemented in a system with sampling frequency <!-- l. 2504 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>, there</p>
are three frequencies of interest:
<p></p>
<pre><code> &lt;ul class='itemize1'&gt;
 &lt;li class='itemize'&gt;&lt;!-- l. 2506 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;ω&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;:
 the analog angular frequencies associated to the analog filter &lt;!-- l. 2506 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;,
 &lt;/li&gt;
 &lt;li class='itemize'&gt;&lt;!-- l. 2507 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mi mathvariant='normal'&gt;Ω&lt;/mi&gt;&lt;/math&gt;:
 the digital frequencies of &lt;!-- l. 2507 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;
 (or &lt;!-- l. 2507 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi mathvariant='normal'&gt;Ω&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;)
 &lt;/li&gt;
 &lt;li class='itemize'&gt;&lt;!-- l. 2508 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;ω&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;:
 other analog frequencies, which are related to &lt;!-- l. 2508 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mi mathvariant='normal'&gt;Ω&lt;/mi&gt;&lt;/math&gt;
 via &lt;!-- l. 2508 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;ω&lt;/mi&gt; &lt;mo class='MathClass-rel' stretchy='false'&gt;=&lt;/mo&gt; &lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant='normal'&gt;Ω&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;
 as indicated in Eq.&nbsp;(&lt;a href='ak_dsp_bookse35.html#x44-139001r28'&gt;3.28&lt;!-- tex4ht:ref: eq:digitalFilterAndDC  --&gt;&lt;/a&gt;).&lt;/li&gt;&lt;/ul&gt;</code></pre>
<!-- l. 2510 -->
<p class="noindent">
It is useful to adopt a more elaborated notation to relate these frequencies to their corresponding frequency responses. With this goal, the system functions <!-- l. 2512 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 2512 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> will be denoted as <!-- l. 2512 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 2512 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, respectively.
</p>
<!-- l. 2514 -->
<p class="indent">
As used before, the frequency response of the analog filter is <!-- l. 2514 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, while <!-- l. 2514 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is adopted for the digital filter. When <!-- l. 2515 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is followed by a D/S step as in Eq.&nbsp;(<a href="ak_dsp_bookse35.html#x44-139001r28">3.28<!-- tex4ht:ref: eq:digitalFilterAndDC  --></a>), the equivalent frequency response of this combined action will be denoted here as <!-- l. 2516 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. The subscripts of <!-- l. 2517 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub></math> and <!-- l. 2517 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub></math> suggest: from “analog” and “digital” filters, respectively (they are both “analog” frequencies, in rad/s, such that <!-- l. 2518 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub></math> is <span class="ec-lmbx-10x-x-109">not </span>a digital frequency).
</p>
<!-- l. 2520 -->
<p class="indent">
When dealing with the bilinear transform and knowing the <!-- l. 2520 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> value that will be used, it is then useful to rewrite Eq.&nbsp;(<a href="#x51-172002r73">3.73<!-- tex4ht:ref: eq:prewarping  --></a>) using <!-- l. 2521 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mi mathvariant="normal">Ω</mi></mrow></math> (as it was done to obtain Eq.&nbsp;(<a href="ak_dsp_bookse35.html#x44-137001r26">3.26<!-- tex4ht:ref: eq:sampledSignalSpectrum  --></a>)), which leads to
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2522 -->
<p class="indent">
</p>
<!-- l. 2522 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-175001r75"></mstyle><!-- endlabel --><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.75)
</td>
</tr>

</tbody></table>
<!-- l. 2526 -->
<p class="indent">
Eq.&nbsp;(<a href="#x51-175001r75">3.75<!-- tex4ht:ref: eq:prewarping2  --></a>) indicates that, when the bilinear transform is adopted, <!-- l. 2526 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> behaves at frequency <!-- l. 2526 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub></math> in the same way that the continuous-time equivalent version of <!-- l. 2526 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> behaves at frequency <!-- l. 2526 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub></math>. In other words, the two systems have the same gain and phase at frequencies <!-- l. 2526 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub></math> and <!-- l. 2526 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub></math>, respectively. The goal of the next example is to expose this relation.
</p>
<!-- l. 2529 -->
<p class="noindent">
<a id="x51-175002r30"></a> <span id="textcolor218">Example 3.30. </span><span class="ec-lmbx-10x-x-109">Frequencies </span><!-- l. 2529 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub></math> <span class="ec-lmbx-10x-x-109">and </span><!-- l. 2529 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub></math> <span class="ec-lmbx-10x-x-109">in bilinear warping</span>. As an example of analog system, Listing&nbsp;<a href="#x51-175004r25">3.25<!-- tex4ht:ref: code:snip_systems_sampling  --></a> obtains
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2532 -->
<p class="indent">
</p>
<!-- l. 2532 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-175003r76"></mstyle><!-- endlabel --><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>13600</mn><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><msup><mrow><mi>s</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4.2</mn><msup><mrow><mi>s</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>421</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>81</mn><msup><mrow><mi>s</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1638</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn><msup><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>8407</mn><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>13600</mn></mrow></mfrac> </mrow></math>
</td>
<td class="eq-no">
(3.76)
</td>
</tr>

</tbody></table>
<!-- l. 2541 -->
<p class="indent">
and converts it to <!-- l. 2541 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> using <span class="ec-lmss-10x-x-109">bilinear</span>. The filter <!-- l. 2541 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is lowpass and its pole with highest frequency is at <!-- l. 2542 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>20</mn></mrow></math>&nbsp;rad/s, which is <!-- l. 2542 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>20</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>3.2</mn></mrow></math>&nbsp;Hz. The adopted sampling frequency was <!-- l. 2543 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math> Hz.
</p>
<p><!-- l. 2545 --></p>
<figcaption class="caption">
<span class="id">Listing&nbsp;3.25: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_sampling.m</span>
</figcaption>
<!-- tex4ht:label?: x51-175004r3.12.5  -->
<pre class="lstinputlisting" id="listing-93"><span class="label"><a id="x51-175006r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">a</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">zeros</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in the s-plane</span> 
</span><span class="label"><a id="x51-175007r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">=-2;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">c=-1+1j*4; d=-0.1+1j*20;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">poles</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in the s-plane</span> 
</span><span class="label"><a id="x51-175008r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Hs_num</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">poly</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">a</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">numerator</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of H_s(s)</span> 
</span><span class="label"><a id="x51-175009r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Hs_den</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">poly</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"> <span class="ec-lmtt-9">c</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">conj</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">c</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">d</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">conj</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">d</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">H_s</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> <span class="ec-lmtt-9">denominator</span> 
</span><span class="label"><a id="x51-175010r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">Hs_den</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Hs_num</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">factor</span> 
</span><span class="label"><a id="x51-175011r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Hs_num</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Hs_num</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">force</span></span><span style="color:#005900"> <span class="ec-lmtt-9">a gain=1 at DC (s=0)</span> 
</span><span class="label"><a id="x51-175012r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency (Hz)</span> 
</span><span class="label"><a id="x51-175013r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Hz_num</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Hz_den] =</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">bilinear</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Hs_num</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Hs_den, Fs)</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">bilinear</span></span>
  </pre>
<!-- l. 2557 -->
<p class="indent">
Figure&nbsp;<a href="#x51-17502042">3.42<!-- tex4ht:ref: fig:bilinear_freq_responses  --></a> shows<span class="footnote-mark"><a href="#fn26x5" id="fn26x5-bk"><sup class="textsuperscript">26</sup></a></span><a id="x51-175016f26"></a> the magnitude of frequency responses of (from top to bottom) <!-- l. 2558 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, <!-- l. 2558 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 2558 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<!-- l. 2560 -->
<p class="indent">
Note that the frequency axis of <!-- l. 2560 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> has been warped<span class="footnote-mark"><a href="#fn27x5" id="fn27x5-bk"><sup class="textsuperscript">27</sup></a></span><a id="x51-175018f27"></a> according to Eq.&nbsp;(<a href="#x51-175001r75">3.75<!-- tex4ht:ref: eq:prewarping2  --></a>).
</p>
<figure class="figure">
<p><a id="x51-17502042"></a></p>
<!-- l. 2564 -->
<p class="noindent">
<img alt="PIC" src="Figures/bilinear_freq_responses.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.42: </span><span class="content">Frequency responses of <!-- l. 2565 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> given by Eq.&nbsp;(<a href="#x51-175003r76">3.76<!-- tex4ht:ref: eq:example_of_Hs  --></a>), <!-- l. 2565 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> obtained via <span class="ec-lmss-10x-x-109">bilinear </span>with <!-- l. 2565 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math>&nbsp;Hz and <!-- l. 2565 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> (from top to bottom). Note that the intrinsic bilinear frequency warping converts <!-- l. 2565 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>20</mn></mrow></math> rad/s into <!-- l. 2565 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>15</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>71</mn></mrow></math> rad/s.</span>
</figcaption>
<!-- tex4ht:label?: x51-17502042  -->
</figure>
<!-- l. 2568 -->
<p class="indent">
The pole at <!-- l. 2568 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>20</mn></mrow></math> rad/s was mapped to
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2569 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac><msup><mrow><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><mn>0.1</mn></mrow></mfrac><msup><mrow><mtext class="qopname">tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mn>0.1</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>20</mn></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>15</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>71</mn><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;&nbsp;rad/s</mtext></mstyle><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2572 -->
<p class="indent">
which can be checked via the commands:
</p>
<!-- l. 2573 -->
<pre class="lstlisting" id="listing-94"><span class="label"><a id="x51-175021r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">wa</span></span><span style="color:#000000"><span class="ec-lmtt-9">=20;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Ts=1/10; wd=2/Ts*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">atan</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">wa</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span></pre>
<!-- l. 2576 -->
<p class="indent">
In some situations, it is desirable to avoid that a frequency of interest (<!-- l. 2576 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>20</mn></mrow></math>&nbsp;rad/s in this case) becomes mapped to another frequency <!-- l. 2576 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class="MathClass-rel" stretchy="false">≠</mo><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub></mrow></math>. In such cases, a <span class="ec-lmri-10x-x-109">pre-warping </span>procedure can be adopted, as will be discussed in the sequel. &nbsp; &nbsp;<!-- l. 2578 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2580 -->
<p class="indent">
Figure&nbsp;<a href="#x51-17502243">3.43<!-- tex4ht:ref: fig:frequency_axes_bilinear  --></a> takes in account that two sampling frequencies can be used in a bilinear transformation: <!-- l. 2581 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> and <!-- l. 2581 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>. The former is used in the transform itself while the latter is adopted for the actual filter implementation.
</p>
<figure class="figure">
<p><a id="x51-17502243"></a></p>
<!-- l. 2587 -->
<p class="noindent">
<img alt="PIC" src="FiguresNonScript/frequency_axes_bilinear.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.43: </span><span class="content">Version of Figure&nbsp;<a href="ak_dsp_bookse7.html#x14-4100433">1.33<!-- tex4ht:ref: fig:frequency_axes  --></a> and Figure&nbsp;<a href="#x51-17200335">3.35<!-- tex4ht:ref: fig:frequency_axes_bilinear_simpler  --></a> that considers both the bilinear transform and the conversion of continuous to discrete-time via <!-- l. 2589 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="normal">Ω</mi><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>.</span>
</figcaption>
<!-- tex4ht:label?: x51-17502243  -->
</figure>
<!-- l. 2592 -->
<p class="indent">
Adapting Eq.&nbsp;(<a href="ak_dsp_bookse41.html#x50-160004r56">3.56<!-- tex4ht:ref: eq:goalOfConversions  --></a>) to the current notation, the goal of pre-warping is to obtain:
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2593 -->
<p class="indent">
</p>
<!-- l. 2593 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-175023r77"></mstyle><!-- endlabel --><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> </mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.77)
</td>
</tr>

</tbody></table>
<!-- l. 2597 -->
<p class="indent">
over the first Nyquist zone (see Section&nbsp;<a href="ak_dsp_bookse35.html#x44-137000doc">3.5.7.0<!-- tex4ht:ref: sec:dcConversionRevisited  --></a>). The following example indicates how to interpret Eq.&nbsp;(<a href="#x51-175023r77">3.77<!-- tex4ht:ref: eq:bilinearTarget  --></a>).
</p>
<!-- l. 2601 -->
<p class="noindent">
<a id="x51-175024r31"></a> <span id="textcolor219">Example 3.31. </span><span class="ec-lmbx-10x-x-109">Pre-warping applied to the system of Example&nbsp;</span><a href="#x51-175002r30"><span class="ec-lmbx-10x-x-109">3.30</span><!-- tex4ht:ref: ex:bilinearWarpingFrequencies  --></a>. Pre-warping is easily done in Matlab/Octave. For example, the change in frequency of the pole at <!-- l. 2602 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>20</mn></mrow></math> rad/s in Figure&nbsp;<a href="#x51-17502042">3.42<!-- tex4ht:ref: fig:bilinear_freq_responses  --></a> can be avoided using <span class="ec-lmss-10x-x-109">[Hz_num, Hz_den] = bilinear(Hs_num, Hs_den, Fs, 20/(2*pi)) </span>instead of <span class="ec-lmss-10x-x-109">[Hz_num, Hz_den] = bilinear(Hs_num, Hs_den, Fs)</span>. Figure&nbsp;<a href="#x51-17502544">3.44<!-- tex4ht:ref: fig:bilinear_responses_prewarped  --></a> illustrates the result of pre-warping. Note that, because in this case <!-- l. 2604 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is already given, for only a single frequency the bilinear can achieve <!-- l. 2604 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub></mrow></math>, while all others are nonlinearly shifted.
</p>
<figure class="figure">
<p><a id="x51-17502544"></a></p>
<!-- l. 2608 -->
<p class="noindent">
<img alt="PIC" src="Figures/bilinear_responses_prewarped.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.44: </span><span class="content">Version of Figure&nbsp;<a href="#x51-17502042">3.42<!-- tex4ht:ref: fig:bilinear_freq_responses  --></a> for which <span class="ec-lmss-10x-x-109">bilinear </span>used pre-warping for obtaining <!-- l. 2609 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>20</mn></mrow></math> rad/s.</span>
</figcaption>
<!-- tex4ht:label?: x51-17502544  -->
</figure>
<!-- l. 2612 -->
<p class="indent">
As mentioned, if possible, before the design of <!-- l. 2612 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, pre-warping should be used for all frequencies of interest. &nbsp; &nbsp;<!-- l. 2613 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<h4 class="subsectionHead">
<span class="titlemark">3.12.6</span>&nbsp;&nbsp;<a id="x51-1760003.12.6"></a>Properties of the bilinear transform
</h4>
<!-- l. 2621 -->
<p class="noindent">
The bilinear transform has two important properties for digital filtering applications:
</p>
<pre><code> &lt;ul class='itemize1'&gt;
 &lt;li class='itemize'&gt;it is capable of maintaining the order of &lt;!-- l. 2624 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;
 is equal to the order of the original proper &lt;!-- l. 2624 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;,
 and
 &lt;/li&gt;
 &lt;li class='itemize'&gt;if &lt;!-- l. 2625 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;
 is causal and stable, then so it is &lt;!-- l. 2625 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo class='MathClass-open' stretchy='false'&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo class='MathClass-close' stretchy='false'&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;.&lt;/li&gt;&lt;/ul&gt;</code></pre>
<!-- l. 2628 -->
<p class="indent">
It has also other interesting properties. The bilinear makes any point in the s-plane to be mapped onto a unique point in the z-plane and vice-versa. It establishes a correspondence between the “analog” DC <!-- l. 2629 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> and the “digital” DC <!-- l. 2629 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>. Similarly, it maps the highest digital frequency <!-- l. 2629 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi></mrow></math> into the highest analog frequency <!-- l. 2629 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="italic">j∞</mi></mrow></math>.
</p>
<!-- l. 2632 -->
<p class="indent">
The bilinear transformation generates <!-- l. 2632 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with the same number of poles as in <!-- l. 2632 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. In fact, a finite pole or zero at <!-- l. 2633 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math> is mapped to a pole or zero at
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2634 -->
<p class="indent">
</p>
<!-- l. 2634 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-176001r78"></mstyle><!-- endlabel --><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow> <mrow><mn>2</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.78)
</td>
</tr>

</tbody></table>
<!-- l. 2638 -->
<p class="indent">
From Example&nbsp;<a href="#x51-169004r21">3.21<!-- tex4ht:ref: ex:bilinearExamples  --></a>, one can check that <span class="ec-lmss-10x-x-109">s=-2+j;Ts=0.1;z=(2+Ts<em>s)/(2-Ts</em>s) </span>outputs <span class="ec-lmss-10x-x-109">0.81 + 0.082j</span>, as indicated in Eq.&nbsp;(<a href="#x51-169007r65">3.65<!-- tex4ht:ref: eq:example_of_hz_zeros  --></a>).
</p>
<!-- l. 2641 -->
<p class="indent">
If <!-- l. 2641 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is too small (make <!-- l. 2641 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">→</mo> <mn>0</mn></mrow></math> in Eq.&nbsp;(<a href="#x51-176001r78">3.78<!-- tex4ht:ref: eq:bilinearPoleZeroMap  --></a>)), the bilinear maps the pole (or zero) into <!-- l. 2641 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>, which can significantly distort the original <!-- l. 2642 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. On the other hand, if <!-- l. 2642 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">→</mo><mi>∞</mi></mrow></math>, it would be mapped to <!-- l. 2643 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></math>.
</p>
<!-- l. 2645 -->
<p class="indent">
As depicted in Figure&nbsp;<a href="#x51-16900333">3.33<!-- tex4ht:ref: fig:bilinear_fs  --></a>, when the bilinear is used for designing IIR filters, the value of <!-- l. 2645 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is used twice and cancels out. In these cases, an arbitrary and reasonable (not too large or small) value such as <!-- l. 2645 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> can be used. In cases in which <!-- l. 2645 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></math> does not cancel out (e. g., in some designs of a digital controller), it is important to choose a value that preserves in <!-- l. 2645 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> the characteristics of interest in <!-- l. 2645 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<!-- l. 2647 -->
<p class="indent">
The bilinear can create extra zeros at <!-- l. 2647 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></math>. This behavior can be studied by applying the bilinear transform to <!-- l. 2647 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. For higher order <!-- l. 2647 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, most of the extra zeros at <!-- l. 2647 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></math> are canceled.<span class="footnote-mark"><a href="#fn28x5" id="fn28x5-bk"><sup class="textsuperscript">28</sup></a></span><a id="x51-176002f28"></a>
</p>
<!-- l. 2649 -->
<p class="indent">
Another aspect is that, when mapping a given <!-- l. 2649 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> to <!-- l. 2649 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> using the bilinear, their values can be <span class="ec-lmri-10x-x-109">forced to match at a single frequency value</span>. For filters having a single cutoff frequency such as lowpass and highpass filters, this frequency is often the chosen one.
</p>
<!-- l. 2651 -->
<p class="indent">
</p><p>When using the bilinear, the values of <!-- l. 2651 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 2651 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> can coincide in only one frequency value, but when designing IIR filters, one can obtain <!-- l. 2651 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> already taking in account that the bilinear will distort the frequencies. This can be done by “pre-warping” the frequencies of interest and is not limited to a single frequency. In other words, it is possible to use “pre-warping” in all frequencies of interest (e. g., passband and stopband frequencies for a lowpass) to obtain <!-- l. 2651 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and, after this stage, face the bilinear restriction of matching <!-- l. 2651 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and <!-- l. 2651 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in a single frequency.</p>
<p></p>
<!-- l. 2663 -->
<p class="noindent">
</p>
<h4 class="subsectionHead">
<span class="titlemark">3.12.7</span>&nbsp;&nbsp;<a id="x51-1770003.12.7"></a>Pre-warped bilinear applied to a first-order system
</h4>
<!-- l. 2665 -->
<p class="noindent">
</p><p>Table&nbsp;<a href="ak_dsp_bookse41.html#x50-1680016">3.6<!-- tex4ht:ref: tab:HsIntoHz  --></a> summarized several methods to convert <!-- l. 2665 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> into <!-- l. 2665 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. Table&nbsp;<a href="#x51-1770017">3.7<!-- tex4ht:ref: tab:HsIntoHz_prewarped  --></a> extends it by incorporating the pre-warped bilinear transformation.</p>
<p></p>
<!-- l. 2668 -->
<p class="indent">
<a id="x51-1770017"></a>
</p>
<figure class="float figure">
<div class="center">
<!-- l. 2669 -->
<p class="noindent">
</p>
<figcaption class="caption figure-caption">
<span class="id">Table&nbsp;3.7: </span><span class="content">Pre-warped bilinear as a method to convert <!-- l. 2670 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> into <!-- l. 2670 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.</span>
</figcaption>
<!-- tex4ht:label?: x51-1770017  -->
<div class="tabular">

<table class="tabular" id="TBL-107" rules="groups">
<colgroup id="TBL-107-1g">
<col id="TBL-107-1">
</colgroup>
<colgroup id="TBL-107-2g">
<col id="TBL-107-2">
</colgroup>
<colgroup id="TBL-107-3g">
<col id="TBL-107-3">
</colgroup>
<tbody><tr class="hline">
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr id="TBL-107-1-" style="vertical-align:baseline;">
<td class="td11" id="TBL-107-1-1" style="text-align:center; white-space:nowrap;">
<div class="multirow">
<!--  rows=2  -->
<span class="ec-lmr-10">Method</span>
</div>
<pre><code>     &lt;/td&gt;&lt;td class='td11' id='TBL-107-1-2' style='text-align:center; white-space:nowrap;'&gt;                                      &lt;div class='multirow'&gt;&lt;!--  rows=2  --&gt;</code></pre>
<span class="ec-lmr-10">Mapping</span>

</td>
<td class="td11" id="TBL-107-1-3" style="text-align:center; white-space:nowrap;">
<div class="multirow">
<!--  rows=2  -->
<!-- l. 2673 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> <span class="ec-lmr-10">when</span>
</div>
</td>
</tr>
<tr id="TBL-107-2-" style="vertical-align:baseline;">
<td class="td11" id="TBL-107-2-1" style="text-align:center; white-space:nowrap;">
</td>
<td class="td11" id="TBL-107-2-2" style="text-align:center; white-space:nowrap;">
</td>
<td class="td11" id="TBL-107-2-3" style="text-align:center; white-space:nowrap;">
<!-- l. 2674 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mi>a</mi></mrow> <mrow><mi>s</mi><mo class="MathClass-bin" stretchy="false">+</mo><mi>a</mi></mrow></mfrac></mrow></math>
</td>
</tr>
<tr class="hline">
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr id="TBL-107-3-" style="vertical-align:baseline;">
<td class="td11" id="TBL-107-3-1" style="text-align:center; white-space:nowrap;">
<span class="ec-lmr-10">Bilinear </span>
</td>
<td class="td11" id="TBL-107-3-2" style="text-align:center; white-space:nowrap;">
<!-- l. 2675 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">−</mo><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow> <mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">+</mo><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></math>
</td>
<td class="td11" id="TBL-107-3-3" style="text-align:center; white-space:nowrap;">
<!-- l. 2675 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mfrac><mrow><mi>a</mi></mrow> <mrow> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">−</mo><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow> <mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">+</mo><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow><mo class="MathClass-bin" stretchy="false">+</mo><mi>a</mi></mrow></mfrac></mrow></math>
</td>
</tr>
<tr class="hline">
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr id="TBL-107-4-" style="vertical-align:baseline;">
<td class="td11" id="TBL-107-4-1" style="text-align:center; white-space:nowrap;">
<div class="multirow">
<!--  rows=2  -->
<span class="ec-lmr-10">Pre-warped bilinear</span>
</div>
</td>
<td class="td11" id="TBL-107-4-2" style="text-align:center; white-space:nowrap;">
<!-- l. 2676 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">−</mo><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow> <mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">+</mo><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></math> <span class="ec-lmr-10">and </span>
</td>
<td class="td11" id="TBL-107-4-3" style="text-align:center; white-space:nowrap;">
<div class="multirow">
<!--  rows=2  -->
<!-- l. 2676 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mfrac><mrow><mtext class="qopname">tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi>a</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow></mrow> <mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">−</mo><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow> <mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">+</mo><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow><mo class="MathClass-bin" stretchy="false">+</mo><mtext class="qopname">tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi>a</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></mfrac> </mrow></math>
</div>
<pre><code>    &lt;/td&gt;</code></pre>
</td></tr>
<tr id="TBL-107-5-" style="vertical-align:baseline;">
<td class="td11" id="TBL-107-5-1" style="text-align:center; white-space:nowrap;">
</td>
<td class="td11" id="TBL-107-5-2" style="text-align:center; white-space:nowrap;">
<!-- l. 2677 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></math>
</td>
<td class="td11" id="TBL-107-5-3" style="text-align:center; white-space:nowrap;">
</td>
</tr>
<tr class="hline">
<td>
</td>
<td>
</td>
<td>
</td>
</tr>

</tbody></table>
</div>
</div>
</figure>
<!-- l. 2682 -->
<p class="indent">
The bilinear with pre-warping in Table&nbsp;<a href="#x51-1770017">3.7<!-- tex4ht:ref: tab:HsIntoHz_prewarped  --></a> is based on first modifying <!-- l. 2682 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> using Eq.&nbsp;(<a href="#x51-175001r75">3.75<!-- tex4ht:ref: eq:prewarping2  --></a>). In other words, the pole in <!-- l. 2683 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is pre-warped to obtain <!-- l. 2684 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>a</mi></mrow></math> in the end, after the conversion using bilinear. Hence, the analog frequency must be <!-- l. 2685 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo><mtext class="qopname">tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub><mi>a</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2686 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi>a</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow> <mrow><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mfrac><mrow><mn>2</mn></mrow> <mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi>a</mi><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2689 -->
<p class="indent">
Applying the bilinear mapping to this <!-- l. 2689 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> leads to the result in Table&nbsp;<a href="ak_dsp_bookse41.html#x50-1680016">3.6<!-- tex4ht:ref: tab:HsIntoHz  --></a>. An alternative shortcut is to use Eq.&nbsp;(<a href="#x51-179002r80">3.80<!-- tex4ht:ref: eq:bilinearWithMatchingViaFs  --></a>) considering that a “match frequency” is <!-- l. 2691 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>a</mi></mrow></math>&nbsp;rad/s, as discussed in the next section.
</p>
<h4 class="subsectionHead">
<span class="titlemark">3.12.8</span>&nbsp;&nbsp;<a id="x51-1780003.12.8"></a>Bilinear for digital controller
</h4>
<!-- l. 2705 -->
<p class="noindent">
In the following discussion, <!-- l. 2705 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is already provided and the bilinear should be used to transform it, or a scaled version of <!-- l. 2706 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, into <!-- l. 2706 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. The application may be obtaining a discrete-time version <!-- l. 2706 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> of a given continuous-time controller <!-- l. 2706 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> that is applied to a <span class="ec-lmri-10x-x-109">plant</span>. In this case, the sampling frequency can be chosen according to the sampling theorem (Eq.&nbsp;(<a href="ak_dsp_bookse6.html#x13-35003r16">1.16<!-- tex4ht:ref: eq:samplingTheoremRealSignals  --></a>)). To distinguish from the use of the bilinear transform for designing IIR filters, we will call this second use case as the <span class="ec-lmri-10x-x-109">design of digital controller</span>.
</p>
<!-- l. 2709 -->
<p class="noindent">
</p>
<h5 class="subsubsectionHead">
<a id="x51-179000"></a>Using the bilinear sampling frequency to match frequencies
</h5>
<!-- l. 2711 -->
<p class="noindent">
In the digital controller design use case, the first thing to consider is that, when there is a single frequency of interest to be “matched” in the continuous and discrete-time domains, it is possible to use <!-- l. 2711 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> (or <!-- l. 2711 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></math>) to make the pre-warping as follows.
</p>
<!-- l. 2713 -->
<p class="indent">
A single “match” frequency <!-- l. 2713 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub></math> can be considered as <!-- l. 2713 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow></math>, where <!-- l. 2713 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub></math> is its value in Hz. From Eq.&nbsp;(<a href="#x51-175001r75">3.75<!-- tex4ht:ref: eq:prewarping2  --></a>):
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2715 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow> <mrow><mn>2</mn><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2718 -->
<p class="indent">
which leads to
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2719 -->
<p class="indent">
</p>
<!-- l. 2719 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-179001r79"></mstyle><!-- endlabel --><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow> <mrow><mn>2</mn><mtext class="qopname">tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow> <mrow><mn>2</mn><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mi>π</mi><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow> <mrow><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi>π</mi><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow> <mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.79)
</td>
</tr>

</tbody></table>
<!-- l. 2723 -->
<p class="indent">
To avoid the discontinuity of <!-- l. 2723 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext class="qopname">tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, one has to choose <!-- l. 2723 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mfrac><mrow><mi>π</mi><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow> <mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">&lt;</mo> <mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math>, which corresponds to <!-- l. 2724 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">&gt;</mo> <mn>2</mn><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow></math> (consistent with the sampling theorem).
</p>
<!-- l. 2726 -->
<p class="indent">
Hence, instead of Eq.&nbsp;(<a href="#x51-169002r64">3.64<!-- tex4ht:ref: eq:bilinearTransform  --></a>) and even before choosing <!-- l. 2726 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>, it is possible to incorporate pre-warping such that <!-- l. 2727 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub></math> is the match frequency using:
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2728 -->
<p class="indent">
</p>
<!-- l. 2728 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-179002r80"></mstyle><!-- endlabel --><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>s</mi><mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow> <mrow><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow><mrow><mn>2</mn><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></mfrac> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></msub><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.80)
</td>
</tr>

</tbody></table>
<!-- l. 2732 -->
<p class="indent">
Note that Eq.&nbsp;(<a href="#x51-179002r80">3.80<!-- tex4ht:ref: eq:bilinearWithMatchingViaFs  --></a>) still uses <!-- l. 2732 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> (restricted to be chosen according to <!-- l. 2733 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">&gt;</mo> <mn>2</mn><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow></math>), which may be confusing. The interpretation is as follows: assume <!-- l. 2734 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math>&nbsp;Hz and <!-- l. 2734 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> was obtained from <!-- l. 2735 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> using Eq.&nbsp;(<a href="#x51-179002r80">3.80<!-- tex4ht:ref: eq:bilinearWithMatchingViaFs  --></a>) with sampling frequency <!-- l. 2735 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> (denoted in short form as <!-- l. 2735 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>). If <!-- l. 2735 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>30</mn></mrow></math>&nbsp;Hz is chosen, then the value of <!-- l. 2736 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-punc" stretchy="false">,</mo><mn>30</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> at the angle <!-- l. 2736 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>m</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>2.1</mn></mrow></math>&nbsp;rad matches the value of <!-- l. 2736 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>s</mi><mo class="MathClass-rel" stretchy="false">=</mo><mi>j</mi><mn>20</mn><mi>π</mi></mrow></msub></mrow></math> at <!-- l. 2737 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn></mrow></math>&nbsp;Hz. In case <!-- l. 2737 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>60</mn></mrow></math>&nbsp;Hz is chosen, then it is at the angle <!-- l. 2737 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mi>m</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>1.05</mn></mrow></math>&nbsp;rad that the value of <!-- l. 2737 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-punc" stretchy="false">,</mo><mn>60</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> matches <!-- l. 2737 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>s</mi><mo class="MathClass-rel" stretchy="false">=</mo><mi>j</mi><mn>20</mn><mi>π</mi></mrow></msub></mrow></math>. Therefore, for any value of <!-- l. 2737 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">&gt;</mo> <mn>2</mn><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow></math>, <!-- l. 2737 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub></math> is a match frequency. As another example, the entry in Table&nbsp;<a href="ak_dsp_bookse41.html#x50-1680016">3.6<!-- tex4ht:ref: tab:HsIntoHz  --></a> corresponding to the pre-warped bilinear of a first-order <!-- l. 2739 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> can be obtained using Eq.&nbsp;(<a href="#x51-179002r80">3.80<!-- tex4ht:ref: eq:bilinearWithMatchingViaFs  --></a>).
</p>
<!-- l. 2741 -->
<p class="indent">
Similarly, Eq.&nbsp;(<a href="#x51-172002r73">3.73<!-- tex4ht:ref: eq:prewarping  --></a>) can be used to find <!-- l. 2741 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> that maps a specific pair <!-- l. 2741 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub></math> and <!-- l. 2741 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msub></math> as follows:
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 2742 -->
<p class="indent">
</p>
<!-- l. 2742 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x51-179003r81"></mstyle><!-- endlabel --><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow> <mrow><mn>2</mn><mtext class="qopname">tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(3.81)
</td>
</tr>

</tbody></table>
<!-- l. 2747 -->
<p class="indent">
In summary, when <!-- l. 2747 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is already provided, one can pick a single frequency <!-- l. 2747 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub></math> to be mapped by pre-warping such that <!-- l. 2748 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub></mrow></math> in Eq.&nbsp;(<a href="#x51-175001r75">3.75<!-- tex4ht:ref: eq:prewarping2  --></a>). Along the same line of reasoning, the sampling frequency <!-- l. 2749 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> can also be used to map two frequencies of interest. Figure&nbsp;<a href="#x51-17900445">3.45<!-- tex4ht:ref: fig:bilinear_givenHs  --></a> complements Figure&nbsp;<a href="#x51-17400141">3.41<!-- tex4ht:ref: fig:bilinear_steps  --></a> for scenarios of bilinear use in which a continuous-time system function (or controller) <!-- l. 2751 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is provided. While, in practice, the steps in Figure&nbsp;<a href="#x51-17400141">3.41<!-- tex4ht:ref: fig:bilinear_steps  --></a> are more frequently used when the goal is to design <!-- l. 2752 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, the steps in Figure&nbsp;<a href="#x51-17900445">3.45<!-- tex4ht:ref: fig:bilinear_givenHs  --></a> are extensively used when studying the theory of bilinear (or in textbook exercises) because they do not require designing <!-- l. 2754 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> (<!-- l. 2754 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is given). On the other hand, it may be needed to perform frequency scaling on <!-- l. 2755 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<figure class="figure">
<p><a id="x51-17900445"></a></p>
<!-- l. 2760 -->
<p class="noindent">
<img alt="PIC" src="FiguresNonScript/bilinear_givenHs.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.45: </span><span class="content">Summary of scenarios of use for the bilinear transform when a continuous-time system function (or controller) <!-- l. 2761 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is provided.</span>
</figcaption>
<!-- tex4ht:label?: x51-17900445  -->
</figure>
<!-- l. 2764 -->
<p class="indent">
Box 4 in Figure&nbsp;<a href="#x51-17900445">3.45<!-- tex4ht:ref: fig:bilinear_givenHs  --></a> corresponds to using the shortcut<span class="footnote-mark"><a href="#fn29x5" id="fn29x5-bk"><sup class="textsuperscript">29</sup></a></span><a id="x51-179005f29"></a> of Eq.&nbsp;(<a href="#x51-179003r81">3.81<!-- tex4ht:ref: eq:bilinearPairWithMatchingViaFs  --></a>) that incorporates pre-warping in the definition of <!-- l. 2765 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>. As an alternative, Box 7 illustrates how bilinear can depend not only on pre-warping but also on the proper use of frequency scaling.
</p>
<!-- l. 2769 -->
<p class="indent">
Some extra examples of the bilinear transform are discussed in the sequel.
</p>
<!-- l. 2772 -->
<p class="noindent">
<a id="x51-179007r32"></a> <span id="textcolor220">Example 3.32. </span><span class="ec-lmbx-10x-x-109">Design an IIR filter with the bilinear transform using a pre-specified continuous-time filter and sampling frequency</span>. The task is to design on Matlab (Octave has a slightly different syntax) a third-order lowpass Butterworth digital filter <!-- l. 2774 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> using the bilinear transformation of <!-- l. 2775 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>s</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><msup><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> (that can be obtained with <span class="ec-lmss-10x-x-109">[Bs,As]=butter(3,1,’s’)</span>). Other project requirements are a sampling frequency of <!-- l. 2776 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>500</mn></mrow></math> Hz and <!-- l. 2776 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with a cutoff frequency <!-- l. 2776 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>100</mn></mrow></math>&nbsp;Hz (i. e., <!-- l. 2776 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><msub><mrow><mi>f</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>628</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>3</mn></mrow></math>&nbsp;rad/s).
</p>
<!-- l. 2778 -->
<p class="indent">
Figure&nbsp;<a href="#x51-17900445">3.45<!-- tex4ht:ref: fig:bilinear_givenHs  --></a> will be used to guide the project. The answer to its Block 1 is “no”, because the design has to have control over the frequencies. Pre-warping must be used because <!-- l. 2780 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>&nbsp;rad/s is the cutoff frequency of <!-- l. 2780 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> that has to be mapped to <!-- l. 2781 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>100</mn></mrow></math>&nbsp;Hz when <!-- l. 2781 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> is implemented.
</p>
<!-- l. 2790 -->
<p class="indent">
The answer to Block 3 is “yes’ and <!-- l. 2790 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>500</mn></mrow></math>&nbsp;Hz is assumed in the sequel. The goal is to find the frequency <!-- l. 2791 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub></math> to which <!-- l. 2791 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><msub><mrow><mi>f</mi></mrow><mrow><mi>d</mi></mrow></msub></mrow></math> is mapped to. Eq.&nbsp;(<a href="#x51-175001r75">3.75<!-- tex4ht:ref: eq:prewarping2  --></a>) leads to
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2793 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub></mrow> <mrow><mn>2</mn><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>500</mn><mtext class="qopname">tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mn>2</mn><mi>π</mi><mn>100</mn></mrow> <mrow><mn>2</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>500</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>726</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>52</mn><mspace class="nbsp" width="0.33em"></mspace><mstyle class="text"><mtext class="textrm" mathvariant="normal">rad/s</mtext></mstyle><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2796 -->
<p class="indent">
</p><p>which corresponds to <!-- l. 2796 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>115</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>63</mn></mrow></math>&nbsp;Hz.</p>
<p></p>
<!-- l. 2798 -->
<p class="indent">
Now, frequency scaling must be applied to <!-- l. 2798 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in order to move its cutoff frequency from <!-- l. 2798 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> to <!-- l. 2798 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>726</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>52</mn></mrow></math>&nbsp;rad/s. Substituting <!-- l. 2798 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi> <mo class="MathClass-rel" stretchy="false">←</mo> <mi>s</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>726</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>52</mn></mrow></math> in <!-- l. 2798 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> leads to
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2799 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>H</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>3.8348</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mn>8</mn></mrow></msup></mrow> <mrow><msup><mrow><mi>s</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1.453</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mn>3</mn></mrow></msup><msup><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1.0557</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mn>6</mn></mrow></msup><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>3.8348</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mn>8</mn></mrow></msup></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2802 -->
<p class="indent">
Applying the bilinear to <!-- l. 2802 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> with <!-- l. 2802 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>500</mn></mrow></math>&nbsp;Hz leads to <!-- l. 2803 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">(</mo><mn>0.0985</mn><mo class="MathClass-bin" stretchy="false">+</mo><mn>0.2956</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo><mn>0.2956</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo><mn>0.0985</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>1</mn><mo class="MathClass-bin" stretchy="false">−</mo><mn>0.5773</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo><mn>0.4218</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo><mn>0.0563</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. Evaluating <!-- l. 2803 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-rel" stretchy="false">|</mo><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-rel" stretchy="false">|</mo></mrow></math> at <!-- l. 2803 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>z</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup></mrow></math>, with <!-- l. 2803 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><msub><mrow><mi>f</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>, one obtains <!-- l. 2803 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><msqrt><mrow><mn>2</mn></mrow></msqrt></mrow></math>. This indicates that, due to the pre-warping, the bilinear positioned the cutoff of <!-- l. 2803 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> at the desired value of 100&nbsp;Hz.
</p>
<!-- l. 2805 -->
<p class="indent">
As mentioned, a computer is very useful to carry out the whole procedure. A first approach is to design an analog filter by first pre-warping the cutoff frequency and then use the bilinear:
</p>
<!-- l. 2807 -->
<pre class="lstlisting" id="listing-95"><span class="label"><a id="x51-179008r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=500;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency (Hz)</span> 
</span><span class="label"><a id="x51-179009r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(3,2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*115.63,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">s</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">analog</span></span><span style="color:#005900"> <span class="ec-lmtt-9">filter</span> 
</span><span class="label"><a id="x51-179010r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">bilinear</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">As</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convert</span></span><span style="color:#005900"> <span class="ec-lmtt-9">analog to digital</span> 
</span><span class="label"><a id="x51-179011r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">exp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1</span></span><span style="color:#000000"><span class="ec-lmtt-9">j</span></span><span style="color:#000000"><span class="ec-lmtt-9">*2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*100/500)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">polyval</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">check</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cutoff</span></span></pre>
<!-- l. 2813 -->
<p class="indent">
The second and simpler approach (at least from the user’s perspective) is to directly use a routine that incorporates pre-warping and bilinear transformation, such as <span class="ec-lmss-10x-x-109">butter</span>:
</p>
<!-- l. 2814 -->
<pre class="lstlisting" id="listing-96"><span class="label"><a id="x51-179012r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=500;</span></span><span style="color:#000000"><span class="ec-lmtt-9">fd</span></span><span style="color:#000000"><span class="ec-lmtt-9">=100;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">fnormalized=fd/(Fs/2); [B2,A2]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(3,</span></span><span style="color:#000000"><span class="ec-lmtt-9">fnormalized</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span></pre>
<!-- l. 2817 -->
<p class="indent">
</p><p>(recall that Matlab/Octave deals with digital filters using frequencies in Hertz normalized by the Nyquist frequency as informed in Table&nbsp;<a href="ak_dsp_bookse7.html#x14-410034">1.4<!-- tex4ht:ref: tab:nyquist_frequency  --></a>). A comparison would show that <span class="ec-lmss-10x-x-109">[Bz,Az]</span> and <span class="ec-lmss-10x-x-109">[B2,A2] </span>have approximately the same elements.</p>
<p></p>
<!-- l. 2820 -->
<p class="indent">
A third way of dealing with a software routine that directly designs a digital filter is to convert the specification to discrete-time. In this case, <!-- l. 2821 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>1.2566</mn></mrow></math>&nbsp;rad is the desired cutoff frequency and <!-- l. 2822 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> can be obtained with:
</p>
<!-- l. 2823 -->
<pre class="lstlisting" id="listing-97"><span class="label"><a id="x51-179013r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=500;</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wd</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*100/</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">;[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B3</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A3</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(3,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wd</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span></pre>
<!-- l. 2827 -->
<p class="indent">
Note that in this and in the previous (second) approach, the function <span class="ec-lmss-10x-x-109">butter.m </span>was not informed about <!-- l. 2828 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>. Consequently, when the pre-warping was done inside <span class="ec-lmss-10x-x-109">butter.m</span>, it used an arbitrary value of <!-- l. 2829 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> to pre-warp, then obtained <!-- l. 2829 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, and converted using bilinear with <!-- l. 2829 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>, such that the value of <!-- l. 2829 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> gets canceled out. This fact is further discussed in the next example. &nbsp; &nbsp;<!-- l. 2830 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 2836 -->
<p class="noindent">
<a id="x51-179014r33"></a> <span id="textcolor221">Example 3.33. </span><span class="ec-lmbx-10x-x-109">Design an IIR filter from specifications in discrete-time with the bilinear transform using a pre-specified continuous-time filter</span>. The task here is to design a second-order digital lowpass filter with a 3-dB cutoff frequency of <!-- l. 2839 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>4</mn></mrow></math>&nbsp;rad by using the bilinear transform on the prototype filter <!-- l. 2839 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <msqrt><mrow><mn>2</mn></mrow></msqrt><mi>s</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> (a normalized Butterworth).
</p>
<!-- l. 2841 -->
<p class="indent">
According to Figure&nbsp;<a href="#x51-17900445">3.45<!-- tex4ht:ref: fig:bilinear_givenHs  --></a>, after answering “no” to both Blocks 1 and 2, the designer can choose to use or not the “shortcut”. For the sake of explanation, assume the shortcut is used by executing Block 4.
</p>
<!-- l. 2845 -->
<p class="indent">
</p><p>There is only one pair of frequencies to be matched: <!-- l. 2846 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msub></math>, which is the cuttof frequency of <!-- l. 2846 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, and the desired <!-- l. 2846 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi mathvariant="normal">Ω</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>4</mn></mrow></math> of <!-- l. 2846 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. Using Eq.&nbsp;(<a href="#x51-179003r81">3.81<!-- tex4ht:ref: eq:bilinearPairWithMatchingViaFs  --></a>) to match these frequencies leads to <!-- l. 2847 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mtext class="qopname">tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>8</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>0.8284</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>1.2071</mn></mrow></math>&nbsp;Hz. Using Eq.&nbsp;(<a href="#x51-169002r64">3.64<!-- tex4ht:ref: eq:bilinearTransform  --></a>) leads to</p>
<p></p>
<!-- tex4ht:inline -->
<!-- l. 2851 -->
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable class="align-star" columnalign="left" displaystyle="true"> <mtr><mtd class="align-odd" columnalign="right"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><msup><mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mn>2</mn><mo class="MathClass-bin" stretchy="false">×</mo><mn>1.2071</mn><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <msqrt><mrow><mn>2</mn></mrow></msqrt> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mn>2</mn><mo class="MathClass-bin" stretchy="false">×</mo><mn>1.2071</mn><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></mrow></mfrac><mspace width="2em"></mspace></mtd> <mtd class="align-label" columnalign="right"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr><mtr><mtd class="align-odd" columnalign="right"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">≈</mo> <mfrac><mrow><mn>0.0976</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.1953</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.0976</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow> <mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.9428</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.3333</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow></mfrac> <mo class="MathClass-punc" stretchy="false">.</mo><mspace width="2em"></mspace></mtd> <mtd class="align-label" columnalign="right"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr></mtable></math> <!-- l. 2853 -->
<p class="noindent">
Using Matlab, the following commands implement the shortcut of Block 4:
</p>
<!-- l. 2854 -->
<pre class="lstlisting" id="listing-98"><span class="label"><a id="x51-179015r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1/(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">tan</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/8)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">[Bz,Az]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">bilinear</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,[1</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sqrt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">1],Fs)</span></span></pre>
<!-- l. 2857 -->
<p class="indent">
which does not explicitly use pre-warping in the <span class="ec-lmss-10x-x-109">bilinear </span>function, but incorporates it on the choice of <!-- l. 2858 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>.
</p>
<!-- l. 2860 -->
<p class="indent">
Now, the solution suggested in Block 7 of Figure&nbsp;<a href="#x51-17900445">3.45<!-- tex4ht:ref: fig:bilinear_givenHs  --></a> is developed for comparison.
</p>
<!-- l. 2863 -->
<p class="indent">
In this case, we can choose any convenient value for <!-- l. 2863 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>. To illustrate that, instead of using, for example, <!-- l. 2869 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> or another numeric value, the development will be made for a generic <!-- l. 2870 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>.
</p>
<!-- l. 2872 -->
<p class="indent">
Eq.&nbsp;(<a href="#x51-172002r73">3.73<!-- tex4ht:ref: eq:prewarping  --></a>) is adopted to perform pre-warping, which leads to
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2873 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub><mtext class="qopname"> tan</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>4</mn></mrow> <mrow><mn>2</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.8284</mn><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2876 -->
<p class="indent">
Then, Eq.&nbsp;(<a href="ak_dsp_bookse40.html#x49-156002r55">3.55<!-- tex4ht:ref: eq:frequencyScaling  --></a>) is used to perform frequency scaling and move the cutoff frequency <!-- l. 2876 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>&nbsp;rad/s of the prototype filter to <!-- l. 2877 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0.8284</mn><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>. Substituting <!-- l. 2877 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math> by <!-- l. 2877 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>ω</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>s</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>0.8284</mn><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> leads to
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2879 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>H</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>1</mn></mrow> <mrow><msup><mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mi>s</mi></mrow> <mrow><mn>0.8284</mn><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <msqrt><mrow><mn>2</mn></mrow></msqrt> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mi>s</mi></mrow> <mrow><mn>0.8284</mn><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></mrow></mfrac> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2882 -->
<p class="indent">
Now, the bilinear can be applied to <!-- l. 2882 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, which leads to
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!-- l. 2883 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>H</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>s</mi><mo class="MathClass-rel" stretchy="false">=</mo><mrow><mo fence="true" form="prefix"> (</mo><mrow><mn>2</mn><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow> <mi>s</mi></mrow></msub><mfrac><mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>0.0976</mn><msup><mrow><mi>z</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.1953</mn><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.0976</mn></mrow> <mrow><msup><mrow><mi>z</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0.9428</mn><mi>z</mi> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0.3333</mn></mrow></mfrac> <mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
</tr>

</tbody></table>
<!-- l. 2886 -->
<p class="indent">
Note that <!-- l. 2886 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> was canceled out because it only appeared in <!-- l. 2886 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>H</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mi>′</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>s</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> dividing <!-- l. 2886 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math>, which is later substituted by <!-- l. 2887 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2</mn><mi>F</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><msub><mrow><mi>′</mi></mrow><mrow><mi>s</mi></mrow></msub><mfrac><mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow> <mrow><mi>z</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></mfrac></mrow></math>.
</p>
<!-- l. 2889 -->
<p class="indent">
Figure&nbsp;<a href="#x51-17900445">3.45<!-- tex4ht:ref: fig:bilinear_givenHs  --></a> (and Figure&nbsp;<a href="#x51-17400141">3.41<!-- tex4ht:ref: fig:bilinear_steps  --></a>) tries to capture common uses of the bilinear transform. But there are several distinct alternatives. For example, another (maybe more obscure) alternative to this design problem is to use a reasoning similar to the one that led to Eq.&nbsp;(<a href="#x51-179002r80">3.80<!-- tex4ht:ref: eq:bilinearWithMatchingViaFs  --></a>): assume <!-- l. 2892 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mi>a</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>&nbsp;rad/s should match. In Hertz, the matching frequency is <!-- l. 2893 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>m</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.1591</mn></mrow></math>. In this case, <!-- l. 2894 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>4</mn></mrow></math> should be mapped to <!-- l. 2894 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub></math> when one uses a D/S conversion, which imposes <!-- l. 2895 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mi mathvariant="normal">Ω</mi></mrow></math>. This requires a sampling frequency of <!-- l. 2895 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mi>π</mi></mrow></math>&nbsp;Hz. Using Matlab, this alternative corresponds to
</p>
<!-- l. 2897 -->
<pre class="lstlisting" id="listing-99"><span class="label"><a id="x51-179016r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">bilinear</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,[1</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sqrt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">1],4/</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,1/(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span></pre>
<!-- l. 2900 -->
<p class="indent">
that leads to the same result of the previous Matlab commands.
</p>
<!-- l. 2902 -->
<p class="indent">
But again, the simplest approach using Matlab/Octave is to directly invoke:
</p>
<!-- l. 2903 -->
<pre class="lstlisting" id="listing-100"><span class="label"><a id="x51-179017r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bz</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Az</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2,1/4)</span></span></pre>
<!-- l. 2906 -->
<p class="indent">
</p><p>given that <span class="ec-lmss-10x-x-109">butter </span>performs pre-warping. &nbsp; &nbsp;<!-- l. 2907 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math></p>
<p></p>
<div class="footnotes">
<a id="x51-169006x23"></a> <!-- l. 2072 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn23x5-bk" id="fn23x5"><sup class="textsuperscript">23</sup>&nbsp;</a></span><span class="ec-lmr-9">Caution: While Matlab’s </span><span class="ec-lmss-9">bilinear </span><span class="ec-lmr-9">function assumes the sampling frequency</span> <!-- l. 2072 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> <span class="ec-lmr-9">as an input parameter, Octave adopts </span><!-- l. 2072 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math><span class="ec-lmr-9">.</span>
</p>
<a id="x51-170002x"></a> <!-- l. 2125 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn24x5-bk" id="fn24x5"><sup class="textsuperscript">24</sup>&nbsp;</a></span><span class="ec-lmr-9">This derivation is just illustrative and the bilinear can also be obtained by applying trapezoidal numerical integration. See alternatives in Problem&nbsp;</span><a href="ak_dsp_bookse49.html#x58-2030144"><span class="ec-lmr-9">3.4.</span><!-- tex4ht:ref: prob:series_expansion  --></a>
</p>
<a id="x51-172031x25"></a> <!-- l. 2349 -->
<p class="noindent">
<span class="footnote-mark"><a href="#fn25x5-bk" id="fn25x5"><sup class="textsuperscript">25</sup>&nbsp;</a></span><span class="ec-lmr-9">For instance, the bilinear is discussed in [</span><span class="ec-lmbx-9">?</span><span class="ec-lmr-9">] always in the context of IIR filter design and</span> <!-- l. 2349 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> <span class="ec-lmr-9">is assumed to be an arbitrary value.</span>
</p>
<a id="x51-175017x26"></a> <!-- l. 2557 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn26x5-bk" id="fn26x5"><sup class="textsuperscript">26</sup>&nbsp;</a></span><span class="ec-lmr-9">Note that Figure&nbsp;</span><a href="#x51-17502042"><span class="ec-lmr-9">3.42</span><!-- tex4ht:ref: fig:bilinear_freq_responses  --></a> <span class="ec-lmr-9">is an extended version of Figure&nbsp;</span><a href="ak_dsp_bookse35.html#x44-13700219"><span class="ec-lmr-9">3.19</span><!-- tex4ht:ref: fig:dc_conversion  --></a><span class="ec-lmr-9">. The same frequency responses were used and only the y-axis ranges differ.</span>
</p>
<a id="x51-175019x27"></a> <!-- l. 2560 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn27x5-bk" id="fn27x5"><sup class="textsuperscript">27</sup>&nbsp;</a></span><span class="ec-lmr-9">And, consequently, the axis of </span><!-- l. 2560 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>z</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub> </mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> <span class="ec-lmr-9">too, given that it is obtained via a simple linear scaling</span> <!-- l. 2560 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>ω</mi></mrow><mrow><mi>d</mi></mrow></msub><msub><mrow><mi>T</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math><span class="ec-lmr-9">.</span>
</p>
<a id="x51-176003x3.12.6"></a> <!-- l. 2647 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn28x5-bk" id="fn28x5"><sup class="textsuperscript">28</sup>&nbsp;</a></span><span class="ec-lmr-9">Inspect the source code of the </span><span class="ec-lmss-9">bilinear </span><span class="ec-lmr-9">function to check the algorithm that deals with this cancellation.</span>
</p>
<a id="x51-179006x"></a> <!-- l. 2764 -->
<p class="indent">
<span class="footnote-mark"><a href="#fn29x5-bk" id="fn29x5"><sup class="textsuperscript">29</sup>&nbsp;</a></span><span class="ec-lmr-9">Suggested, for example, in [</span><span class="ec-lmbx-9">?</span><span class="ec-lmr-9">].</span>
</p>
<pre><code>                                                                                   &lt;/div&gt;</code></pre>





 <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ak_dsp_bookse41.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">IIR Filter Design</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ak_dsp_bookse43.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">FIR Filter Design</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Digital Signal Processing with Python, Matlab or Octave, Applications in Machine Learning Aldebaro Klautau Federal University of Pará (UFPA), Brazil</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>