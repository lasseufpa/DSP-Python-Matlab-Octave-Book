<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aldebaro Klautau">

<title>Digital Signal Processing with Python, Matlab or Octave - 55&nbsp; Nonparametric PSD Estimation via Periodogram</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ak_dsp_bookse56.html" rel="next">
<link href="./ak_dsp_bookse54.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ak_dsp_bookch4.html">Spectral Estimation Techniques</a></li><li class="breadcrumb-item"><a href="./ak_dsp_bookse55.html"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Periodogram</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Digital Signal Processing with Python, Matlab or Octave</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Tables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listings</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Signals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analog, Digital and Discrete-Time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basic Signal Manipulation and Representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Block Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Complex-Valued and Sampled Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modeling the Stages in A/D and D/A Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Relating Frequencies in Continuous, Sampled and Discrete-time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">An Introduction to Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Signal Categorization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Power and Energy in Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Relating Power in Continuous and Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Correlation: Finding Trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Linear Model for Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforms and Signal Representation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Linear Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inner Products to Obtain the Transform Coefficients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Block Transforms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Fourier Transforms and Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Relating discrete and analog frequencies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Summary of equations for DFT / FFT Usage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Laplace Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Z Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Contrasting Signals and Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Analog and Digital Filters: A Quick Hands-On Tour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Linear Time-Invariant Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Sampling and Signal Reconstruction Revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse36.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Facts About First and Second-Order Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse37.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Bandwidth and Quality Factor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse38.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Importance of Linear Phase (or Constant Group Delay)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse39.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Filtering technologies: Surface acoustic wave (SAW) and others</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse40.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse41.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">IIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse42.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Bilinear Transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse43.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">FIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse44.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Realization of Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse45.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multirate Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse46.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse47.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse48.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse49.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spectral Estimation Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse51.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse52.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Windows for spectral analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse53.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">The ESD, PSD and MS Spectrum functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse54.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Filtering Random Signals and the Impact on PSDs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse55.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Periodogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse56.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Welch’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse57.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Parametric PSD Estimation via Autoregressive (AR) Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse58.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Time-frequency Analysis using the Spectrogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse59.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse60.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse61.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse62.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">ak_dsp_bookap1.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Useful Mathematics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Useful Softwares and Programming Tricks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Periodogram</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<meta charset="utf-8">
<meta content="TeX4ht (https://tug.org/tex4ht/)" name="generator">
<meta content="width=device-width,initial-scale=1" name="viewport">
<link href="ak_dsp_book.css" rel="stylesheet" type="text/css">
<meta content="ak_dsp_book.tex" name="src">
<script async="async" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js" type="text/javascript"></script>


<!-- l. 1019 -->
<p class="noindent">
The ESD, PSD and MS spectrum were defined without a discussion on how to estimate them. This section will exclusively concern this estimation using the FFT.
</p>
<!-- l. 1021 -->
<p class="indent">
The <span class="ec-lmri-10x-x-109">periodogram</span><a id="dx65-231001"></a> <!-- l. 1021 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is a classical approach for PSD estimation. There are distinct definitions in the literature and here, especially for consistency with Matlab/Octave, the periodogram is an approximation of <!-- l. 1021 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> and defined as
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1022 -->
<p class="indent">
</p>
<!-- l. 1022 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x65-231002r45"></mstyle><!-- endlabel --><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mover class="stackrel"><mrow><mo class="MathClass-rel" stretchy="false">=</mo></mrow><mrow><mrow><mstyle class="text"><mtext>def</mtext></mstyle></mrow></mrow></mover> <mfrac><mrow><mn>1</mn></mrow> <mrow><mi>N</mi><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle></mrow></mfrac><mo class="MathClass-rel" stretchy="false">|</mo><mstyle class="text"><mtext class="textrm" mathvariant="normal">FFT</mtext></mstyle><mo class="MathClass-open" stretchy="false">{</mo><msub><mrow><mi>x</mi></mrow><mrow><mi>N</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-close" stretchy="false">}</mo><msup><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(4.45)
</td>
</tr>

</tbody></table>
<!-- l. 1026 -->
<p class="indent">
where <!-- l. 1026 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>N</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is the <!-- l. 1026 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>-samples windowed version of <!-- l. 1026 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 1026 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle></math> the assumed frequency bandwidth. If the window is other than the rectangular, <!-- l. 1026 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is called the <span class="ec-lmri-10x-x-109">modified periodogram</span><a id="dx65-231003"></a>.
</p>
<!-- l. 1028 -->
<p class="indent">
</p><p>When compared to the actual PSD <!-- l. 1028 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, notice that the periodogram <!-- l. 1028 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> may present aliasing in case <!-- l. 1028 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>N</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> was obtained by sampling a continuous-time <!-- l. 1028 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>t</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. It may also present leakage due to windowing. Besides, the periodogram inherits the properties and pitfalls of an FFT, such as a frequency resolution <!-- l. 1029 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> that may not be enough to distinguish peaks separated by less than <!-- l. 1029 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Ω</mi></mrow></math> due to the picket-fence effect.</p>
<p></p>
<!-- l. 1031 -->
<p class="indent">
Based on the definition of <!-- l. 1031 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, the signal power <!-- l. 1031 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow></math> can be conveniently obtained by approximating the integral of Eq.&nbsp;(<a href="ak_dsp_bookse53.html#x63-218001r17">4.17<!-- tex4ht:ref: eq:psd_integration_continuousTime  --></a>). For instance, using the rectangle method one obtains
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1032 -->
<p class="indent">
</p>
<!-- l. 1032 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x65-231004r46"></mstyle><!-- endlabel --><mstyle mathvariant="script"></mstyle><mi>P</mi> <mo class="MathClass-rel" stretchy="false">≈</mo><mi mathvariant="normal">Δ</mi><mi>f</mi><munderover accent="false" accentunder="false"><mrow><mo>∑</mo> </mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(4.46)
</td>
</tr>

</tbody></table>
<!-- l. 1036 -->
<p class="indent">
where <!-- l. 1036 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> is the FFT frequency spacing.
</p>
<!-- l. 1038 -->
<p class="indent">
Some important facts related to this definition:
</p>
<pre><code> &lt;ul class='itemize1'&gt;
 &lt;li class='itemize'&gt;The  periodogram  is  associated  by  definition  to  the  FFT  operation  and,
 consequently, operates in a finite-length discrete-time signal.
 &lt;/li&gt;
 &lt;li class='itemize'&gt;The  periodogram  input  is  a  discrete-time  signal,  but  frequencies  can  be
 conveniently interpreted in Hertz (or rad/s) via &lt;!-- l. 1041 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;mi&gt;ω&lt;/mi&gt; &lt;mo class='MathClass-rel' stretchy='false'&gt;=&lt;/mo&gt; &lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant='normal'&gt;Ω&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;
 (Eq.&nbsp;(&lt;a href='ak_dsp_bookse7.html#x14-39001r22'&gt;1.22&lt;!-- tex4ht:ref: eq:freqdiscrete2continuous  --&gt;&lt;/a&gt;)) when the sampling frequency &lt;!-- l. 1041 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;
 is specified.
 &lt;/li&gt;
 &lt;li class='itemize'&gt;The bandwidth &lt;!-- l. 1042 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mstyle class='text'&gt;&lt;mtext class='textrm' mathvariant='normal'&gt;BW&lt;/mtext&gt;&lt;/mstyle&gt;&lt;/math&gt;
 is   in   Hertz,   and   obtained   from   the   specified   sampling   frequency
 &lt;!-- l. 1042 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;.
 The &lt;!-- l. 1042 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mstyle class='text'&gt;&lt;mtext class='textrm' mathvariant='normal'&gt;BW&lt;/mtext&gt;&lt;/mstyle&gt;&lt;/math&gt;
 is assumed to be from &lt;!-- l. 1042 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt; &lt;mo class='MathClass-bin' stretchy='false'&gt;−&lt;/mo&gt; &lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo class='MathClass-bin' stretchy='false'&gt;∕&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;
 to &lt;!-- l. 1042 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo class='MathClass-bin' stretchy='false'&gt;∕&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;
 for a bilateral or &lt;!-- l. 1042 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;
 to &lt;!-- l. 1042 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo class='MathClass-bin' stretchy='false'&gt;∕&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;
 for a unilateral periodogram.&lt;/li&gt;&lt;/ul&gt;
                                                                          
                                                                          </code></pre>
<!-- l. 1047 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.6.1</span>&nbsp;&nbsp;<a id="x65-2320004.6.1"></a>Discrete-time PSD estimation using the periodogram
</h4>
<!-- l. 1049 -->
<p class="noindent">
The periodogram is an approximation of the continuous-time PSD <!-- l. 1049 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>, but one can “trick” the software routine and obtain an estimate of <!-- l. 1049 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> by imposing <!-- l. 1049 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>&nbsp;Hz. In this case, the numerical values of the periodogram <!-- l. 1049 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> provide an estimate <!-- l. 1049 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> of the discrete-time PSD <!-- l. 1049 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> as follows:
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1050 -->
<p class="indent">
</p>
<!-- l. 1050 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x65-232001r47"></mstyle><!-- endlabel --><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi mathvariant="normal"> Ω</mi><mo class="MathClass-rel" stretchy="false">=</mo><mi>k</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(4.47)
</td>
</tr>

</tbody></table>
<!-- l. 1055 -->
<p class="indent">
Having the periodogram calculated with <!-- l. 1055 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>, allows to interpret <!-- l. 1055 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> in Watts/Dhertz (normalized frequency), as discussed in Example&nbsp;<a href="ak_dsp_bookse53.html#x63-217041r8">4.8<!-- tex4ht:ref: ex:units_of_esd_discrete_time  --></a>.
</p>
<!-- l. 1057 -->
<p class="indent">
However, when invoking a periodogram software routine for discrete-time signals without specifying <!-- l. 1057 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>, the assumed default value is <!-- l. 1057 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi></mrow></math>, not <!-- l. 1057 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>. The values of <!-- l. 1057 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> will differ in these two cases by <!-- l. 1057 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2</mn><mi>π</mi></mrow></math>. But, independent on <!-- l. 1057 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math>, the signal average power can always be obtained with Eq.&nbsp;(<a href="#x65-231004r46">4.46<!-- tex4ht:ref: eq:periodogram_discretetime3  --></a>).
</p>
<!-- l. 1093 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.6.2</span>&nbsp;&nbsp;<a id="x65-2330004.6.2"></a>Relation between MS spectrum and periodogram
</h4>
<!-- l. 1095 -->
<p class="noindent">
The FFT-based estimation of both PSD and MS spectrum are closely related. From Eq.&nbsp;(<a href="ak_dsp_bookse53.html#x63-222006r35">4.35<!-- tex4ht:ref: eq:msEstimationViaFFT  --></a>) and Eq.&nbsp;(<a href="#x65-231002r45">4.45<!-- tex4ht:ref: eq:periodogram_discretetime2  --></a>), one has:
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1096 -->
<p class="indent">
</p>
<!-- l. 1096 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x65-233001r48"></mstyle><!-- endlabel --><msub><mrow><mi>Ŝ</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">ms</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle></mrow> <mrow><mi>N</mi></mrow></mfrac> <mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="normal">Δ</mi><mi mathvariant="italic">fŜ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(4.48)
</td>
</tr>

</tbody></table>
<!-- l. 1106 -->
<p class="indent">
Because <!-- l. 1106 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is a PSD estimate, the user of a PSD estimation routine that returns <!-- l. 1106 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> just needs to know the bin width <!-- l. 1106 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi></mrow></math> to be able to obtain the average power <!-- l. 1106 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow></math> from <!-- l. 1106 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, and/or individual values of <!-- l. 1106 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>Ŝ</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">ms</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. This reasoning is valid when <!-- l. 1107 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow></math> should be calculated over the whole frequency range, or shorter frequency intervals, because the amount of power <!-- l. 1107 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>k</mi></mrow></msub></math> at a single FFT bin (the <!-- l. 1107 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math>-th bin) in a periodogram <!-- l. 1107 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1108 -->
<p class="indent">
</p>
<!-- l. 1108 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x65-233002r49"></mstyle><!-- endlabel --><msub><mrow><mi>Ŝ</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">ms</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo><msub><mrow> <mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>k</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="normal">Δ</mi><mi mathvariant="italic">fŜ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(4.49)
</td>
</tr>

</tbody></table>
<!-- l. 1113 -->
<p class="indent">
For discrete-time signals assuming <!-- l. 1113 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi></mrow></math> or <!-- l. 1113 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>, <!-- l. 1113 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>k</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">(</mo><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi><mo class="MathClass-close" stretchy="false">)</mo><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. In both continuous and discrete-time cases, <!-- l. 1113 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi> <mo class="MathClass-rel" stretchy="false">=</mo><msubsup><mrow> <mi class="MathClass-op">∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo> <!-- nolimits --></mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></math>.
</p>
<!-- l. 1115 -->
<p class="indent">
Listing&nbsp;<a href="#x65-233003r7">4.7<!-- tex4ht:ref: code:snip_frequency_mssFromPeriodogram  --></a> illustrates how Eq.&nbsp;(<a href="#x65-233001r48">4.48<!-- tex4ht:ref: eq:fromPeriodogramToMS  --></a>) can be used to obtain <!-- l. 1115 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>Ŝ</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">ms</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>.
</p>
<!-- l. 1117 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.7: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_mssFromPeriodogram.m</span>
</figcaption>
<!-- tex4ht:label?: x65-233003r4.6.2  -->
<pre class="lstinputlisting" id="listing-143"><span class="label"><a id="x65-233005r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1024;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">n=(0:N-1)</span><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">N of samples and column vector n</span> 
</span><span class="label"><a id="x65-233006r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x=A*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">((2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/64)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cosine with period 64</span> 
</span><span class="label"><a id="x65-233007r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Sms</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">MS</span></span><span style="color:#005900"> <span class="ec-lmtt-9">spectrum |DTFS{x}|^2</span> 
</span><span class="label"><a id="x65-233008r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">assumed</span></span><span style="color:#005900"> <span class="ec-lmtt-9">bandwidth is 2*pi</span> 
</span><span class="label"><a id="x65-233009r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">S</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2/(</span></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Periodogram</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(|FFT{x}|^2)/(BW * N)</span> 
</span><span class="label"><a id="x65-233010r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Sms2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">S</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Example</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of obtaining MS spectrum from periodogram</span> 
</span><span class="label"><a id="x65-233011r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sms</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Obtaining</span></span><span style="color:#005900"> <span class="ec-lmtt-9">power from the MS spectrum</span> 
</span><span class="label"><a id="x65-233012r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power2</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">S</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Obtaining</span></span><span style="color:#005900"> <span class="ec-lmtt-9">power from the periodogram</span></span>
  </pre>
<!-- l. 1123 -->
<p class="indent">
While the MS spectrum is a discrete function with the property specified by Eq.&nbsp;(<a href="ak_dsp_bookse53.html#x63-222004r33">4.33<!-- tex4ht:ref: eq:ms_sumPower  --></a>), the periodogram values <!-- l. 1123 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> ideally coincide with a continuous function of frequency: the PSD <!-- l. 1123 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> or <!-- l. 1123 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>. Consequently, having an array of values <!-- l. 1123 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, the property that should be obeyed depends on the <span class="ec-lmri-10x-x-109">integral </span>Eq.&nbsp;(<a href="ak_dsp_bookse53.html#x63-218001r17">4.17<!-- tex4ht:ref: eq:psd_integration_continuousTime  --></a>) or Eq.&nbsp;(<a href="ak_dsp_bookse53.html#x63-218004r20">4.20<!-- tex4ht:ref: eq:psd_integration  --></a>), respectively, not a <span class="ec-lmri-10x-x-109">summation </span>as in Eq.&nbsp;(<a href="ak_dsp_bookse53.html#x63-222004r33">4.33<!-- tex4ht:ref: eq:ms_sumPower  --></a>).
</p>
<!-- l. 1125 -->
<p class="indent">
It is recommended to observe Table&nbsp;<a href="ak_dsp_bookse75.html#x87-2700011">B.1<!-- tex4ht:ref: tab:analogy_psd_pdf  --></a> and associated discussion, which summarizes an interesting analogy between the use of FFTs and histograms that helps understanding the difference betweeen <!-- l. 1125 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> and <!-- l. 1125 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>Ŝ</mi></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">ms</mtext></mstyle></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>.
</p>
<!-- l. 1168 -->
<p class="noindent">
</p>
<h5 class="subsubsectionHead anchored">
<a id="x65-234000"></a>Matlab/Octave adopted conventions for periodograms
</h5>
<!-- l. 1170 -->
<p class="noindent">
Is should be noted that Matlab/Octave adopts the following:
</p>
<pre><code> &lt;ul class='itemize1'&gt;
 &lt;li class='itemize'&gt;When the sampling frequency &lt;!-- l. 1172 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;
 is not specified, it is assumed &lt;!-- l. 1172 --&gt;&lt;math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt; &lt;mo class='MathClass-rel' stretchy='false'&gt;=&lt;/mo&gt; &lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;π&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;&nbsp;Hz
 and Eq.&nbsp;(&lt;a href='ak_dsp_bookse53.html#x63-218001r17'&gt;4.17&lt;!-- tex4ht:ref: eq:psd_integration_continuousTime  --&gt;&lt;/a&gt;) is adopted.
 &lt;/li&gt;
 &lt;li class='itemize'&gt;When the signal is real, a unilateral PSD is adopted by default.
 &lt;/li&gt;
 &lt;li class='itemize'&gt;By default, the &lt;span class='ec-lmss-10x-x-109'&gt;periodogram.m &lt;/span&gt;function uses a power-of-two FFT-length with a
 minimum of 256, adopting zero-padding in case the input signal has less than
 256 samples.
 &lt;/li&gt;
 &lt;li class='itemize'&gt;The periodogram values are converted to dB.&lt;/li&gt;&lt;/ul&gt;</code></pre>
<!-- l. 1177 -->
<p class="noindent">
</p><p>These conventions are discussed in the sequel.</p>
<p></p>
<!-- l. 1194 -->
<p class="indent">
A characteristic of Matlab/Octave is the adoption, by default, of a unilateral PSD when the signal is real and has a Hermitian-symmetric spectrum. In this case, only the nonnegative frequency range are used in the graphs and in the summation of the normalized periodogram to obtain <!-- l. 1194 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow></math>. For example, in continuous-time, instead of Eq.&nbsp;(<a href="#x65-231004r46">4.46<!-- tex4ht:ref: eq:periodogram_discretetime3  --></a>), one would have
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1195 -->
<p class="indent">
</p>
<!-- l. 1195 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x65-234001r50"></mstyle><!-- endlabel --><mstyle mathvariant="script"></mstyle><mi>P</mi> <mo class="MathClass-rel" stretchy="false">=</mo><msubsup><mrow><mo> ∫ <!-- nolimits --></mo><!-- nolimits --></mrow><mrow><mn>0</mn></mrow><mrow><mi>∞</mi></mrow></msubsup><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo><mstyle class="text"><mtext class="textrm" mathvariant="normal">d</mtext></mstyle><mi>f</mi> <mo class="MathClass-rel" stretchy="false">≈</mo><mi mathvariant="normal">Δ</mi><mi>f</mi><munderover accent="false" accentunder="false"><mrow><mtext>∑</mtext></mrow><mrow> <mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>0</mn></mrow><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow></munderover><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">,</mo> </mrow></math>
</td>
<td class="eq-no">
(4.50)
</td>
</tr>

</tbody></table>
<!-- l. 1199 -->
<p class="indent">
assuming <!-- l. 1199 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is even. Hence, the values of <!-- l. 1199 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> in a unilateral periodogram are twice the values in the corresponding bilateral representation, with exception of the DC and Nyquist frequencies. This can be seen in the result of Listing&nbsp;<a href="#x65-234002r8">4.8<!-- tex4ht:ref: code:snip_frequency_comparePeriodograms  --></a>, which avoids zero-padding via the third input argument of <span class="ec-lmss-10x-x-109">periodogram.m</span>.
</p>
<!-- l. 1204 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.8: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_comparePeriodograms.m</span>
</figcaption>
<!-- tex4ht:label?: x65-234002r  -->
<pre class="lstinputlisting" id="listing-144"><span class="label"><a id="x65-234004r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1024;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">n=(0:N-1)</span><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">N of samples and column vector n</span> 
</span><span class="label"><a id="x65-234005r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x=A*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">((2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/64)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cosine with period 64</span> 
</span><span class="label"><a id="x65-234006r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">assume</span></span><span style="color:#005900"> <span class="ec-lmtt-9">defaut Fs=2*pi (bandwidth) in periodogram</span> 
</span><span class="label"><a id="x65-234007r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">S</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2/(</span></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Periodogram</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(|FFT{x}|^2)/(BW * N)</span> 
</span><span class="label"><a id="x65-234008r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= N;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">avoid</span></span><span style="color:#005900"> <span class="ec-lmtt-9">zero-padding in periodogram below:</span> 
</span><span class="label"><a id="x65-234009r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],</span></span><span style="color:#000000"><span class="ec-lmtt-9">Nfft</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Using</span></span><span style="color:#005900"> <span class="ec-lmtt-9">Matlab/Octave</span> 
</span><span class="label"><a id="x65-234010r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Power</span></span><span style="color:#005900"> <span class="ec-lmtt-9">from unilateral periodogram</span> 
</span><span class="label"><a id="x65-234011r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power2</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">S</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Power</span></span><span style="color:#005900"> <span class="ec-lmtt-9">from bilateral periodogram</span> 
</span><span class="label"><a id="x65-234012r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Sunilateral</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= [S(1); 2*S(2:N/2); S(N/2+1)];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">from</span></span><span style="color:#005900"> <span class="ec-lmtt-9">bi to unilateral</span> 
</span><span class="label"><a id="x65-234013r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">-</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">o</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sunilateral</span></span><span style="color:#000000"> <span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">-</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">x</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Compare</span></span><span style="color:#005900"> <span class="ec-lmtt-9">periodograms</span></span>
  </pre>
<!-- l. 1206 -->
<p class="indent">
As indicated in Listing&nbsp;<a href="#x65-234002r8">4.8<!-- tex4ht:ref: code:snip_frequency_comparePeriodograms  --></a>, to obtain the power <!-- l. 1206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow></math> from the periodogram, the proper normalization factor is the bin width <!-- l. 1206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi></mrow></math>=<span class="ec-lmss-10x-x-109">BW/N</span>, which in this case is <!-- l. 1206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>1024</mn></mrow></math> because <!-- l. 1206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> was not specified when calling the <span class="ec-lmss-10x-x-109">periodogram.m </span>routine and <!-- l. 1206 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi></mrow></math> is assumed.
</p>
<!-- l. 1209 -->
<p class="indent">
</p><p>A minor detail is that when <!-- l. 1209 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> is even and the periodogram is unilateral, <span class="ec-lmss-10x-x-109">w(end) </span>is <!-- l. 1209 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math> and <span class="ec-lmss-10x-x-109">length(H) </span>is <!-- l. 1209 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">(</mo><mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn></mrow></math>. If a bilateral periodogram</p>
is calculated, <span class="ec-lmss-10x-x-109">w(end) </span>is <!-- l. 1209 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mi mathvariant="normal">Δ</mi><mi>f</mi></mrow></math> and <span class="ec-lmss-10x-x-109">length(H) </span>is <!-- l. 1209 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>. Listing&nbsp;<a href="#x65-234014r9">4.9<!-- tex4ht:ref: code:snip_frequency_correctPeriodograms  --></a> illustrates this point.
<p></p>
<!-- l. 1216 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.9: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_correctPeriodograms.m</span>
</figcaption>
<!-- tex4ht:label?: x65-234014r  -->
<pre class="lstinputlisting" id="listing-145"><span class="label"><a id="x65-234016r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1024;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">n=(0:N-1)</span><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">N of samples and column vector n</span> 
</span><span class="label"><a id="x65-234017r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x=A*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">((2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/64)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cosine with period 64</span> 
</span><span class="label"><a id="x65-234018r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=500;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">BW = Fs;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Fs</span></span><span style="color:#005900"> <span class="ec-lmtt-9">= BW = 500 Hz</span> 
</span><span class="label"><a id="x65-234019r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Unilateral</span></span><span style="color:#005900"> <span class="ec-lmtt-9">periodogram</span> 
</span><span class="label"><a id="x65-234020r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">H2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">f2</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">twosided</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Bilateral</span></span><span style="color:#005900"> <span class="ec-lmtt-9">periodogram</span> 
</span><span class="label"><a id="x65-234021r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= (BW/N)*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Power</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for unilateral periodograma</span> 
</span><span class="label"><a id="x65-234022r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power2</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= (BW/N)*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">H2</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Power</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for bilateral periodograma</span> 
</span><span class="label"><a id="x65-234023r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">f2(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">f2</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">values</span></span><span style="color:#005900"> <span class="ec-lmtt-9">for N even</span></span>
  </pre>
<!-- l. 1233 -->
<p class="indent">
All the previous calculations (e. g., <span class="ec-lmss-10x-x-109">sum(H)</span>) used the periodogram in linear scale. Another convention adopted by Matlab/Octave is to convert, by default, the periodogram values to dBW/Hz when the function <span class="ec-lmss-10x-x-109">periodogram.m </span>is invoked without output parameters. However, as discussed in Appendix&nbsp;<a href="ak_dsp_bookse86.html#x98-303000B.24">B.24<!-- tex4ht:ref: app:decibel  --></a>, the periodogram unit is informed to be dB/Hz instead of dBW/Hz.
</p>
<!-- l. 1235 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.6.3</span>&nbsp;&nbsp;<a id="x65-2350004.6.3"></a>Periodogram of periodic or energy signals
</h4>
<!-- l. 1237 -->
<p class="noindent">
A periodogram must be properly interpreted if applied to a periodic signal. Note that, as indicated in Section&nbsp;<a href="ak_dsp_bookse53.html#x63-220000doc">4.4.2.0<!-- tex4ht:ref: sec:psdPeriodicSignals  --></a>, while the PSD of a periodic signal is composed by impulses, the periodogram <!-- l. 1238 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> obtained from a finite-duration window does not contain impulses due to the convolution with the window spectrum.
</p>
<!-- l. 1240 -->
<p class="indent">
Similarly, care must be exercised when a periodogram is applied to an energy signal. As discussed in Section&nbsp;<a href="ak_dsp_bookse53.html#x63-2170004.4.1">4.4.1<!-- tex4ht:ref: sec:esd  --></a>, an energy signal should be associated to an ESD, not PSD. The periodogram of an energy signal such as <!-- l. 1241 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>u</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>u</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>5</mn><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>, for example, is implicitly assuming that <!-- l. 1241 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is just a windowed version of a periodic signal.
</p>
<!-- l. 1245 -->
<p class="indent">
Before discussing the more advanced Welch method for PSD estimation, few examples of periodograms are provided in the next section to consolidate the concepts.
</p>
<!-- l. 1247 -->
<p class="noindent">
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.6.4</span>&nbsp;&nbsp;<a id="x65-2360004.6.4"></a>Examples of PSD and MS spectrum estimation
</h4>
<!-- l. 1249 -->
<p class="noindent">
</p><p><a id="x65-236001r14"></a> <span id="textcolor294">Example 4.14. </span><span class="ec-lmbx-10x-x-109">Using </span><span class="ec-lmssbx-10x-x-109">periodogram.m </span><span class="ec-lmbx-10x-x-109">to approximate a continuous-time PSD</span> <!-- l. 1249 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>f</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> <span class="ec-lmbx-10x-x-109">of a sinusoid</span>. When the sampling frequency <!-- l. 1251 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is specified as input argument and without output arguments, the <span class="ec-lmss-10x-x-109">periodogram</span></p>
of Matlab/Octave indicates the abscissa in Hertz. For example, Listing&nbsp;<a href="#x65-236002r10">4.10<!-- tex4ht:ref: code:snip_frequency_normalized_periodogram  --></a> was used to generate Figure&nbsp;<a href="#x65-2360128">4.8<!-- tex4ht:ref: fig:cosinePeriodogramFs8000  --></a>, which has the abscissa going from 0 to <!-- l. 1251 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn></mrow></math>&nbsp;Hz because the signal is real and the default periodogram is unilateral in this case.
<p></p>
<!-- l. 1253 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.10: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_normalized_periodogram.m</span>
</figcaption>
<!-- tex4ht:label?: x65-236002r4.6.4  -->
<pre class="lstinputlisting" id="listing-146"><span class="label"><a id="x65-236004r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1024;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">A=10; x=A*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/64*(0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cosine</span> 
</span><span class="label"><a id="x65-236005r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=8000;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency in Hz</span> 
</span><span class="label"><a id="x65-236006r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">rectWindow</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">rectwin</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">rectangular</span></span><span style="color:#005900"> <span class="ec-lmtt-9">window</span> 
</span><span class="label"><a id="x65-236007r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">rectWindow</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">rectWindow</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">x=x(:);</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">make</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sure both are column vectors</span> 
</span><span class="label"><a id="x65-236008r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">P</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">rectWindow</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">periodogram</span></span> 
<span class="label"><a id="x65-236009r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">df</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= Fs/N;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">FFT</span></span><span style="color:#005900"> <span class="ec-lmtt-9">bin width to be used in power computation</span> 
</span><span class="label"><a id="x65-236010r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">P</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">df</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">calculate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the average power</span> 
</span><span class="label"><a id="x65-236011r8"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">/1000,10*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">P</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">grid</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convert</span></span><span style="color:#005900"> <span class="ec-lmtt-9">to dBW/Hz</span></span>
  </pre>
<figure class="figure">
<p><a id="x65-2360128"></a></p>
<!-- l. 1257 -->
<p class="noindent">
<img alt="PIC" src="./Figures/cosinePeriodogramFs8000.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.8: </span><span class="content">Periodogram of <!-- l. 1258 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>64</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in dBW/Hz estimated by <span class="ec-lmss-10x-x-109">periodogram.m </span>with a <!-- l. 1258 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>1024</mn></mrow></math>-point FFT and assuming <!-- l. 1258 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math>&nbsp;kHz.</span>
</figcaption>
<!-- tex4ht:label?: x65-2360128  -->
</figure>
<!-- l. 1261 -->
<p class="indent">
The signal power is <!-- l. 1261 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>50</mn></mrow></math>&nbsp;W. Figure&nbsp;<a href="#x65-2360128">4.8<!-- tex4ht:ref: fig:cosinePeriodogramFs8000  --></a> indicates a peak at <!-- l. 1262 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>125</mn></mrow></math>&nbsp;Hz, which corresponds to tone <!-- l. 1262 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>16</mn></mrow></math>. This can be confirmed by observing that <!-- l. 1262 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8000</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>1024</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>7.8125</mn></mrow></math>&nbsp;Hz, such that <!-- l. 1262 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>k</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>k</mi><mi mathvariant="normal">Δ</mi><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>16</mn> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>8000</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>1024</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>125</mn></mrow></math>&nbsp;Hz. Because there was no leakage in this case, the sinusoid power <!-- l. 1263 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>50</mn></mrow></math>&nbsp;W is completely residing in bin <!-- l. 1264 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>16</mn></mrow></math>. From Eq.&nbsp;(<a href="#x65-233002r49">4.49<!-- tex4ht:ref: eq:powerPerTone  --></a>), the expected PSD value at this bin is <!-- l. 1265 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mn>16</mn></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mstyle mathvariant="script"></mstyle><mi>P</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi mathvariant="normal">Δ</mi><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>50</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>7.8125</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>6.4</mn></mrow></math>&nbsp;W/Hz. Converting it to dBW leads to <!-- l. 1265 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mn>6.4</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>8.062</mn></mrow></math>&nbsp;dBW/Hz, as indicated in Figure&nbsp;<a href="#x65-2360128">4.8<!-- tex4ht:ref: fig:cosinePeriodogramFs8000  --></a>.
</p>
<!-- l. 1269 -->
<p class="indent">
One aspect of PSD graphs in dB scale is that dynamic ranges larger than hundreds of dB should be associated to numerical errors, given that <span class="ec-lmss-10x-x-109">10*log10(eps)=-156.5</span>. &nbsp; &nbsp;<!-- l. 1270 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 1272 -->
<p class="noindent">
<a id="x65-236013r15"></a> <span id="textcolor295">Example 4.15. </span><span class="ec-lmbx-10x-x-109">Discrete-time PSD of a sinusoid using the </span><span class="ec-lmssbx-10x-x-109">periodogram </span><span class="ec-lmbx-10x-x-109">function</span>. Listing&nbsp;<a href="#x65-236014r11">4.11<!-- tex4ht:ref: code:snip_frequency_periodogram  --></a> uses the Matlab/Octave <span class="ec-lmss-10x-x-109">periodogram </span>function to estimate the discrete-time PSD of a cosine and compares it with a periodogram directly calculated based on the definition adopted in this text. Figure&nbsp;<a href="#x65-2360299">4.9<!-- tex4ht:ref: fig:cosinePeriodograms  --></a> depicts the result.
</p>
<!-- l. 1276 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.11: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_periodogram.m</span>
</figcaption>
<!-- tex4ht:label?: x65-236014r4.6.4  -->
<pre class="lstinputlisting" id="listing-147"><span class="label"><a id="x65-236016r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=16;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">alpha=2; A=10; n=0:N-1;</span> 
</span><span class="label"><a id="x65-236017r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">((2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">alpha</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cosine</span> 
</span><span class="label"><a id="x65-236018r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">(:)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Octave</span></span><span style="color:#005900"> <span class="ec-lmtt-9">requires column vector</span> 
</span><span class="label"><a id="x65-236019r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">it</span></span><span style="color:#005900"> <span class="ec-lmtt-9">is a discrete-time signal, assume BW=1 Hz</span> 
</span><span class="label"><a id="x65-236020r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= (1/(N*BW))*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Periodogram</span></span><span style="color:#005900"> <span class="ec-lmtt-9">as defined in text</span> 
</span><span class="label"><a id="x65-236021r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= (BW/N)*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Obtain</span></span><span style="color:#005900"> <span class="ec-lmtt-9">power from periodogram</span> 
</span><span class="label"><a id="x65-236022r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Smatlab</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">twosided</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">from</span></span><span style="color:#005900"> <span class="ec-lmtt-9">f=0 to 1 dHz</span> 
</span><span class="label"><a id="x65-236023r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Smatlab</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#005900"> <span class="ec-lmtt-9">used zero-padding and unilateral PSD</span> 
</span><span class="label"><a id="x65-236024r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">dhertz</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= (1/N)*(-N/2:(N/2-1));</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">normalized</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency</span> 
</span><span class="label"><a id="x65-236025r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">Power2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> <span class="ec-lmtt-9">(BW/N)*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Smatlab</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Power</span></span><span style="color:#005900"> <span class="ec-lmtt-9">from periodogram function</span> 
</span><span class="label"><a id="x65-236026r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">dhertz</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convert</span></span><span style="color:#005900"> <span class="ec-lmtt-9">abscissa to Omega in radians</span> 
</span><span class="label"><a id="x65-236027r12"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">clf</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(211)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">h=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fftshift</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Smatlab</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x65-236028r13"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on;</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">stem</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">W</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fftshift</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">xr</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span>
  </pre>
<figure class="figure">
<p><a id="x65-2360299"></a></p>
<!-- l. 1280 -->
<p class="noindent">
<img alt="PIC" src="./Figures/cosinePeriodograms.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.9: </span><span class="content">Discrete-time PSD of <!-- l. 1281 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn><mtext class="qopname">cos</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --><mo class="MathClass-open" stretchy="false">(</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>8</mn><mo class="MathClass-close" stretchy="false">)</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> in linear scale estimated with periodograms.</span>
</figcaption>
<!-- tex4ht:label?: x65-2360299  -->
</figure>
<!-- l. 1284 -->
<p class="indent">
Listing&nbsp;<a href="#x65-236014r11">4.11<!-- tex4ht:ref: code:snip_frequency_periodogram  --></a> returns the value <!-- l. 1284 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>50</mn></mrow></math>&nbsp;W for both <span class="ec-lmss-10x-x-109">Power </span>and <span class="ec-lmss-10x-x-109">Power2</span>. The cosine angular frequencies are <!-- l. 1285 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">±</mo> <mn>0.7854</mn></mrow></math>&nbsp;rad as indicated in the top plot of Figure&nbsp;<a href="#x65-2360299">4.9<!-- tex4ht:ref: fig:cosinePeriodograms  --></a> for the positive frequency. The periodogram values at <!-- l. 1285 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></math> and <!-- l. 1285 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn></mrow></math> are <!-- l. 1286 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">|</mo><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">±</mo><mn>2</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-open" stretchy="false">(</mo><mstyle mathvariant="script"></mstyle><mi>P</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mi mathvariant="normal">Δ</mi><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>400</mn></mrow></math>, given that <!-- l. 1286 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> and <!-- l. 1286 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>.
</p>
<!-- l. 1288 -->
<p class="indent">
There was no leakage in the top plot of Figure&nbsp;<a href="#x65-2360299">4.9<!-- tex4ht:ref: fig:cosinePeriodograms  --></a>. But in case one allows the <span class="ec-lmss-10x-x-109">periodogram.m </span>routine to use zero-padding as in:
</p>
<!-- l. 1289 -->
<pre class="lstlisting" id="listing-148"><span class="label"><a id="x65-236030r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Smatlab</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],[],</span></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">twosided</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">zero</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">padding</span></span></pre>
<!-- l. 1292 -->
<p class="indent">
the result is the bottom plot of Figure&nbsp;<a href="#x65-2360299">4.9<!-- tex4ht:ref: fig:cosinePeriodograms  --></a>. In this case, <span class="ec-lmss-10x-x-109">periodogram.m </span>adopted zero-padding to reach <!-- l. 1292 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>256</mn></mrow></math> samples. This can be confirmed with
</p>
<!-- l. 1293 -->
<pre class="lstlisting" id="listing-149"><span class="label"><a id="x65-236031r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power3</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> <span class="ec-lmtt-9">(BW/256)*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Smatlab</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Power</span></span><span style="color:#005900"> <span class="ec-lmtt-9">from periodogram function</span></span></pre>
<!-- l. 1296 -->
<p class="indent">
which returns <span class="ec-lmss-10x-x-109">Power3=50</span>. Another discrepancy between the two plots in Figure&nbsp;<a href="#x65-2360299">4.9<!-- tex4ht:ref: fig:cosinePeriodograms  --></a> is that the bottom plot uses the range <!-- l. 1296 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Ω</mi> <mo class="MathClass-rel" stretchy="false">∈</mo> <mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>2</mn><mi>π</mi><mo class="MathClass-open" stretchy="false">[</mo></mrow></math> while the top plot adopted <!-- l. 1296 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><mi>π</mi><mo class="MathClass-punc" stretchy="false">,</mo><mi>π</mi><mo class="MathClass-open" stretchy="false">[</mo></mrow></math> via <span class="ec-lmss-10x-x-109">fftshift.m</span>. &nbsp;&nbsp;<!-- l. 1297 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 1368 -->
<p class="noindent">
<a id="x65-236032r16"></a> <span id="textcolor296">Example 4.16. </span><span class="ec-lmbx-10x-x-109">MS spectrum and PSD of a sum of sinusoids</span>. A 1024-points DFT is adopted to inspect a signal composed by two discrete-time cosines that are not bin-centered and have amplitudes 10 and 1&nbsp;V, as indicated in Listing&nbsp;<a href="#x65-236033r12">4.12<!-- tex4ht:ref: code:snip_frequency_not_bin_cent_cos  --></a>.
</p>
<!-- l. 1370 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.12: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_not_bin_cent_cos.m</span>
</figcaption>
<!-- tex4ht:label?: x65-236033r4.6.4  -->
<pre class="lstinputlisting" id="listing-150"><span class="label"><a id="x65-236035r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1024;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">n=(0:N-1)</span><span class="ts1-lmtt9-">'</span><span class="ec-lmtt-9">;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of samples and column vector</span> 
</span><span class="label"><a id="x65-236036r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">dw</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">FFT</span></span><span style="color:#005900"> <span class="ec-lmtt-9">bin width</span> 
</span><span class="label"><a id="x65-236037r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">k1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=115.3;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">k2=500.8; w1=k1*dw; w2=k2*dw;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">define</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequencies</span> 
</span><span class="label"><a id="x65-236038r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w1</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">+ 1*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w2</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">sum of two cosines</span> 
</span><span class="label"><a id="x65-236039r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sms</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">MS</span></span><span style="color:#005900"> <span class="ec-lmtt-9">spectrum |DTFS{x}|^2</span> 
</span><span class="label"><a id="x65-236040r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">S</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Periodogram</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency w=0 to pi</span> 
</span><span class="label"><a id="x65-236041r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sms</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">estimate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">the power in Watts = A^2/2</span> 
</span><span class="label"><a id="x65-236042r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span><span style="color:#005900"> <span class="ec-lmtt-9">index</span> 
</span><span class="label"><a id="x65-236043r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(211)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">h=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">,10*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sms</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">MS</span></span><span style="color:#005900"> <span class="ec-lmtt-9">spectrum (dB)</span> 
</span><span class="label"><a id="x65-236044r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(212)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> <span class="ec-lmtt-9">h2=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">w</span></span><span style="color:#000000"><span class="ec-lmtt-9">,10*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">S</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Periodogram</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(dB)</span></span>
  </pre>
<!-- l. 1372 -->
<p class="indent">
Figure&nbsp;<a href="#x65-23604510">4.10<!-- tex4ht:ref: fig:sumOfCosinesPeriodogramMSS  --></a> depicts the obtained result. To obtain cosines that are not bin-centered, non-integer numbers <span class="ec-lmss-10x-x-109">k1=115.3 </span>and <span class="ec-lmss-10x-x-109">k2=500.8 </span>were specified to create the angular frequencies. Hence, each cosine has most of its power located at bins <!-- l. 1372 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>115</mn></mrow></math> and 501 as indicated by the data tips in Figure&nbsp;<a href="#x65-23604510">4.10<!-- tex4ht:ref: fig:sumOfCosinesPeriodogramMSS  --></a>.
</p>
<!-- l. 1374 -->
<p class="indent">
</p><p>The top graph shows the bilateral MS spectrum with the positive frequencies (the ones that have associated data tips), from</p>
<!-- l. 1374 -->
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn></mrow></math> to 512 preceding the “negative” frequencies from <!-- l. 1374 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>k</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>513</mn></mrow></math> to 1023. The function <span class="ec-lmss-10x-x-109">fftshift </span>could be used to make the “negative” precede the positive frequencies. Note that the implicitly adopted rectangular window leads to considerable leakage. The bottom graph is a unilateral representation of the periodogram.
<p></p>
<figure class="figure">
<p><a id="x65-23604510"></a></p>
<!-- l. 1381 -->
<p class="noindent">
<img alt="PIC" src="./Figures/sumOfCosinesPeriodogramMSS.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.10: </span><span class="content">Periodogram and MS spectrum for a sum of sinusoids. Both are in dB scale.</span>
</figcaption>
<!-- tex4ht:label?: x65-23604510  -->
</figure>
<!-- l. 1385 -->
<p class="indent">
The <span class="ec-lmss-10x-x-109">Power </span>calculated by the code was 50.5397&nbsp;W while the theoretical result is <!-- l. 1385 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <msup><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>50</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn></mrow></math>. The small discrepancy is due to the fact that the sinusoids are not bin-centered and the time-domain signal <span class="ec-lmss-10x-x-109">x </span>itself has power <!-- l. 1386 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>50</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5397</mn></mrow></math>&nbsp;W.
</p>
<!-- l. 1388 -->
<p class="indent">
Bin-centered cosines with power 50 and 0.5&nbsp;W would lead to values <!-- l. 1388 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>25</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>13</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>98</mn></mrow></math>&nbsp;dB and <!-- l. 1388 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>0.25</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>6.02</mn></mrow></math>&nbsp;dB at their corresponding frequencies in a bilateral MS spectrum. Given that <!-- l. 1388 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi></mrow></math> and the FFT bin width is <!-- l. 1388 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>1024</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>0.0061</mn></mrow></math>, the theoretical values for the unilateral periodogram are <!-- l. 1388 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>50</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>0.0061</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>39</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>11</mn></mrow></math> and <!-- l. 1388 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>0.5</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>0.0061</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>19</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>11</mn></mrow></math>. Figure&nbsp;<a href="#x65-23604510">4.10<!-- tex4ht:ref: fig:sumOfCosinesPeriodogramMSS  --></a> presents slightly smaller values for both MS spectrum and periodogram due to leakage. Because <!-- l. 1388 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mi>π</mi></mrow></math> instead of <!-- l. 1388 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>, the depicted values are not the ones of a discrete-time PSD <!-- l. 1388 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math>.
</p>
<!-- l. 1390 -->
<p class="indent">
An interesting aspect is that the relative difference in power between the two sinusoids can be obtained in both periodogram and MS spectrum, leading to <!-- l. 1390 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>37</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>79</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>18</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>63</mn> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>19</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn></mrow></math>&nbsp;dB and <!-- l. 1390 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>12</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>66</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mo class="MathClass-open" stretchy="false">(</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>6.497</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo> <mn>19</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn></mrow></math>&nbsp;dB, respectively. In other words, the PSD does not allow directly reading the absolute power values but can inform the relation between powers of signal components that reside in specific bins. &nbsp;&nbsp;<!-- l. 1392 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 1394 -->
<p class="noindent">
<a id="x65-236046r17"></a> <span id="textcolor297">Example 4.17. </span><span class="ec-lmbx-10x-x-109">Periodogram variance does not decrease with number of samples</span>. Figure&nbsp;<a href="#x65-23606011">4.11<!-- tex4ht:ref: fig:periodogram  --></a> illustrates the adoption of periodograms <!-- l. 1395 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> to estimate the discrete-time PSD <!-- l. 1395 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> of a white noise with power of 600&nbsp;W. The estimation used <!-- l. 1397 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>300</mn></mrow></math> (top) and <!-- l. 1397 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3000</mn></mrow></math> (bottom) samples of the noise signal. The code for signal generation and periodogram estimation for <span class="ec-lmss-10x-x-109">N=300 </span>(the same code was used for <span class="ec-lmss-10x-x-109">N=3000 </span>samples) is:
</p>
<!-- l. 1398 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.13: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_noise_PSD.m</span>
</figcaption>
<!-- tex4ht:label?: x65-236047r4.6.4  -->
<pre class="lstinputlisting" id="listing-151"><span class="label"><a id="x65-236049r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 300;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> <span class="ec-lmtt-9">number of samples and FFT size</span> 
</span><span class="label"><a id="x65-236050r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 600;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">desired</span></span><span style="color:#005900"> <span class="ec-lmtt-9">noise power in Watts</span> 
</span><span class="label"><a id="x65-236051r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 1;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency = BW = 1 Dhertz</span> 
</span><span class="label"><a id="x65-236052r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sqrt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">*</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Gaussian</span></span><span style="color:#005900"> <span class="ec-lmtt-9">white noise</span> 
</span><span class="label"><a id="x65-236053r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">actualPower</span></span><span style="color:#000000"> <span class="ec-lmtt-9">=</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> <span class="ec-lmtt-9">actual obtained power</span> 
</span><span class="label"><a id="x65-236054r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">F</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],[],</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">twosided</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">periodogram</span></span> 
<span class="label"><a id="x65-236055r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">subplot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(211)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">F</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">plot</span></span><span style="color:#005900"> <span class="ec-lmtt-9">periodogram</span> 
</span><span class="label"><a id="x65-236056r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Sx_th</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ones</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">F</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">theoretical</span></span><span style="color:#005900"> <span class="ec-lmtt-9">PSD</span> 
</span><span class="label"><a id="x65-236057r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">mean</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> <span class="ec-lmtt-9">this case, it coincides with actualPower</span> 
</span><span class="label"><a id="x65-236058r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">disp</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Periodogram</span></span><span style="color:#FF0000"> <span class="ec-lmtt-9">standard deviation=</span><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">num2str</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">std</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">])</span></span> 
<span class="label"><a id="x65-236059r11"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">hold</span></span><span style="color:#000000"> <span class="ec-lmtt-9">on; h=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">F</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sx_th</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">r</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">:</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">lineWidth</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">,3)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span>
  </pre>
<!-- l. 1399 -->
<p class="indent">
</p><p>Note that due to the limited number <span class="ec-lmss-10x-x-109">N </span>of samples, the <span class="ec-lmss-10x-x-109">actualPower </span>values (e. g., 512.3 and</p>
601.0&nbsp;W), may differ from the desired value <span class="ec-lmss-10x-x-109">power_x=600</span>.
<p></p>
<figure class="figure">
<p><a id="x65-23606011"></a></p>
<!-- l. 1403 -->
<p class="noindent">
<img alt="PIC" src="./Figures/periodogram.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.11: </span><span class="content">Periodograms of a white noise with power equal to 600&nbsp;W estimated with <!-- l. 1404 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>300</mn></mrow></math> (top) and <!-- l. 1404 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3000</mn></mrow></math> (bottom) samples.</span>
</figcaption>
<!-- tex4ht:label?: x65-23606011  -->
</figure>
<!-- l. 1407 -->
<p class="indent">
Recall from Eq.&nbsp;(<a href="#x65-232001r47">4.47<!-- tex4ht:ref: eq:periodogram_discretetime4  --></a>), that in the case of <!-- l. 1407 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math>, the periodogram coincides with the discrete-time PSD estimate <!-- l. 1409 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mo class="MathClass-rel" stretchy="false">|</mo></mrow><mrow><mi mathvariant="normal">Ω</mi><mo class="MathClass-rel" stretchy="false">=</mo><mi>k</mi><mo class="MathClass-open" stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></msub></mrow></math>.
</p>
<!-- l. 1411 -->
<p class="indent">
This example illustrates that the periodogram values with <!-- l. 1411 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> have an average <span class="ec-lmss-10x-x-109">mean(Sk) </span>that coincides with <span class="ec-lmss-10x-x-109">actualPower </span>(because <!-- l. 1411 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">Δ</mi><mi>f</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mi>N</mi></mrow></math> in this case). However, the variance of the estimate does not decrease with <!-- l. 1411 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>. For <!-- l. 1411 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>300</mn></mrow></math> and 3000, the standard deviations are 593.1 and 599.4, respectively. This issue is discussed in Section&nbsp;<a href="ak_dsp_bookse56.html#x66-2380004.7">4.7<!-- tex4ht:ref: sec:welch  --></a>, in which the Welch’s PSD estimation method is presented. &nbsp; &nbsp;<!-- l. 1412 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 1414 -->
<p class="noindent">
<a id="x65-236061r18"></a> <span id="textcolor298">Example 4.18. </span><span class="ec-lmbx-10x-x-109">PSD of a sinusoid contaminated by AWGN</span>. Special care must be exercised when interpreting a PSD that represents both broadband and narrowband signals. An example is when using the PSD to estimate the SNRs of sinusoids immersed in white noise. Figure&nbsp;<a href="#x65-23607312">4.12<!-- tex4ht:ref: fig:cosineOnAWGN  --></a> shows the periodogram of a cosine contaminated by AWGN generated with Listing&nbsp;<a href="#x65-236062r14">4.14<!-- tex4ht:ref: code:snip_frequency_noisy_cosine  --></a>.
</p>
<!-- l. 1416 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.14: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_noisy_cosine.m</span>
</figcaption>
<!-- tex4ht:label?: x65-236062r4.6.4  -->
<pre class="lstinputlisting" id="listing-152"><span class="label"><a id="x65-236064r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1024;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">A=4;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">#</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of samples and cosine amplitude of A Volts</span> 
</span><span class="label"><a id="x65-236065r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=8000;</span></span><span style="color:#000000"> <span class="ec-lmtt-9">Ts=1/Fs;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency (Hz) and period (s)</span> 
</span><span class="label"><a id="x65-236066r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">f0</span></span><span style="color:#000000"><span class="ec-lmtt-9">=915;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">cosine</span></span><span style="color:#005900"> <span class="ec-lmtt-9">frequency in Hz</span> 
</span><span class="label"><a id="x65-236067r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">noisePower</span></span><span style="color:#000000"><span class="ec-lmtt-9">=16;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">noise</span></span><span style="color:#005900"> <span class="ec-lmtt-9">power in Watts</span> 
</span><span class="label"><a id="x65-236068r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">noise</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sqrt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">noisePower</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x65-236069r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">:(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ts</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">N</span></span><span style="color:#005900"> <span class="ec-lmtt-9">time instants separated by Ts</span> 
</span><span class="label"><a id="x65-236070r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">cos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">pi</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">f0</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">t</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">+ noise;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> <span class="ec-lmtt-9">cosine with AWGN</span> 
</span><span class="label"><a id="x65-236071r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">P</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">periodogram</span></span> 
<span class="label"><a id="x65-236072r9"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">plot</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">f</span></span><span style="color:#000000"><span class="ec-lmtt-9">,10*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">log10</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">P</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">dB</span></span><span style="color:#005900"> <span class="ec-lmtt-9">scale</span></span>
  </pre>
<!-- l. 1426 -->
<p class="indent">
Listing&nbsp;<a href="#x65-236062r14">4.14<!-- tex4ht:ref: code:snip_frequency_noisy_cosine  --></a> was used to generate the top plot with <span class="ec-lmss-10x-x-109">subplot(211)</span>. Then, the bottom plot was obtained by increasing <span class="ec-lmss-10x-x-109">N </span>from 1024 to 16384. All the absolute values of the two periodograms differ due to their dependence on <span class="ec-lmss-10x-x-109">N</span>.
</p>
<figure class="figure">
<p><a id="x65-23607312"></a></p>
<!-- l. 1430 -->
<p class="noindent">
<img alt="PIC" src="./Figures/cosineOnAWGN.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.12: </span><span class="content">Periodograms of a cosine contaminated by AWGN at an SNR of <!-- l. 1431 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>3</mn></mrow></math>&nbsp;dB with an FFT of <!-- l. 1431 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1024</mn></mrow></math> points (top plot) and 16384 (bottom). In this case the SNR cannot be inferred directly from the noise level.</span>
</figcaption>
<!-- tex4ht:label?: x65-23607312  -->
</figure>
<!-- l. 1434 -->
<p class="indent">
It can be noticed from Listing&nbsp;<a href="#x65-236062r14">4.14<!-- tex4ht:ref: code:snip_frequency_noisy_cosine  --></a> that the cosine power is <!-- l. 1434 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mstyle mathvariant="script"></mstyle><mi>P</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class="MathClass-bin" stretchy="false">∕</mo><mn>2</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></mrow></math>&nbsp;W while the noise power is 16&nbsp;W, leading to a <!-- l. 1434 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">SNR</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>10</mn><msub><mrow><mtext class="qopname">log</mtext><mo> ⁡<!-- FUNCTION APPLICATION --> </mo><!-- nolimits --></mrow><mrow><mn>10</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mn>8</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>16</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">≈</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>3.01</mn></mrow></math>&nbsp;dB. However, one may be tempted by Figure&nbsp;<a href="#x65-23607312">4.12<!-- tex4ht:ref: fig:cosineOnAWGN  --></a> to erroneously infer that SNR is positive given that the noise level (sometimes called <span class="ec-lmri-10x-x-109">noise floor</span><a id="dx65-236074"></a>) is more than 20&nbsp;dB below the cosine peak for the top graph. Directly observing the ratio of powers in PSD graphs was valid in Figure&nbsp;<a href="#x65-23604510">4.10<!-- tex4ht:ref: fig:sumOfCosinesPeriodogramMSS  --></a>, but in that case, the cosines were assumed to have all power confined in their respective bins. This is not the case with signals that have power spread over several bins and especially with white noise.
</p>
<!-- l. 1436 -->
<p class="indent">
Because the white noise power is spread over all bins of a periodogram, the larger the number <!-- l. 1436 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> of FFT bins, the less noise power each bin carries and the larger the difference between the sinusoid power (assumed to be confined in a single bin) and the noise floor. In Figure&nbsp;<a href="#x65-23604510">4.10<!-- tex4ht:ref: fig:sumOfCosinesPeriodogramMSS  --></a>, the bottom plot shows that the cosine power is approximately 30&nbsp;dB above the noise level when <span class="ec-lmss-10x-x-109">N </span>is increased to 16384. However, in both plots, the SNR is <!-- l. 1436 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>3</mn></mrow></math>&nbsp;dB as attested by Listing&nbsp;<a href="#x65-236062r14">4.14<!-- tex4ht:ref: code:snip_frequency_noisy_cosine  --></a>.
</p>
<!-- l. 1438 -->
<p class="indent">
In summary, the proper way of measuring the signal power is to account for the power in all bins that represent the signal.&nbsp;&nbsp;<!-- l. 1439 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">4.6.5</span>&nbsp;&nbsp;<a id="x65-2370004.6.5"></a>Estimating the PSD from Autocorrelation
</h4>
<!-- l. 1512 -->
<p class="noindent">
An alternative way of estimating the PSD of a finite duration discrete-time signal is via the autocorrelation. The autocorrelation for such finite-duration signals can be obtained via Eq.&nbsp;(<a href="ak_dsp_bookse12.html#x19-71005r61">1.61<!-- tex4ht:ref: eq:xcorrFiniteDuration  --></a>), and then the PSD estimated with
</p>

<table class="equation">
<tbody><tr>
<td>
<!-- l. 1520 -->
<p class="indent">
</p>
<!-- l. 1520 -->
<math class="equation" display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mstyle class="label" id="x65-237001r51"></mstyle><!-- endlabel --><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo><munderover accent="false" accentunder="false"><mrow><mtext> ∑</mtext></mrow><mrow> <mi>k</mi><mo class="MathClass-rel" stretchy="false">=</mo><mo class="MathClass-bin" stretchy="false">−</mo><mi>N</mi><mo class="MathClass-bin" stretchy="false">+</mo><mn>1</mn></mrow><mrow><mi>N</mi><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></munderover><mover accent="true"><mrow><mi>R</mi></mrow><mo accent="true">^</mo></mover><mo class="MathClass-open" stretchy="false">[</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo><msup><mrow><mi>e</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mi>j</mi><mi mathvariant="normal">Ω</mi><mi>n</mi></mrow></msup><mo class="MathClass-punc" stretchy="false">.</mo> </mrow></math>
</td>
<td class="eq-no">
(4.51)
</td>
</tr>

</tbody></table>
<!-- l. 1524 -->
<p class="indent">
</p><p>As previously done, an FFT can be used to obtain the values of <!-- l. 1524 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ŝ</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></math> at the FFT frequency grid.</p>
<p></p>
<!-- l. 1526 -->
<p class="noindent">
<a id="x65-237002r19"></a> <span id="textcolor299">Example 4.19. </span><span class="ec-lmbx-10x-x-109">PSD of filtered white-noise via its autocorrelation</span>. Listing&nbsp;<a href="#x65-237003r15">4.15<!-- tex4ht:ref: code:snip_frequency_PSD_using_xcorr  --></a> illustrates how Eq.&nbsp;(<a href="#x65-237001r51">4.51<!-- tex4ht:ref: eq:psd_via_xcorr  --></a>) can be used to generate Figure&nbsp;<a href="#x65-23701613">4.13<!-- tex4ht:ref: fig:psd_of_pulse_via_xcorr  --></a>. The theoretical expression for the PSD in Figure&nbsp;<a href="#x65-23701613">4.13<!-- tex4ht:ref: fig:psd_of_pulse_via_xcorr  --></a> was obtained from Eq.&nbsp;(<a href="ak_dsp_bookse54.html#x64-225006r41">4.41<!-- tex4ht:ref: eq:whiteNoiseLTIOutput  --></a>).
</p>
<!-- l. 1530 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.15: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_PSD_using_xcorr.m</span>
</figcaption>
<!-- tex4ht:label?: x65-237003r4.6.5  -->
<pre class="lstinputlisting" id="listing-153"><span class="label"><a id="x65-237005r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 3000;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">total</span></span><span style="color:#005900"> <span class="ec-lmtt-9">number of signal samples</span> 
</span><span class="label"><a id="x65-237006r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 4;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of non-zero samples of h[n]</span> 
</span><span class="label"><a id="x65-237007r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"> <span class="ec-lmtt-9">= 600;</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">noise</span></span><span style="color:#005900"> <span class="ec-lmtt-9">power in Watts</span> 
</span><span class="label"><a id="x65-237008r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sqrt</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> <span class="ec-lmtt-9">*</span> </span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Gaussian</span></span><span style="color:#005900"> <span class="ec-lmtt-9">white noise</span> 
</span><span class="label"><a id="x65-237009r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ones</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">L</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">FIR</span></span><span style="color:#005900"> <span class="ec-lmtt-9">moving average filter impulse response</span> 
</span><span class="label"><a id="x65-237010r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">conv</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">filtered</span></span><span style="color:#005900"> <span class="ec-lmtt-9">signal y[n] = x[n] * h[n]</span> 
</span><span class="label"><a id="x65-237011r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">h</span></span><span style="color:#000000"><span class="ec-lmtt-9">,4*</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">DTFT</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(sampled) of the impulse response</span> 
</span><span class="label"><a id="x65-237012r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Sy_th</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">power_x</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">H</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">theoretical</span></span><span style="color:#005900"> <span class="ec-lmtt-9">PSD via sampling DTFT</span> 
</span><span class="label"><a id="x65-237013r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">=256;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">maximum</span></span><span style="color:#005900"> <span class="ec-lmtt-9">lag chosen as M &lt; N</span> 
</span><span class="label"><a id="x65-237014r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ry</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">xcorr</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">biased</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">estimating</span></span><span style="color:#005900"> <span class="ec-lmtt-9">autocorrelation</span> 
</span><span class="label"><a id="x65-237015r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Sy_corr</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Ry</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">PSD</span></span><span style="color:#005900"> <span class="ec-lmtt-9">estimate via autocorrelation</span></span>
  </pre>
<figure class="figure">
<p><a id="x65-23701613"></a></p>
<!-- l. 1548 -->
<p class="noindent">
<img alt="PIC" src="./Figures/psd_of_pulse_via_xcorr.png" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;4.13: </span><span class="content">PSD of a filtered white noise <!-- l. 1549 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> estimated via the autocorrelation.</span>
</figcaption>
<!-- tex4ht:label?: x65-23701613  -->
</figure>
<!-- l. 1554 -->
<p class="indent">
Note that for an input signal with <!-- l. 1554 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> samples, the function <span class="ec-lmss-10x-x-109">xcorr </span>would, by default, output an autocorrelation with lags from <!-- l. 1554 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>N</mi></mrow></math> to <!-- l. 1554 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math>. However, to avoid noisy estimations at the autocorrelation tails, it is a good strategy to use a maximum lag <!-- l. 1555 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">«</mo> <mi>N</mi></mrow></math>, if possible. There is a rule of thumb that suggests adopting <!-- l. 1555 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>N</mi><mo class="MathClass-bin" stretchy="false">∕</mo><mn>10</mn></mrow></math>. This was used in Listing&nbsp;<a href="#x65-237003r15">4.15<!-- tex4ht:ref: code:snip_frequency_PSD_using_xcorr  --></a>, where <span class="ec-lmss-10x-x-109">Ry </span>was calculated for a maximum lag of <span class="ec-lmss-10x-x-109">M=256 </span>while the signal had <span class="ec-lmss-10x-x-109">N=3000</span> samples. &nbsp;&nbsp;<!-- l. 1557 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math>
</p>
<!-- l. 1560 -->
<p class="noindent">
<a id="x65-237017r20"></a> <span id="textcolor300">Example 4.20. </span><span class="ec-lmbx-10x-x-109">PSD of a discrete-time impulse</span>. Let <!-- l. 1563 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi mathvariant="italic">Aδ</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>n</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> be a discrete-time impulse with amplitude <!-- l. 1563 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math> that is multiplied by a rectangular window of <!-- l. 1564 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math> samples for FFT-based spectral analysis. For example, with <!-- l. 1565 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>N</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn></mrow></math> and <!-- l. 1565 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>6</mn></mrow></math> and <span class="ec-lmss-10x-x-109">x=[6, 0, 0, 0, 0] </span>is the vector representing <!-- l. 1565 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math>. Because the PSD disregards the phase information, the value of <!-- l. 1566 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi>n</mi></mrow><mrow><mn>0</mn></mrow></msub></math> and the position of the peak with amplitude <!-- l. 1566 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math> within the windowed signal <!-- l. 1566 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> is not relevant. For the given example, using <span class="ec-lmss-10x-x-109">x=[0, 0, 0, 6, 0] </span>would lead to the same results. This signal <!-- l. 1567 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mrow><mi>x</mi></mrow><mrow><mi>w</mi></mrow></msub><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></mrow></math> also has an autocorrelation that is an impulse and a white spectrum. Its PSD has a constant value of <!-- l. 1567 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mstyle mathvariant="script"></mstyle><mi>P</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>36</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>5</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>7.2</mn></mrow></math>&nbsp;W/Dhertz (normalized frequency), as indicated in Eq.&nbsp;(<a href="ak_dsp_bookse54.html#x64-227001r42">4.42<!-- tex4ht:ref: eq:whiteNoisePSD  --></a>). Listing&nbsp;<a href="#x65-237018r16">4.16<!-- tex4ht:ref: code:snip_frequency_impulse_PSD  --></a> calculates the periodogram and MS spectrum.
</p>
<!-- l. 1571 -->
<figcaption class="caption">
<span class="id">Listing&nbsp;4.16: </span><span class="content">MatlabOctaveCodeSnippets/snip_frequency_impulse_PSD.m</span>
</figcaption>
<!-- tex4ht:label?: x65-237018r4.6.5  -->
<pre class="lstinputlisting" id="listing-154"><span class="label"><a id="x65-237020r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> <span class="ec-lmtt-9">of FFT points</span> 
</span><span class="label"><a id="x65-237021r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">maximum</span></span><span style="color:#005900"> <span class="ec-lmtt-9">number of autocorrelation lags</span> 
</span><span class="label"><a id="x65-237022r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">BW</span></span><span style="color:#005900"> <span class="ec-lmtt-9">in normalized frequency (digital Hertz)</span> 
</span><span class="label"><a id="x65-237023r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[6</span></span><span style="color:#000000"> <span class="ec-lmtt-9">0 0 0 0];</span> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">impulse</span></span><span style="color:#005900"> <span class="ec-lmtt-9">signal truncated in N samples</span> 
</span><span class="label"><a id="x65-237024r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sms</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">.^2</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">MS</span></span><span style="color:#005900"> <span class="ec-lmtt-9">spectrum: all values are 2.25 Watts</span> 
</span><span class="label"><a id="x65-237025r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">periodogram</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,[],</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,1,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">twosided</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">periodogram</span></span> 
<span class="label"><a id="x65-237026r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">R</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">lags</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">xcorr</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">biased</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">estimating</span></span><span style="color:#005900"> <span class="ec-lmtt-9">autocorrelation</span> 
</span><span class="label"><a id="x65-237027r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Sxcorr</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fft</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">R</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">PSD</span></span><span style="color:#005900"> <span class="ec-lmtt-9">via autocorrelation</span> 
</span><span class="label"><a id="x65-237028r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sms</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">power</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(9 W) obtained from MS spectrum</span> 
</span><span class="label"><a id="x65-237029r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">Power2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(</span></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sk</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">power</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(9 W) from</span> 
</span><span class="label"><a id="x65-237030r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Power3</span></span><span style="color:#000000"><span class="ec-lmtt-9">=(</span></span><span style="color:#000000"><span class="ec-lmtt-9">BW</span></span><span style="color:#000000"><span class="ec-lmtt-9">/</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Sxcorr</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">power</span></span><span style="color:#005900"> <span class="ec-lmtt-9">(9 W) from periodogram via xcorr</span></span>
  </pre>
<!-- l. 1573 -->
<p class="indent">
</p><p>The last commands obtain the average power equal to 7.2&nbsp;W using three distinct alternatives. All elements of <span class="ec-lmss-10x-x-109">Sms </span>have a value of <!-- l. 1573 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>7.2</mn><mo class="MathClass-bin" stretchy="false">∕</mo><mn>5</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1.44</mn></mrow></math>&nbsp;W, given that the power was uniformly distributed over the five discrete frequency values. The bilateral periodogram was calculated assuming a bandwidth</p>
<!-- l. 1573 -->
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">BW</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn></mrow></math> (in normalized frequency, or Dhertz) such that the returned value has all values equal to 7.2, coinciding with <!-- l. 1573 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo class="MathClass-open" stretchy="false">(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>j</mi><mi mathvariant="normal">Ω</mi></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>7.2</mn></mrow></math> (see Eq.&nbsp;(<a href="#x65-232001r47">4.47<!-- tex4ht:ref: eq:periodogram_discretetime4  --></a>)). &nbsp;&nbsp;<!-- l. 1574 --><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mtext class="MathClass-ord">□</mtext></math></p>
<p></p>





</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ak_dsp_bookse54.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Filtering Random Signals and the Impact on PSDs</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ak_dsp_bookse56.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Welch’s method</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Digital Signal Processing with Python, Matlab or Octave, Applications in Machine Learning Aldebaro Klautau Federal University of Pará (UFPA), Brazil</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>