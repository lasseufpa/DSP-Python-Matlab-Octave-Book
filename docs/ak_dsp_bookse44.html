<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aldebaro Klautau">

<title>Digital Signal Processing with Python, Matlab or Octave - 44&nbsp; Realization of Digital Filters</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ak_dsp_bookse45.html" rel="next">
<link href="./ak_dsp_bookse43.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ak_dsp_bookch3.html">Analog and Digital Systems</a></li><li class="breadcrumb-item"><a href="./ak_dsp_bookse44.html"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Realization of Digital Filters</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Digital Signal Processing with Python, Matlab or Octave</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Tables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookli4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listings</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Signals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analog, Digital and Discrete-Time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basic Signal Manipulation and Representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Block Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Complex-Valued and Sampled Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modeling the Stages in A/D and D/A Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Relating Frequencies in Continuous, Sampled and Discrete-time Signals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">An Introduction to Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Signal Categorization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Power and Energy in Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Relating Power in Continuous and Discrete-Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Correlation: Finding Trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Linear Model for Quantization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforms and Signal Representation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Linear Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inner Products to Obtain the Transform Coefficients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Block Transforms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Fourier Transforms and Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Relating discrete and analog frequencies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Summary of equations for DFT / FFT Usage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Laplace Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Z Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Review Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analog and Digital Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Contrasting Signals and Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Analog and Digital Filters: A Quick Hands-On Tour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Linear Time-Invariant Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Sampling and Signal Reconstruction Revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse36.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Facts About First and Second-Order Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse37.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Bandwidth and Quality Factor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse38.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Importance of Linear Phase (or Constant Group Delay)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse39.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Filtering technologies: Surface acoustic wave (SAW) and others</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse40.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse41.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">IIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse42.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Bilinear Transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse43.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">FIR Filter Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse44.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Realization of Digital Filters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse45.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multirate Processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse46.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse47.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse48.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse49.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ak_dsp_bookch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spectral Estimation Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">To Learn in This Chapter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse51.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse52.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Windows for spectral analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse53.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">The ESD, PSD and MS Spectrum functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse54.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Filtering Random Signals and the Impact on PSDs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse55.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Periodogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse56.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nonparametric PSD Estimation via Welch’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse57.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Parametric PSD Estimation via Autoregressive (AR) Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse58.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Time-frequency Analysis using the Spectrogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse59.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse60.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Comments and Further Reading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse61.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookse62.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Extra Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">ak_dsp_bookap1.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Useful Mathematics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Useful Softwares and Programming Tricks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ak_dsp_bookap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Realization of Digital Filters</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>


<meta charset="utf-8">
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" type="text/css" href="ak_dsp_book.css">
<meta name="src" content="ak_dsp_book.tex">
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js"></script>


<h3 class="sectionHead anchored">
<span class="titlemark">3.14</span>&nbsp;&nbsp;<a id="x53-1900003.14"></a>Realization of Digital Filters
</h3>
<!--l. 3215-->
<p class="noindent">
Having <!--l. 3215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math>, the next step is to choose a <span class="ec-lmri-10x-x-109">realization</span><a id="dx53-190001"></a>. For example, the difference equation <!--l. 3215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>5</mn><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo></math> could be implemented as <!--l. 3215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn><mo class="MathClass-open" stretchy="false">(</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-close" stretchy="false">)</mo></math> to save computation. In this case, instead of two multiplications followed by a subtraction, the alternative requires only one subtraction and one multiplication. However, a difference equation is not adequate to distinguish realizations. For example, algebraically, they are of course the same: <!--l. 3215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>5</mn><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn><mo class="MathClass-open" stretchy="false">(</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-close" stretchy="false">)</mo></math>. In order to specify realizations of digital filters, a flow chart or diagram is used. The “delay block” is represented by <span class="fbox"><!--l. 3215--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></math></span>, such that its output is the previous value of the input. For example:
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!--l. 3216-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext>&nbsp;<msup><mrow>z</mrow>&lt;mrow&nbsp; &gt;−1&lt;/msup&nbsp; &gt; <mo class="MathClass-rel" stretchy="false">→</mo><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo> 
</msup></mtext></mstyle></math></td>
</tr>

</tbody></table>
<!--l. 3219-->
<p class="indent">
and
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!--l. 3220-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext>&nbsp;<msup><mrow>z</mrow>&lt;mrow&nbsp; &gt;−1&lt;/msup&nbsp; &gt; <mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext><msup><mrow>z</mrow>&lt;mrow&nbsp; &gt;−1&lt;/msup&nbsp; &gt;</msup></mtext></mstyle> <mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext>&nbsp;<msup><mrow>z</mrow>&lt;mrow&nbsp; &gt;−1&lt;/msup&nbsp; &gt;</msup></mtext></mstyle> <mo class="MathClass-rel" stretchy="false">→</mo> <mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>3</mn><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">.</mo> 
</msup></mtext></mstyle></math></td>
</tr>

</tbody></table>
<!--l. 3223-->
<p class="indent">
The output of each delay block needs to be stored in RAM memory, such that the number of these blocks should be minimized if one aims at a reduced memory requirement. The <span class="ec-lmri-10x-x-109">filter</span> <span class="ec-lmri-10x-x-109">memory</span><a id="dx53-190002"></a> is the set of values taken from the output of the delay blocks, which are stored for using in the next iteration.
</p>
<!--l. 3225-->
<p class="indent">
Other blocks are the multiplier and adder. These three help to indicate the order of operations when implementing a difference equation. Figure&nbsp;<a href="#x53-19000552">3.52<!--tex4ht:ref: fig:fir_realizations --></a> depicts the two realizations mentioned previously. A careful observation concludes that such diagrams still have some ambiguity with respect to the order of operations but they are more descriptive than a difference equation.
</p>
<figure class="figure">
<p><a id="x53-19000552"></a></p>
<a id="x53-190003r1"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="FiguresTex/filter_realization_1.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(a) </span>
</div>
</td>
</tr>

</tbody></table>
</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a id="x53-190004r2"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="FiguresTex/filter_realization_2.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(b) </span>
</div>
</td>
</tr>

</tbody></table>
</div>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.52: </span><span class="content">Two distinct realizations of <!--l. 3231--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>5</mn><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>5</mn><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo></math>.</span>
</figcaption>
<!--tex4ht:label?: x53-19000552 -->
</figure>
<!--l. 3235-->
<p class="indent">
At this point, it may not be clear that the value of <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> can be distinct in the two cases of Figure&nbsp;<a href="#x53-19000552">3.52<!--tex4ht:ref: fig:fir_realizations --></a>. This may happen when one compares these two filter realizations using a finite number of bits to represent numbers. For example, assume that the hardware used to implement the equations provides only 8 bits to represent integer numbers in the range <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-open" stretchy="false">[</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn><mn>2</mn><mn>8</mn><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn><mn>2</mn><mn>7</mn><mo class="MathClass-close" stretchy="false">]</mo></math> in two’s complement. Say that <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn><mn>5</mn></math> and <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>9</mn><mn>2</mn></math> and the goal is to obtain <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo></math>. Using the realization of Figure&nbsp;<a href="#x53-190004r2">3.52(b)<!--tex4ht:ref: fig:filter_realization_2 --></a>, the difference <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-bin" stretchy="false">−</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>9</mn><mn>2</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>8</mn><mn>5</mn> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>7</mn></math> is multiplied by 5 and <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>3</mn><mn>5</mn></math>. In contrast, using Figure&nbsp;<a href="#x53-190003r1">3.52(a)<!--tex4ht:ref: fig:filter_realization_1 --></a> leads to an overflow when calculating <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>5</mn><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn><mn>2</mn><mn>5</mn></math>, which would require at least 10 bits because converting from decimal to binary leads to <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>4</mn><mn>2</mn><msub><mrow><mn>5</mn></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">D</mtext></mstyle></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mn>1</mn><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mn>1</mn><mn>0</mn><mn>1</mn><mn>0</mn><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mn>1</mn><mn>0</mn><mn>0</mn><msub><mrow><mn>1</mn></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">B</mtext></mstyle></mrow></msub></math>, with the most significant bit representing the sign. Therefore, unless the hardware was able to implement <span class="ec-lmri-10x-x-109">saturation </span>and represent this product as 127, the result with finite precision would be <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>5</mn><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>0</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>8</mn><msub><mrow><mn>7</mn></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">D</mtext></mstyle></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>0</mn><mn>1</mn><mn>0</mn><mstyle class="text"><mtext class="textrm" mathvariant="normal">&nbsp;</mtext></mstyle><mn>1</mn><mn>0</mn><mn>0</mn><msub><mrow><mn>1</mn></mrow><mrow><mstyle class="text"><mtext class="textrm" mathvariant="normal">B</mtext></mstyle></mrow></msub></math>. Similarly, <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>5</mn><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>5</mn><mn>2</mn></math> when represented with 8 bits and, consequently, <!--l. 3235--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mn>1</mn><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>8</mn><mn>7</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mo class="MathClass-open" stretchy="false">(</mo><mo class="MathClass-bin" stretchy="false">−</mo><mn>5</mn><mn>2</mn><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn><mn>5</mn></math> in this case. This simple example should suffice to illustrate the importance of the filter realization when the precision is finite. There are many structures for obtaining realizations of digital filters. The most popular will be presented in the sequel.
</p>
<h4 class="subsectionHead anchored">
<span class="titlemark">3.14.1</span>&nbsp;&nbsp;<a id="x53-1910003.14.1"></a>Structures for FIR filters
</h4>
<figure class="figure">
<p><a id="x53-19100353"></a></p>
<pre><code>                                   &lt;div class="center" </code></pre>
<blockquote class="blockquote">
<!--l. 3240-->
<p class="noindent">
<a id="x53-191001r1"></a>
</p>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="FiguresTex/fir_direct_form.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(a)</span> <span class="ec-lmr-9">Direct</span> <span class="ec-lmr-9">form</span>
</div>
</td>
</tr>

</tbody></table>
</div>
<a id="x53-191002r2"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="FiguresTex/fir_direct_form_symmetric.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(b)</span> <span class="ec-lmr-9">Symmetric</span>
</div>
</td>
</tr>

</tbody></table>
</div>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.53: </span><span class="content">Two structures for FIR realizations.</span>
</figcaption>
<!--tex4ht:label?: x53-19100353 -->
</blockquote></figure></main></div>


<!--l. 3248-->
<p class="indent">
The most straightforward implementation of a FIR is called <span class="ec-lmri-10x-x-109">direct</span> <span class="ec-lmri-10x-x-109">form </span>or <span class="ec-lmri-10x-x-109">tapped delay line</span>, which is depicted in Figure&nbsp;<a href="#x53-191001r1">3.53(a)<!--tex4ht:ref: fig:fir_direct_form --></a> for <!--l. 3248--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>3</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>5</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>8</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>6</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn></mrow></msup></math>.
</p>
<!--l. 3250-->
<p class="indent">
Many FIR filters are designed to have linear phase and, consequently, have symmetry in their coefficients,<span class="footnote-mark"><a href="#fn32x5" id="fn32x5-bk"><sup class="textsuperscript">32</sup></a></span><a id="x53-191004f32"></a> as indicated in Table&nbsp;<a href="ak_dsp_bookse43.html#x52-1890018">3.8<!--tex4ht:ref: tab:fir-types --></a>. This has been taken into account in the <span class="ec-lmri-10x-x-109">symmetric </span>FIR structure of Figure&nbsp;<a href="#x53-191002r2">3.53(b)<!--tex4ht:ref: fig:fir_direct_form_symmetric --></a>, which implements <!--l. 3251--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>3</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>8</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>8</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>4</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>3</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>5</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>2</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>6</mn></mrow></msup></math>.
</p>
<h4 class="subsectionHead">
<span class="titlemark">3.14.2</span>&nbsp;&nbsp;<a id="x53-1920003.14.2"></a>Structures for IIR filters
</h4>
<figure class="figure">
<p><a id="x53-19200454"></a></p>
<pre><code>                                   &lt;div class="center" </code></pre>
<blockquote class="blockquote">
<!--l. 3256-->
<p class="noindent">
<a id="x53-192001r1"></a>
</p>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="FiguresTex/iir_direct_1.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(a)</span> <span class="ec-lmr-9">Direct</span> <span class="ec-lmr-9">form</span> <span class="ec-lmr-9">I</span>
</div>
<pre><code> &lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt; &lt;a </code></pre>
id=“x53-192002r2”&gt;
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="FiguresTex/iir_direct_2_preparation.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(b)</span> <span class="ec-lmr-9">Preparation</span> <span class="ec-lmr-9">for</span> <span class="ec-lmr-9">direct</span> <span class="ec-lmr-9">form</span> <span class="ec-lmr-9">II</span>
</div>
<pre><code>&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt; &lt;a </code></pre>
id=“x53-192003r3”&gt;
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="FiguresTex/iir_direct_2.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(c)</span> <span class="ec-lmr-9">Direct</span> <span class="ec-lmr-9">form</span> <span class="ec-lmr-9">II</span>
</div>
<pre><code>&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;</code></pre>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.54: </span><span class="content">Two alternatives for implementing the digital filter of Eq.&nbsp;(<a href="#x53-192005r93">3.93<!--tex4ht:ref: eq:iir_example --></a>).</span>
</figcaption>
<!--tex4ht:label?: x53-19200454 -->


<!--l. 3265-->
<p class="indent">
IIR filters are often implemented using the <span class="ec-lmri-10x-x-109">transposed direct II </span>structure. It is convenient first to describe the <span class="ec-lmri-10x-x-109">direct I </span>structure via an example. Assume the task is to implement:
</p>

<table class="equation">
<tbody><tr>
<td>
<!--l. 3266-->
<p class="indent">
</p>
<!--l. 3266-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <mstyle id="x53-192005r93" class="label"></mstyle><!--endlabel--><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mi>B</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow> <mrow><mi>A</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>1</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>2</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>3</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>5</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn></mrow></msup></mrow> <mrow><mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>0</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>4</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>5</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>3</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>1</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>4</mn></mrow></msup></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </math>
</td>
<td class="eq-no">
(3.93)
</td>
</tr>

</tbody></table>
<!--l. 3270-->
<p class="indent">
Figure&nbsp;<a href="#x53-192001r1">3.54(a)<!--tex4ht:ref: fig:iir_direct_1 --></a> depicts the implementation of <!--l. 3270--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> using the direct form I structure. Note that 7 delay blocks were used, which corresponds to requiring 7 memory locations to store their outputs. In case each number is represented by 16 bits, this would require 14 bytes. It is possible to reduce this number to 8 bytes using a direct form II structure, as depicted in Figure&nbsp;<a href="#x53-192003r3">3.54(c)<!--tex4ht:ref: fig:iir_direct_2 --></a>.
</p>
<!--l. 3272-->
<p class="indent">
The direct form II can be derived from the form I by noting that <!--l. 3272--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> is a LTI system and the following is valid:
</p>
<!--tex4ht:inline-->
<!--l. 3276-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="left" class="align-star"> <mtr><mtd columnalign="right" class="align-odd"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">x</mo><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext>&nbsp;B(z)</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">→</mo><mi>z</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext>&nbsp;A(z)</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">→</mo><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mspace width="2em"></mspace></mtd> <mtd columnalign="right" class="align-label"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr><mtr><mtd columnalign="right" class="align-odd"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">≡</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext>&nbsp;A(z)</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">→</mo><mi>w</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext>&nbsp;B(z)</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">→</mo><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">.</mo><mspace width="2em"></mspace></mtd> <mtd columnalign="right" class="align-label"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr></mtable></math> <!--l. 3278-->
<p class="noindent">
</p><p>However, there is a disadvantage in implementing the poles first, as done in the direct form II: the signal can saturate in intermediate stages of filtering. When using the direct form I, the zeros tend to attenuate the signal and, after this attenuation, the poles amplify some frequency components. The net result should be no overflows. On the other hand, the direct form II first amplifies via the poles and later attenuates via the zeros. To circumvent this</p>
disadvantage while retaining the property of requiring the minimum amount of delay blocks, the direct form II can be transposed. In other words, while the form I implements <!--l. 3279--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>B</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> first (corresponding to the zeros), the form II implements <!--l. 3279--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>A</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> first. This new order allows sharing the delay blocks and reduces their number to the order of the filter (<!--l. 3279--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>4</mn></math> in the example of Figure&nbsp;<a href="#x53-19200454">3.54<!--tex4ht:ref: fig:iir_realizations --></a>). Figure&nbsp;<a href="#x53-192002r2">3.54(b)<!--tex4ht:ref: fig:iir_direct_2_preparation --></a> shows the intermediate step when one goes from direct form I to II.
<p></p>
<figure class="figure">
<p><a id="x53-19200855"></a></p>
<a id="x53-192006r1"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="FiguresTex/iir_transposed_preparation.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(a)</span> <span class="ec-lmr-9">Intermediate</span> <span class="ec-lmr-9">step</span>
</div>
</td>
</tr>

</tbody></table>
</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a id="x53-192007r2"></a>
<div class="subfigure">

<table>
<tbody><tr>
<td style="text-align:left">
<img src="FiguresTex/iir_transposed_final.png" alt="PIC" class="figure-img">
<div class="subfigcaption">
<span class="ec-lmr-9">(b)</span> <span class="ec-lmr-9">Reorganized</span>
</div>
</td>
</tr>

</tbody></table>
</div>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.55: </span><span class="content">IIR of Eq.&nbsp;(<a href="#x53-192005r93">3.93<!--tex4ht:ref: eq:iir_example --></a>) implemented with the transposed direct form II. The intermediate diagram in (a) is obtained by transposing Figure&nbsp;<a href="#x53-192003r3">3.54(c)<!--tex4ht:ref: fig:iir_direct_2 --></a>, while (b) simply reorganizes it.</span>
</figcaption>
<!--tex4ht:label?: x53-19200855 -->
</figure>
<!--l. 3289-->
<p class="indent">
The <span class="ec-lmri-10x-x-109">transposed direct form II </span>is based on the fact that with three steps: a) inverting the orientation of all “arrows” in signal flow graph, b) swapping input <!--l. 3289--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math> and output <!--l. 3289--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>, and c) swapping adders by signal “splitters” and vice-versa, one obtains a structure that implements the same difference equation of the original structure.
</p>
<!--l. 3291-->
<p class="indent">
If the IIR filter has order <!--l. 3291--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>M</mi> <mo class="MathClass-rel" stretchy="false">&gt;</mo> <mn>2</mn></math> it is common to organize its poles and zeros as <span class="ec-lmri-10x-x-109">second order sections </span>(SOS)<a id="dx53-192009"></a>. For example, a filter <!--l. 3291--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> of order <!--l. 3291--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>M</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>7</mn></math> can be implemented as a <span class="ec-lmri-10x-x-109">cascade </span>connection <!--l. 3291--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> of three SOS <!--l. 3291--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>H</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>H</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> and one first-order section <!--l. 3291--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>H</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> as indicated by:
</p>
<!--tex4ht:inline-->
<!--l. 3295-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="left" class="align-star"> <mtr><mtd columnalign="right" class="align-odd"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">x</mo><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext>&nbsp;H(z)</mtext></mstyle> <mo class="MathClass-rel" stretchy="false">→</mo><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mspace width="2em"></mspace></mtd> <mtd columnalign="right" class="align-label"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd></mtr><mtr><mtd columnalign="right" class="align-odd"></mtd> <mtd class="align-even"> <mo class="MathClass-rel" stretchy="false">≡</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext>&nbsp;<msub><mrow>H</mrow>&lt;mrow&nbsp; &gt;1&lt;/msub&nbsp; &gt;(z) <mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext><msub><mrow>H</mrow>&lt;mrow&nbsp; &gt;2&lt;/msub&nbsp; &gt;(z)</msub></mtext></mstyle> <mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext>&nbsp;<msub><mrow>H</mrow>&lt;mrow&nbsp; &gt;3&lt;/msub&nbsp; &gt;(z)</msub></mtext></mstyle> <mo class="MathClass-rel" stretchy="false">→</mo><mstyle class="fbox"><mtext>&nbsp;<msub><mrow>H</mrow>&lt;mrow&nbsp; &gt;4&lt;/msub&nbsp; &gt;(z)</msub></mtext></mstyle> <mo class="MathClass-rel" stretchy="false">→</mo> <mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-punc" stretchy="false">.</mo><mspace width="2em"> <mtd columnalign="right" class="align-label"></mtd> <mtd class="align-label"> <mspace width="2em"></mspace></mtd> <!--l. 3296-->
<p class="noindent">
It is also possible to decompose <!--l. 3296--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> into SOS sections that are organized in <span class="ec-lmri-10x-x-109">parallel</span>, such that <!--l. 3296--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>G</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>G</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>G</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>G</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> for this example, with <!--l. 3296--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>G</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> being a first-order section. The commands <span class="ec-lmss-10x-x-109">residue </span>and <span class="ec-lmss-10x-x-109">residuez</span><a id="dx53-192010"></a> are helpful to obtain the partial fractions expansion in the Laplace and Z transform domains, respectively, and are useful when designing the parallel structure. Using <span class="ec-lmss-10x-x-109">residuez </span>and assuming that <!--l. 3296--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> is given by Eq.&nbsp;(<a href="#x53-192005r93">3.93<!--tex4ht:ref: eq:iir_example --></a>), one can find the parallel structure with the commands:
</p>
<!--l. 3297-->
<figcaption class="caption figure-caption">
<span class="id">Listing&nbsp;3.31: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_residuez.m</span>
</figcaption>
<!--tex4ht:label?: x53-192011r3.14.2 -->
<pre class="lstinputlisting" id="listing-107"><span class="label"><a id="x53-192013r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[0.6</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">0.1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">2.3</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">4.5];</span></span> 
<span class="label"><a id="x53-192014r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">a</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-1.2</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">0.4</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">5.2</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">1.1];</span></span> 
<span class="label"><a id="x53-192015r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">residuez</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">a</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">fraction</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">expansion</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Z</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">domain</span></span> 
<span class="label"><a id="x53-192016r4"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">note</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">that</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">[</span></span><span style="color:#005900"><span class="ec-lmtt-9">b</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"><span class="ec-lmtt-9">a</span></span><span style="color:#005900"><span class="ec-lmtt-9">]=</span></span><span style="color:#005900"><span class="ec-lmtt-9">residuez</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">r</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"><span class="ec-lmtt-9">p</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"><span class="ec-lmtt-9">k</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">reconstructs</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">b</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"><span class="ec-lmtt-9">a</span></span> 
<span class="label"><a id="x53-192017r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">hence</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">create</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">two</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">SOS</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">with</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">pairs</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">fractions</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span> 
<span class="label"><a id="x53-192018r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">b1</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">a1</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">residuez</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">],[</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">(2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">],0)</span></span> 
<span class="label"><a id="x53-192019r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">b2</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">a2</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">residuez</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">(3)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">r</span></span><span style="color:#000000"><span class="ec-lmtt-9">(4)</span></span><span style="color:#000000"><span class="ec-lmtt-9">],[</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">(3)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">(4)</span></span><span style="color:#000000"><span class="ec-lmtt-9">],0)</span></span>
  </pre>
<!--l. 3307-->
<p class="indent">
The hint is that <span class="ec-lmss-10x-x-109">residuez </span>can be used for decomposing in fractions and also for organizing pairs of fractions as second-order sections. The last two commands in the previous code reorganizes pairs of fractions, i. e., it implements
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!--l. 3308-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <mfrac><mrow><msub><mrow><mi>r</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow> <mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>p</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow></mfrac> <mo class="MathClass-bin" stretchy="false">+</mo> <mfrac><mrow><msub><mrow><mi>r</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow> <mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow></mfrac> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><msub><mrow><mi>r</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>r</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">−</mo> <mo class="MathClass-open" stretchy="false">(</mo><msub><mrow><mi>r</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>r</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>p</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-close" stretchy="false">)</mo><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow> <mrow><mo class="MathClass-open" stretchy="false">(</mo><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>p</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-open" stretchy="false">(</mo><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <msub><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></mrow></mfrac> <mo class="MathClass-punc" stretchy="false">,</mo> </math>
</td>
</tr>

</tbody></table>
<!--l. 3311-->
<p class="indent">
where <!--l. 3311--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>r</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is the residue of pole <!--l. 3311--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>p</mi></mrow><mrow><mi>i</mi></mrow></msub></math>. Therefore, Eq.&nbsp;(<a href="#x53-192005r93">3.93<!--tex4ht:ref: eq:iir_example --></a>) can be written as
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!--l. 3313-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>1</mn><mn>6</mn><mn>3</mn><mn>7</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>3</mn><mn>5</mn><mn>4</mn><mn>2</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow> <mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>2</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn><mn>6</mn><mn>6</mn><mn>9</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>0</mn><mn>3</mn><mn>9</mn><mn>9</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow></mfrac> <mo class="MathClass-bin" stretchy="false">+</mo> <mfrac><mrow><mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>7</mn><mn>6</mn><mn>3</mn><mn>7</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>0</mn><mn>2</mn><mn>2</mn><mn>6</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow> <mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>4</mn><mn>6</mn><mn>6</mn><mn>9</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn><mn>7</mn><mn>2</mn><mn>3</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow></mfrac><mo class="MathClass-punc" stretchy="false">.</mo> </math>
</td>
</tr>

</tbody></table>
<!--l. 3317-->
<p class="indent">
The cascade structure with each SOS implemented with a transposed direct form II can be considered the most popular realization and will be emphasized here.
</p>
<!--l. 3319-->
<p class="indent">
</p><p>Decomposing <!--l. 3319--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> in sections allows an easier control of issues provoked by using finite precision. For example, the poles with higher quality factor <!--l. 3319--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi></math> can be placed last in the cascade and pairs of zeros “paired” (or “matched”) to pairs of poles to minimize the chances of signal saturation at intermediate stages.</p>
<p></p>
<!--l. 3321-->
<p class="indent">
<a id="x53-1920229"></a>
</p>
<figure class="float figure">
<figcaption class="caption figure-caption">
<span class="id">Table&nbsp;3.9: </span><span class="content">Matlab/Octave functions to convert among the formats: transfer function (tf), zero-pole (zp) and second order sections (sos). The number two is a mnemonic for “to”.</span>
</figcaption>
<!--tex4ht:label?: x53-1920229 -->
<div class="tabular">

<table id="TBL-111" class="tabular">
<colgroup id="TBL-111-1g">
<col id="TBL-111-1">
<col id="TBL-111-2">
<col id="TBL-111-3">
<col id="TBL-111-4">
</colgroup>
<tbody><tr style="vertical-align:baseline;" id="TBL-111-1-">
<td style="text-align:center; white-space:nowrap;" id="TBL-111-1-1" class="td11">
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-1-2" class="td11">
<span class="ec-lmr-10">tf </span>
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-1-3" class="td11">
<span class="ec-lmr-10">zp </span>
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-1-4" class="td11">
<span class="ec-lmr-10">sos </span>
</td>
</tr>
<tr style="vertical-align:baseline;" id="TBL-111-2-">
<td style="text-align:center; white-space:nowrap;" id="TBL-111-2-1" class="td11">
<span class="ec-lmr-10">tf </span>
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-2-2" class="td11">
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-2-3" class="td11">
<span class="ec-lmr-10">tf2zp </span>
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-2-4" class="td11">
<span class="ec-lmr-10">tf2sos </span>
</td>
</tr>
<tr style="vertical-align:baseline;" id="TBL-111-3-">
<td style="text-align:center; white-space:nowrap;" id="TBL-111-3-1" class="td11">
<span class="ec-lmr-10">zp </span>
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-3-2" class="td11">
<span class="ec-lmr-10">zp2tf </span>
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-3-3" class="td11">
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-3-4" class="td11">
<span class="ec-lmr-10">zp2sos </span>
</td>
</tr>
<tr style="vertical-align:baseline;" id="TBL-111-4-">
<td style="text-align:center; white-space:nowrap;" id="TBL-111-4-1" class="td11">
<span class="ec-lmr-10">sos </span>
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-4-2" class="td11">
<span class="ec-lmr-10">sos2tf </span>
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-4-3" class="td11">
<span class="ec-lmr-10">sos2zp </span>
</td>
<td style="text-align:center; white-space:nowrap;" id="TBL-111-4-4" class="td11">
</td>
</tr>
<tr style="vertical-align:baseline;" id="TBL-111-5-">
<td style="text-align:center; white-space:nowrap;" id="TBL-111-5-1" class="td11">
</td>
</tr>

</tbody></table>
<pre><code>                                                                   &lt;/div&gt;
                                                                          
                                                                          </code></pre>
</div></figure>
<!--l. 3337-->
<p class="indent">
Matlab/Octave offers several functions to deal with SOS, as indicated in Table&nbsp;<a href="#x53-1920229">3.9<!--tex4ht:ref: tab:tfzpsos --></a>. The description of <!--l. 3337--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> with <!--l. 3337--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>S</mi></math> sections uses a matrix of dimension <!--l. 3337--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>S</mi> <mo class="MathClass-bin" stretchy="false">×</mo> <mn>6</mn></math>, where each row describes a SOS
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!--l. 3338-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <msub><mrow><mi>H</mi></mrow><mrow><mi>s</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mfrac><mrow><msub><mrow><mi>b</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow> <mrow><mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>0</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow></mfrac> </math>
</td>
</tr>

</tbody></table>
<!--l. 3341-->
<p class="indent">
via a vector <!--l. 3341--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-open" stretchy="false">[</mo><msub><mrow><mi>b</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>b</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><mn>1</mn><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class="MathClass-punc" stretchy="false">,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class="MathClass-close" stretchy="false">]</mo></math>. For example, Eq.&nbsp;(<a href="#x53-192005r93">3.93<!--tex4ht:ref: eq:iir_example --></a>) can be decomposed in SOS with:
</p>
<!--l. 3342-->
<figcaption class="caption figure-caption">
<span class="id">Listing&nbsp;3.32: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_SOS_decomposition.m</span>
</figcaption>
<!--tex4ht:label?: x53-192023r3.14.2 -->
<pre class="lstinputlisting" id="listing-108"><span class="label"><a id="x53-192025r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[0.6</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">0.1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">2.3</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">4.5];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">numerator</span></span> 
<span class="label"><a id="x53-192026r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">=[1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-1.2</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">0.4</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">5.2</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">1.1];</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">denominator</span></span> 
<span class="label"><a id="x53-192027r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">tf2zp</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">convert</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">zero</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">pole</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">improved</span></span> 
<span class="label"><a id="x53-192028r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">sos</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">g</span></span><span style="color:#000000"><span class="ec-lmtt-9">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">zp2sos</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">SOS</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">g</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">is</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">overall</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">gain</span></span>
  </pre>
<!--l. 3349-->
<p class="indent">
</p><p>The Octave implementation of the <span class="ec-lmss-10x-x-109">zp2sos </span>function is slightly different from Matlab’s. The gain <span class="ec-lmss-10x-x-109">g=0.6 </span>obtained with the previous commands is the same for both Matlab and Octave. But the <span class="ec-lmss-10x-x-109">sos </span>matrix in Matlab is:</p>
<p></p>
<pre class="verbatim" id="verbatim-5">sos&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;1.0000&nbsp;&nbsp;&nbsp;&nbsp;1.3689&nbsp;&nbsp;&nbsp;&nbsp;1.0000&nbsp;&nbsp;&nbsp;&nbsp;1.4669&nbsp;&nbsp;&nbsp;&nbsp;0.2723
&nbsp;&nbsp;&nbsp;&nbsp;1.0000&nbsp;&nbsp;&nbsp;-1.2022&nbsp;&nbsp;&nbsp;&nbsp;5.4790&nbsp;&nbsp;&nbsp;&nbsp;1.0000&nbsp;&nbsp;&nbsp;-2.6669&nbsp;&nbsp;&nbsp;&nbsp;4.0399
</pre>
<!--l. 3353-->
<p class="nopar">
</p><p>while in Octave it is:</p>
<p></p>
<pre class="verbatim" id="verbatim-6">sos&nbsp;=&nbsp;1.00000&nbsp;&nbsp;-1.20220&nbsp;&nbsp;&nbsp;5.47898&nbsp;&nbsp;&nbsp;1.00000&nbsp;&nbsp;-2.66692&nbsp;&nbsp;&nbsp;4.03987
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.00000&nbsp;&nbsp;&nbsp;1.36887&nbsp;&nbsp;-0.00000&nbsp;&nbsp;&nbsp;1.00000&nbsp;&nbsp;&nbsp;1.46692&nbsp;&nbsp;&nbsp;0.27229
</pre>
<!--l. 3358-->
<p class="nopar">
The comparison shows that the order of SOS is inverted: by default Matlab orders the sections with poles closest to the unit circle (higher <!--l. 3359--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>Q</mi></math>) last in the cascade while Octave performs the opposite. Another difference is the representation of the SOS with a numerator <!--l. 3359--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-open" stretchy="false">(</mo><mn>1</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>3</mn><mn>6</mn><mn>8</mn><mn>9</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup><mo class="MathClass-close" stretchy="false">)</mo></math> of order 1. The Matlab’s version is
</p>

<table class="equation-star">
<tbody><tr>
<td>
<!--l. 3360-->
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" class="equation"> <mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>3</mn><mn>6</mn><mn>8</mn><mn>9</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup></mrow> <mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>4</mn><mn>6</mn><mn>6</mn><mn>9</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>0</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn><mn>7</mn><mn>2</mn><mn>3</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mfrac><mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>2</mn><mn>0</mn><mn>2</mn><mn>2</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>5</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>4</mn><mn>7</mn><mn>9</mn><mn>0</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow> <mrow><mn>1</mn> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>2</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>6</mn><mn>6</mn><mn>6</mn><mn>9</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>1</mn></mrow></msup> <mo class="MathClass-bin" stretchy="false">+</mo> <mn>4</mn><mo class="MathClass-punc" stretchy="false">.</mo><mn>0</mn><mn>3</mn><mn>9</mn><mn>9</mn><msup><mrow><mi>z</mi></mrow><mrow><mo class="MathClass-bin" stretchy="false">−</mo><mn>2</mn></mrow></msup></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mo class="MathClass-punc" stretchy="false">,</mo> </math>
</td>
</tr>

</tbody></table>
<!--l. 3363-->
<p class="indent">
which is represented using transposed direct form II sections in Figure&nbsp;<a href="#x53-19203156">3.56<!--tex4ht:ref: fig:cascade_sos --></a>.
</p>
<figure class="figure">
<p><a id="x53-19203156"></a></p>
<!--l. 3368-->
<p class="noindent">
<img src="FiguresTex/cascade_sos.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.56: </span><span class="content">Realization of Eq.&nbsp;(<a href="#x53-192005r93">3.93<!--tex4ht:ref: eq:iir_example --></a>) with transposed direct form II second order sections.</span>
</figcaption>
<!--tex4ht:label?: x53-19203156 -->
</figure>
<!--l. 3372-->
<p class="indent">
It is important to note that using zero/pole (<!--l. 3372--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-open" stretchy="false">[</mo><mi>z</mi><mo class="MathClass-punc" stretchy="false">,</mo><mi>p</mi><mo class="MathClass-punc" stretchy="false">,</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></math> syntax) to design IIR filters is better than using transfer functions with respect to numerical accuracy. After obtaining <!--l. 3372--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-open" stretchy="false">[</mo><mi>z</mi><mo class="MathClass-punc" stretchy="false">,</mo><mi>p</mi><mo class="MathClass-punc" stretchy="false">,</mo><mi>k</mi><mo class="MathClass-close" stretchy="false">]</mo></math>, one can analyze or implement the filter using SOS (via <span class="ec-lmss-10x-x-109">zp2sos</span>). For filters of order higher than 7, numerical problems may happen when forming the transfer function (<!--l. 3372--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mo class="MathClass-open" stretchy="false">[</mo><mi>b</mi><mo class="MathClass-punc" stretchy="false">,</mo><mi>a</mi><mo class="MathClass-close" stretchy="false">]</mo></math> syntax).<span class="footnote-mark"><a href="#fn33x5" id="fn33x5-bk"><sup class="textsuperscript">33</sup></a></span><a id="x53-192032f33"></a>
</p>
<h4 class="subsectionHead">
<span class="titlemark">3.14.3</span>&nbsp;&nbsp;<a id="x53-1930003.14.3"></a>Running a digital filter using filter or conv
</h4>
<!--l. 3377-->
<p class="noindent">
Any LTI system <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> can be represented by an impulse response <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>. Having <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>, one can use convolution to obtain <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>y</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>x</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo><mo class="MathClass-bin" stretchy="false">∗</mo><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>. On a computer, it may be necessary to truncate an infinite duration <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>. Matlab/Octave has the function <span class="ec-lmss-10x-x-109">impz </span>that, based on <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math>, can obtain a vector <span class="ec-lmss-10x-x-109">h </span>representing <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>h</mi><mo class="MathClass-open" stretchy="false">[</mo><mi>n</mi><mo class="MathClass-close" stretchy="false">]</mo></math>. However, if <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> <mo class="MathClass-rel" stretchy="false">=</mo> <mi>B</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo><mo class="MathClass-bin" stretchy="false">∕</mo><mi>A</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math> represents a LCCDE, it is typically more efficient to implement an IIR via its difference equation with <span class="ec-lmss-10x-x-109">y=filter(B,A,x) </span>than via convolution with <span class="ec-lmss-10x-x-109">y=conv(x,h)</span>. When comparing the result of these two options, it is important to note that <span class="ec-lmss-10x-x-109">conv </span>outputs a vector of length <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>N</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>N</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">+</mo> <msub><mrow><mi>N</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class="MathClass-bin" stretchy="false">−</mo> <mn>1</mn></math>, where <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>N</mi></mrow><mrow><mi>x</mi></mrow></msub></math> and <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>N</mi></mrow><mrow><mi>h</mi></mrow></msub></math> are the lengths of <span class="ec-lmss-10x-x-109">x </span>and <span class="ec-lmss-10x-x-109">h</span>, respectively, while <span class="ec-lmss-10x-x-109">filter </span>always has <!--l. 3377--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>N</mi></mrow><mrow><mi>y</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <msub><mrow><mi>N</mi></mrow><mrow><mi>x</mi></mrow></msub></math> because it truncates the tail of the corresponding convolution.
</p>
<!--l. 3379-->
<p class="noindent">
</p>
<h4 class="subsectionHead">
<span class="titlemark">3.14.4</span>&nbsp;&nbsp;<a id="x53-1940003.14.4"></a>Effects of finite precision
</h4>
<!--l. 3381-->
<p class="noindent">
When implementing a digital filter using finite precision there are two aspects to consider:
</p>
<pre><code> &lt;ul class="itemize1"&gt;
 &lt;li class="itemize"&gt;
 &lt;!--l. 3383--&gt;&lt;p class="noindent" &gt;The quantization of the filter coefficients of &lt;!--l. 3383--&gt;&lt;math </code></pre>
<p>xmlns=“http://www.w3.org/1998/Math/MathML”<br>
display=“inline” &gt;<mi>H</mi><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo> leads to another transfer function <!--l. 3383--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>H</mi></mrow><mrow><mi>q</mi></mrow></msub><mo class="MathClass-open" stretchy="false">(</mo><mi>z</mi><mo class="MathClass-close" stretchy="false">)</mo></math></p>
<pre><code> with, eventually, displaced poles and zeros, frequency response, etc.
 &lt;/p&gt;&lt;/li&gt;
 &lt;li class="itemize"&gt;
 &lt;!--l. 3384--&gt;&lt;p class="noindent" &gt;During runtime, the result of multiplications and additions are quantized and
 this error impacts the system output. This is called round-off or rounding error.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</code></pre>
<!--l. 3387-->
<p class="indent">
It is possible to implement digital filters using floating-point arithmetics. This is performed by Matlab/Octave, for example, which can operate with double precision (each number represented by 64 bits). This is considered the representation with infinite precision here. For the study of finite precision effects, it will be assumed a fixed-point representation.
</p>
<!--l. 3389-->
<p class="noindent">
</p>
<h5 class="subsubsectionHead">
<a id="x53-195000"></a>Quantization of the filter coefficients via examples
</h5>
<!--l. 3391-->
<p class="noindent">
This section briefly discusses the issue of quantizing the filter coefficients via examples. Recall from Section&nbsp;<a href="ak_dsp_bookse90.html#x102-324000B.28.1">B.28.1<!--tex4ht:ref: sec:fixedPoint --></a> that <!--l. 3391--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>b</mi></mrow><mrow><mi>i</mi></mrow></msub></math> and <!--l. 3391--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>b</mi></mrow><mrow><mi>f</mi></mrow></msub></math> are the number of bits assigned to the integer and fractional part of the number, respectively.
</p>
<!--l. 3394-->
<p class="indent">
In order to study the effect of coefficient quantization, a 8-th order bandpass filter was used. It was designed with the commands in Listing&nbsp;<a href="#x53-195001r33">3.33<!--tex4ht:ref: code:snip_systems_coefficient_quantization --></a>.
</p>
<!--l. 3396-->
<figcaption class="caption figure-caption">
<span class="id">Listing&nbsp;3.33: </span><span class="content">MatlabOctaveCodeSnippets/snip_systems_coefficient_quantization.m</span>
</figcaption>
<!--tex4ht:label?: x53-195001r -->
<pre class="lstinputlisting" id="listing-109"><span class="label"><a id="x53-195003r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Apass</span></span><span style="color:#000000"><span class="ec-lmtt-9">=5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">maximum</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">ripple</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">passband</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">dB</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x53-195004r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Astop</span></span><span style="color:#000000"><span class="ec-lmtt-9">=40;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">minimum</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">attenuation</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">at</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">stopband</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">dB</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x53-195005r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">=500;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">sampling</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span> 
<span class="label"><a id="x53-195006r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wr1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=10/(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">normalized</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">frequencies</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">from</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">0</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">1)</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span> 
<span class="label"><a id="x53-195007r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=20/(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">frequencies</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Hz</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">are</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">divided</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">by</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">...</span></span> 
<span class="label"><a id="x53-195008r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wp2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=120/(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Nyquist</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">frequency</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Fs</span></span><span style="color:#005900"><span class="ec-lmtt-9">/2</span></span> 
<span class="label"><a id="x53-195009r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Wr2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=140/(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Fs</span></span><span style="color:#000000"><span class="ec-lmtt-9">/2)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x53-195010r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ellipord</span></span><span style="color:#000000"><span class="ec-lmtt-9">([</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Wp2</span></span><span style="color:#000000"><span class="ec-lmtt-9">],[</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wr1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Wr2</span></span><span style="color:#000000"><span class="ec-lmtt-9">],</span></span><span style="color:#000000"><span class="ec-lmtt-9">Apass</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Astop</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">order</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"><span class="ec-lmtt-9">Wp</span></span> 
<span class="label"><a id="x53-195011r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">ellip</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Apass</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Astop</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Wp</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">design</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">digital</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span> 
<span class="label"><a id="x53-195012r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">zp2tf</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">z</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">p</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">k</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">zero</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">pole</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">transfer</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">function</span></span>
  </pre>
<!--l. 3410-->
<p class="indent">
After the filter is designed, with its coefficients represented in double precision, Matlab or Octave can be used to find their fixed point representations.
</p>
<!--l. 3412-->
<p class="indent">
Using Matlab, the coefficients of the filter can be quantized with the commands in Listing&nbsp;<a href="#x53-195015r34">3.34<!--tex4ht:ref: code:snip_systems_Matlab_coef_quant --></a>.
</p>
<!--l. 3414-->
<figcaption class="caption figure-caption">
<span class="id">Listing&nbsp;3.34: </span><span class="content">MatlabOnly/snip_systems_Matlab_coef_quant.m</span>
</figcaption>
<!--tex4ht:label?: x53-195015r -->
<pre class="lstinputlisting" id="listing-110"><span class="label"><a id="x53-195017r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">=7;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bits</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">integer</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">part</span></span> 
<span class="label"><a id="x53-195018r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">=8;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bits</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">decimal</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">part</span></span> 
<span class="label"><a id="x53-195019r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">+1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">total</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bits</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">inclusing</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">sign</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bit</span></span> 
<span class="label"><a id="x53-195020r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">signed</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">use</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">signed</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">numbers</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">i</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"><span class="ec-lmtt-9">e</span></span><span style="color:#005900"><span class="ec-lmtt-9">.,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">not</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">"</span></span><span style="color:#005900"><span class="ec-lmtt-9">unsigned</span></span><span style="color:#005900"><span class="ec-lmtt-9">")</span></span> 
<span class="label"><a id="x53-195021r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bq</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fi</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">signed</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantize</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">coefficients</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">B</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Q7</span></span><span style="color:#005900"><span class="ec-lmtt-9">.8</span></span> 
<span class="label"><a id="x53-195022r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Aq</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fi</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">signed</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantize</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">coefficients</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">A</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Q7</span></span><span style="color:#005900"><span class="ec-lmtt-9">.8</span></span> 
<span class="label"><a id="x53-195023r7"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">zplane</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">double</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bq</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">double</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Aq</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">cast</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">double</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">before</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">manipulating</span></span>
  </pre>
<!--l. 3416-->
<p class="indent">
</p><p>Using Octave, the quantization code is Listing&nbsp;<a href="#x53-195024r35">3.35<!--tex4ht:ref: code:snip_systems_Octave_coef_quant --></a>.</p>
<p></p>
<!--l. 3418-->
<figcaption class="caption figure-caption">
<span class="id">Listing&nbsp;3.35: </span><span class="content">OctaveOnly/snip_systems_Octave_coef_quant.m</span>
</figcaption>
<!--tex4ht:label?: x53-195024r -->
<pre class="lstinputlisting" id="listing-111"><span class="label"><a id="x53-195026r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">=7;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bits</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">integer</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">part</span></span> 
<span class="label"><a id="x53-195027r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">=8;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bits</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">decimal</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">part</span></span> 
<span class="label"><a id="x53-195028r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Bq</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fixed</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantize</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">coefficients</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">B</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Q7</span></span><span style="color:#005900"><span class="ec-lmtt-9">.8</span></span> 
<span class="label"><a id="x53-195029r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Aq</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fixed</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantize</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">coefficients</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">A</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Q7</span></span><span style="color:#005900"><span class="ec-lmtt-9">.8</span></span>
  </pre>
<figure class="figure">
<p><a id="x53-19503257"></a></p>
<!--l. 3428-->
<p class="noindent">
<img src="Figures/quantized_filter1.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.57: </span><span class="content">The original magnitude response of the 8-th order filter and its 16-bits per coefficient Q7.8 quantized version (<!--l. 3429--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>b</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>7</mn></math> and <!--l. 3429--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>b</mi></mrow><mrow><mi>f</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>8</mn></math>).</span>
</figcaption>
<!--tex4ht:label?: x53-19503257 -->
</figure>
<figure class="figure">
<p><a id="x53-19503358"></a></p>
<!--l. 3434-->
<p class="noindent">
<img src="Figures/quantized_filter1_zp.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.58: </span><span class="content">Zeros and poles for the original and quantized filters discussed in Figure&nbsp;<a href="#x53-19503257">3.57<!--tex4ht:ref: fig:quantized_filter1 --></a>.</span>
</figcaption>
<!--tex4ht:label?: x53-19503358 -->
</figure>
<!--l. 3439-->
<p class="indent">
Figure&nbsp;<a href="#x53-19503257">3.57<!--tex4ht:ref: fig:quantized_filter1 --></a> shows the magnitude responses of the original and quantized filters, and one can see that there is a discrepancy close to DC. Figure&nbsp;<a href="#x53-19503358">3.58<!--tex4ht:ref: fig:quantized_filter1_zp --></a> shows zeros and poles for the same pair of filters. One can note that the pair of poles close to DC get transformed into real poles. This impacts the frequency response and creates the mentioned discrepancy.
</p>
<figure class="figure">
<p><a id="x53-19503459"></a></p>
<!--l. 3444-->
<p class="noindent">
<img src="Figures/quantized_filter2.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.59: </span><span class="content">Magnitude of quantized filter with Q10.15 using 26 bits (<!--l. 3445--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>b</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>0</mn></math> and <!--l. 3445--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>b</mi></mrow><mrow><mi>f</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>5</mn></math>) and the original filter of order 8 in Figure&nbsp;<a href="#x53-19503257">3.57<!--tex4ht:ref: fig:quantized_filter1 --></a>.</span>
</figcaption>
<!--tex4ht:label?: x53-19503459 -->
</figure>
<!--l. 3450-->
<p class="indent">
Figure&nbsp;<a href="#x53-19503459">3.59<!--tex4ht:ref: fig:quantized_filter2 --></a> is the result of increasing the number of bits to <!--l. 3450--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>b</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mn>6</mn></math>, with <!--l. 3450--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>b</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>0</mn></math> and <!--l. 3450--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>b</mi></mrow><mrow><mi>f</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>5</mn></math> when quantizing the eighth-order filter. It can be observed that good results are obtained. However, <!--l. 3450--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>b</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mn>6</mn></math> bits does not always guarantee good results. The following example illustrates that a good choice of <!--l. 3450--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>b</mi></math> depends on aspects such as the filter order.
</p>
<figure class="figure">
<p><a id="x53-19503560"></a></p>
<!--l. 3454-->
<p class="noindent">
<img src="Figures/quantized_filter3.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.60: </span><span class="content">Magnitude responses for original filter of order 14 and its quantized version with <!--l. 3455--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>b</mi> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>2</mn><mn>6</mn></math> bits (<!--l. 3455--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>b</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>0</mn></math> and <!--l. 3455--><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><msub><mrow><mi>b</mi></mrow><mrow><mi>f</mi></mrow></msub> <mo class="MathClass-rel" stretchy="false">=</mo> <mn>1</mn><mn>5</mn></math>).</span>
</figcaption>
<!--tex4ht:label?: x53-19503560 -->
</figure>
<figure class="figure">
<p><a id="x53-19503661"></a></p>
<!--l. 3460-->
<p class="noindent">
<img src="Figures/quantized_filter3_zp.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.61: </span><span class="content">Zeros and poles for the corresponding filter in Figure&nbsp;<a href="#x53-19503560">3.60<!--tex4ht:ref: fig:quantized_filter3 --></a>. Note the occurrence of poles outside the unit circle, which make the quantized filter unstable.</span>
</figcaption>
<!--tex4ht:label?: x53-19503661 -->
</figure>
<!--l. 3464-->
<p class="indent">
Changing the filter mask of the original 8-th filter to impose <span class="ec-lmss-10x-x-109">Astop=80 </span>increases the filter order from 8 to 14. Now, quantization with 26 bits generates an unstable filter as illustrated in Figure&nbsp;<a href="#x53-19503560">3.60<!--tex4ht:ref: fig:quantized_filter3 --></a> and Figure&nbsp;<a href="#x53-19503661">3.61<!--tex4ht:ref: fig:quantized_filter3_zp --></a>.
</p>
<h5 class="subsubsectionHead">
<a id="x53-196000"></a>Roundoff errors during the signal processing
</h5>
<!--l. 3469-->
<p class="noindent">
The analysis of the quantization error created along the filtering process is more involved than observing the effect of filter coefficients quantization. Note that the term roundoff is used even when truncation is the actual operation, as done by Octave’s fixed point package.
</p>
<!--l. 3471-->
<p class="indent">
When interested on evaluating the roundoff errors, it does not suffice to pass objects of the fixed point class (called FixedPoint and embedded.fi in Octave and Matlab, respectively) to a specific function. For example, considering <span class="ec-lmss-10x-x-109">filter</span>, the internal operations within this function may not have its results quantized. To study the roundoff errors, one typically has to write a function that internally represents the numbers in fixed point too. Listing&nbsp;<a href="#x53-196001r36">3.36<!--tex4ht:ref: code:snip_systems_filtering_precision --></a> and Listing&nbsp;<a href="#x53-196018r37">3.37<!--tex4ht:ref: code:roundoffErrors --></a> illustrate this point. Octave was adopted for the former code and Matlab for the latter. The commands for dealing with fixed point in both are discussed in Section&nbsp;<a href="ak_dsp_bookse90.html#x102-324000B.28.1">B.28.1<!--tex4ht:ref: sec:fixedPoint --></a>.
</p>
<!--l. 3476-->
<figcaption class="caption figure-caption">
<span class="id">Listing&nbsp;3.36: </span><span class="content">OctaveOnly/snip_systems_filtering_precision.m</span>
</figcaption>
<!--tex4ht:label?: x53-196001r -->
<pre class="lstinputlisting" id="listing-112"><span class="label"><a id="x53-196003r1"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=100;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span> 
<span class="label"><a id="x53-196004r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=20*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">gerante</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">random</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span> 
<span class="label"><a id="x53-196005r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">=4;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">order</span></span> 
<span class="label"><a id="x53-196006r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">,0.3)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">design</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">IIR</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span> 
<span class="label"><a id="x53-196007r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Define</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">fixed</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">point</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">elements</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span> 
<span class="label"><a id="x53-196008r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">=3;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bits</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">integer</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">part</span></span> 
<span class="label"><a id="x53-196009r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">=5;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bits</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">fractional</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">part</span></span> 
<span class="label"><a id="x53-196010r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">xf</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fixed</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantize</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span> 
<span class="label"><a id="x53-196011r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fixed</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantize</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">numerator</span></span> 
<span class="label"><a id="x53-196012r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">Af</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fixed</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantize</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">denominator</span></span> 
<span class="label"><a id="x53-196013r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y1</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">with</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">("</span></span><span style="color:#005900"><span class="ec-lmtt-9">infinite</span></span><span style="color:#005900"><span class="ec-lmtt-9">")</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">double</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">precision</span></span> 
<span class="label"><a id="x53-196014r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y2</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Af</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantized</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">only</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">coefficients</span></span> 
<span class="label"><a id="x53-196015r13"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y3</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Af</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">xf</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantized</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">coeffficients</span></span> 
<span class="label"><a id="x53-196016r14"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y4</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">xf</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantized</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">only</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span> 
<span class="label"><a id="x53-196017r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#000000"><span class="ec-lmtt-9">y5</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fixed</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y1</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantized</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">coefficients</span></span>
  </pre>
<!--l. 3478-->
<p class="indent">
Listing&nbsp;<a href="#x53-196001r36">3.36<!--tex4ht:ref: code:snip_systems_filtering_precision --></a> uses <span class="ec-lmss-10x-x-109">filter </span>and illustrates how the signals and coefficients can be quantized. When observing the signal <span class="ec-lmss-10x-x-109">y5</span>, one may consider that all the processing used fixed point numbers in Q3.5 format. However, the internal variables used by filter were not quantized. In other words, internally, <span class="ec-lmss-10x-x-109">filter </span>does not uses finite precision arithmetics. This is circumvented in Listing&nbsp;<a href="#x53-196018r37">3.37<!--tex4ht:ref: code:roundoffErrors --></a>.
</p>
<!--l. 3495-->
<figcaption class="caption figure-caption">
<span class="id">Listing&nbsp;3.37: </span><span class="content">MatlabBookFigures/figs_systems_roundoffErrors</span>
</figcaption>
<!--tex4ht:label?: x53-196018r -->
<pre class="lstinputlisting" id="listing-113"><span class="label"><a id="x53-196020r1"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">function</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">yq_my</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">y_my</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">y_matlab</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#000000"><span class="ec-lmtt-9">figs_systems_roundoffErrors</span></span> 
<span class="label"><a id="x53-196021r2"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=30;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span> 
<span class="label"><a id="x53-196022r3"></a></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">=7*</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">randn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(1,</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">generate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">N</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">random</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span> 
<span class="label"><a id="x53-196023r4"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">zeros</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">size</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">pre</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">allocate</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">space</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span> 
<span class="label"><a id="x53-196024r5"></a><span class="ec-lmr-6">5</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">=4;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">order</span></span> 
<span class="label"><a id="x53-196025r6"></a></span><span style="color:#000000"><span class="ec-lmtt-9">[</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">]=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">butter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">,0.3)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">design</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">IIR</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span> 
<span class="label"><a id="x53-196026r7"></a></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">=2;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bits</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">integer</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">part</span></span> 
<span class="label"><a id="x53-196027r8"></a></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">=3;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bits</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">for</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">fractional</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">part</span></span> 
<span class="label"><a id="x53-196028r9"></a></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">bi</span></span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">+1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">total</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">number</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bits</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">inclusing</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">sign</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">bit</span></span> 
<span class="label"><a id="x53-196029r10"></a><span class="ec-lmr-6">10</span></span><span style="color:#000000"><span class="ec-lmtt-9">signed</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">use</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">signed</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">numbers</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">i</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span><span style="color:#005900"><span class="ec-lmtt-9">e</span></span><span style="color:#005900"><span class="ec-lmtt-9">.,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">not</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">"</span></span><span style="color:#005900"><span class="ec-lmtt-9">unsigned</span></span><span style="color:#005900"><span class="ec-lmtt-9">")</span></span> 
<span class="label"><a id="x53-196030r11"></a></span><span style="color:#000000"><span class="ec-lmtt-9">xf</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fi</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">signed</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">create</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">variables</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">with</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">fixed</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">point</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span> 
<span class="label"><a id="x53-196031r12"></a></span><span style="color:#000000"><span class="ec-lmtt-9">yf</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fi</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">signed</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span> 
<span class="label"><a id="x53-196032r13"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Bq</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fi</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">signed</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantized</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">B</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">coefficients</span></span> 
<span class="label"><a id="x53-196033r14"></a></span><span style="color:#000000"><span class="ec-lmtt-9">Aq</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fi</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">signed</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">quantized</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">A</span></span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">z</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">coefficients</span></span> 
<span class="label"><a id="x53-196034r15"></a><span class="ec-lmr-6">15</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">if</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bq</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">==0</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">||</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">sum</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">abs</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Aq</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">==0</span></span> 
<span class="label"><a id="x53-196035r16"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">error</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">Quantized</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">filter</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">has</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">B</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">z</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">)</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">or</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">A</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">(</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">z</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">)</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">only</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">with</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">zero</span></span><span style="color:#FF0000"> </span><span style="color:#FF0000"><span class="ec-lmtt-9">values</span></span><span style="color:#FF0000"><span class="ec-lmtt-9">!</span></span><span style="color:#FF0000"><span class="ts1-lmtt9-">'</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x53-196036r17"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x53-196037r18"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">1)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">everything</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">quantized</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">coeffs</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">input</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">internal</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">processing</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span> 
<span class="label"><a id="x53-196038r19"></a></span><span style="color:#000000"><span class="ec-lmtt-9">zeroReference</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">fi</span></span><span style="color:#000000"><span class="ec-lmtt-9">(0,1,2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">b</span></span><span style="color:#000000"><span class="ec-lmtt-9">,2*</span></span><span style="color:#000000"><span class="ec-lmtt-9">bf</span></span><span style="color:#000000"><span class="ec-lmtt-9">+1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">make</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">acc</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">a</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">fixed</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">point</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">obj</span></span> 
<span class="label"><a id="x53-196039r20"></a><span class="ec-lmr-6">20</span></span><span style="color:#000000"><span class="ec-lmtt-9">yq_my</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">myFilter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bq</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Aq</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">xf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">yf</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">zeroReference</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">all</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">inputs</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">fixed</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">point</span></span> 
<span class="label"><a id="x53-196040r21"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">2)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">no</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">quantization</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">but</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">myFilter</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">function</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span> 
<span class="label"><a id="x53-196041r22"></a></span><span style="color:#000000"><span class="ec-lmtt-9">zeroReference</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">it</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">is</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">a</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">double</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">so</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">it</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">will</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">be</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">acc</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">myFilter</span></span> 
<span class="label"><a id="x53-196042r23"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y_my</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">myFilter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">zeroReference</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">note</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">that</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">x</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"><span class="ec-lmtt-9">y</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"><span class="ec-lmtt-9">etc</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">are</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">double</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span> 
<span class="label"><a id="x53-196043r24"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">3)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">no</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">quantization</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">but</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">using</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Matlab</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span> 
<span class="label"><a id="x53-196044r25"></a><span class="ec-lmr-6">25</span></span><span style="color:#000000"><span class="ec-lmtt-9">y_matlab</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">filter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">B</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">A</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">x</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span> 
<span class="label"><a id="x53-196045r26"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x53-196046r27"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">function</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span class="ec-lmtt-9">myFilter</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bq</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">Aq</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">xn</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">yn</span></span><span style="color:#000000"><span class="ec-lmtt-9">,</span></span><span style="color:#000000"><span class="ec-lmtt-9">zeroReference</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x53-196047r28"></a></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Bq</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">get</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">order</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">of</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">numerator</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">...</span></span> 
<span class="label"><a id="x53-196048r29"></a></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">Aq</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">-1;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">denominator</span></span> 
<span class="label"><a id="x53-196049r30"></a><span class="ec-lmr-6">30</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Note</span></span><span style="color:#005900"><span class="ec-lmtt-9">:</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">this</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">code</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">does</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">not</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">treat</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">transient</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">in</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">first</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">samples</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">and</span></span> 
<span class="label"><a id="x53-196050r31"></a></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">will</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">differ</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">from</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Matlab</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">during</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">transient</span></span><span style="color:#005900"><span class="ec-lmtt-9">.</span></span> 
<span class="label"><a id="x53-196051r32"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">for</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"><span class="ec-lmtt-9">+1:</span></span><span style="color:#0000FF"><span class="ec-lmtt-9">length</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">xn</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">after</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">transient</span></span> 
<span class="label"><a id="x53-196052r33"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">acc</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">zeroReference</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">resets</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">accumulator</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"><span class="ec-lmtt-9">assume</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">fi</span></span><span style="color:#005900"><span class="ec-lmtt-9">(0,1,2*</span></span><span style="color:#005900"><span class="ec-lmtt-9">b</span></span><span style="color:#005900"><span class="ec-lmtt-9">,2*</span></span><span style="color:#005900"><span class="ec-lmtt-9">bf</span></span><span style="color:#005900"><span class="ec-lmtt-9">+1)</span></span> 
<span class="label"><a id="x53-196053r34"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">for</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">=0:</span></span><span style="color:#000000"><span class="ec-lmtt-9">M</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">implement</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Direct</span></span><span style="color:#005900"><span class="ec-lmtt-9">-</span></span><span style="color:#005900"><span class="ec-lmtt-9">II</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Transposed</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">as</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">Matlab</span></span><span style="color:#005900"><span class="ts1-lmtt9-">'</span></span><span style="color:#005900"><span class="ec-lmtt-9">s</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">filter</span></span> 
<span class="label"><a id="x53-196054r35"></a><span class="ec-lmr-6">35</span></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">acc</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">acc</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Bq</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">+1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">xn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">implements</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">numerator</span></span> 
<span class="label"><a id="x53-196055r36"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x53-196056r37"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">for</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">=1:</span></span><span style="color:#000000"><span class="ec-lmtt-9">N</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">Note</span></span><span style="color:#005900"><span class="ec-lmtt-9">,</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">code</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">assumes</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">A</span></span><span style="color:#005900"><span class="ec-lmtt-9">(1)</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">=</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">1</span></span> 
<span class="label"><a id="x53-196057r38"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">acc</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">acc</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">Aq</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">+1)</span></span><span style="color:#000000"><span class="ec-lmtt-9">*</span></span><span style="color:#000000"><span class="ec-lmtt-9">yn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">-</span></span><span style="color:#000000"><span class="ec-lmtt-9">i</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">implements</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">denominator</span></span> 
<span class="label"><a id="x53-196058r39"></a></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x53-196059r40"></a><span class="ec-lmr-6">40</span></span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span class="ec-lmtt-9">&nbsp;</span><span style="color:#000000"><span class="ec-lmtt-9">yn</span></span><span style="color:#000000"><span class="ec-lmtt-9">(</span></span><span style="color:#000000"><span class="ec-lmtt-9">n</span></span><span style="color:#000000"><span class="ec-lmtt-9">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span class="ec-lmtt-9">acc</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">update</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span> 
<span class="label"><a id="x53-196060r41"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span> 
<span class="label"><a id="x53-196061r42"></a></span><span style="color:#000000"><span class="ec-lmtt-9">y</span></span><span style="color:#000000"><span class="ec-lmtt-9">=</span></span><span style="color:#000000"><span class="ec-lmtt-9">yn</span></span><span style="color:#000000"><span class="ec-lmtt-9">;</span></span><span style="color:#000000"> </span><span style="color:#005900"><span class="ec-lmtt-9">%</span></span><span style="color:#005900"><span class="ec-lmtt-9">make</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">the</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">output</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">equal</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">to</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">yn</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">(</span></span><span style="color:#005900"><span class="ec-lmtt-9">yn</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">is</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">double</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">or</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">fixed</span></span><span style="color:#005900"> </span><span style="color:#005900"><span class="ec-lmtt-9">point</span></span><span style="color:#005900"><span class="ec-lmtt-9">)</span></span> 
<span class="label"><a id="x53-196062r43"></a></span><span style="color:#0000FF"><span class="ec-lmtt-9">end</span></span>
  </pre>
<figure class="figure">
<p><a id="x53-19606362"></a></p>
<!--l. 3499-->
<p class="noindent">
<img src="Figures/roundoffErrors.png" alt="PIC" class="figure-img">
</p>
<figcaption class="caption figure-caption">
<span class="id">Figure&nbsp;3.62: </span><span class="content">Example of filter outputs with floating-point double precision and fixed-point using Q2.3 generated with Listing&nbsp;<a href="#x53-196018r37">3.37<!--tex4ht:ref: code:roundoffErrors --></a>.</span>
</figcaption>
<!--tex4ht:label?: x53-19606362 -->
</figure>
<!--l. 3503-->
<p class="indent">
Listing&nbsp;<a href="#x53-196018r37">3.37<!--tex4ht:ref: code:roundoffErrors --></a> was used to generate Figure&nbsp;<a href="#x53-19606362">3.62<!--tex4ht:ref: fig:roundoffErrors --></a> with three signals: one obtained with fixed-point processing and two other not-quantized signals, which were obtained with <span class="ec-lmss-10x-x-109">myFilter </span>and Matlab’s <span class="ec-lmss-10x-x-109">filter </span>for validation purposes. It can be seen that the non-quantized signals differ only during the transient part, as commented in the source code of <span class="ec-lmss-10x-x-109">myFilter</span>. Other than that, the signals are equivalent.
</p>
<!--l. 3505-->
<p class="indent">
Observe that <span class="ec-lmss-10x-x-109">myFilter </span>provides support to using a special register called <span class="ec-lmri-10x-x-109">accumulator</span><a id="dx53-196064"></a>, which is typical in digital signal processor chips, and in this case uses twice the number of bits of the other registers. For example, when the regular registers have 16 bits, the accumulator may have 32 bits, to minimize the roundoff error. The number representation adopted during the internal processing within <span class="ec-lmss-10x-x-109">myFilter </span>is determined by the type (or class) of the inputs passed to the function. In the first call to <span class="ec-lmss-10x-x-109">myFilter </span>in Listing&nbsp;<a href="#x53-196018r37">3.37<!--tex4ht:ref: code:roundoffErrors --></a>, the variable <span class="ec-lmss-10x-x-109">zeroReference </span>and all others are fixed point objects and the function is careful to not change this condition. For example, using a command such as <span class="ec-lmss-10x-x-109">acc = 0 </span>would make acc a “double” variable, not an object of the fixed point class anymore. In the second call, all <span class="ec-lmss-10x-x-109">myFilter </span>inputs are in double precision and the result is equivalent to <span class="ec-lmss-10x-x-109">filter </span>after the transient.
</p>
<!--l. 3507-->
<p class="indent">
</p><p>It can be seen from Figure&nbsp;<a href="#x53-19606362">3.62<!--tex4ht:ref: fig:roundoffErrors --></a> that the quantized output has restricted range due to the small number of bits assigned to the integer part according to the Q2.3 representation. The reader is invited to run the code with a larger value for <span class="ec-lmss-10x-x-109">bi</span> and even modify it to properly deal with the transient in a Transposed Direct-II realization.</p>
<p></p>
<div class="footnotes">
<a id="x53-191005x3.14.1"></a> <!--l. 3250-->
<p class="indent">
<span class="footnote-mark"><a href="#fn32x5-bk" id="fn32x5"><sup class="textsuperscript">32</sup>&nbsp;</a></span><span class="ec-lmr-9">Matlab’s </span><span class="ec-lmss-9">fdatool</span><span class="ec-lmr-9">, via its menu Edit, provides support to converting the structure and also to showing</span> <span class="ec-lmr-9">it.</span>
</p>
<a id="x53-192033x3.14.2"></a> <!--l. 3372-->
<p class="indent">
<span class="footnote-mark"><a href="#fn33x5-bk" id="fn33x5"><sup class="textsuperscript">33</sup>&nbsp;</a></span><span class="ec-lmr-9">See Matlab’s documentation for the </span><span class="ec-lmss-9">filter </span><span class="ec-lmr-9">function for more details.</span>
</p>
<pre><code>                                  &lt;/div&gt;</code></pre>





 <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ak_dsp_bookse43.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">FIR Filter Design</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ak_dsp_bookse45.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multirate Processing</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Digital Signal Processing with Python, Matlab or Octave, Applications in Machine Learning Aldebaro Klautau Federal University of Pará (UFPA), Brazil</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</mspace></msub></mtext></mstyle></mtd></mtr></mtable></math></td></tr></tbody></table></div></td></tr></tbody></table></div></td></tr></tbody></table></div></blockquote></figure></body></html>